

============================== 2023-02-27 02:06:47.466036 | 758f225c-c1ec-4f53-81b7-6af7c6550314 ==============================
[0m02:06:47.466036 [info ] [MainThread]: Running with dbt=1.4.3
[0m02:06:47.467397 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/katiehuang/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
[0m02:06:47.467686 [debug] [MainThread]: Tracking: tracking
[0m02:06:47.488194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb7a08cd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb7a081ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb7a081dc0>]}
[0m02:06:47.957575 [debug] [MainThread]: Executing "git --help"
[0m02:06:48.149740 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m02:06:48.150825 [debug] [MainThread]: STDERR: "b''"
[0m02:06:48.190706 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m02:06:48.193017 [debug] [MainThread]: Using snowflake connection "debug"
[0m02:06:48.193309 [debug] [MainThread]: On debug: select 1 as id
[0m02:06:48.193572 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:06:52.181090 [debug] [MainThread]: SQL status: SUCCESS 1 in 4 seconds
[0m02:06:52.184529 [debug] [MainThread]: On debug: Close
[0m02:06:52.819452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb584763a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb58476580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb7a1e4bb0>]}
[0m02:06:52.820503 [debug] [MainThread]: Flushing usage events
[0m02:06:54.040157 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2023-02-27 03:16:09.544191 | 4ef64c3c-c5f3-4208-9163-e3db59d8c05d ==============================
[0m03:16:09.544191 [info ] [MainThread]: Running with dbt=1.4.3
[0m03:16:09.546514 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/katiehuang/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m03:16:09.546858 [debug] [MainThread]: Tracking: tracking
[0m03:16:09.547608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2204426a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc220442a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc220442910>]}
[0m03:16:09.560682 [debug] [MainThread]: checksum: c7a5cda64f02d8b9dd20ef412f82fbb79fdce1bb359c3c5dae3d080de7f31bfd, vars: {}, profile: None, target: None, version: 1.4.3
[0m03:16:09.561260 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m03:16:09.561582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4ef64c3c-c5f3-4208-9163-e3db59d8c05d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc220442a60>]}
[0m03:16:10.300662 [debug] [MainThread]: 1699: static parser successfully parsed src/src_listings.sql
[0m03:16:10.397342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4ef64c3c-c5f3-4208-9163-e3db59d8c05d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc232bd7310>]}
[0m03:16:10.403948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4ef64c3c-c5f3-4208-9163-e3db59d8c05d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2204426a0>]}
[0m03:16:10.404309 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 304 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m03:16:10.404625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4ef64c3c-c5f3-4208-9163-e3db59d8c05d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc220469340>]}
[0m03:16:10.405689 [info ] [MainThread]: 
[0m03:16:10.407181 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m03:16:10.408117 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_airbnb'
[0m03:16:10.423382 [debug] [ThreadPool]: Using snowflake connection "list_airbnb"
[0m03:16:10.423669 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb"} */
show terse schemas in database airbnb
    limit 10000
[0m03:16:10.423899 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:16:13.299562 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 3 seconds
[0m03:16:13.307944 [debug] [ThreadPool]: On list_airbnb: Close
[0m03:16:13.927808 [debug] [ThreadPool]: Acquiring new snowflake connection 'create_airbnb_dev'
[0m03:16:13.929836 [debug] [ThreadPool]: Acquiring new snowflake connection 'create_airbnb_dev'
[0m03:16:13.930640 [debug] [ThreadPool]: Creating schema "ReferenceKeyMsg(database='airbnb', schema='dev', identifier=None)"
[0m03:16:13.944876 [debug] [ThreadPool]: Using snowflake connection "create_airbnb_dev"
[0m03:16:13.945505 [debug] [ThreadPool]: On create_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "create_airbnb_dev"} */
create schema if not exists airbnb.dev
[0m03:16:13.945925 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:16:16.011403 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 2 seconds
[0m03:16:16.018527 [debug] [ThreadPool]: On create_airbnb_dev: Close
[0m03:16:16.594658 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_airbnb_dev'
[0m03:16:16.607848 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m03:16:16.608352 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m03:16:16.608692 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:16:18.657543 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 2 seconds
[0m03:16:18.662152 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m03:16:19.259608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4ef64c3c-c5f3-4208-9163-e3db59d8c05d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2204742b0>]}
[0m03:16:19.261654 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m03:16:19.262479 [info ] [MainThread]: 
[0m03:16:19.271364 [debug] [Thread-1  ]: Began running node model.dbtlearn.src_listings
[0m03:16:19.272122 [info ] [Thread-1  ]: 1 of 1 START sql view model dev.src_listings ................................... [RUN]
[0m03:16:19.273569 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtlearn.src_listings'
[0m03:16:19.273952 [debug] [Thread-1  ]: Began compiling node model.dbtlearn.src_listings
[0m03:16:19.276537 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearn.src_listings"
[0m03:16:19.277844 [debug] [Thread-1  ]: Timing info for model.dbtlearn.src_listings (compile): 2023-02-27 03:16:19.274220 => 2023-02-27 03:16:19.277681
[0m03:16:19.278219 [debug] [Thread-1  ]: Began executing node model.dbtlearn.src_listings
[0m03:16:19.315820 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtlearn.src_listings"
[0m03:16:19.317241 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.src_listings"
[0m03:16:19.317442 [debug] [Thread-1  ]: On model.dbtlearn.src_listings: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_listings"} */
create or replace   view airbnb.dev.src_listings
  
   as (
    WITH raw_listings AS (
	SELECT * FROM AIRBNB.RAW.RAW_LISTINGS
)

SELECT 
	id AS listing_id,
    name AS listing_name,
    listing_url,
    room_type,
    minimum_nights,
    host_id,
    price AS price_str,
    created_at,
    updated_at
FROM 
	raw_listings
  );
[0m03:16:19.317626 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:16:21.732592 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2 seconds
[0m03:16:21.765774 [debug] [Thread-1  ]: Timing info for model.dbtlearn.src_listings (execute): 2023-02-27 03:16:19.278466 => 2023-02-27 03:16:21.765677
[0m03:16:21.766222 [debug] [Thread-1  ]: On model.dbtlearn.src_listings: Close
[0m03:16:22.546297 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4ef64c3c-c5f3-4208-9163-e3db59d8c05d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc232d7db80>]}
[0m03:16:22.547852 [info ] [Thread-1  ]: 1 of 1 OK created sql view model dev.src_listings .............................. [[32mSUCCESS 1[0m in 3.27s]
[0m03:16:22.550830 [debug] [Thread-1  ]: Finished running node model.dbtlearn.src_listings
[0m03:16:22.555341 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m03:16:22.556242 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:16:22.556603 [debug] [MainThread]: Connection 'model.dbtlearn.src_listings' was properly closed.
[0m03:16:22.556890 [debug] [MainThread]: Connection 'list_airbnb_dev' was properly closed.
[0m03:16:22.557242 [info ] [MainThread]: 
[0m03:16:22.557848 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 12.15 seconds (12.15s).
[0m03:16:22.558629 [debug] [MainThread]: Command end result
[0m03:16:22.568024 [info ] [MainThread]: 
[0m03:16:22.568716 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:16:22.569106 [info ] [MainThread]: 
[0m03:16:22.569473 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m03:16:22.569942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc220bc2550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc220ce6430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc220bcb430>]}
[0m03:16:22.570306 [debug] [MainThread]: Flushing usage events


============================== 2023-02-27 03:26:12.708035 | 8304dbe7-28ac-4255-add6-76b7f534603b ==============================
[0m03:26:12.708035 [info ] [MainThread]: Running with dbt=1.4.3
[0m03:26:12.710465 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/katiehuang/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m03:26:12.710824 [debug] [MainThread]: Tracking: tracking
[0m03:26:12.711703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1a90d4700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1a90d4a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1a90d4970>]}
[0m03:26:12.724803 [debug] [MainThread]: checksum: c7a5cda64f02d8b9dd20ef412f82fbb79fdce1bb359c3c5dae3d080de7f31bfd, vars: {}, profile: None, target: None, version: 1.4.3
[0m03:26:12.763559 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m03:26:12.764099 [debug] [MainThread]: Partial parsing: added file: dbtlearn://models/src/src_reviews.sql
[0m03:26:12.781891 [debug] [MainThread]: 1699: static parser successfully parsed src/src_reviews.sql
[0m03:26:12.806664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8304dbe7-28ac-4255-add6-76b7f534603b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1986511f0>]}
[0m03:26:12.814687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8304dbe7-28ac-4255-add6-76b7f534603b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1ba664fd0>]}
[0m03:26:12.815079 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 304 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m03:26:12.815568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8304dbe7-28ac-4255-add6-76b7f534603b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1a90bf7c0>]}
[0m03:26:12.817117 [info ] [MainThread]: 
[0m03:26:12.818865 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m03:26:12.820044 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_airbnb'
[0m03:26:12.836890 [debug] [ThreadPool]: Using snowflake connection "list_airbnb"
[0m03:26:12.837284 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb"} */
show terse schemas in database airbnb
    limit 10000
[0m03:26:12.837736 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:26:15.245118 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2 seconds
[0m03:26:15.249736 [debug] [ThreadPool]: On list_airbnb: Close
[0m03:26:15.929327 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_airbnb_dev'
[0m03:26:15.942232 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m03:26:15.942639 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m03:26:15.942956 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:26:17.984928 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 2 seconds
[0m03:26:17.991542 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m03:26:18.607418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8304dbe7-28ac-4255-add6-76b7f534603b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1ba5b90d0>]}
[0m03:26:18.608759 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m03:26:18.609349 [info ] [MainThread]: 
[0m03:26:18.617388 [debug] [Thread-2  ]: Began running node model.dbtlearn.src_reviews
[0m03:26:18.617954 [debug] [Thread-1  ]: Began running node model.dbtlearn.src_listings
[0m03:26:18.618454 [info ] [Thread-2  ]: 2 of 2 START sql view model dev.src_reviews .................................... [RUN]
[0m03:26:18.619955 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtlearn.src_reviews'
[0m03:26:18.618952 [info ] [Thread-1  ]: 1 of 2 START sql view model dev.src_listings ................................... [RUN]
[0m03:26:18.620499 [debug] [Thread-2  ]: Began compiling node model.dbtlearn.src_reviews
[0m03:26:18.621234 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtlearn.src_listings'
[0m03:26:18.623791 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtlearn.src_reviews"
[0m03:26:18.624196 [debug] [Thread-1  ]: Began compiling node model.dbtlearn.src_listings
[0m03:26:18.626539 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearn.src_listings"
[0m03:26:18.627223 [debug] [Thread-2  ]: Timing info for model.dbtlearn.src_reviews (compile): 2023-02-27 03:26:18.621509 => 2023-02-27 03:26:18.627141
[0m03:26:18.627505 [debug] [Thread-1  ]: Timing info for model.dbtlearn.src_listings (compile): 2023-02-27 03:26:18.624529 => 2023-02-27 03:26:18.627443
[0m03:26:18.627784 [debug] [Thread-2  ]: Began executing node model.dbtlearn.src_reviews
[0m03:26:18.628073 [debug] [Thread-1  ]: Began executing node model.dbtlearn.src_listings
[0m03:26:18.677329 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbtlearn.src_reviews"
[0m03:26:18.677797 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtlearn.src_listings"
[0m03:26:18.678844 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearn.src_reviews"
[0m03:26:18.679634 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.src_listings"
[0m03:26:18.679813 [debug] [Thread-2  ]: On model.dbtlearn.src_reviews: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_reviews"} */
create or replace   view airbnb.dev.src_reviews
  
   as (
    WITH raw_reviews AS (
	SELECT * FROM AIRBNB.RAW.RAW_REVIEWS
)

SELECT
    listing_id,
    date AS review_date,
    reviewer_name,
    comments AS review_text,
    sentiment AS review_sentiment
FROM raw_reviews
  );
[0m03:26:18.679996 [debug] [Thread-1  ]: On model.dbtlearn.src_listings: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_listings"} */
create or replace   view airbnb.dev.src_listings
  
   as (
    WITH raw_listings AS (
	SELECT * FROM AIRBNB.RAW.RAW_LISTINGS
)

SELECT 
	id AS listing_id,
    name AS listing_name,
    listing_url,
    room_type,
    minimum_nights,
    host_id,
    price AS price_str,
    created_at,
    updated_at
FROM 
	raw_listings
  );
[0m03:26:18.680191 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m03:26:18.680388 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:26:20.690129 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2 seconds
[0m03:26:20.728366 [debug] [Thread-1  ]: Timing info for model.dbtlearn.src_listings (execute): 2023-02-27 03:26:18.652982 => 2023-02-27 03:26:20.728273
[0m03:26:20.728801 [debug] [Thread-1  ]: On model.dbtlearn.src_listings: Close
[0m03:26:20.896862 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 2 seconds
[0m03:26:20.904132 [debug] [Thread-2  ]: Timing info for model.dbtlearn.src_reviews (execute): 2023-02-27 03:26:18.628299 => 2023-02-27 03:26:20.904009
[0m03:26:20.904675 [debug] [Thread-2  ]: On model.dbtlearn.src_reviews: Close
[0m03:26:21.293165 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8304dbe7-28ac-4255-add6-76b7f534603b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1ba78c130>]}
[0m03:26:21.294120 [info ] [Thread-1  ]: 1 of 2 OK created sql view model dev.src_listings .............................. [[32mSUCCESS 1[0m in 2.67s]
[0m03:26:21.296661 [debug] [Thread-1  ]: Finished running node model.dbtlearn.src_listings
[0m03:26:21.690140 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8304dbe7-28ac-4255-add6-76b7f534603b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc18819cd60>]}
[0m03:26:21.691232 [info ] [Thread-2  ]: 2 of 2 OK created sql view model dev.src_reviews ............................... [[32mSUCCESS 1[0m in 3.07s]
[0m03:26:21.691975 [debug] [Thread-2  ]: Finished running node model.dbtlearn.src_reviews
[0m03:26:21.694498 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m03:26:21.695472 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:26:21.695824 [debug] [MainThread]: Connection 'model.dbtlearn.src_listings' was properly closed.
[0m03:26:21.696128 [debug] [MainThread]: Connection 'model.dbtlearn.src_reviews' was properly closed.
[0m03:26:21.696521 [info ] [MainThread]: 
[0m03:26:21.697073 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 8.88 seconds (8.88s).
[0m03:26:21.697840 [debug] [MainThread]: Command end result
[0m03:26:21.707893 [info ] [MainThread]: 
[0m03:26:21.708397 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:26:21.708803 [info ] [MainThread]: 
[0m03:26:21.709197 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m03:26:21.709691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1a90d4760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1880a3640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1880a3d90>]}
[0m03:26:21.710074 [debug] [MainThread]: Flushing usage events


============================== 2023-02-27 03:39:31.844922 | 48f4d644-9dc2-42db-ba87-89f75f54a7b6 ==============================
[0m03:39:31.844922 [info ] [MainThread]: Running with dbt=1.4.3
[0m03:39:31.847311 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/katiehuang/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m03:39:31.847647 [debug] [MainThread]: Tracking: tracking
[0m03:39:31.848438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1ea4da790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1ea4dab20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1ea4daa00>]}
[0m03:39:31.861136 [debug] [MainThread]: checksum: c7a5cda64f02d8b9dd20ef412f82fbb79fdce1bb359c3c5dae3d080de7f31bfd, vars: {}, profile: None, target: None, version: 1.4.3
[0m03:39:31.901811 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m03:39:31.902278 [debug] [MainThread]: Partial parsing: added file: dbtlearn://models/src/src_hosts.sql
[0m03:39:31.919834 [debug] [MainThread]: 1699: static parser successfully parsed src/src_hosts.sql
[0m03:39:31.944358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '48f4d644-9dc2-42db-ba87-89f75f54a7b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1ea69a4f0>]}
[0m03:39:31.951431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '48f4d644-9dc2-42db-ba87-89f75f54a7b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1ea6738e0>]}
[0m03:39:31.951792 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 304 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m03:39:31.952109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '48f4d644-9dc2-42db-ba87-89f75f54a7b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1ea6739a0>]}
[0m03:39:31.953488 [info ] [MainThread]: 
[0m03:39:31.955003 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m03:39:31.956116 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_airbnb'
[0m03:39:31.971677 [debug] [ThreadPool]: Using snowflake connection "list_airbnb"
[0m03:39:31.972000 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb"} */
show terse schemas in database airbnb
    limit 10000
[0m03:39:31.972244 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:39:34.268006 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2 seconds
[0m03:39:34.272316 [debug] [ThreadPool]: On list_airbnb: Close
[0m03:39:34.880705 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_airbnb_dev'
[0m03:39:34.894131 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m03:39:34.894515 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m03:39:34.894845 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:39:37.705095 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 3 seconds
[0m03:39:37.709817 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m03:39:38.374988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '48f4d644-9dc2-42db-ba87-89f75f54a7b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1ea4da7f0>]}
[0m03:39:38.376489 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m03:39:38.377088 [info ] [MainThread]: 
[0m03:39:38.385251 [debug] [Thread-2  ]: Began running node model.dbtlearn.src_listings
[0m03:39:38.385809 [debug] [Thread-3  ]: Began running node model.dbtlearn.src_reviews
[0m03:39:38.386269 [debug] [Thread-1  ]: Began running node model.dbtlearn.src_hosts
[0m03:39:38.386747 [info ] [Thread-2  ]: 2 of 3 START sql view model dev.src_listings ................................... [RUN]
[0m03:39:38.387386 [info ] [Thread-3  ]: 3 of 3 START sql view model dev.src_reviews .................................... [RUN]
[0m03:39:38.388121 [info ] [Thread-1  ]: 1 of 3 START sql view model dev.src_hosts ...................................... [RUN]
[0m03:39:38.389179 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtlearn.src_listings'
[0m03:39:38.389939 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtlearn.src_reviews'
[0m03:39:38.390659 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtlearn.src_hosts'
[0m03:39:38.391030 [debug] [Thread-2  ]: Began compiling node model.dbtlearn.src_listings
[0m03:39:38.391371 [debug] [Thread-3  ]: Began compiling node model.dbtlearn.src_reviews
[0m03:39:38.391692 [debug] [Thread-1  ]: Began compiling node model.dbtlearn.src_hosts
[0m03:39:38.394308 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtlearn.src_listings"
[0m03:39:38.396566 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtlearn.src_reviews"
[0m03:39:38.398589 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearn.src_hosts"
[0m03:39:38.399711 [debug] [Thread-3  ]: Timing info for model.dbtlearn.src_reviews (compile): 2023-02-27 03:39:38.394602 => 2023-02-27 03:39:38.399588
[0m03:39:38.400058 [debug] [Thread-2  ]: Timing info for model.dbtlearn.src_listings (compile): 2023-02-27 03:39:38.391945 => 2023-02-27 03:39:38.399989
[0m03:39:38.400328 [debug] [Thread-1  ]: Timing info for model.dbtlearn.src_hosts (compile): 2023-02-27 03:39:38.396839 => 2023-02-27 03:39:38.400262
[0m03:39:38.400621 [debug] [Thread-3  ]: Began executing node model.dbtlearn.src_reviews
[0m03:39:38.400926 [debug] [Thread-2  ]: Began executing node model.dbtlearn.src_listings
[0m03:39:38.401209 [debug] [Thread-1  ]: Began executing node model.dbtlearn.src_hosts
[0m03:39:38.468599 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbtlearn.src_reviews"
[0m03:39:38.469073 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbtlearn.src_listings"
[0m03:39:38.471373 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtlearn.src_hosts"
[0m03:39:38.472571 [debug] [Thread-3  ]: Using snowflake connection "model.dbtlearn.src_reviews"
[0m03:39:38.473394 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearn.src_listings"
[0m03:39:38.473588 [debug] [Thread-3  ]: On model.dbtlearn.src_reviews: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_reviews"} */
create or replace   view airbnb.dev.src_reviews
  
   as (
    WITH raw_reviews AS (
	SELECT * FROM AIRBNB.RAW.RAW_REVIEWS
)

SELECT
    listing_id,
    date AS review_date,
    reviewer_name,
    comments AS review_text,
    sentiment AS review_sentiment
FROM raw_reviews
  );
[0m03:39:38.474252 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.src_hosts"
[0m03:39:38.474416 [debug] [Thread-2  ]: On model.dbtlearn.src_listings: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_listings"} */
create or replace   view airbnb.dev.src_listings
  
   as (
    WITH raw_listings AS (
	SELECT * FROM AIRBNB.RAW.RAW_LISTINGS
)

SELECT 
	id AS listing_id,
    name AS listing_name,
    listing_url,
    room_type,
    minimum_nights,
    host_id,
    price AS price_str,
    created_at,
    updated_at
FROM 
	raw_listings
  );
[0m03:39:38.474604 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m03:39:38.474787 [debug] [Thread-1  ]: On model.dbtlearn.src_hosts: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_hosts"} */
create or replace   view airbnb.dev.src_hosts
  
   as (
    WITH raw_hosts AS (
	SELECT * FROM AIRBNB.RAW.RAW_HOSTS
)

SELECT
    id AS host_id,
    name AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM raw_hosts
  );
[0m03:39:38.474975 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m03:39:38.475426 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:39:40.649637 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 2 seconds
[0m03:39:40.677540 [debug] [Thread-3  ]: Timing info for model.dbtlearn.src_reviews (execute): 2023-02-27 03:39:38.401410 => 2023-02-27 03:39:40.677455
[0m03:39:40.677932 [debug] [Thread-3  ]: On model.dbtlearn.src_reviews: Close
[0m03:39:40.742244 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2 seconds
[0m03:39:40.747454 [debug] [Thread-1  ]: Timing info for model.dbtlearn.src_hosts (execute): 2023-02-27 03:39:38.419823 => 2023-02-27 03:39:40.747336
[0m03:39:40.747966 [debug] [Thread-1  ]: On model.dbtlearn.src_hosts: Close
[0m03:39:40.777828 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 2 seconds
[0m03:39:40.782580 [debug] [Thread-2  ]: Timing info for model.dbtlearn.src_listings (execute): 2023-02-27 03:39:38.407758 => 2023-02-27 03:39:40.782520
[0m03:39:40.782848 [debug] [Thread-2  ]: On model.dbtlearn.src_listings: Close
[0m03:39:41.286583 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '48f4d644-9dc2-42db-ba87-89f75f54a7b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1ea8edb50>]}
[0m03:39:41.287780 [info ] [Thread-3  ]: 3 of 3 OK created sql view model dev.src_reviews ............................... [[32mSUCCESS 1[0m in 2.90s]
[0m03:39:41.290056 [debug] [Thread-3  ]: Finished running node model.dbtlearn.src_reviews
[0m03:39:41.307048 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '48f4d644-9dc2-42db-ba87-89f75f54a7b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1ea5f00a0>]}
[0m03:39:41.307892 [info ] [Thread-1  ]: 1 of 3 OK created sql view model dev.src_hosts ................................. [[32mSUCCESS 1[0m in 2.92s]
[0m03:39:41.308485 [debug] [Thread-1  ]: Finished running node model.dbtlearn.src_hosts
[0m03:39:41.359927 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '48f4d644-9dc2-42db-ba87-89f75f54a7b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1ea998cd0>]}
[0m03:39:41.360680 [info ] [Thread-2  ]: 2 of 3 OK created sql view model dev.src_listings .............................. [[32mSUCCESS 1[0m in 2.97s]
[0m03:39:41.361276 [debug] [Thread-2  ]: Finished running node model.dbtlearn.src_listings
[0m03:39:41.364874 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m03:39:41.365638 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:39:41.365914 [debug] [MainThread]: Connection 'model.dbtlearn.src_hosts' was properly closed.
[0m03:39:41.366153 [debug] [MainThread]: Connection 'model.dbtlearn.src_listings' was properly closed.
[0m03:39:41.366380 [debug] [MainThread]: Connection 'model.dbtlearn.src_reviews' was properly closed.
[0m03:39:41.366702 [info ] [MainThread]: 
[0m03:39:41.367138 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 9.41 seconds (9.41s).
[0m03:39:41.367856 [debug] [MainThread]: Command end result
[0m03:39:41.376548 [info ] [MainThread]: 
[0m03:39:41.377053 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:39:41.377437 [info ] [MainThread]: 
[0m03:39:41.377814 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m03:39:41.378285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1ea8218e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1ea8219d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1c89fbc10>]}
[0m03:39:41.378648 [debug] [MainThread]: Flushing usage events


============================== 2023-02-27 05:11:14.941298 | d9787f48-ff85-457e-9f05-2852faba9344 ==============================
[0m05:11:14.941298 [info ] [MainThread]: Running with dbt=1.4.3
[0m05:11:14.943962 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/katiehuang/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m05:11:14.944316 [debug] [MainThread]: Tracking: tracking
[0m05:11:14.945043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8199702820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8199702bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8199702a90>]}
[0m05:11:14.958105 [debug] [MainThread]: checksum: c7a5cda64f02d8b9dd20ef412f82fbb79fdce1bb359c3c5dae3d080de7f31bfd, vars: {}, profile: None, target: None, version: 1.4.3
[0m05:11:14.996182 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m05:11:14.996654 [debug] [MainThread]: Partial parsing: added file: dbtlearn://models/dim/dim_listings_cleansed.sql
[0m05:11:15.014808 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_cleansed.sql
[0m05:11:15.039256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd9787f48-ff85-457e-9f05-2852faba9344', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8188285940>]}
[0m05:11:15.047226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd9787f48-ff85-457e-9f05-2852faba9344', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81aa3fbd30>]}
[0m05:11:15.047586 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 304 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m05:11:15.047917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd9787f48-ff85-457e-9f05-2852faba9344', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81aa3fbe80>]}
[0m05:11:15.049340 [info ] [MainThread]: 
[0m05:11:15.050825 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m05:11:15.052001 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_airbnb'
[0m05:11:15.067861 [debug] [ThreadPool]: Using snowflake connection "list_airbnb"
[0m05:11:15.068204 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb"} */
show terse schemas in database airbnb
    limit 10000
[0m05:11:15.068452 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:11:17.479202 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2 seconds
[0m05:11:17.484668 [debug] [ThreadPool]: On list_airbnb: Close
[0m05:11:18.158709 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_airbnb_dev'
[0m05:11:18.171910 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m05:11:18.172323 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m05:11:18.172654 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:11:20.082896 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 2 seconds
[0m05:11:20.087432 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m05:11:20.689579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd9787f48-ff85-457e-9f05-2852faba9344', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81aa30f250>]}
[0m05:11:20.690861 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m05:11:20.691447 [info ] [MainThread]: 
[0m05:11:20.699869 [debug] [Thread-2  ]: Began running node model.dbtlearn.src_listings
[0m05:11:20.700472 [debug] [Thread-3  ]: Began running node model.dbtlearn.src_reviews
[0m05:11:20.700976 [debug] [Thread-1  ]: Began running node model.dbtlearn.src_hosts
[0m05:11:20.701517 [info ] [Thread-2  ]: 2 of 4 START sql view model dev.src_listings ................................... [RUN]
[0m05:11:20.702148 [info ] [Thread-3  ]: 3 of 4 START sql view model dev.src_reviews .................................... [RUN]
[0m05:11:20.702695 [info ] [Thread-1  ]: 1 of 4 START sql view model dev.src_hosts ...................................... [RUN]
[0m05:11:20.703729 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtlearn.src_listings'
[0m05:11:20.704447 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtlearn.src_reviews'
[0m05:11:20.705110 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtlearn.src_hosts'
[0m05:11:20.705459 [debug] [Thread-2  ]: Began compiling node model.dbtlearn.src_listings
[0m05:11:20.705776 [debug] [Thread-3  ]: Began compiling node model.dbtlearn.src_reviews
[0m05:11:20.706077 [debug] [Thread-1  ]: Began compiling node model.dbtlearn.src_hosts
[0m05:11:20.708557 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtlearn.src_listings"
[0m05:11:20.710747 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtlearn.src_reviews"
[0m05:11:20.712657 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearn.src_hosts"
[0m05:11:20.713504 [debug] [Thread-2  ]: Timing info for model.dbtlearn.src_listings (compile): 2023-02-27 05:11:20.706312 => 2023-02-27 05:11:20.713403
[0m05:11:20.713871 [debug] [Thread-2  ]: Began executing node model.dbtlearn.src_listings
[0m05:11:20.720518 [debug] [Thread-3  ]: Timing info for model.dbtlearn.src_reviews (compile): 2023-02-27 05:11:20.708834 => 2023-02-27 05:11:20.720432
[0m05:11:20.733946 [debug] [Thread-1  ]: Timing info for model.dbtlearn.src_hosts (compile): 2023-02-27 05:11:20.710996 => 2023-02-27 05:11:20.733884
[0m05:11:20.734212 [debug] [Thread-3  ]: Began executing node model.dbtlearn.src_reviews
[0m05:11:20.750141 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbtlearn.src_listings"
[0m05:11:20.750388 [debug] [Thread-1  ]: Began executing node model.dbtlearn.src_hosts
[0m05:11:20.754531 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbtlearn.src_reviews"
[0m05:11:20.757799 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtlearn.src_hosts"
[0m05:11:20.758927 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearn.src_listings"
[0m05:11:20.759137 [debug] [Thread-2  ]: On model.dbtlearn.src_listings: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_listings"} */
create or replace   view airbnb.dev.src_listings
  
   as (
    WITH raw_listings AS (
	SELECT * FROM AIRBNB.RAW.RAW_LISTINGS
)

SELECT 
	id AS listing_id,
    name AS listing_name,
    listing_url,
    room_type,
    minimum_nights,
    host_id,
    price AS price_str,
    created_at,
    updated_at
FROM 
	raw_listings
  );
[0m05:11:20.759842 [debug] [Thread-3  ]: Using snowflake connection "model.dbtlearn.src_reviews"
[0m05:11:20.760047 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m05:11:20.760251 [debug] [Thread-3  ]: On model.dbtlearn.src_reviews: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_reviews"} */
create or replace   view airbnb.dev.src_reviews
  
   as (
    WITH raw_reviews AS (
	SELECT * FROM AIRBNB.RAW.RAW_REVIEWS
)

SELECT
    listing_id,
    date AS review_date,
    reviewer_name,
    comments AS review_text,
    sentiment AS review_sentiment
FROM raw_reviews
  );
[0m05:11:20.760870 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.src_hosts"
[0m05:11:20.761291 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m05:11:20.761800 [debug] [Thread-1  ]: On model.dbtlearn.src_hosts: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_hosts"} */
create or replace   view airbnb.dev.src_hosts
  
   as (
    WITH raw_hosts AS (
	SELECT * FROM AIRBNB.RAW.RAW_HOSTS
)

SELECT
    id AS host_id,
    name AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM raw_hosts
  );
[0m05:11:20.763034 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m05:11:23.108755 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2 seconds
[0m05:11:23.146382 [debug] [Thread-1  ]: Timing info for model.dbtlearn.src_hosts (execute): 2023-02-27 05:11:20.754817 => 2023-02-27 05:11:23.146304
[0m05:11:23.146999 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 2 seconds
[0m05:11:23.147258 [debug] [Thread-1  ]: On model.dbtlearn.src_hosts: Close
[0m05:11:23.149698 [debug] [Thread-3  ]: Timing info for model.dbtlearn.src_reviews (execute): 2023-02-27 05:11:20.750560 => 2023-02-27 05:11:23.149654
[0m05:11:23.151182 [debug] [Thread-3  ]: On model.dbtlearn.src_reviews: Close
[0m05:11:23.308939 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 3 seconds
[0m05:11:23.316976 [debug] [Thread-2  ]: Timing info for model.dbtlearn.src_listings (execute): 2023-02-27 05:11:20.714143 => 2023-02-27 05:11:23.316871
[0m05:11:23.317462 [debug] [Thread-2  ]: On model.dbtlearn.src_listings: Close
[0m05:11:23.760211 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9787f48-ff85-457e-9f05-2852faba9344', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81882f8520>]}
[0m05:11:23.761930 [info ] [Thread-3  ]: 3 of 4 OK created sql view model dev.src_reviews ............................... [[32mSUCCESS 1[0m in 3.06s]
[0m05:11:23.765011 [debug] [Thread-3  ]: Finished running node model.dbtlearn.src_reviews
[0m05:11:23.848902 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9787f48-ff85-457e-9f05-2852faba9344', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81aa30f2b0>]}
[0m05:11:23.849585 [info ] [Thread-1  ]: 1 of 4 OK created sql view model dev.src_hosts ................................. [[32mSUCCESS 1[0m in 3.14s]
[0m05:11:23.850096 [debug] [Thread-1  ]: Finished running node model.dbtlearn.src_hosts
[0m05:11:23.922628 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9787f48-ff85-457e-9f05-2852faba9344', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8188381d90>]}
[0m05:11:23.923672 [info ] [Thread-2  ]: 2 of 4 OK created sql view model dev.src_listings .............................. [[32mSUCCESS 1[0m in 3.22s]
[0m05:11:23.924551 [debug] [Thread-2  ]: Finished running node model.dbtlearn.src_listings
[0m05:11:23.925758 [debug] [Thread-4  ]: Began running node model.dbtlearn.dim_listings_cleansed
[0m05:11:23.926405 [info ] [Thread-4  ]: 4 of 4 START sql view model dev.dim_listings_cleansed .......................... [RUN]
[0m05:11:23.927591 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.dbtlearn.dim_listings_cleansed'
[0m05:11:23.928003 [debug] [Thread-4  ]: Began compiling node model.dbtlearn.dim_listings_cleansed
[0m05:11:23.935706 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtlearn.dim_listings_cleansed"
[0m05:11:23.936749 [debug] [Thread-4  ]: Timing info for model.dbtlearn.dim_listings_cleansed (compile): 2023-02-27 05:11:23.928295 => 2023-02-27 05:11:23.936657
[0m05:11:23.937119 [debug] [Thread-4  ]: Began executing node model.dbtlearn.dim_listings_cleansed
[0m05:11:23.941732 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbtlearn.dim_listings_cleansed"
[0m05:11:23.943655 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearn.dim_listings_cleansed"
[0m05:11:23.943949 [debug] [Thread-4  ]: On model.dbtlearn.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_cleansed"} */
create or replace   view airbnb.dev.dim_listings_cleansed
  
   as (
    WITH src_listings AS (
    SELECT * FROM airbnb.dev.src_listings
)

SELECT
    listing_id,
    listing_name,
    room_type,
    CASE 
        WHEN minimum_nights = 0 THEN 1 -- 0 night = 1 night, so we assign the value of 1 to indicate 1 night
        ELSE minimum_nights
    END AS minimum_nights,
    host_id,
    REPLACE( -- Parse string value into numerical form
        price_str, '$' -- Replace '$' with price_str value. In other words, to remove '$' from string.
        ) :: NUMBER (10, 2 -- Convert string type to numerical with 2 decimal places
    ) AS price,
    created_at,
    updated_at
    
FROM src_listings
  );
[0m05:11:23.944243 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m05:11:26.224192 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 2 seconds
[0m05:11:26.230856 [debug] [Thread-4  ]: Timing info for model.dbtlearn.dim_listings_cleansed (execute): 2023-02-27 05:11:23.937358 => 2023-02-27 05:11:26.230682
[0m05:11:26.231565 [debug] [Thread-4  ]: On model.dbtlearn.dim_listings_cleansed: Close
[0m05:11:26.843980 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9787f48-ff85-457e-9f05-2852faba9344', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f818842a190>]}
[0m05:11:26.844627 [info ] [Thread-4  ]: 4 of 4 OK created sql view model dev.dim_listings_cleansed ..................... [[32mSUCCESS 1[0m in 2.92s]
[0m05:11:26.845169 [debug] [Thread-4  ]: Finished running node model.dbtlearn.dim_listings_cleansed
[0m05:11:26.848645 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m05:11:26.849310 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:11:26.849545 [debug] [MainThread]: Connection 'model.dbtlearn.src_hosts' was properly closed.
[0m05:11:26.849751 [debug] [MainThread]: Connection 'model.dbtlearn.src_listings' was properly closed.
[0m05:11:26.849946 [debug] [MainThread]: Connection 'model.dbtlearn.src_reviews' was properly closed.
[0m05:11:26.850134 [debug] [MainThread]: Connection 'model.dbtlearn.dim_listings_cleansed' was properly closed.
[0m05:11:26.850470 [info ] [MainThread]: 
[0m05:11:26.850859 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 11.80 seconds (11.80s).
[0m05:11:26.851542 [debug] [MainThread]: Command end result
[0m05:11:26.861094 [info ] [MainThread]: 
[0m05:11:26.861612 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:11:26.862019 [info ] [MainThread]: 
[0m05:11:26.862417 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m05:11:26.862947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8188458c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8188365d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8188365e50>]}
[0m05:11:26.863350 [debug] [MainThread]: Flushing usage events


============================== 2023-02-27 05:17:00.367957 | ba257fb8-d9ff-4a29-b418-e23e976d8804 ==============================
[0m05:17:00.367957 [info ] [MainThread]: Running with dbt=1.4.3
[0m05:17:00.370509 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/katiehuang/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m05:17:00.370859 [debug] [MainThread]: Tracking: tracking
[0m05:17:00.371795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3f94de730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3f94deac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3f94de9a0>]}
[0m05:17:00.384853 [debug] [MainThread]: checksum: c7a5cda64f02d8b9dd20ef412f82fbb79fdce1bb359c3c5dae3d080de7f31bfd, vars: {}, profile: None, target: None, version: 1.4.3
[0m05:17:00.422952 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m05:17:00.423408 [debug] [MainThread]: Partial parsing: added file: dbtlearn://models/dim/dim_hosts_cleansed.sql
[0m05:17:00.441841 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_hosts_cleansed.sql
[0m05:17:00.466813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ba257fb8-d9ff-4a29-b418-e23e976d8804', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3e8765c10>]}
[0m05:17:00.474191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ba257fb8-d9ff-4a29-b418-e23e976d8804', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3e8743eb0>]}
[0m05:17:00.474564 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 304 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m05:17:00.474890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ba257fb8-d9ff-4a29-b418-e23e976d8804', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3e8743e80>]}
[0m05:17:00.476358 [info ] [MainThread]: 
[0m05:17:00.477861 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m05:17:00.479047 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_airbnb'
[0m05:17:00.494720 [debug] [ThreadPool]: Using snowflake connection "list_airbnb"
[0m05:17:00.495052 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb"} */
show terse schemas in database airbnb
    limit 10000
[0m05:17:00.495285 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:17:03.140355 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 3 seconds
[0m05:17:03.145907 [debug] [ThreadPool]: On list_airbnb: Close
[0m05:17:04.366253 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_airbnb_dev'
[0m05:17:04.387072 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m05:17:04.387732 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m05:17:04.388148 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:17:06.790016 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2 seconds
[0m05:17:06.794229 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m05:17:07.541460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ba257fb8-d9ff-4a29-b418-e23e976d8804', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3e8743d30>]}
[0m05:17:07.543839 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m05:17:07.546153 [info ] [MainThread]: 
[0m05:17:07.559062 [debug] [Thread-2  ]: Began running node model.dbtlearn.src_listings
[0m05:17:07.559928 [debug] [Thread-3  ]: Began running node model.dbtlearn.src_reviews
[0m05:17:07.560529 [debug] [Thread-1  ]: Began running node model.dbtlearn.src_hosts
[0m05:17:07.561141 [info ] [Thread-2  ]: 2 of 5 START sql view model dev.src_listings ................................... [RUN]
[0m05:17:07.562058 [info ] [Thread-3  ]: 3 of 5 START sql view model dev.src_reviews .................................... [RUN]
[0m05:17:07.562859 [info ] [Thread-1  ]: 1 of 5 START sql view model dev.src_hosts ...................................... [RUN]
[0m05:17:07.564184 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtlearn.src_listings'
[0m05:17:07.565172 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtlearn.src_reviews'
[0m05:17:07.566063 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtlearn.src_hosts'
[0m05:17:07.566490 [debug] [Thread-2  ]: Began compiling node model.dbtlearn.src_listings
[0m05:17:07.566934 [debug] [Thread-3  ]: Began compiling node model.dbtlearn.src_reviews
[0m05:17:07.567357 [debug] [Thread-1  ]: Began compiling node model.dbtlearn.src_hosts
[0m05:17:07.570478 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtlearn.src_listings"
[0m05:17:07.574004 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtlearn.src_reviews"
[0m05:17:07.576153 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearn.src_hosts"
[0m05:17:07.576936 [debug] [Thread-2  ]: Timing info for model.dbtlearn.src_listings (compile): 2023-02-27 05:17:07.567655 => 2023-02-27 05:17:07.576844
[0m05:17:07.577352 [debug] [Thread-2  ]: Began executing node model.dbtlearn.src_listings
[0m05:17:07.590363 [debug] [Thread-3  ]: Timing info for model.dbtlearn.src_reviews (compile): 2023-02-27 05:17:07.570837 => 2023-02-27 05:17:07.590302
[0m05:17:07.590632 [debug] [Thread-1  ]: Timing info for model.dbtlearn.src_hosts (compile): 2023-02-27 05:17:07.574286 => 2023-02-27 05:17:07.590573
[0m05:17:07.602909 [debug] [Thread-3  ]: Began executing node model.dbtlearn.src_reviews
[0m05:17:07.613878 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbtlearn.src_listings"
[0m05:17:07.614154 [debug] [Thread-1  ]: Began executing node model.dbtlearn.src_hosts
[0m05:17:07.617219 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbtlearn.src_reviews"
[0m05:17:07.620592 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtlearn.src_hosts"
[0m05:17:07.621714 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearn.src_listings"
[0m05:17:07.621926 [debug] [Thread-2  ]: On model.dbtlearn.src_listings: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_listings"} */
create or replace   view airbnb.dev.src_listings
  
   as (
    WITH raw_listings AS (
	SELECT * FROM AIRBNB.RAW.RAW_LISTINGS
)

SELECT 
	id AS listing_id,
    name AS listing_name,
    listing_url,
    room_type,
    minimum_nights,
    host_id,
    price AS price_str,
    created_at,
    updated_at
FROM 
	raw_listings
  );
[0m05:17:07.622149 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m05:17:07.623172 [debug] [Thread-3  ]: Using snowflake connection "model.dbtlearn.src_reviews"
[0m05:17:07.624272 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.src_hosts"
[0m05:17:07.624442 [debug] [Thread-3  ]: On model.dbtlearn.src_reviews: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_reviews"} */
create or replace   view airbnb.dev.src_reviews
  
   as (
    WITH raw_reviews AS (
	SELECT * FROM AIRBNB.RAW.RAW_REVIEWS
)

SELECT
    listing_id,
    date AS review_date,
    reviewer_name,
    comments AS review_text,
    sentiment AS review_sentiment
FROM raw_reviews
  );
[0m05:17:07.624627 [debug] [Thread-1  ]: On model.dbtlearn.src_hosts: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_hosts"} */
create or replace   view airbnb.dev.src_hosts
  
   as (
    WITH raw_hosts AS (
	SELECT * FROM AIRBNB.RAW.RAW_HOSTS
)

SELECT
    id AS host_id,
    name AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM raw_hosts
  );
[0m05:17:07.625353 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m05:17:07.625613 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m05:17:10.389035 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 3 seconds
[0m05:17:10.417348 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 3 seconds
[0m05:17:10.427819 [debug] [Thread-3  ]: Timing info for model.dbtlearn.src_reviews (execute): 2023-02-27 05:17:07.614320 => 2023-02-27 05:17:10.427757
[0m05:17:10.430250 [debug] [Thread-2  ]: Timing info for model.dbtlearn.src_listings (execute): 2023-02-27 05:17:07.577656 => 2023-02-27 05:17:10.430206
[0m05:17:10.430528 [debug] [Thread-3  ]: On model.dbtlearn.src_reviews: Close
[0m05:17:10.430763 [debug] [Thread-2  ]: On model.dbtlearn.src_listings: Close
[0m05:17:10.537567 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 3 seconds
[0m05:17:10.543696 [debug] [Thread-1  ]: Timing info for model.dbtlearn.src_hosts (execute): 2023-02-27 05:17:07.617497 => 2023-02-27 05:17:10.543612
[0m05:17:10.544120 [debug] [Thread-1  ]: On model.dbtlearn.src_hosts: Close
[0m05:17:11.600358 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ba257fb8-d9ff-4a29-b418-e23e976d8804', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3e8743910>]}
[0m05:17:11.601802 [info ] [Thread-1  ]: 1 of 5 OK created sql view model dev.src_hosts ................................. [[32mSUCCESS 1[0m in 4.03s]
[0m05:17:11.604566 [debug] [Thread-1  ]: Finished running node model.dbtlearn.src_hosts
[0m05:17:11.605646 [debug] [Thread-4  ]: Began running node model.dbtlearn.dim_hosts_cleansed
[0m05:17:11.606200 [info ] [Thread-4  ]: 4 of 5 START sql view model dev.dim_hosts_cleansed ............................. [RUN]
[0m05:17:11.607365 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.dbtlearn.dim_hosts_cleansed'
[0m05:17:11.607764 [debug] [Thread-4  ]: Began compiling node model.dbtlearn.dim_hosts_cleansed
[0m05:17:11.612586 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtlearn.dim_hosts_cleansed"
[0m05:17:11.613660 [debug] [Thread-4  ]: Timing info for model.dbtlearn.dim_hosts_cleansed (compile): 2023-02-27 05:17:11.608039 => 2023-02-27 05:17:11.613569
[0m05:17:11.614016 [debug] [Thread-4  ]: Began executing node model.dbtlearn.dim_hosts_cleansed
[0m05:17:11.618763 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbtlearn.dim_hosts_cleansed"
[0m05:17:11.620182 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearn.dim_hosts_cleansed"
[0m05:17:11.620481 [debug] [Thread-4  ]: On model.dbtlearn.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_hosts_cleansed"} */
create or replace   view airbnb.dev.dim_hosts_cleansed
  
   as (
    WITH src_hosts AS (
    SELECT * FROM airbnb.dev.src_hosts
)

SELECT 
    host_id,
    NVL(host_name, 'Anonymous') AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM src_hosts
  );
[0m05:17:11.620745 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m05:17:12.759057 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ba257fb8-d9ff-4a29-b418-e23e976d8804', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3f958cd00>]}
[0m05:17:12.760686 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ba257fb8-d9ff-4a29-b418-e23e976d8804', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3f959f610>]}
[0m05:17:12.761724 [info ] [Thread-3  ]: 3 of 5 OK created sql view model dev.src_reviews ............................... [[32mSUCCESS 1[0m in 5.19s]
[0m05:17:12.762439 [info ] [Thread-2  ]: 2 of 5 OK created sql view model dev.src_listings .............................. [[32mSUCCESS 1[0m in 5.20s]
[0m05:17:12.764054 [debug] [Thread-3  ]: Finished running node model.dbtlearn.src_reviews
[0m05:17:12.764569 [debug] [Thread-2  ]: Finished running node model.dbtlearn.src_listings
[0m05:17:12.766302 [debug] [Thread-1  ]: Began running node model.dbtlearn.dim_listings_cleansed
[0m05:17:12.766886 [info ] [Thread-1  ]: 5 of 5 START sql view model dev.dim_listings_cleansed .......................... [RUN]
[0m05:17:12.768026 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtlearn.dim_listings_cleansed'
[0m05:17:12.768428 [debug] [Thread-1  ]: Began compiling node model.dbtlearn.dim_listings_cleansed
[0m05:17:12.773736 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearn.dim_listings_cleansed"
[0m05:17:12.776625 [debug] [Thread-1  ]: Timing info for model.dbtlearn.dim_listings_cleansed (compile): 2023-02-27 05:17:12.768718 => 2023-02-27 05:17:12.776536
[0m05:17:12.777001 [debug] [Thread-1  ]: Began executing node model.dbtlearn.dim_listings_cleansed
[0m05:17:12.781602 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtlearn.dim_listings_cleansed"
[0m05:17:12.783180 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.dim_listings_cleansed"
[0m05:17:12.783449 [debug] [Thread-1  ]: On model.dbtlearn.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_cleansed"} */
create or replace   view airbnb.dev.dim_listings_cleansed
  
   as (
    WITH src_listings AS (
    SELECT * FROM airbnb.dev.src_listings
)

SELECT
    listing_id,
    listing_name,
    room_type,
    CASE 
        WHEN minimum_nights = 0 THEN 1 -- 0 night = 1 night, so we assign the value of 1 to indicate 1 night
        ELSE minimum_nights
    END AS minimum_nights,
    host_id,
    REPLACE( -- Parse string value into numerical form
        price_str, '$' -- Replace '$' with price_str value. In other words, to remove '$' from string.
        ) :: NUMBER (10, 2 -- Convert string type to numerical with 2 decimal places
    ) AS price,
    created_at,
    updated_at
    
FROM src_listings
  );
[0m05:17:12.783697 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m05:17:14.317769 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 3 seconds
[0m05:17:14.319934 [debug] [Thread-4  ]: Timing info for model.dbtlearn.dim_hosts_cleansed (execute): 2023-02-27 05:17:11.614241 => 2023-02-27 05:17:14.319882
[0m05:17:14.320177 [debug] [Thread-4  ]: On model.dbtlearn.dim_hosts_cleansed: Close
[0m05:17:14.943359 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ba257fb8-d9ff-4a29-b418-e23e976d8804', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3f959fd60>]}
[0m05:17:14.944700 [info ] [Thread-4  ]: 4 of 5 OK created sql view model dev.dim_hosts_cleansed ........................ [[32mSUCCESS 1[0m in 3.34s]
[0m05:17:14.945588 [debug] [Thread-4  ]: Finished running node model.dbtlearn.dim_hosts_cleansed
[0m05:17:15.273581 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2 seconds
[0m05:17:15.280223 [debug] [Thread-1  ]: Timing info for model.dbtlearn.dim_listings_cleansed (execute): 2023-02-27 05:17:12.777236 => 2023-02-27 05:17:15.280067
[0m05:17:15.281121 [debug] [Thread-1  ]: On model.dbtlearn.dim_listings_cleansed: Close
[0m05:17:16.227520 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ba257fb8-d9ff-4a29-b418-e23e976d8804', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3f959f310>]}
[0m05:17:16.228655 [info ] [Thread-1  ]: 5 of 5 OK created sql view model dev.dim_listings_cleansed ..................... [[32mSUCCESS 1[0m in 3.46s]
[0m05:17:16.229388 [debug] [Thread-1  ]: Finished running node model.dbtlearn.dim_listings_cleansed
[0m05:17:16.232139 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m05:17:16.233109 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:17:16.233460 [debug] [MainThread]: Connection 'model.dbtlearn.dim_listings_cleansed' was properly closed.
[0m05:17:16.233764 [debug] [MainThread]: Connection 'model.dbtlearn.src_listings' was properly closed.
[0m05:17:16.234042 [debug] [MainThread]: Connection 'model.dbtlearn.src_reviews' was properly closed.
[0m05:17:16.234311 [debug] [MainThread]: Connection 'model.dbtlearn.dim_hosts_cleansed' was properly closed.
[0m05:17:16.234744 [info ] [MainThread]: 
[0m05:17:16.235308 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 15.76 seconds (15.76s).
[0m05:17:16.236331 [debug] [MainThread]: Command end result
[0m05:17:16.248849 [info ] [MainThread]: 
[0m05:17:16.249393 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:17:16.249827 [info ] [MainThread]: 
[0m05:17:16.250247 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m05:17:16.250683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3f95015b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3f9601460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3f958d7f0>]}
[0m05:17:16.251036 [debug] [MainThread]: Flushing usage events


============================== 2023-02-27 05:30:49.517657 | b47b3049-7d34-4920-b303-108ef921907a ==============================
[0m05:30:49.517657 [info ] [MainThread]: Running with dbt=1.4.3
[0m05:30:49.519929 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/katiehuang/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m05:30:49.520281 [debug] [MainThread]: Tracking: tracking
[0m05:30:49.521124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff35ab016a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff35ab01a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff35ab01910>]}
[0m05:30:49.534271 [debug] [MainThread]: checksum: c7a5cda64f02d8b9dd20ef412f82fbb79fdce1bb359c3c5dae3d080de7f31bfd, vars: {}, profile: None, target: None, version: 1.4.3
[0m05:30:49.545194 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m05:30:49.545609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b47b3049-7d34-4920-b303-108ef921907a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff35ab017c0>]}
[0m05:30:50.281788 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_cleansed.sql
[0m05:30:50.295247 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_hosts_cleansed.sql
[0m05:30:50.298147 [debug] [MainThread]: 1699: static parser successfully parsed src/src_reviews.sql
[0m05:30:50.301148 [debug] [MainThread]: 1699: static parser successfully parsed src/src_listings.sql
[0m05:30:50.303860 [debug] [MainThread]: 1699: static parser successfully parsed src/src_hosts.sql
[0m05:30:50.389446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b47b3049-7d34-4920-b303-108ef921907a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff35aacb940>]}
[0m05:30:50.396923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b47b3049-7d34-4920-b303-108ef921907a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff35ab01a00>]}
[0m05:30:50.397270 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 304 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m05:30:50.397582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b47b3049-7d34-4920-b303-108ef921907a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff338294b50>]}
[0m05:30:50.398881 [info ] [MainThread]: 
[0m05:30:50.400332 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m05:30:50.401466 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_airbnb'
[0m05:30:50.417019 [debug] [ThreadPool]: Using snowflake connection "list_airbnb"
[0m05:30:50.417292 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb"} */
show terse schemas in database airbnb
    limit 10000
[0m05:30:50.417505 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:30:52.815258 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2 seconds
[0m05:30:52.822093 [debug] [ThreadPool]: On list_airbnb: Close
[0m05:30:53.718420 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_airbnb_dev'
[0m05:30:53.739590 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m05:30:53.740158 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m05:30:53.740546 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:30:55.958533 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2 seconds
[0m05:30:55.964468 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m05:30:56.582763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b47b3049-7d34-4920-b303-108ef921907a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff35aacbdf0>]}
[0m05:30:56.584779 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m05:30:56.585393 [info ] [MainThread]: 
[0m05:30:56.593083 [debug] [Thread-2  ]: Began running node model.dbtlearn.src_listings
[0m05:30:56.593671 [debug] [Thread-3  ]: Began running node model.dbtlearn.src_reviews
[0m05:30:56.594288 [debug] [Thread-1  ]: Began running node model.dbtlearn.src_hosts
[0m05:30:56.594785 [info ] [Thread-2  ]: 2 of 5 START sql view model dev.src_listings ................................... [RUN]
[0m05:30:56.595450 [info ] [Thread-3  ]: 3 of 5 START sql view model dev.src_reviews .................................... [RUN]
[0m05:30:56.596085 [info ] [Thread-1  ]: 1 of 5 START sql view model dev.src_hosts ...................................... [RUN]
[0m05:30:56.597121 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtlearn.src_listings'
[0m05:30:56.597852 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtlearn.src_reviews'
[0m05:30:56.598561 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtlearn.src_hosts'
[0m05:30:56.598922 [debug] [Thread-2  ]: Began compiling node model.dbtlearn.src_listings
[0m05:30:56.599259 [debug] [Thread-3  ]: Began compiling node model.dbtlearn.src_reviews
[0m05:30:56.599572 [debug] [Thread-1  ]: Began compiling node model.dbtlearn.src_hosts
[0m05:30:56.602133 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtlearn.src_listings"
[0m05:30:56.604374 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtlearn.src_reviews"
[0m05:30:56.606291 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearn.src_hosts"
[0m05:30:56.607400 [debug] [Thread-2  ]: Timing info for model.dbtlearn.src_listings (compile): 2023-02-27 05:30:56.599819 => 2023-02-27 05:30:56.607297
[0m05:30:56.607730 [debug] [Thread-1  ]: Timing info for model.dbtlearn.src_hosts (compile): 2023-02-27 05:30:56.604608 => 2023-02-27 05:30:56.607671
[0m05:30:56.607972 [debug] [Thread-3  ]: Timing info for model.dbtlearn.src_reviews (compile): 2023-02-27 05:30:56.602426 => 2023-02-27 05:30:56.607916
[0m05:30:56.608255 [debug] [Thread-2  ]: Began executing node model.dbtlearn.src_listings
[0m05:30:56.608573 [debug] [Thread-1  ]: Began executing node model.dbtlearn.src_hosts
[0m05:30:56.608861 [debug] [Thread-3  ]: Began executing node model.dbtlearn.src_reviews
[0m05:30:56.669268 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbtlearn.src_listings"
[0m05:30:56.669624 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtlearn.src_hosts"
[0m05:30:56.672503 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbtlearn.src_reviews"
[0m05:30:56.673712 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearn.src_listings"
[0m05:30:56.673940 [debug] [Thread-2  ]: On model.dbtlearn.src_listings: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_listings"} */
create or replace   view airbnb.dev.src_listings
  
   as (
    WITH raw_listings AS (
	SELECT * FROM AIRBNB.RAW.RAW_LISTINGS
)

SELECT 
	id AS listing_id,
    name AS listing_name,
    listing_url,
    room_type,
    minimum_nights,
    host_id,
    price AS price_str,
    created_at,
    updated_at
FROM 
	raw_listings
  );
[0m05:30:56.674583 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.src_hosts"
[0m05:30:56.675272 [debug] [Thread-3  ]: Using snowflake connection "model.dbtlearn.src_reviews"
[0m05:30:56.675449 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m05:30:56.675637 [debug] [Thread-1  ]: On model.dbtlearn.src_hosts: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_hosts"} */
create or replace   view airbnb.dev.src_hosts
  
   as (
    WITH raw_hosts AS (
	SELECT * FROM AIRBNB.RAW.RAW_HOSTS
)

SELECT
    id AS host_id,
    name AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM raw_hosts
  );
[0m05:30:56.675839 [debug] [Thread-3  ]: On model.dbtlearn.src_reviews: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_reviews"} */
create or replace   view airbnb.dev.src_reviews
  
   as (
    WITH raw_reviews AS (
	SELECT * FROM AIRBNB.RAW.RAW_REVIEWS
)

SELECT
    listing_id,
    date AS review_date,
    reviewer_name,
    comments AS review_text,
    sentiment AS review_sentiment
FROM raw_reviews
  );
[0m05:30:56.676279 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m05:30:56.676853 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m05:30:58.587759 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 2 seconds
[0m05:30:58.624973 [debug] [Thread-3  ]: Timing info for model.dbtlearn.src_reviews (execute): 2023-02-27 05:30:56.653905 => 2023-02-27 05:30:58.624882
[0m05:30:58.625423 [debug] [Thread-3  ]: On model.dbtlearn.src_reviews: Close
[0m05:30:58.771099 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2 seconds
[0m05:30:58.778150 [debug] [Thread-1  ]: Timing info for model.dbtlearn.src_hosts (execute): 2023-02-27 05:30:56.628723 => 2023-02-27 05:30:58.778071
[0m05:30:58.778566 [debug] [Thread-1  ]: On model.dbtlearn.src_hosts: Close
[0m05:30:58.995989 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 2 seconds
[0m05:30:59.003525 [debug] [Thread-2  ]: Timing info for model.dbtlearn.src_listings (execute): 2023-02-27 05:30:56.609065 => 2023-02-27 05:30:59.003425
[0m05:30:59.003977 [debug] [Thread-2  ]: On model.dbtlearn.src_listings: Close
[0m05:30:59.179339 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b47b3049-7d34-4920-b303-108ef921907a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3490687f0>]}
[0m05:30:59.180630 [info ] [Thread-3  ]: 3 of 5 OK created sql view model dev.src_reviews ............................... [[32mSUCCESS 1[0m in 2.58s]
[0m05:30:59.183330 [debug] [Thread-3  ]: Finished running node model.dbtlearn.src_reviews
[0m05:30:59.358906 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b47b3049-7d34-4920-b303-108ef921907a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff338126190>]}
[0m05:30:59.360216 [info ] [Thread-1  ]: 1 of 5 OK created sql view model dev.src_hosts ................................. [[32mSUCCESS 1[0m in 2.76s]
[0m05:30:59.361121 [debug] [Thread-1  ]: Finished running node model.dbtlearn.src_hosts
[0m05:30:59.362261 [debug] [Thread-4  ]: Began running node model.dbtlearn.dim_hosts_cleansed
[0m05:30:59.362817 [info ] [Thread-4  ]: 4 of 5 START sql table model dev.dim_hosts_cleansed ............................ [RUN]
[0m05:30:59.364004 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.dbtlearn.dim_hosts_cleansed'
[0m05:30:59.364444 [debug] [Thread-4  ]: Began compiling node model.dbtlearn.dim_hosts_cleansed
[0m05:30:59.369824 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtlearn.dim_hosts_cleansed"
[0m05:30:59.371513 [debug] [Thread-4  ]: Timing info for model.dbtlearn.dim_hosts_cleansed (compile): 2023-02-27 05:30:59.364738 => 2023-02-27 05:30:59.371432
[0m05:30:59.371861 [debug] [Thread-4  ]: Began executing node model.dbtlearn.dim_hosts_cleansed
[0m05:30:59.387951 [debug] [Thread-4  ]: Dropping relation "AIRBNB"."DEV"."DIM_HOSTS_CLEANSED" because it is of type view
[0m05:30:59.396327 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearn.dim_hosts_cleansed"
[0m05:30:59.396627 [debug] [Thread-4  ]: On model.dbtlearn.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_hosts_cleansed"} */
drop view if exists "AIRBNB"."DEV"."DIM_HOSTS_CLEANSED" cascade
[0m05:30:59.397518 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m05:30:59.823620 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b47b3049-7d34-4920-b303-108ef921907a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff349059d90>]}
[0m05:30:59.824178 [info ] [Thread-2  ]: 2 of 5 OK created sql view model dev.src_listings .............................. [[32mSUCCESS 1[0m in 3.23s]
[0m05:30:59.824595 [debug] [Thread-2  ]: Finished running node model.dbtlearn.src_listings
[0m05:30:59.825081 [debug] [Thread-1  ]: Began running node model.dbtlearn.dim_listings_cleansed
[0m05:30:59.825405 [info ] [Thread-1  ]: 5 of 5 START sql table model dev.dim_listings_cleansed ......................... [RUN]
[0m05:30:59.826058 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtlearn.dim_listings_cleansed'
[0m05:30:59.826280 [debug] [Thread-1  ]: Began compiling node model.dbtlearn.dim_listings_cleansed
[0m05:30:59.829119 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearn.dim_listings_cleansed"
[0m05:30:59.830639 [debug] [Thread-1  ]: Timing info for model.dbtlearn.dim_listings_cleansed (compile): 2023-02-27 05:30:59.826436 => 2023-02-27 05:30:59.830587
[0m05:30:59.830872 [debug] [Thread-1  ]: Began executing node model.dbtlearn.dim_listings_cleansed
[0m05:30:59.833873 [debug] [Thread-1  ]: Dropping relation "AIRBNB"."DEV"."DIM_LISTINGS_CLEANSED" because it is of type view
[0m05:30:59.836142 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.dim_listings_cleansed"
[0m05:30:59.836337 [debug] [Thread-1  ]: On model.dbtlearn.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_cleansed"} */
drop view if exists "AIRBNB"."DEV"."DIM_LISTINGS_CLEANSED" cascade
[0m05:30:59.836522 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m05:31:01.147137 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 2 seconds
[0m05:31:01.173990 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbtlearn.dim_hosts_cleansed"
[0m05:31:01.175652 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearn.dim_hosts_cleansed"
[0m05:31:01.175934 [debug] [Thread-4  ]: On model.dbtlearn.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_hosts_cleansed"} */
create or replace transient table airbnb.dev.dim_hosts_cleansed  as
        (WITH src_hosts AS (
    SELECT * FROM airbnb.dev.src_hosts
)

SELECT 
    host_id,
    NVL(host_name, 'Anonymous') AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM src_hosts
        );
[0m05:31:01.662194 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2 seconds
[0m05:31:01.666936 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtlearn.dim_listings_cleansed"
[0m05:31:01.669777 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.dim_listings_cleansed"
[0m05:31:01.670168 [debug] [Thread-1  ]: On model.dbtlearn.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_cleansed"} */
create or replace transient table airbnb.dev.dim_listings_cleansed  as
        (WITH src_listings AS (
    SELECT * FROM airbnb.dev.src_listings
)

SELECT
    listing_id,
    listing_name,
    room_type,
    CASE 
        WHEN minimum_nights = 0 THEN 1 -- 0 night = 1 night, so we assign the value of 1 to indicate 1 night
        ELSE minimum_nights
    END AS minimum_nights,
    host_id,
    REPLACE( -- Parse string value into numerical form
        price_str, '$' -- Replace '$' with price_str value. In other words, to remove '$' from string.
        ) :: NUMBER (10, 2 -- Convert string type to numerical with 2 decimal places
    ) AS price,
    created_at,
    updated_at
    
FROM src_listings
        );
[0m05:31:03.023717 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 2 seconds
[0m05:31:03.040944 [debug] [Thread-4  ]: Timing info for model.dbtlearn.dim_hosts_cleansed (execute): 2023-02-27 05:30:59.372093 => 2023-02-27 05:31:03.040768
[0m05:31:03.041408 [debug] [Thread-4  ]: On model.dbtlearn.dim_hosts_cleansed: Close
[0m05:31:03.643716 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b47b3049-7d34-4920-b303-108ef921907a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff35ad96880>]}
[0m05:31:03.645064 [info ] [Thread-4  ]: 4 of 5 OK created sql table model dev.dim_hosts_cleansed ....................... [[32mSUCCESS 1[0m in 4.28s]
[0m05:31:03.646093 [debug] [Thread-4  ]: Finished running node model.dbtlearn.dim_hosts_cleansed
[0m05:31:03.948004 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2 seconds
[0m05:31:03.954479 [debug] [Thread-1  ]: Timing info for model.dbtlearn.dim_listings_cleansed (execute): 2023-02-27 05:30:59.831027 => 2023-02-27 05:31:03.954367
[0m05:31:03.955045 [debug] [Thread-1  ]: On model.dbtlearn.dim_listings_cleansed: Close
[0m05:31:04.570053 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b47b3049-7d34-4920-b303-108ef921907a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff349059790>]}
[0m05:31:04.571359 [info ] [Thread-1  ]: 5 of 5 OK created sql table model dev.dim_listings_cleansed .................... [[32mSUCCESS 1[0m in 4.74s]
[0m05:31:04.572282 [debug] [Thread-1  ]: Finished running node model.dbtlearn.dim_listings_cleansed
[0m05:31:04.574758 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m05:31:04.575774 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:31:04.576128 [debug] [MainThread]: Connection 'model.dbtlearn.dim_listings_cleansed' was properly closed.
[0m05:31:04.576426 [debug] [MainThread]: Connection 'model.dbtlearn.src_listings' was properly closed.
[0m05:31:04.576705 [debug] [MainThread]: Connection 'model.dbtlearn.src_reviews' was properly closed.
[0m05:31:04.576976 [debug] [MainThread]: Connection 'model.dbtlearn.dim_hosts_cleansed' was properly closed.
[0m05:31:04.577463 [info ] [MainThread]: 
[0m05:31:04.578040 [info ] [MainThread]: Finished running 3 view models, 2 table models in 0 hours 0 minutes and 14.18 seconds (14.18s).
[0m05:31:04.579086 [debug] [MainThread]: Command end result
[0m05:31:04.589652 [info ] [MainThread]: 
[0m05:31:04.590189 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:31:04.590615 [info ] [MainThread]: 
[0m05:31:04.591024 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m05:31:04.591531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff349051e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff348fe5a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff348fe5880>]}
[0m05:31:04.591924 [debug] [MainThread]: Flushing usage events


============================== 2023-02-27 05:44:26.578600 | e5e3ea25-6d6b-4d08-8c8b-13ff038ba593 ==============================
[0m05:44:26.578600 [info ] [MainThread]: Running with dbt=1.4.3
[0m05:44:26.580945 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/katiehuang/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['fct_reviews'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m05:44:26.581271 [debug] [MainThread]: Tracking: tracking
[0m05:44:26.582107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1a98e56d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1a98e5a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1a98e5940>]}
[0m05:44:26.594991 [debug] [MainThread]: checksum: c7a5cda64f02d8b9dd20ef412f82fbb79fdce1bb359c3c5dae3d080de7f31bfd, vars: {}, profile: None, target: None, version: 1.4.3
[0m05:44:26.634887 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m05:44:26.635344 [debug] [MainThread]: Partial parsing: added file: dbtlearn://models/fct/fct_reviews.sql
[0m05:44:26.652353 [debug] [MainThread]: 1603: static parser failed on fct/fct_reviews.sql
[0m05:44:26.656627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1980d0580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1981a3820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1981a38b0>]}
[0m05:44:26.656972 [debug] [MainThread]: Flushing usage events
[0m05:44:28.340917 [error] [MainThread]: Encountered an error:
Compilation Error in model fct_reviews (models/fct/fct_reviews.sql)
  unexpected '%'
    line 22
      {% if {% if is_incremental() %}


============================== 2023-02-27 05:45:07.410182 | c6b6a099-32d6-4aeb-b10c-b6894707d354 ==============================
[0m05:45:07.410182 [info ] [MainThread]: Running with dbt=1.4.3
[0m05:45:07.412512 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/katiehuang/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['fct_reviews'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m05:45:07.412835 [debug] [MainThread]: Tracking: tracking
[0m05:45:07.413321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0391c1790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0391c1b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0391c1a00>]}
[0m05:45:07.425930 [debug] [MainThread]: checksum: c7a5cda64f02d8b9dd20ef412f82fbb79fdce1bb359c3c5dae3d080de7f31bfd, vars: {}, profile: None, target: None, version: 1.4.3
[0m05:45:07.464701 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m05:45:07.465174 [debug] [MainThread]: Partial parsing: added file: dbtlearn://models/fct/fct_reviews.sql
[0m05:45:07.482861 [debug] [MainThread]: 1603: static parser failed on fct/fct_reviews.sql
[0m05:45:07.504099 [debug] [MainThread]: 1602: parser fallback to jinja rendering on fct/fct_reviews.sql
[0m05:45:07.514826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c6b6a099-32d6-4aeb-b10c-b6894707d354', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc04a9a27c0>]}
[0m05:45:07.521920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c6b6a099-32d6-4aeb-b10c-b6894707d354', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc02815ef40>]}
[0m05:45:07.522266 [info ] [MainThread]: Found 6 models, 0 tests, 0 snapshots, 0 analyses, 304 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m05:45:07.522589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c6b6a099-32d6-4aeb-b10c-b6894707d354', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc02815eb80>]}
[0m05:45:07.523822 [info ] [MainThread]: 
[0m05:45:07.525312 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m05:45:07.526356 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_airbnb'
[0m05:45:07.542126 [debug] [ThreadPool]: Using snowflake connection "list_airbnb"
[0m05:45:07.542459 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb"} */
show terse schemas in database airbnb
    limit 10000
[0m05:45:07.542710 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:45:09.860489 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2 seconds
[0m05:45:09.865267 [debug] [ThreadPool]: On list_airbnb: Close
[0m05:45:10.505224 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_airbnb_dev'
[0m05:45:10.517436 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m05:45:10.517818 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m05:45:10.518140 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:45:12.336813 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2 seconds
[0m05:45:12.342883 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m05:45:12.951684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c6b6a099-32d6-4aeb-b10c-b6894707d354', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0391fd5e0>]}
[0m05:45:12.952991 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m05:45:12.953598 [info ] [MainThread]: 
[0m05:45:12.961656 [debug] [Thread-1  ]: Began running node model.dbtlearn.fct_reviews
[0m05:45:12.962223 [info ] [Thread-1  ]: 1 of 1 START sql incremental model dev.fct_reviews ............................. [RUN]
[0m05:45:12.963176 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtlearn.fct_reviews'
[0m05:45:12.963516 [debug] [Thread-1  ]: Began compiling node model.dbtlearn.fct_reviews
[0m05:45:12.970314 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearn.fct_reviews"
[0m05:45:12.971191 [debug] [Thread-1  ]: Timing info for model.dbtlearn.fct_reviews (compile): 2023-02-27 05:45:12.963766 => 2023-02-27 05:45:12.971104
[0m05:45:12.971512 [debug] [Thread-1  ]: Began executing node model.dbtlearn.fct_reviews
[0m05:45:13.040302 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtlearn.fct_reviews"
[0m05:45:13.041679 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m05:45:13.041885 [debug] [Thread-1  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
create or replace transient table airbnb.dev.fct_reviews  as
        (-- Doc: https://docs.getdbt.com/reference/dbt-jinja-functions/config


WITH src_reviews AS (
    SELECT * FROM airbnb.dev.src_reviews
)

SELECT 
    listing_id,
    review_date,
    NVL(reviewer_name, 'Anonymous') AS reviewer_name,
    review_text,
    review_sentiment
FROM src_reviews
WHERE review_text IS NOT NULL


        );
[0m05:45:13.042068 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m05:45:20.193459 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 7 seconds
[0m05:45:20.209486 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m05:45:20.209894 [debug] [Thread-1  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
drop view if exists airbnb.dev.fct_reviews__dbt_tmp cascade
[0m05:45:20.602692 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m05:45:20.639622 [debug] [Thread-1  ]: Timing info for model.dbtlearn.fct_reviews (execute): 2023-02-27 05:45:12.971716 => 2023-02-27 05:45:20.639558
[0m05:45:20.639901 [debug] [Thread-1  ]: On model.dbtlearn.fct_reviews: Close
[0m05:45:21.341487 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c6b6a099-32d6-4aeb-b10c-b6894707d354', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc02815edf0>]}
[0m05:45:21.342515 [info ] [Thread-1  ]: 1 of 1 OK created sql incremental model dev.fct_reviews ........................ [[32mSUCCESS 1[0m in 8.38s]
[0m05:45:21.345210 [debug] [Thread-1  ]: Finished running node model.dbtlearn.fct_reviews
[0m05:45:21.349669 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m05:45:21.350563 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:45:21.350855 [debug] [MainThread]: Connection 'model.dbtlearn.fct_reviews' was properly closed.
[0m05:45:21.351166 [info ] [MainThread]: 
[0m05:45:21.351635 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 13.83 seconds (13.83s).
[0m05:45:21.352213 [debug] [MainThread]: Command end result
[0m05:45:21.361475 [info ] [MainThread]: 
[0m05:45:21.362011 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:45:21.362371 [info ] [MainThread]: 
[0m05:45:21.362708 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m05:45:21.363118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0280d72e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc04ab060a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc01801cbb0>]}
[0m05:45:21.363442 [debug] [MainThread]: Flushing usage events


============================== 2023-02-27 06:06:48.919705 | 778476ac-e9de-4e01-ad9d-63da039ca286 ==============================
[0m06:06:48.919705 [info ] [MainThread]: Running with dbt=1.4.3
[0m06:06:48.922044 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/katiehuang/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m06:06:48.922442 [debug] [MainThread]: Tracking: tracking
[0m06:06:48.923149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80d17456a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80d1745a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80d1745910>]}
[0m06:06:48.936298 [debug] [MainThread]: checksum: c7a5cda64f02d8b9dd20ef412f82fbb79fdce1bb359c3c5dae3d080de7f31bfd, vars: {}, profile: None, target: None, version: 1.4.3
[0m06:06:48.975494 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m06:06:48.975973 [debug] [MainThread]: Partial parsing: added file: dbtlearn://models/dim/dim_listings_w_hosts.sql
[0m06:06:48.976302 [debug] [MainThread]: Partial parsing: updated file: dbtlearn://models/fct/fct_reviews.sql
[0m06:06:48.995580 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_w_hosts.sql
[0m06:06:49.010735 [debug] [MainThread]: 1603: static parser failed on fct/fct_reviews.sql
[0m06:06:49.020547 [debug] [MainThread]: 1602: parser fallback to jinja rendering on fct/fct_reviews.sql
[0m06:06:49.031345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '778476ac-e9de-4e01-ad9d-63da039ca286', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80d17a2d30>]}
[0m06:06:49.039140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '778476ac-e9de-4e01-ad9d-63da039ca286', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80c0358d90>]}
[0m06:06:49.039532 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 304 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m06:06:49.039867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '778476ac-e9de-4e01-ad9d-63da039ca286', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80c03587f0>]}
[0m06:06:49.041421 [info ] [MainThread]: 
[0m06:06:49.042954 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m06:06:49.044305 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_airbnb'
[0m06:06:49.059904 [debug] [ThreadPool]: Using snowflake connection "list_airbnb"
[0m06:06:49.060190 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb"} */
show terse schemas in database airbnb
    limit 10000
[0m06:06:49.060441 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:06:51.851525 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 3 seconds
[0m06:06:51.859522 [debug] [ThreadPool]: On list_airbnb: Close
[0m06:06:52.570201 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_airbnb_dev'
[0m06:06:52.590071 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m06:06:52.590632 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m06:06:52.591014 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:06:54.683601 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 2 seconds
[0m06:06:54.689034 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m06:06:55.659927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '778476ac-e9de-4e01-ad9d-63da039ca286', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80c02d65e0>]}
[0m06:06:55.662487 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:06:55.663559 [info ] [MainThread]: 
[0m06:06:55.676163 [debug] [Thread-1  ]: Began running node model.dbtlearn.src_hosts
[0m06:06:55.678380 [debug] [Thread-3  ]: Began running node model.dbtlearn.src_listings
[0m06:06:55.677664 [info ] [Thread-1  ]: 1 of 7 START sql view model dev.src_hosts ...................................... [RUN]
[0m06:06:55.679572 [debug] [Thread-4  ]: Began running node model.dbtlearn.src_reviews
[0m06:06:55.680390 [info ] [Thread-3  ]: 2 of 7 START sql view model dev.src_listings ................................... [RUN]
[0m06:06:55.682036 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtlearn.src_hosts'
[0m06:06:55.682725 [info ] [Thread-4  ]: 3 of 7 START sql view model dev.src_reviews .................................... [RUN]
[0m06:06:55.683814 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtlearn.src_listings'
[0m06:06:55.684235 [debug] [Thread-1  ]: Began compiling node model.dbtlearn.src_hosts
[0m06:06:55.685054 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.dbtlearn.src_reviews'
[0m06:06:55.685442 [debug] [Thread-3  ]: Began compiling node model.dbtlearn.src_listings
[0m06:06:55.690130 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearn.src_hosts"
[0m06:06:55.690757 [debug] [Thread-4  ]: Began compiling node model.dbtlearn.src_reviews
[0m06:06:55.693189 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtlearn.src_listings"
[0m06:06:55.695665 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtlearn.src_reviews"
[0m06:06:55.696365 [debug] [Thread-1  ]: Timing info for model.dbtlearn.src_hosts (compile): 2023-02-27 06:06:55.685739 => 2023-02-27 06:06:55.696239
[0m06:06:55.696828 [debug] [Thread-1  ]: Began executing node model.dbtlearn.src_hosts
[0m06:06:55.710788 [debug] [Thread-3  ]: Timing info for model.dbtlearn.src_listings (compile): 2023-02-27 06:06:55.691035 => 2023-02-27 06:06:55.710696
[0m06:06:55.711088 [debug] [Thread-4  ]: Timing info for model.dbtlearn.src_reviews (compile): 2023-02-27 06:06:55.693599 => 2023-02-27 06:06:55.711029
[0m06:06:55.730427 [debug] [Thread-3  ]: Began executing node model.dbtlearn.src_listings
[0m06:06:55.735522 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtlearn.src_hosts"
[0m06:06:55.735797 [debug] [Thread-4  ]: Began executing node model.dbtlearn.src_reviews
[0m06:06:55.738891 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbtlearn.src_listings"
[0m06:06:55.742145 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbtlearn.src_reviews"
[0m06:06:55.743069 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.src_hosts"
[0m06:06:55.743371 [debug] [Thread-1  ]: On model.dbtlearn.src_hosts: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_hosts"} */
create or replace   view airbnb.dev.src_hosts
  
   as (
    WITH raw_hosts AS (
	SELECT * FROM AIRBNB.RAW.RAW_HOSTS
)

SELECT
    id AS host_id,
    name AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM raw_hosts
  );
[0m06:06:55.743581 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:06:55.744637 [debug] [Thread-3  ]: Using snowflake connection "model.dbtlearn.src_listings"
[0m06:06:55.744837 [debug] [Thread-3  ]: On model.dbtlearn.src_listings: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_listings"} */
create or replace   view airbnb.dev.src_listings
  
   as (
    WITH raw_listings AS (
	SELECT * FROM AIRBNB.RAW.RAW_LISTINGS
)

SELECT 
	id AS listing_id,
    name AS listing_name,
    listing_url,
    room_type,
    minimum_nights,
    host_id,
    price AS price_str,
    created_at,
    updated_at
FROM 
	raw_listings
  );
[0m06:06:55.745020 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m06:06:55.747226 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearn.src_reviews"
[0m06:06:55.747972 [debug] [Thread-4  ]: On model.dbtlearn.src_reviews: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_reviews"} */
create or replace   view airbnb.dev.src_reviews
  
   as (
    WITH raw_reviews AS (
	SELECT * FROM AIRBNB.RAW.RAW_REVIEWS
)

SELECT
    listing_id,
    date AS review_date,
    reviewer_name,
    comments AS review_text,
    sentiment AS review_sentiment
FROM raw_reviews
  );
[0m06:06:55.748211 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m06:06:58.027065 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2 seconds
[0m06:06:58.063224 [debug] [Thread-1  ]: Timing info for model.dbtlearn.src_hosts (execute): 2023-02-27 06:06:55.697139 => 2023-02-27 06:06:58.063134
[0m06:06:58.063632 [debug] [Thread-1  ]: On model.dbtlearn.src_hosts: Close
[0m06:06:58.232151 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 2 seconds
[0m06:06:58.239403 [debug] [Thread-3  ]: Timing info for model.dbtlearn.src_listings (execute): 2023-02-27 06:06:55.735971 => 2023-02-27 06:06:58.239297
[0m06:06:58.239867 [debug] [Thread-3  ]: On model.dbtlearn.src_listings: Close
[0m06:06:58.294233 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 3 seconds
[0m06:06:58.301227 [debug] [Thread-4  ]: Timing info for model.dbtlearn.src_reviews (execute): 2023-02-27 06:06:55.739164 => 2023-02-27 06:06:58.301132
[0m06:06:58.301668 [debug] [Thread-4  ]: On model.dbtlearn.src_reviews: Close
[0m06:06:58.880237 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '778476ac-e9de-4e01-ad9d-63da039ca286', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80e2227400>]}
[0m06:06:58.881505 [info ] [Thread-3  ]: 2 of 7 OK created sql view model dev.src_listings .............................. [[32mSUCCESS 1[0m in 3.20s]
[0m06:06:58.884219 [debug] [Thread-3  ]: Finished running node model.dbtlearn.src_listings
[0m06:06:58.886006 [debug] [Thread-2  ]: Began running node model.dbtlearn.dim_listings_cleansed
[0m06:06:58.886635 [info ] [Thread-2  ]: 4 of 7 START sql table model dev.dim_listings_cleansed ......................... [RUN]
[0m06:06:58.887890 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtlearn.dim_listings_cleansed'
[0m06:06:58.888307 [debug] [Thread-2  ]: Began compiling node model.dbtlearn.dim_listings_cleansed
[0m06:06:58.893696 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtlearn.dim_listings_cleansed"
[0m06:06:58.895398 [debug] [Thread-2  ]: Timing info for model.dbtlearn.dim_listings_cleansed (compile): 2023-02-27 06:06:58.888592 => 2023-02-27 06:06:58.895314
[0m06:06:58.895761 [debug] [Thread-2  ]: Began executing node model.dbtlearn.dim_listings_cleansed
[0m06:06:58.927214 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbtlearn.dim_listings_cleansed"
[0m06:06:58.928691 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearn.dim_listings_cleansed"
[0m06:06:58.929347 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '778476ac-e9de-4e01-ad9d-63da039ca286', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80e2283100>]}
[0m06:06:58.929541 [debug] [Thread-2  ]: On model.dbtlearn.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_cleansed"} */
create or replace transient table airbnb.dev.dim_listings_cleansed  as
        (WITH src_listings AS (
    SELECT * FROM airbnb.dev.src_listings
)

SELECT
    listing_id,
    listing_name,
    room_type,
    CASE 
        WHEN minimum_nights = 0 THEN 1 -- 0 night = 1 night, so we assign the value of 1 to indicate 1 night
        ELSE minimum_nights
    END AS minimum_nights,
    host_id,
    REPLACE( -- Parse string value into numerical form
        price_str, '$' -- Replace '$' with price_str value. In other words, to remove '$' from string.
        ) :: NUMBER (10, 2 -- Convert string type to numerical with 2 decimal places
    ) AS price,
    created_at,
    updated_at
    
FROM src_listings
        );
[0m06:06:58.929989 [info ] [Thread-1  ]: 1 of 7 OK created sql view model dev.src_hosts ................................. [[32mSUCCESS 1[0m in 3.25s]
[0m06:06:58.930298 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m06:06:58.930586 [debug] [Thread-1  ]: Finished running node model.dbtlearn.src_hosts
[0m06:06:58.932238 [debug] [Thread-3  ]: Began running node model.dbtlearn.dim_hosts_cleansed
[0m06:06:58.932588 [info ] [Thread-3  ]: 5 of 7 START sql table model dev.dim_hosts_cleansed ............................ [RUN]
[0m06:06:58.933167 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtlearn.dim_hosts_cleansed'
[0m06:06:58.933548 [debug] [Thread-3  ]: Began compiling node model.dbtlearn.dim_hosts_cleansed
[0m06:06:58.936796 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtlearn.dim_hosts_cleansed"
[0m06:06:58.937667 [debug] [Thread-3  ]: Timing info for model.dbtlearn.dim_hosts_cleansed (compile): 2023-02-27 06:06:58.934038 => 2023-02-27 06:06:58.937601
[0m06:06:58.937929 [debug] [Thread-3  ]: Began executing node model.dbtlearn.dim_hosts_cleansed
[0m06:06:58.940701 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbtlearn.dim_hosts_cleansed"
[0m06:06:58.941693 [debug] [Thread-3  ]: Using snowflake connection "model.dbtlearn.dim_hosts_cleansed"
[0m06:06:58.941874 [debug] [Thread-3  ]: On model.dbtlearn.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_hosts_cleansed"} */
create or replace transient table airbnb.dev.dim_hosts_cleansed  as
        (WITH src_hosts AS (
    SELECT * FROM airbnb.dev.src_hosts
)

SELECT 
    host_id,
    NVL(host_name, 'Anonymous') AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM src_hosts
        );
[0m06:06:58.942048 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m06:06:59.529337 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '778476ac-e9de-4e01-ad9d-63da039ca286', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80e2283ee0>]}
[0m06:06:59.530482 [info ] [Thread-4  ]: 3 of 7 OK created sql view model dev.src_reviews ............................... [[32mSUCCESS 1[0m in 3.84s]
[0m06:06:59.531282 [debug] [Thread-4  ]: Finished running node model.dbtlearn.src_reviews
[0m06:06:59.532169 [debug] [Thread-1  ]: Began running node model.dbtlearn.fct_reviews
[0m06:06:59.532781 [info ] [Thread-1  ]: 6 of 7 START sql incremental model dev.fct_reviews ............................. [RUN]
[0m06:06:59.533959 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtlearn.fct_reviews'
[0m06:06:59.534399 [debug] [Thread-1  ]: Began compiling node model.dbtlearn.fct_reviews
[0m06:06:59.544872 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearn.fct_reviews"
[0m06:06:59.546694 [debug] [Thread-1  ]: Timing info for model.dbtlearn.fct_reviews (compile): 2023-02-27 06:06:59.534687 => 2023-02-27 06:06:59.546605
[0m06:06:59.547061 [debug] [Thread-1  ]: Began executing node model.dbtlearn.fct_reviews
[0m06:06:59.594637 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m06:06:59.594949 [debug] [Thread-1  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
create or replace  temporary view airbnb.dev.fct_reviews__dbt_tmp
  
   as (
    -- Doc | Config : https://docs.getdbt.com/reference/dbt-jinja-functions/config


-- dbt materializes the model as an incremental table. 
-- Read for difference btw table vs. incremental: https://docs.getdbt.com/docs/build/materializations

WITH src_reviews AS (
    SELECT * FROM airbnb.dev.src_reviews
)

SELECT 
    listing_id,
    review_date,
    NVL(reviewer_name, 'Anonymous') AS reviewer_name,
    review_text,
    review_sentiment
FROM src_reviews
WHERE review_text IS NOT NULL


  and review_date > (select max(review_date) from airbnb.dev.fct_reviews)

  );
[0m06:06:59.595178 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:07:01.934017 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2 seconds
[0m06:07:01.961914 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m06:07:01.962444 [debug] [Thread-1  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
describe table airbnb.dev.fct_reviews__dbt_tmp
[0m06:07:02.346762 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0 seconds
[0m06:07:02.348534 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 3 seconds
[0m06:07:02.362305 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m06:07:02.378224 [debug] [Thread-3  ]: Timing info for model.dbtlearn.dim_hosts_cleansed (execute): 2023-02-27 06:06:58.938082 => 2023-02-27 06:07:02.378064
[0m06:07:02.378575 [debug] [Thread-1  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
describe table airbnb.dev.fct_reviews
[0m06:07:02.378971 [debug] [Thread-3  ]: On model.dbtlearn.dim_hosts_cleansed: Close
[0m06:07:02.488641 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 4 seconds
[0m06:07:02.496557 [debug] [Thread-2  ]: Timing info for model.dbtlearn.dim_listings_cleansed (execute): 2023-02-27 06:06:58.896009 => 2023-02-27 06:07:02.496368
[0m06:07:02.497496 [debug] [Thread-2  ]: On model.dbtlearn.dim_listings_cleansed: Close
[0m06:07:02.689160 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0 seconds
[0m06:07:02.729128 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m06:07:02.729530 [debug] [Thread-1  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
describe table airbnb.dev.fct_reviews__dbt_tmp
[0m06:07:02.982411 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '778476ac-e9de-4e01-ad9d-63da039ca286', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80e224d5e0>]}
[0m06:07:02.984426 [info ] [Thread-3  ]: 5 of 7 OK created sql table model dev.dim_hosts_cleansed ....................... [[32mSUCCESS 1[0m in 4.05s]
[0m06:07:02.985704 [debug] [Thread-3  ]: Finished running node model.dbtlearn.dim_hosts_cleansed
[0m06:07:03.056758 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0 seconds
[0m06:07:03.070626 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m06:07:03.071486 [debug] [Thread-1  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
describe table "AIRBNB"."DEV"."FCT_REVIEWS"
[0m06:07:03.167702 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '778476ac-e9de-4e01-ad9d-63da039ca286', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80e2283d60>]}
[0m06:07:03.170133 [info ] [Thread-2  ]: 4 of 7 OK created sql table model dev.dim_listings_cleansed .................... [[32mSUCCESS 1[0m in 4.28s]
[0m06:07:03.171388 [debug] [Thread-2  ]: Finished running node model.dbtlearn.dim_listings_cleansed
[0m06:07:03.173085 [debug] [Thread-4  ]: Began running node model.dbtlearn.dim_listings_w_hosts
[0m06:07:03.174148 [info ] [Thread-4  ]: 7 of 7 START sql table model dev.dim_listings_w_hosts .......................... [RUN]
[0m06:07:03.176151 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.dbtlearn.dim_listings_w_hosts'
[0m06:07:03.176989 [debug] [Thread-4  ]: Began compiling node model.dbtlearn.dim_listings_w_hosts
[0m06:07:03.185903 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtlearn.dim_listings_w_hosts"
[0m06:07:03.187377 [debug] [Thread-4  ]: Timing info for model.dbtlearn.dim_listings_w_hosts (compile): 2023-02-27 06:07:03.177484 => 2023-02-27 06:07:03.187211
[0m06:07:03.187974 [debug] [Thread-4  ]: Began executing node model.dbtlearn.dim_listings_w_hosts
[0m06:07:03.195759 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbtlearn.dim_listings_w_hosts"
[0m06:07:03.198741 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearn.dim_listings_w_hosts"
[0m06:07:03.199067 [debug] [Thread-4  ]: On model.dbtlearn.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_w_hosts"} */
create or replace transient table airbnb.dev.dim_listings_w_hosts  as
        (WITH 
listings AS (
    SELECT * FROM airbnb.dev.dim_listings_cleansed
),
hosts AS (
    SELECT * FROM airbnb.dev.dim_hosts_cleansed
)

SELECT 
    listings.listing_id,
    listings.listing_name,
    listings.room_type,
    listings.minimum_nights,
    listings.price,
    listings.host_id,
    hosts.host_name,
    hosts.is_superhost AS host_is_superhost,
    listings.created_at,
    GREATEST(listings.updated_at, hosts.updated_at) AS updated_at -- Keep most recent updated_at
FROM listings
LEFT JOIN hosts
    ON listings.host_id = hosts.host_id
        );
[0m06:07:03.199355 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m06:07:03.427896 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0 seconds
[0m06:07:03.457962 [debug] [Thread-1  ]: 
    In "AIRBNB"."DEV"."FCT_REVIEWS":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m06:07:03.481704 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtlearn.fct_reviews"
[0m06:07:03.482847 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m06:07:03.483054 [debug] [Thread-1  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
-- back compat for old kwarg name
  
  begin;
[0m06:07:03.831796 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m06:07:03.833113 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m06:07:03.833841 [debug] [Thread-1  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
insert into airbnb.dev.fct_reviews ("LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT")
        (
            select "LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT"
            from airbnb.dev.fct_reviews__dbt_tmp
        );
[0m06:07:04.494762 [debug] [Thread-1  ]: SQL status: SUCCESS 0 in 1 seconds
[0m06:07:04.495222 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m06:07:04.495466 [debug] [Thread-1  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
COMMIT
[0m06:07:04.892459 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m06:07:04.918846 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m06:07:04.919469 [debug] [Thread-1  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
drop view if exists airbnb.dev.fct_reviews__dbt_tmp cascade
[0m06:07:05.256877 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m06:07:05.265834 [debug] [Thread-1  ]: Timing info for model.dbtlearn.fct_reviews (execute): 2023-02-27 06:06:59.547292 => 2023-02-27 06:07:05.265630
[0m06:07:05.266900 [debug] [Thread-1  ]: On model.dbtlearn.fct_reviews: Close
[0m06:07:06.542025 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 3 seconds
[0m06:07:06.550547 [debug] [Thread-4  ]: Timing info for model.dbtlearn.dim_listings_w_hosts (execute): 2023-02-27 06:07:03.188363 => 2023-02-27 06:07:06.550325
[0m06:07:06.552974 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '778476ac-e9de-4e01-ad9d-63da039ca286', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80e2283d30>]}
[0m06:07:06.553695 [debug] [Thread-4  ]: On model.dbtlearn.dim_listings_w_hosts: Close
[0m06:07:06.557709 [info ] [Thread-1  ]: 6 of 7 OK created sql incremental model dev.fct_reviews ........................ [[32mSUCCESS 0[0m in 7.02s]
[0m06:07:06.559925 [debug] [Thread-1  ]: Finished running node model.dbtlearn.fct_reviews
[0m06:07:07.226322 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '778476ac-e9de-4e01-ad9d-63da039ca286', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80d1991040>]}
[0m06:07:07.228041 [info ] [Thread-4  ]: 7 of 7 OK created sql table model dev.dim_listings_w_hosts ..................... [[32mSUCCESS 1[0m in 4.05s]
[0m06:07:07.229431 [debug] [Thread-4  ]: Finished running node model.dbtlearn.dim_listings_w_hosts
[0m06:07:07.232555 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m06:07:07.233831 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:07:07.234289 [debug] [MainThread]: Connection 'model.dbtlearn.fct_reviews' was properly closed.
[0m06:07:07.234751 [debug] [MainThread]: Connection 'model.dbtlearn.dim_hosts_cleansed' was properly closed.
[0m06:07:07.235218 [debug] [MainThread]: Connection 'model.dbtlearn.dim_listings_w_hosts' was properly closed.
[0m06:07:07.235704 [debug] [MainThread]: Connection 'model.dbtlearn.dim_listings_cleansed' was properly closed.
[0m06:07:07.236421 [info ] [MainThread]: 
[0m06:07:07.237146 [info ] [MainThread]: Finished running 3 view models, 3 table models, 1 incremental model in 0 hours 0 minutes and 18.19 seconds (18.19s).
[0m06:07:07.238847 [debug] [MainThread]: Command end result
[0m06:07:07.254436 [info ] [MainThread]: 
[0m06:07:07.255230 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:07:07.255768 [info ] [MainThread]: 
[0m06:07:07.256202 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m06:07:07.256739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80d175b880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80d17b91f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80e22775e0>]}
[0m06:07:07.257140 [debug] [MainThread]: Flushing usage events


============================== 2023-02-27 06:08:12.186805 | 38e80d35-8b1b-4b01-8945-a08f7e477b3c ==============================
[0m06:08:12.186805 [info ] [MainThread]: Running with dbt=1.4.3
[0m06:08:12.189281 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/katiehuang/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['dbt_project'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m06:08:12.189597 [debug] [MainThread]: Tracking: tracking
[0m06:08:12.190384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2b974a9a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2b974ad60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2b974ac10>]}
[0m06:08:12.203372 [debug] [MainThread]: checksum: c7a5cda64f02d8b9dd20ef412f82fbb79fdce1bb359c3c5dae3d080de7f31bfd, vars: {}, profile: None, target: None, version: 1.4.3
[0m06:08:12.214857 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m06:08:12.215316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '38e80d35-8b1b-4b01-8945-a08f7e477b3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2b974ac70>]}
[0m06:08:12.982478 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_w_hosts.sql
[0m06:08:12.995773 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_cleansed.sql
[0m06:08:12.998729 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_hosts_cleansed.sql
[0m06:08:13.001848 [debug] [MainThread]: 1603: static parser failed on fct/fct_reviews.sql
[0m06:08:13.010874 [debug] [MainThread]: 1602: parser fallback to jinja rendering on fct/fct_reviews.sql
[0m06:08:13.012185 [debug] [MainThread]: 1699: static parser successfully parsed src/src_reviews.sql
[0m06:08:13.014943 [debug] [MainThread]: 1699: static parser successfully parsed src/src_listings.sql
[0m06:08:13.017920 [debug] [MainThread]: 1699: static parser successfully parsed src/src_hosts.sql
[0m06:08:13.104391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '38e80d35-8b1b-4b01-8945-a08f7e477b3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2a8130be0>]}
[0m06:08:13.111774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '38e80d35-8b1b-4b01-8945-a08f7e477b3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2a81308e0>]}
[0m06:08:13.112112 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 304 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m06:08:13.112437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '38e80d35-8b1b-4b01-8945-a08f7e477b3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2b974e850>]}
[0m06:08:13.113117 [warn ] [MainThread]: The selection criterion 'dbt_project' does not match any nodes
[0m06:08:13.113962 [info ] [MainThread]: 
[0m06:08:13.114382 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m06:08:13.114706 [debug] [MainThread]: Command end result
[0m06:08:13.119739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2a81552b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2a8130b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2a8130be0>]}
[0m06:08:13.120005 [debug] [MainThread]: Flushing usage events


============================== 2023-02-27 06:08:22.646427 | 99cc5dbe-e3a0-4e21-9a98-568c7cdc0eff ==============================
[0m06:08:22.646427 [info ] [MainThread]: Running with dbt=1.4.3
[0m06:08:22.648445 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/katiehuang/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m06:08:22.648745 [debug] [MainThread]: Tracking: tracking
[0m06:08:22.649376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce7b3faa00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce7b3fadc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce7b3fac70>]}
[0m06:08:22.661640 [debug] [MainThread]: checksum: c7a5cda64f02d8b9dd20ef412f82fbb79fdce1bb359c3c5dae3d080de7f31bfd, vars: {}, profile: None, target: None, version: 1.4.3
[0m06:08:22.699263 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:08:22.699570 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:08:22.707205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '99cc5dbe-e3a0-4e21-9a98-568c7cdc0eff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce7b59c430>]}
[0m06:08:22.714009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '99cc5dbe-e3a0-4e21-9a98-568c7cdc0eff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce7b523910>]}
[0m06:08:22.714359 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 304 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m06:08:22.714684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '99cc5dbe-e3a0-4e21-9a98-568c7cdc0eff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce7b523940>]}
[0m06:08:22.716270 [info ] [MainThread]: 
[0m06:08:22.717794 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m06:08:22.719052 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_airbnb'
[0m06:08:22.735111 [debug] [ThreadPool]: Using snowflake connection "list_airbnb"
[0m06:08:22.735422 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb"} */
show terse schemas in database airbnb
    limit 10000
[0m06:08:22.735690 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:08:25.912544 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 3 seconds
[0m06:08:25.919000 [debug] [ThreadPool]: On list_airbnb: Close
[0m06:08:26.796378 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_airbnb_dev'
[0m06:08:26.808238 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m06:08:26.808613 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m06:08:26.808954 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:08:29.384008 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 3 seconds
[0m06:08:29.392322 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m06:08:30.721843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '99cc5dbe-e3a0-4e21-9a98-568c7cdc0eff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce881beeb0>]}
[0m06:08:30.723455 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:08:30.724060 [info ] [MainThread]: 
[0m06:08:30.732132 [debug] [Thread-1  ]: Began running node model.dbtlearn.src_hosts
[0m06:08:30.732652 [debug] [Thread-2  ]: Began running node model.dbtlearn.src_listings
[0m06:08:30.733054 [debug] [Thread-3  ]: Began running node model.dbtlearn.src_reviews
[0m06:08:30.733843 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtlearn.src_hosts'
[0m06:08:30.734657 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtlearn.src_listings'
[0m06:08:30.735382 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtlearn.src_reviews'
[0m06:08:30.735732 [debug] [Thread-1  ]: Began compiling node model.dbtlearn.src_hosts
[0m06:08:30.736099 [debug] [Thread-2  ]: Began compiling node model.dbtlearn.src_listings
[0m06:08:30.736430 [debug] [Thread-3  ]: Began compiling node model.dbtlearn.src_reviews
[0m06:08:30.739130 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearn.src_hosts"
[0m06:08:30.741507 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtlearn.src_listings"
[0m06:08:30.743435 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtlearn.src_reviews"
[0m06:08:30.744466 [debug] [Thread-1  ]: Timing info for model.dbtlearn.src_hosts (compile): 2023-02-27 06:08:30.736692 => 2023-02-27 06:08:30.744373
[0m06:08:30.744769 [debug] [Thread-2  ]: Timing info for model.dbtlearn.src_listings (compile): 2023-02-27 06:08:30.739434 => 2023-02-27 06:08:30.744692
[0m06:08:30.747476 [debug] [Thread-1  ]: Finished running node model.dbtlearn.src_hosts
[0m06:08:30.747840 [debug] [Thread-3  ]: Timing info for model.dbtlearn.src_reviews (compile): 2023-02-27 06:08:30.741754 => 2023-02-27 06:08:30.747775
[0m06:08:30.748738 [debug] [Thread-2  ]: Finished running node model.dbtlearn.src_listings
[0m06:08:30.749735 [debug] [Thread-3  ]: Finished running node model.dbtlearn.src_reviews
[0m06:08:30.750238 [debug] [Thread-2  ]: Began running node model.dbtlearn.dim_hosts_cleansed
[0m06:08:30.751354 [debug] [Thread-1  ]: Began running node model.dbtlearn.dim_listings_cleansed
[0m06:08:30.750937 [info ] [Thread-2  ]: 1 of 4 START sql table model dev.dim_hosts_cleansed ............................ [RUN]
[0m06:08:30.751838 [info ] [Thread-1  ]: 2 of 4 START sql table model dev.dim_listings_cleansed ......................... [RUN]
[0m06:08:30.752534 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtlearn.dim_hosts_cleansed'
[0m06:08:30.752801 [debug] [Thread-3  ]: Began running node model.dbtlearn.fct_reviews
[0m06:08:30.753372 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtlearn.dim_listings_cleansed'
[0m06:08:30.753633 [debug] [Thread-2  ]: Began compiling node model.dbtlearn.dim_hosts_cleansed
[0m06:08:30.753954 [info ] [Thread-3  ]: 3 of 4 START sql incremental model dev.fct_reviews ............................. [RUN]
[0m06:08:30.754333 [debug] [Thread-1  ]: Began compiling node model.dbtlearn.dim_listings_cleansed
[0m06:08:30.766836 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtlearn.fct_reviews'
[0m06:08:30.769641 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtlearn.dim_hosts_cleansed"
[0m06:08:30.779132 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearn.dim_listings_cleansed"
[0m06:08:30.779455 [debug] [Thread-3  ]: Began compiling node model.dbtlearn.fct_reviews
[0m06:08:30.796164 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtlearn.fct_reviews"
[0m06:08:30.796655 [debug] [Thread-1  ]: Timing info for model.dbtlearn.dim_listings_cleansed (compile): 2023-02-27 06:08:30.769864 => 2023-02-27 06:08:30.796595
[0m06:08:30.796882 [debug] [Thread-2  ]: Timing info for model.dbtlearn.dim_hosts_cleansed (compile): 2023-02-27 06:08:30.754515 => 2023-02-27 06:08:30.796830
[0m06:08:30.797114 [debug] [Thread-1  ]: Began executing node model.dbtlearn.dim_listings_cleansed
[0m06:08:30.797367 [debug] [Thread-2  ]: Began executing node model.dbtlearn.dim_hosts_cleansed
[0m06:08:30.803927 [debug] [Thread-3  ]: Timing info for model.dbtlearn.fct_reviews (compile): 2023-02-27 06:08:30.779812 => 2023-02-27 06:08:30.803875
[0m06:08:30.841586 [debug] [Thread-3  ]: Began executing node model.dbtlearn.fct_reviews
[0m06:08:30.846560 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbtlearn.dim_hosts_cleansed"
[0m06:08:30.849444 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtlearn.dim_listings_cleansed"
[0m06:08:30.897385 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearn.dim_hosts_cleansed"
[0m06:08:30.897659 [debug] [Thread-2  ]: On model.dbtlearn.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_hosts_cleansed"} */
create or replace transient table airbnb.dev.dim_hosts_cleansed  as
        (WITH  __dbt__cte__src_hosts as (
WITH raw_hosts AS (
	SELECT * FROM AIRBNB.RAW.RAW_HOSTS
)

SELECT
    id AS host_id,
    name AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM raw_hosts
),src_hosts AS (
    SELECT * FROM __dbt__cte__src_hosts
)

SELECT 
    host_id,
    NVL(host_name, 'Anonymous') AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM src_hosts
        );
[0m06:08:30.897856 [debug] [Thread-3  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m06:08:30.899279 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.dim_listings_cleansed"
[0m06:08:30.899476 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m06:08:30.899672 [debug] [Thread-3  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
create or replace  temporary view airbnb.dev.fct_reviews__dbt_tmp
  
   as (
    -- Doc | Config : https://docs.getdbt.com/reference/dbt-jinja-functions/config


-- dbt materializes the model as an incremental table. 
-- Read for difference btw table vs. incremental: https://docs.getdbt.com/docs/build/materializations

WITH  __dbt__cte__src_reviews as (
WITH raw_reviews AS (
	SELECT * FROM AIRBNB.RAW.RAW_REVIEWS
)

SELECT
    listing_id,
    date AS review_date,
    reviewer_name,
    comments AS review_text,
    sentiment AS review_sentiment
FROM raw_reviews
),src_reviews AS (
    SELECT * FROM __dbt__cte__src_reviews
)

SELECT 
    listing_id,
    review_date,
    NVL(reviewer_name, 'Anonymous') AS reviewer_name,
    review_text,
    review_sentiment
FROM src_reviews
WHERE review_text IS NOT NULL


  and review_date > (select max(review_date) from airbnb.dev.fct_reviews)

  );
[0m06:08:30.899862 [debug] [Thread-1  ]: On model.dbtlearn.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_cleansed"} */
create or replace transient table airbnb.dev.dim_listings_cleansed  as
        (WITH  __dbt__cte__src_listings as (
WITH raw_listings AS (
	SELECT * FROM AIRBNB.RAW.RAW_LISTINGS
)

SELECT 
	id AS listing_id,
    name AS listing_name,
    listing_url,
    room_type,
    minimum_nights,
    host_id,
    price AS price_str,
    created_at,
    updated_at
FROM 
	raw_listings
),src_listings AS (
    SELECT * FROM __dbt__cte__src_listings
)

SELECT
    listing_id,
    listing_name,
    room_type,
    CASE 
        WHEN minimum_nights = 0 THEN 1 -- 0 night = 1 night, so we assign the value of 1 to indicate 1 night
        ELSE minimum_nights
    END AS minimum_nights,
    host_id,
    REPLACE( -- Parse string value into numerical form
        price_str, '$' -- Replace '$' with price_str value. In other words, to remove '$' from string.
        ) :: NUMBER (10, 2 -- Convert string type to numerical with 2 decimal places
    ) AS price,
    created_at,
    updated_at
    
FROM src_listings
        );
[0m06:08:30.900299 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m06:08:30.900877 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:08:32.986102 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 2 seconds
[0m06:08:32.996079 [debug] [Thread-3  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m06:08:32.996374 [debug] [Thread-3  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
describe table airbnb.dev.fct_reviews__dbt_tmp
[0m06:08:33.310718 [debug] [Thread-3  ]: SQL status: SUCCESS 5 in 0 seconds
[0m06:08:33.325221 [debug] [Thread-3  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m06:08:33.325996 [debug] [Thread-3  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
describe table airbnb.dev.fct_reviews
[0m06:08:33.347712 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 2 seconds
[0m06:08:33.386868 [debug] [Thread-2  ]: Timing info for model.dbtlearn.dim_hosts_cleansed (execute): 2023-02-27 06:08:30.816426 => 2023-02-27 06:08:33.386791
[0m06:08:33.387197 [debug] [Thread-2  ]: On model.dbtlearn.dim_hosts_cleansed: Close
[0m06:08:33.681586 [debug] [Thread-3  ]: SQL status: SUCCESS 5 in 0 seconds
[0m06:08:33.713882 [debug] [Thread-3  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m06:08:33.714322 [debug] [Thread-3  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
describe table airbnb.dev.fct_reviews__dbt_tmp
[0m06:08:34.055543 [debug] [Thread-3  ]: SQL status: SUCCESS 5 in 0 seconds
[0m06:08:34.065944 [debug] [Thread-3  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m06:08:34.066555 [debug] [Thread-3  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
describe table "AIRBNB"."DEV"."FCT_REVIEWS"
[0m06:08:34.071225 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '99cc5dbe-e3a0-4e21-9a98-568c7cdc0eff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce7b38ad30>]}
[0m06:08:34.072488 [info ] [Thread-2  ]: 1 of 4 OK created sql table model dev.dim_hosts_cleansed ....................... [[32mSUCCESS 1[0m in 3.32s]
[0m06:08:34.073905 [debug] [Thread-2  ]: Finished running node model.dbtlearn.dim_hosts_cleansed
[0m06:08:34.385906 [debug] [Thread-3  ]: SQL status: SUCCESS 5 in 0 seconds
[0m06:08:34.407453 [debug] [Thread-3  ]: 
    In "AIRBNB"."DEV"."FCT_REVIEWS":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m06:08:34.431226 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbtlearn.fct_reviews"
[0m06:08:34.433439 [debug] [Thread-3  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m06:08:34.433693 [debug] [Thread-3  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
-- back compat for old kwarg name
  
  begin;
[0m06:08:34.811219 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0 seconds
[0m06:08:34.812620 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 4 seconds
[0m06:08:34.813167 [debug] [Thread-3  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m06:08:34.818672 [debug] [Thread-1  ]: Timing info for model.dbtlearn.dim_listings_cleansed (execute): 2023-02-27 06:08:30.797563 => 2023-02-27 06:08:34.818576
[0m06:08:34.819102 [debug] [Thread-3  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
insert into airbnb.dev.fct_reviews ("LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT")
        (
            select "LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT"
            from airbnb.dev.fct_reviews__dbt_tmp
        );
[0m06:08:34.819491 [debug] [Thread-1  ]: On model.dbtlearn.dim_listings_cleansed: Close
[0m06:08:35.337698 [debug] [Thread-3  ]: SQL status: SUCCESS 0 in 1 seconds
[0m06:08:35.338924 [debug] [Thread-3  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m06:08:35.339391 [debug] [Thread-3  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
COMMIT
[0m06:08:35.435478 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '99cc5dbe-e3a0-4e21-9a98-568c7cdc0eff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce8836d490>]}
[0m06:08:35.436910 [info ] [Thread-1  ]: 2 of 4 OK created sql table model dev.dim_listings_cleansed .................... [[32mSUCCESS 1[0m in 4.68s]
[0m06:08:35.438013 [debug] [Thread-1  ]: Finished running node model.dbtlearn.dim_listings_cleansed
[0m06:08:35.439436 [debug] [Thread-4  ]: Began running node model.dbtlearn.dim_listings_w_hosts
[0m06:08:35.440066 [info ] [Thread-4  ]: 4 of 4 START sql table model dev.dim_listings_w_hosts .......................... [RUN]
[0m06:08:35.441359 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.dbtlearn.dim_listings_w_hosts'
[0m06:08:35.441785 [debug] [Thread-4  ]: Began compiling node model.dbtlearn.dim_listings_w_hosts
[0m06:08:35.448014 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtlearn.dim_listings_w_hosts"
[0m06:08:35.448962 [debug] [Thread-4  ]: Timing info for model.dbtlearn.dim_listings_w_hosts (compile): 2023-02-27 06:08:35.442072 => 2023-02-27 06:08:35.448876
[0m06:08:35.449347 [debug] [Thread-4  ]: Began executing node model.dbtlearn.dim_listings_w_hosts
[0m06:08:35.453602 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbtlearn.dim_listings_w_hosts"
[0m06:08:35.455992 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearn.dim_listings_w_hosts"
[0m06:08:35.456285 [debug] [Thread-4  ]: On model.dbtlearn.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_w_hosts"} */
create or replace transient table airbnb.dev.dim_listings_w_hosts  as
        (WITH 
listings AS (
    SELECT * FROM airbnb.dev.dim_listings_cleansed
),
hosts AS (
    SELECT * FROM airbnb.dev.dim_hosts_cleansed
)

SELECT 
    listings.listing_id,
    listings.listing_name,
    listings.room_type,
    listings.minimum_nights,
    listings.price,
    listings.host_id,
    hosts.host_name,
    hosts.is_superhost AS host_is_superhost,
    listings.created_at,
    GREATEST(listings.updated_at, hosts.updated_at) AS updated_at -- Keep most recent updated_at
FROM listings
LEFT JOIN hosts
    ON listings.host_id = hosts.host_id
        );
[0m06:08:35.456553 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m06:08:35.728585 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0 seconds
[0m06:08:35.742033 [debug] [Thread-3  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m06:08:35.742382 [debug] [Thread-3  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
drop view if exists airbnb.dev.fct_reviews__dbt_tmp cascade
[0m06:08:36.109593 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0 seconds
[0m06:08:36.116521 [debug] [Thread-3  ]: Timing info for model.dbtlearn.fct_reviews (execute): 2023-02-27 06:08:30.849617 => 2023-02-27 06:08:36.116405
[0m06:08:36.117075 [debug] [Thread-3  ]: On model.dbtlearn.fct_reviews: Close
[0m06:08:36.773724 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '99cc5dbe-e3a0-4e21-9a98-568c7cdc0eff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce882bd280>]}
[0m06:08:36.774795 [info ] [Thread-3  ]: 3 of 4 OK created sql incremental model dev.fct_reviews ........................ [[32mSUCCESS 0[0m in 6.01s]
[0m06:08:36.775827 [debug] [Thread-3  ]: Finished running node model.dbtlearn.fct_reviews
[0m06:08:38.697215 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 3 seconds
[0m06:08:38.704243 [debug] [Thread-4  ]: Timing info for model.dbtlearn.dim_listings_w_hosts (execute): 2023-02-27 06:08:35.449585 => 2023-02-27 06:08:38.704124
[0m06:08:38.704773 [debug] [Thread-4  ]: On model.dbtlearn.dim_listings_w_hosts: Close
[0m06:08:39.923306 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '99cc5dbe-e3a0-4e21-9a98-568c7cdc0eff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce8836d550>]}
[0m06:08:39.924518 [info ] [Thread-4  ]: 4 of 4 OK created sql table model dev.dim_listings_w_hosts ..................... [[32mSUCCESS 1[0m in 4.48s]
[0m06:08:39.925496 [debug] [Thread-4  ]: Finished running node model.dbtlearn.dim_listings_w_hosts
[0m06:08:39.928322 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m06:08:39.929310 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:08:39.929669 [debug] [MainThread]: Connection 'model.dbtlearn.dim_listings_cleansed' was properly closed.
[0m06:08:39.929972 [debug] [MainThread]: Connection 'model.dbtlearn.dim_hosts_cleansed' was properly closed.
[0m06:08:39.930255 [debug] [MainThread]: Connection 'model.dbtlearn.fct_reviews' was properly closed.
[0m06:08:39.930533 [debug] [MainThread]: Connection 'model.dbtlearn.dim_listings_w_hosts' was properly closed.
[0m06:08:39.930940 [info ] [MainThread]: 
[0m06:08:39.931500 [info ] [MainThread]: Finished running 3 table models, 1 incremental model in 0 hours 0 minutes and 17.21 seconds (17.21s).
[0m06:08:39.932452 [debug] [MainThread]: Command end result
[0m06:08:39.942741 [info ] [MainThread]: 
[0m06:08:39.943273 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:08:39.943697 [info ] [MainThread]: 
[0m06:08:39.944102 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m06:08:39.944610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce8835fca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce88246310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce7b523340>]}
[0m06:08:39.945023 [debug] [MainThread]: Flushing usage events


============================== 2023-02-27 06:45:11.534649 | 450b7007-69e7-4263-b166-068f0db9c0a8 ==============================
[0m06:45:11.534649 [info ] [MainThread]: Running with dbt=1.4.3
[0m06:45:11.537254 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/katiehuang/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m06:45:11.537576 [debug] [MainThread]: Tracking: tracking
[0m06:45:11.538353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1291dba00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1291dbdc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1291dbc70>]}
[0m06:45:11.551388 [debug] [MainThread]: checksum: c7a5cda64f02d8b9dd20ef412f82fbb79fdce1bb359c3c5dae3d080de7f31bfd, vars: {}, profile: None, target: None, version: 1.4.3
[0m06:45:11.592734 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m06:45:11.593290 [debug] [MainThread]: Partial parsing: updated file: dbtlearn://models/dim/dim_listings_cleansed.sql
[0m06:45:11.593614 [debug] [MainThread]: Partial parsing: updated file: dbtlearn://models/dim/dim_hosts_cleansed.sql
[0m06:45:11.610662 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_cleansed.sql
[0m06:45:11.625722 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_hosts_cleansed.sql
[0m06:45:11.639532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '450b7007-69e7-4263-b166-068f0db9c0a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1183b6cd0>]}
[0m06:45:11.648341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '450b7007-69e7-4263-b166-068f0db9c0a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc11838f700>]}
[0m06:45:11.648714 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 304 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m06:45:11.649045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '450b7007-69e7-4263-b166-068f0db9c0a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1183a2d60>]}
[0m06:45:11.650567 [info ] [MainThread]: 
[0m06:45:11.652088 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m06:45:11.653239 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_airbnb'
[0m06:45:11.669047 [debug] [ThreadPool]: Using snowflake connection "list_airbnb"
[0m06:45:11.669387 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb"} */
show terse schemas in database airbnb
    limit 10000
[0m06:45:11.669634 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:45:14.202250 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 3 seconds
[0m06:45:14.207917 [debug] [ThreadPool]: On list_airbnb: Close
[0m06:45:14.824611 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_airbnb_dev'
[0m06:45:14.836517 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m06:45:14.836861 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m06:45:14.837161 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:45:18.110808 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 3 seconds
[0m06:45:18.117418 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m06:45:18.721003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '450b7007-69e7-4263-b166-068f0db9c0a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1291dbdc0>]}
[0m06:45:18.722533 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:45:18.723185 [info ] [MainThread]: 
[0m06:45:18.731305 [debug] [Thread-2  ]: Began running node model.dbtlearn.src_listings
[0m06:45:18.731815 [debug] [Thread-3  ]: Began running node model.dbtlearn.src_reviews
[0m06:45:18.732255 [debug] [Thread-1  ]: Began running node model.dbtlearn.src_hosts
[0m06:45:18.733035 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtlearn.src_listings'
[0m06:45:18.733847 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtlearn.src_reviews'
[0m06:45:18.734594 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtlearn.src_hosts'
[0m06:45:18.734950 [debug] [Thread-2  ]: Began compiling node model.dbtlearn.src_listings
[0m06:45:18.735280 [debug] [Thread-3  ]: Began compiling node model.dbtlearn.src_reviews
[0m06:45:18.735583 [debug] [Thread-1  ]: Began compiling node model.dbtlearn.src_hosts
[0m06:45:18.746209 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtlearn.src_listings"
[0m06:45:18.749954 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtlearn.src_reviews"
[0m06:45:18.752873 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearn.src_hosts"
[0m06:45:18.762141 [debug] [Thread-2  ]: Timing info for model.dbtlearn.src_listings (compile): 2023-02-27 06:45:18.735818 => 2023-02-27 06:45:18.761976
[0m06:45:18.765133 [debug] [Thread-2  ]: Finished running node model.dbtlearn.src_listings
[0m06:45:18.765644 [debug] [Thread-3  ]: Timing info for model.dbtlearn.src_reviews (compile): 2023-02-27 06:45:18.746512 => 2023-02-27 06:45:18.765555
[0m06:45:18.765935 [debug] [Thread-1  ]: Timing info for model.dbtlearn.src_hosts (compile): 2023-02-27 06:45:18.750304 => 2023-02-27 06:45:18.765860
[0m06:45:18.767083 [debug] [Thread-3  ]: Finished running node model.dbtlearn.src_reviews
[0m06:45:18.767486 [debug] [Thread-4  ]: Began running node model.dbtlearn.dim_listings_cleansed
[0m06:45:18.768321 [debug] [Thread-1  ]: Finished running node model.dbtlearn.src_hosts
[0m06:45:18.768994 [info ] [Thread-4  ]: 1 of 4 START sql view model dev.dim_listings_cleansed .......................... [RUN]
[0m06:45:18.769578 [debug] [Thread-1  ]: Began running node model.dbtlearn.fct_reviews
[0m06:45:18.770321 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.dbtlearn.dim_listings_cleansed'
[0m06:45:18.770772 [info ] [Thread-1  ]: 2 of 4 START sql incremental model dev.fct_reviews ............................. [RUN]
[0m06:45:18.771253 [debug] [Thread-3  ]: Began running node model.dbtlearn.dim_hosts_cleansed
[0m06:45:18.771527 [debug] [Thread-4  ]: Began compiling node model.dbtlearn.dim_listings_cleansed
[0m06:45:18.772135 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtlearn.fct_reviews'
[0m06:45:18.772497 [info ] [Thread-3  ]: 3 of 4 START sql view model dev.dim_hosts_cleansed ............................. [RUN]
[0m06:45:18.784523 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtlearn.dim_listings_cleansed"
[0m06:45:18.784923 [debug] [Thread-1  ]: Began compiling node model.dbtlearn.fct_reviews
[0m06:45:18.785613 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtlearn.dim_hosts_cleansed'
[0m06:45:18.801508 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearn.fct_reviews"
[0m06:45:18.801931 [debug] [Thread-3  ]: Began compiling node model.dbtlearn.dim_hosts_cleansed
[0m06:45:18.802252 [debug] [Thread-4  ]: Timing info for model.dbtlearn.dim_listings_cleansed (compile): 2023-02-27 06:45:18.772841 => 2023-02-27 06:45:18.802186
[0m06:45:18.808646 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtlearn.dim_hosts_cleansed"
[0m06:45:18.809031 [debug] [Thread-4  ]: Began executing node model.dbtlearn.dim_listings_cleansed
[0m06:45:18.821964 [debug] [Thread-1  ]: Timing info for model.dbtlearn.fct_reviews (compile): 2023-02-27 06:45:18.785927 => 2023-02-27 06:45:18.821899
[0m06:45:18.828489 [debug] [Thread-3  ]: Timing info for model.dbtlearn.dim_hosts_cleansed (compile): 2023-02-27 06:45:18.802427 => 2023-02-27 06:45:18.828435
[0m06:45:18.828723 [debug] [Thread-1  ]: Began executing node model.dbtlearn.fct_reviews
[0m06:45:18.835132 [debug] [Thread-4  ]: Dropping relation "AIRBNB"."DEV"."DIM_LISTINGS_CLEANSED" because it is of type table
[0m06:45:18.835409 [debug] [Thread-3  ]: Began executing node model.dbtlearn.dim_hosts_cleansed
[0m06:45:18.863024 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearn.dim_listings_cleansed"
[0m06:45:18.872149 [debug] [Thread-3  ]: Dropping relation "AIRBNB"."DEV"."DIM_HOSTS_CLEANSED" because it is of type table
[0m06:45:18.889022 [debug] [Thread-4  ]: On model.dbtlearn.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_cleansed"} */
drop table if exists "AIRBNB"."DEV"."DIM_LISTINGS_CLEANSED" cascade
[0m06:45:18.890532 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m06:45:18.892948 [debug] [Thread-3  ]: Using snowflake connection "model.dbtlearn.dim_hosts_cleansed"
[0m06:45:18.893166 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m06:45:18.893377 [debug] [Thread-1  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
create or replace  temporary view airbnb.dev.fct_reviews__dbt_tmp
  
   as (
    -- Doc | Config : https://docs.getdbt.com/reference/dbt-jinja-functions/config


-- dbt materializes the model as an incremental table. 
-- Read for difference btw table vs. incremental: https://docs.getdbt.com/docs/build/materializations

WITH  __dbt__cte__src_reviews as (
WITH raw_reviews AS (
	SELECT * FROM AIRBNB.RAW.RAW_REVIEWS
)

SELECT
    listing_id,
    date AS review_date,
    reviewer_name,
    comments AS review_text,
    sentiment AS review_sentiment
FROM raw_reviews
),src_reviews AS (
    SELECT * FROM __dbt__cte__src_reviews
)

SELECT 
    listing_id,
    review_date,
    NVL(reviewer_name, 'Anonymous') AS reviewer_name,
    review_text,
    review_sentiment
FROM src_reviews
WHERE review_text IS NOT NULL


  and review_date > (select max(review_date) from airbnb.dev.fct_reviews)

  );
[0m06:45:18.893563 [debug] [Thread-3  ]: On model.dbtlearn.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_hosts_cleansed"} */
drop table if exists "AIRBNB"."DEV"."DIM_HOSTS_CLEANSED" cascade
[0m06:45:18.894556 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:45:18.895292 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m06:45:20.968284 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 2 seconds
[0m06:45:20.983891 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbtlearn.dim_hosts_cleansed"
[0m06:45:20.986014 [debug] [Thread-3  ]: Using snowflake connection "model.dbtlearn.dim_hosts_cleansed"
[0m06:45:20.986326 [debug] [Thread-3  ]: On model.dbtlearn.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_hosts_cleansed"} */
create or replace   view airbnb.dev.dim_hosts_cleansed
  
   as (
    

WITH  __dbt__cte__src_hosts as (
WITH raw_hosts AS (
	SELECT * FROM AIRBNB.RAW.RAW_HOSTS
)

SELECT
    id AS host_id,
    name AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM raw_hosts
),src_hosts AS (
    SELECT * FROM __dbt__cte__src_hosts
)

SELECT 
    host_id,
    NVL(host_name, 'Anonymous') AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM src_hosts
  );
[0m06:45:21.107232 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2 seconds
[0m06:45:21.127239 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m06:45:21.127603 [debug] [Thread-1  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
describe table airbnb.dev.fct_reviews__dbt_tmp
[0m06:45:21.142048 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 2 seconds
[0m06:45:21.144806 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbtlearn.dim_listings_cleansed"
[0m06:45:21.147584 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearn.dim_listings_cleansed"
[0m06:45:21.147878 [debug] [Thread-4  ]: On model.dbtlearn.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_cleansed"} */
create or replace   view airbnb.dev.dim_listings_cleansed
  
   as (
    


WITH  __dbt__cte__src_listings as (
WITH raw_listings AS (
	SELECT * FROM AIRBNB.RAW.RAW_LISTINGS
)

SELECT 
	id AS listing_id,
    name AS listing_name,
    listing_url,
    room_type,
    minimum_nights,
    host_id,
    price AS price_str,
    created_at,
    updated_at
FROM 
	raw_listings
),src_listings AS (
    SELECT * FROM __dbt__cte__src_listings
)

SELECT
    listing_id,
    listing_name,
    room_type,
    CASE 
        WHEN minimum_nights = 0 THEN 1 -- 0 night = 1 night, so we assign the value of 1 to indicate 1 night
        ELSE minimum_nights
    END AS minimum_nights,
    host_id,
    REPLACE( -- Parse string value into numerical form
        price_str, '$' -- Replace '$' with price_str value. In other words, to remove '$' from string.
        ) :: NUMBER (10, 2 -- Convert string type to numerical with 2 decimal places
    ) AS price,
    created_at,
    updated_at
    
FROM src_listings
  );
[0m06:45:21.402896 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0 seconds
[0m06:45:21.440865 [debug] [Thread-3  ]: Timing info for model.dbtlearn.dim_hosts_cleansed (execute): 2023-02-27 06:45:18.869540 => 2023-02-27 06:45:21.440741
[0m06:45:21.441662 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0 seconds
[0m06:45:21.441959 [debug] [Thread-3  ]: On model.dbtlearn.dim_hosts_cleansed: Close
[0m06:45:21.446742 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m06:45:21.448382 [debug] [Thread-1  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
describe table airbnb.dev.fct_reviews
[0m06:45:21.585770 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0 seconds
[0m06:45:21.593951 [debug] [Thread-4  ]: Timing info for model.dbtlearn.dim_listings_cleansed (execute): 2023-02-27 06:45:18.809335 => 2023-02-27 06:45:21.593771
[0m06:45:21.594633 [debug] [Thread-4  ]: On model.dbtlearn.dim_listings_cleansed: Close
[0m06:45:21.749675 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0 seconds
[0m06:45:21.780449 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m06:45:21.780988 [debug] [Thread-1  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
describe table airbnb.dev.fct_reviews__dbt_tmp
[0m06:45:22.030428 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '450b7007-69e7-4263-b166-068f0db9c0a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1293cae80>]}
[0m06:45:22.031497 [info ] [Thread-3  ]: 3 of 4 OK created sql view model dev.dim_hosts_cleansed ........................ [[32mSUCCESS 1[0m in 3.24s]
[0m06:45:22.032256 [debug] [Thread-3  ]: Finished running node model.dbtlearn.dim_hosts_cleansed
[0m06:45:22.102661 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0 seconds
[0m06:45:22.113762 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m06:45:22.114247 [debug] [Thread-1  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
describe table "AIRBNB"."DEV"."FCT_REVIEWS"
[0m06:45:22.145780 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '450b7007-69e7-4263-b166-068f0db9c0a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc13a952520>]}
[0m06:45:22.146783 [info ] [Thread-4  ]: 1 of 4 OK created sql view model dev.dim_listings_cleansed ..................... [[32mSUCCESS 1[0m in 3.38s]
[0m06:45:22.147514 [debug] [Thread-4  ]: Finished running node model.dbtlearn.dim_listings_cleansed
[0m06:45:22.148669 [debug] [Thread-2  ]: Began running node model.dbtlearn.dim_listings_w_hosts
[0m06:45:22.149287 [info ] [Thread-2  ]: 4 of 4 START sql table model dev.dim_listings_w_hosts .......................... [RUN]
[0m06:45:22.150454 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtlearn.dim_listings_w_hosts'
[0m06:45:22.150924 [debug] [Thread-2  ]: Began compiling node model.dbtlearn.dim_listings_w_hosts
[0m06:45:22.156933 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtlearn.dim_listings_w_hosts"
[0m06:45:22.158764 [debug] [Thread-2  ]: Timing info for model.dbtlearn.dim_listings_w_hosts (compile): 2023-02-27 06:45:22.151264 => 2023-02-27 06:45:22.158661
[0m06:45:22.159197 [debug] [Thread-2  ]: Began executing node model.dbtlearn.dim_listings_w_hosts
[0m06:45:22.189610 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbtlearn.dim_listings_w_hosts"
[0m06:45:22.191892 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearn.dim_listings_w_hosts"
[0m06:45:22.192132 [debug] [Thread-2  ]: On model.dbtlearn.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_w_hosts"} */
create or replace transient table airbnb.dev.dim_listings_w_hosts  as
        (WITH 
listings AS (
    SELECT * FROM airbnb.dev.dim_listings_cleansed
),
hosts AS (
    SELECT * FROM airbnb.dev.dim_hosts_cleansed
)

SELECT 
    listings.listing_id,
    listings.listing_name,
    listings.room_type,
    listings.minimum_nights,
    listings.price,
    listings.host_id,
    hosts.host_name,
    hosts.is_superhost AS host_is_superhost,
    listings.created_at,
    GREATEST(listings.updated_at, hosts.updated_at) AS updated_at -- Keep most recent updated_at
FROM listings
LEFT JOIN hosts
    ON listings.host_id = hosts.host_id
        );
[0m06:45:22.193202 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m06:45:22.428798 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0 seconds
[0m06:45:22.452422 [debug] [Thread-1  ]: 
    In "AIRBNB"."DEV"."FCT_REVIEWS":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m06:45:22.475877 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtlearn.fct_reviews"
[0m06:45:22.477127 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m06:45:22.477396 [debug] [Thread-1  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
-- back compat for old kwarg name
  
  begin;
[0m06:45:22.798283 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m06:45:22.800089 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m06:45:22.800862 [debug] [Thread-1  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
insert into airbnb.dev.fct_reviews ("LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT")
        (
            select "LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT"
            from airbnb.dev.fct_reviews__dbt_tmp
        );
[0m06:45:26.593354 [debug] [Thread-1  ]: SQL status: SUCCESS 0 in 4 seconds
[0m06:45:26.594712 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m06:45:26.595393 [debug] [Thread-1  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
COMMIT
[0m06:45:27.002312 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m06:45:27.019055 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m06:45:27.019517 [debug] [Thread-1  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
drop view if exists airbnb.dev.fct_reviews__dbt_tmp cascade
[0m06:45:27.098432 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 5 seconds
[0m06:45:27.123129 [debug] [Thread-2  ]: Timing info for model.dbtlearn.dim_listings_w_hosts (execute): 2023-02-27 06:45:22.159500 => 2023-02-27 06:45:27.123015
[0m06:45:27.123585 [debug] [Thread-2  ]: On model.dbtlearn.dim_listings_w_hosts: Close
[0m06:45:27.333660 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m06:45:27.340579 [debug] [Thread-1  ]: Timing info for model.dbtlearn.fct_reviews (execute): 2023-02-27 06:45:18.835580 => 2023-02-27 06:45:27.340479
[0m06:45:27.341068 [debug] [Thread-1  ]: On model.dbtlearn.fct_reviews: Close
[0m06:45:27.739069 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '450b7007-69e7-4263-b166-068f0db9c0a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc12945dd60>]}
[0m06:45:27.740015 [info ] [Thread-2  ]: 4 of 4 OK created sql table model dev.dim_listings_w_hosts ..................... [[32mSUCCESS 1[0m in 5.59s]
[0m06:45:27.740794 [debug] [Thread-2  ]: Finished running node model.dbtlearn.dim_listings_w_hosts
[0m06:45:27.929531 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '450b7007-69e7-4263-b166-068f0db9c0a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc13a9ca3a0>]}
[0m06:45:27.930551 [info ] [Thread-1  ]: 2 of 4 OK created sql incremental model dev.fct_reviews ........................ [[32mSUCCESS 0[0m in 9.16s]
[0m06:45:27.931279 [debug] [Thread-1  ]: Finished running node model.dbtlearn.fct_reviews
[0m06:45:27.933687 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m06:45:27.934603 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:45:27.934941 [debug] [MainThread]: Connection 'model.dbtlearn.fct_reviews' was properly closed.
[0m06:45:27.935242 [debug] [MainThread]: Connection 'model.dbtlearn.dim_listings_w_hosts' was properly closed.
[0m06:45:27.935553 [debug] [MainThread]: Connection 'model.dbtlearn.dim_hosts_cleansed' was properly closed.
[0m06:45:27.935831 [debug] [MainThread]: Connection 'model.dbtlearn.dim_listings_cleansed' was properly closed.
[0m06:45:27.936306 [info ] [MainThread]: 
[0m06:45:27.936946 [info ] [MainThread]: Finished running 2 view models, 1 table model, 1 incremental model in 0 hours 0 minutes and 16.29 seconds (16.29s).
[0m06:45:27.937953 [debug] [MainThread]: Command end result
[0m06:45:27.948360 [info ] [MainThread]: 
[0m06:45:27.948944 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:45:27.949384 [info ] [MainThread]: 
[0m06:45:27.949831 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m06:45:27.950357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1183a2d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1291d5760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1293cf820>]}
[0m06:45:27.950742 [debug] [MainThread]: Flushing usage events


============================== 2023-02-27 08:19:48.540013 | 1d722efb-d720-429f-a9c8-e5f90e96b8c3 ==============================
[0m08:19:48.540013 [info ] [MainThread]: Running with dbt=1.4.3
[0m08:19:48.542393 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/katiehuang/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'show': False, 'which': 'seed', 'rpc_method': 'seed', 'indirect_selection': 'eager'}
[0m08:19:48.542719 [debug] [MainThread]: Tracking: tracking
[0m08:19:48.543588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa820e3d970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa820e3dd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa820e3dbe0>]}
[0m08:19:48.556535 [debug] [MainThread]: checksum: c7a5cda64f02d8b9dd20ef412f82fbb79fdce1bb359c3c5dae3d080de7f31bfd, vars: {}, profile: None, target: None, version: 1.4.3
[0m08:19:48.567675 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m08:19:48.568101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '1d722efb-d720-429f-a9c8-e5f90e96b8c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa820e3dc40>]}
[0m08:19:49.345507 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_w_hosts.sql
[0m08:19:49.358746 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_cleansed.sql
[0m08:19:49.362053 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_hosts_cleansed.sql
[0m08:19:49.365199 [debug] [MainThread]: 1603: static parser failed on fct/fct_reviews.sql
[0m08:19:49.374191 [debug] [MainThread]: 1602: parser fallback to jinja rendering on fct/fct_reviews.sql
[0m08:19:49.375506 [debug] [MainThread]: 1699: static parser successfully parsed src/src_reviews.sql
[0m08:19:49.378280 [debug] [MainThread]: 1699: static parser successfully parsed src/src_listings.sql
[0m08:19:49.381236 [debug] [MainThread]: 1699: static parser successfully parsed src/src_hosts.sql
[0m08:19:49.481821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1d722efb-d720-429f-a9c8-e5f90e96b8c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa800115e50>]}
[0m08:19:49.489582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1d722efb-d720-429f-a9c8-e5f90e96b8c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa820e3d9d0>]}
[0m08:19:49.489917 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 304 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics
[0m08:19:49.490224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1d722efb-d720-429f-a9c8-e5f90e96b8c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa820e2a550>]}
[0m08:19:49.491481 [info ] [MainThread]: 
[0m08:19:49.492926 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:19:49.493885 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_airbnb'
[0m08:19:49.509540 [debug] [ThreadPool]: Using snowflake connection "list_airbnb"
[0m08:19:49.509816 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb"} */
show terse schemas in database airbnb
    limit 10000
[0m08:19:49.510040 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:19:52.225278 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 3 seconds
[0m08:19:52.231086 [debug] [ThreadPool]: On list_airbnb: Close
[0m08:19:52.886120 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_airbnb_dev'
[0m08:19:52.898849 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m08:19:52.899238 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m08:19:52.899567 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:19:54.756084 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2 seconds
[0m08:19:54.761214 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m08:19:55.361509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1d722efb-d720-429f-a9c8-e5f90e96b8c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa82034c3a0>]}
[0m08:19:55.362895 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:19:55.363481 [info ] [MainThread]: 
[0m08:19:55.371473 [debug] [Thread-1  ]: Began running node seed.dbtlearn.seed_full_moon_dates
[0m08:19:55.372065 [info ] [Thread-1  ]: 1 of 1 START seed file dev.seed_full_moon_dates ................................ [RUN]
[0m08:19:55.373035 [debug] [Thread-1  ]: Acquiring new snowflake connection 'seed.dbtlearn.seed_full_moon_dates'
[0m08:19:55.373389 [debug] [Thread-1  ]: Began compiling node seed.dbtlearn.seed_full_moon_dates
[0m08:19:55.373742 [debug] [Thread-1  ]: Timing info for seed.dbtlearn.seed_full_moon_dates (compile): 2023-02-27 08:19:55.373649 => 2023-02-27 08:19:55.373655
[0m08:19:55.374073 [debug] [Thread-1  ]: Began executing node seed.dbtlearn.seed_full_moon_dates
[0m08:19:55.426026 [debug] [Thread-1  ]: Using snowflake connection "seed.dbtlearn.seed_full_moon_dates"
[0m08:19:55.426289 [debug] [Thread-1  ]: On seed.dbtlearn.seed_full_moon_dates: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "seed.dbtlearn.seed_full_moon_dates"} */
create table airbnb.dev.seed_full_moon_dates (full_moon_date date)
[0m08:19:55.426472 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m08:19:57.927266 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 3 seconds
[0m08:19:57.965274 [debug] [Thread-1  ]: Using snowflake connection "seed.dbtlearn.seed_full_moon_dates"
[0m08:19:57.965679 [debug] [Thread-1  ]: On seed.dbtlearn.seed_full_moon_dates: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "seed.dbtlearn.seed_full_moon_dates"} */
BEGIN
[0m08:19:58.356193 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m08:19:58.363867 [debug] [Thread-1  ]: Using snowflake connection "seed.dbtlearn.seed_full_moon_dates"
[0m08:19:58.364310 [debug] [Thread-1  ]: On seed.dbtlearn.seed_full_moon_dates: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "seed.dbtlearn.seed_full_moon_dates"} */
insert into airbnb.dev.seed_full_moon_dates (full_moon_date) values
            (%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s...
[0m08:20:00.029054 [debug] [Thread-1  ]: SQL status: SUCCESS 272 in 2 seconds
[0m08:20:00.030346 [debug] [Thread-1  ]: Using snowflake connection "seed.dbtlearn.seed_full_moon_dates"
[0m08:20:00.030892 [debug] [Thread-1  ]: On seed.dbtlearn.seed_full_moon_dates: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "seed.dbtlearn.seed_full_moon_dates"} */
COMMIT
[0m08:20:00.643223 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1 seconds
[0m08:20:00.659158 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.dbtlearn.seed_full_moon_dates"
[0m08:20:00.695373 [debug] [Thread-1  ]: Timing info for seed.dbtlearn.seed_full_moon_dates (execute): 2023-02-27 08:19:55.374305 => 2023-02-27 08:20:00.695311
[0m08:20:00.695660 [debug] [Thread-1  ]: On seed.dbtlearn.seed_full_moon_dates: Close
[0m08:20:01.356800 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1d722efb-d720-429f-a9c8-e5f90e96b8c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa800115e50>]}
[0m08:20:01.357415 [info ] [Thread-1  ]: 1 of 1 OK loaded seed file dev.seed_full_moon_dates ............................ [[32mINSERT 272[0m in 5.98s]
[0m08:20:01.359007 [debug] [Thread-1  ]: Finished running node seed.dbtlearn.seed_full_moon_dates
[0m08:20:01.361386 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:20:01.361910 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:20:01.362098 [debug] [MainThread]: Connection 'seed.dbtlearn.seed_full_moon_dates' was properly closed.
[0m08:20:01.362301 [info ] [MainThread]: 
[0m08:20:01.362586 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 11.87 seconds (11.87s).
[0m08:20:01.362955 [debug] [MainThread]: Command end result
[0m08:20:01.370188 [info ] [MainThread]: 
[0m08:20:01.370553 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:20:01.370823 [info ] [MainThread]: 
[0m08:20:01.371085 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m08:20:01.371409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa820e2a550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8001fce50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa800115370>]}
[0m08:20:01.371671 [debug] [MainThread]: Flushing usage events


============================== 2023-02-27 08:52:55.886926 | fbe9bbd6-c3b1-4d6a-8978-ac5ad969bac2 ==============================
[0m08:52:55.886926 [info ] [MainThread]: Running with dbt=1.4.3
[0m08:52:55.889261 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/katiehuang/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m08:52:55.889602 [debug] [MainThread]: Tracking: tracking
[0m08:52:55.890248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2a953d8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2a953dca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2a953db50>]}
[0m08:52:55.903483 [debug] [MainThread]: checksum: c7a5cda64f02d8b9dd20ef412f82fbb79fdce1bb359c3c5dae3d080de7f31bfd, vars: {}, profile: None, target: None, version: 1.4.3
[0m08:52:55.944590 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m08:52:55.945057 [debug] [MainThread]: Partial parsing: added file: dbtlearn://models/mart/mart_fullmoon_reviews.sql
[0m08:52:55.962538 [debug] [MainThread]: 1699: static parser successfully parsed mart/mart_fullmoon_reviews.sql
[0m08:52:55.987843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fbe9bbd6-c3b1-4d6a-8978-ac5ad969bac2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2881bddf0>]}
[0m08:52:55.996476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fbe9bbd6-c3b1-4d6a-8978-ac5ad969bac2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2881abf70>]}
[0m08:52:55.996886 [info ] [MainThread]: Found 8 models, 0 tests, 0 snapshots, 0 analyses, 304 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics
[0m08:52:55.997230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fbe9bbd6-c3b1-4d6a-8978-ac5ad969bac2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2881abdc0>]}
[0m08:52:55.998946 [info ] [MainThread]: 
[0m08:52:56.000528 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:52:56.001743 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_airbnb'
[0m08:52:56.017574 [debug] [ThreadPool]: Using snowflake connection "list_airbnb"
[0m08:52:56.017906 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb"} */
show terse schemas in database airbnb
    limit 10000
[0m08:52:56.018148 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:52:58.932972 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 3 seconds
[0m08:52:58.938188 [debug] [ThreadPool]: On list_airbnb: Close
[0m08:53:00.439383 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_airbnb_dev'
[0m08:53:00.452891 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m08:53:00.453306 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m08:53:00.453637 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:53:02.237900 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2 seconds
[0m08:53:02.243027 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m08:53:02.879153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fbe9bbd6-c3b1-4d6a-8978-ac5ad969bac2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2881bdd60>]}
[0m08:53:02.880469 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:53:02.881087 [info ] [MainThread]: 
[0m08:53:02.889208 [debug] [Thread-2  ]: Began running node model.dbtlearn.src_listings
[0m08:53:02.889712 [debug] [Thread-3  ]: Began running node model.dbtlearn.src_reviews
[0m08:53:02.890231 [debug] [Thread-1  ]: Began running node model.dbtlearn.src_hosts
[0m08:53:02.891035 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtlearn.src_listings'
[0m08:53:02.891788 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtlearn.src_reviews'
[0m08:53:02.892518 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtlearn.src_hosts'
[0m08:53:02.892878 [debug] [Thread-2  ]: Began compiling node model.dbtlearn.src_listings
[0m08:53:02.893212 [debug] [Thread-3  ]: Began compiling node model.dbtlearn.src_reviews
[0m08:53:02.893530 [debug] [Thread-1  ]: Began compiling node model.dbtlearn.src_hosts
[0m08:53:02.896020 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtlearn.src_listings"
[0m08:53:02.899342 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtlearn.src_reviews"
[0m08:53:02.901278 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearn.src_hosts"
[0m08:53:02.902336 [debug] [Thread-2  ]: Timing info for model.dbtlearn.src_listings (compile): 2023-02-27 08:53:02.893767 => 2023-02-27 08:53:02.902249
[0m08:53:02.904553 [debug] [Thread-2  ]: Finished running node model.dbtlearn.src_listings
[0m08:53:02.905027 [debug] [Thread-3  ]: Timing info for model.dbtlearn.src_reviews (compile): 2023-02-27 08:53:02.896309 => 2023-02-27 08:53:02.904943
[0m08:53:02.906083 [debug] [Thread-3  ]: Finished running node model.dbtlearn.src_reviews
[0m08:53:02.906510 [debug] [Thread-3  ]: Began running node model.dbtlearn.dim_listings_cleansed
[0m08:53:02.906847 [debug] [Thread-1  ]: Timing info for model.dbtlearn.src_hosts (compile): 2023-02-27 08:53:02.899599 => 2023-02-27 08:53:02.906797
[0m08:53:02.907211 [info ] [Thread-3  ]: 1 of 5 START sql view model dev.dim_listings_cleansed .......................... [RUN]
[0m08:53:02.908205 [debug] [Thread-1  ]: Finished running node model.dbtlearn.src_hosts
[0m08:53:02.908569 [debug] [Thread-2  ]: Began running node model.dbtlearn.fct_reviews
[0m08:53:02.909128 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtlearn.dim_listings_cleansed'
[0m08:53:02.909924 [debug] [Thread-4  ]: Began running node model.dbtlearn.dim_hosts_cleansed
[0m08:53:02.909586 [info ] [Thread-2  ]: 2 of 5 START sql incremental model dev.fct_reviews ............................. [RUN]
[0m08:53:02.910348 [debug] [Thread-3  ]: Began compiling node model.dbtlearn.dim_listings_cleansed
[0m08:53:02.910648 [info ] [Thread-4  ]: 3 of 5 START sql view model dev.dim_hosts_cleansed ............................. [RUN]
[0m08:53:02.911314 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtlearn.fct_reviews'
[0m08:53:02.922368 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtlearn.dim_listings_cleansed"
[0m08:53:02.923022 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.dbtlearn.dim_hosts_cleansed'
[0m08:53:02.923286 [debug] [Thread-2  ]: Began compiling node model.dbtlearn.fct_reviews
[0m08:53:02.923583 [debug] [Thread-4  ]: Began compiling node model.dbtlearn.dim_hosts_cleansed
[0m08:53:02.938638 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtlearn.fct_reviews"
[0m08:53:02.944613 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtlearn.dim_hosts_cleansed"
[0m08:53:02.944990 [debug] [Thread-3  ]: Timing info for model.dbtlearn.dim_listings_cleansed (compile): 2023-02-27 08:53:02.911499 => 2023-02-27 08:53:02.944933
[0m08:53:02.945266 [debug] [Thread-3  ]: Began executing node model.dbtlearn.dim_listings_cleansed
[0m08:53:02.970635 [debug] [Thread-4  ]: Timing info for model.dbtlearn.dim_hosts_cleansed (compile): 2023-02-27 08:53:02.938865 => 2023-02-27 08:53:02.970571
[0m08:53:02.977144 [debug] [Thread-2  ]: Timing info for model.dbtlearn.fct_reviews (compile): 2023-02-27 08:53:02.923745 => 2023-02-27 08:53:02.977099
[0m08:53:02.977371 [debug] [Thread-4  ]: Began executing node model.dbtlearn.dim_hosts_cleansed
[0m08:53:02.978840 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbtlearn.dim_listings_cleansed"
[0m08:53:02.979101 [debug] [Thread-2  ]: Began executing node model.dbtlearn.fct_reviews
[0m08:53:02.982193 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbtlearn.dim_hosts_cleansed"
[0m08:53:03.002751 [debug] [Thread-3  ]: Using snowflake connection "model.dbtlearn.dim_listings_cleansed"
[0m08:53:03.015740 [debug] [Thread-3  ]: On model.dbtlearn.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_cleansed"} */
create or replace   view airbnb.dev.dim_listings_cleansed
  
   as (
    


WITH  __dbt__cte__src_listings as (
WITH raw_listings AS (
	SELECT * FROM AIRBNB.RAW.RAW_LISTINGS
)

SELECT 
	id AS listing_id,
    name AS listing_name,
    listing_url,
    room_type,
    minimum_nights,
    host_id,
    price AS price_str,
    created_at,
    updated_at
FROM 
	raw_listings
),src_listings AS (
    SELECT * FROM __dbt__cte__src_listings
)

SELECT
    listing_id,
    listing_name,
    room_type,
    CASE 
        WHEN minimum_nights = 0 THEN 1 -- 0 night = 1 night, so we assign the value of 1 to indicate 1 night
        ELSE minimum_nights
    END AS minimum_nights,
    host_id,
    REPLACE( -- Parse string value into numerical form
        price_str, '$' -- Replace '$' with price_str value. In other words, to remove '$' from string.
        ) :: NUMBER (10, 2 -- Convert string type to numerical with 2 decimal places
    ) AS price,
    created_at,
    updated_at
    
FROM src_listings
  );
[0m08:53:03.015996 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m08:53:03.023318 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearn.dim_hosts_cleansed"
[0m08:53:03.028039 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m08:53:03.028258 [debug] [Thread-4  ]: On model.dbtlearn.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_hosts_cleansed"} */
create or replace   view airbnb.dev.dim_hosts_cleansed
  
   as (
    

WITH  __dbt__cte__src_hosts as (
WITH raw_hosts AS (
	SELECT * FROM AIRBNB.RAW.RAW_HOSTS
)

SELECT
    id AS host_id,
    name AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM raw_hosts
),src_hosts AS (
    SELECT * FROM __dbt__cte__src_hosts
)

SELECT 
    host_id,
    NVL(host_name, 'Anonymous') AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM src_hosts
  );
[0m08:53:03.029007 [debug] [Thread-2  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
create or replace  temporary view airbnb.dev.fct_reviews__dbt_tmp
  
   as (
    -- Doc | Config : https://docs.getdbt.com/reference/dbt-jinja-functions/config


-- dbt materializes the model as an incremental table. 
-- Read for difference btw table vs. incremental: https://docs.getdbt.com/docs/build/materializations

WITH  __dbt__cte__src_reviews as (
WITH raw_reviews AS (
	SELECT * FROM AIRBNB.RAW.RAW_REVIEWS
)

SELECT
    listing_id,
    date AS review_date,
    reviewer_name,
    comments AS review_text,
    sentiment AS review_sentiment
FROM raw_reviews
),src_reviews AS (
    SELECT * FROM __dbt__cte__src_reviews
)

SELECT 
    listing_id,
    review_date,
    NVL(reviewer_name, 'Anonymous') AS reviewer_name,
    review_text,
    review_sentiment
FROM src_reviews
WHERE review_text IS NOT NULL


  and review_date > (select max(review_date) from airbnb.dev.fct_reviews)

  );
[0m08:53:03.029265 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m08:53:03.029464 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m08:53:05.415883 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 2 seconds
[0m08:53:05.435839 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m08:53:05.436273 [debug] [Thread-2  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
describe table airbnb.dev.fct_reviews__dbt_tmp
[0m08:53:05.453067 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 2 seconds
[0m08:53:05.481597 [debug] [Thread-3  ]: Timing info for model.dbtlearn.dim_listings_cleansed (execute): 2023-02-27 08:53:02.945440 => 2023-02-27 08:53:05.481532
[0m08:53:05.481881 [debug] [Thread-3  ]: On model.dbtlearn.dim_listings_cleansed: Close
[0m08:53:05.554548 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 3 seconds
[0m08:53:05.558725 [debug] [Thread-4  ]: Timing info for model.dbtlearn.dim_hosts_cleansed (execute): 2023-02-27 08:53:02.979281 => 2023-02-27 08:53:05.558638
[0m08:53:05.559151 [debug] [Thread-4  ]: On model.dbtlearn.dim_hosts_cleansed: Close
[0m08:53:05.768292 [debug] [Thread-2  ]: SQL status: SUCCESS 5 in 0 seconds
[0m08:53:05.778347 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m08:53:05.779073 [debug] [Thread-2  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
describe table airbnb.dev.fct_reviews
[0m08:53:06.092243 [debug] [Thread-2  ]: SQL status: SUCCESS 5 in 0 seconds
[0m08:53:06.123220 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m08:53:06.123553 [debug] [Thread-2  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
describe table airbnb.dev.fct_reviews__dbt_tmp
[0m08:53:06.131415 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fbe9bbd6-c3b1-4d6a-8978-ac5ad969bac2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2a960f880>]}
[0m08:53:06.132117 [info ] [Thread-3  ]: 1 of 5 OK created sql view model dev.dim_listings_cleansed ..................... [[32mSUCCESS 1[0m in 3.22s]
[0m08:53:06.132657 [debug] [Thread-3  ]: Finished running node model.dbtlearn.dim_listings_cleansed
[0m08:53:06.205950 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fbe9bbd6-c3b1-4d6a-8978-ac5ad969bac2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc29a7c4df0>]}
[0m08:53:06.206907 [info ] [Thread-4  ]: 3 of 5 OK created sql view model dev.dim_hosts_cleansed ........................ [[32mSUCCESS 1[0m in 3.28s]
[0m08:53:06.207652 [debug] [Thread-4  ]: Finished running node model.dbtlearn.dim_hosts_cleansed
[0m08:53:06.208765 [debug] [Thread-1  ]: Began running node model.dbtlearn.dim_listings_w_hosts
[0m08:53:06.209309 [info ] [Thread-1  ]: 4 of 5 START sql table model dev.dim_listings_w_hosts .......................... [RUN]
[0m08:53:06.210442 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtlearn.dim_listings_w_hosts'
[0m08:53:06.210844 [debug] [Thread-1  ]: Began compiling node model.dbtlearn.dim_listings_w_hosts
[0m08:53:06.215844 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearn.dim_listings_w_hosts"
[0m08:53:06.217483 [debug] [Thread-1  ]: Timing info for model.dbtlearn.dim_listings_w_hosts (compile): 2023-02-27 08:53:06.211076 => 2023-02-27 08:53:06.217392
[0m08:53:06.217883 [debug] [Thread-1  ]: Began executing node model.dbtlearn.dim_listings_w_hosts
[0m08:53:06.247417 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtlearn.dim_listings_w_hosts"
[0m08:53:06.249241 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.dim_listings_w_hosts"
[0m08:53:06.249443 [debug] [Thread-1  ]: On model.dbtlearn.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_w_hosts"} */
create or replace transient table airbnb.dev.dim_listings_w_hosts  as
        (WITH 
listings AS (
    SELECT * FROM airbnb.dev.dim_listings_cleansed
),
hosts AS (
    SELECT * FROM airbnb.dev.dim_hosts_cleansed
)

SELECT 
    listings.listing_id,
    listings.listing_name,
    listings.room_type,
    listings.minimum_nights,
    listings.price,
    listings.host_id,
    hosts.host_name,
    hosts.is_superhost AS host_is_superhost,
    listings.created_at,
    GREATEST(listings.updated_at, hosts.updated_at) AS updated_at -- Keep most recent updated_at
FROM listings
LEFT JOIN hosts
    ON listings.host_id = hosts.host_id
        );
[0m08:53:06.249625 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m08:53:06.448612 [debug] [Thread-2  ]: SQL status: SUCCESS 5 in 0 seconds
[0m08:53:06.458849 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m08:53:06.459315 [debug] [Thread-2  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
describe table "AIRBNB"."DEV"."FCT_REVIEWS"
[0m08:53:06.804420 [debug] [Thread-2  ]: SQL status: SUCCESS 5 in 0 seconds
[0m08:53:06.818204 [debug] [Thread-2  ]: 
    In "AIRBNB"."DEV"."FCT_REVIEWS":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m08:53:06.836156 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbtlearn.fct_reviews"
[0m08:53:06.837108 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m08:53:06.837310 [debug] [Thread-2  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
-- back compat for old kwarg name
  
  begin;
[0m08:53:07.940506 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1 seconds
[0m08:53:07.941893 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m08:53:07.942354 [debug] [Thread-2  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
insert into airbnb.dev.fct_reviews ("LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT")
        (
            select "LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT"
            from airbnb.dev.fct_reviews__dbt_tmp
        );
[0m08:53:08.482013 [debug] [Thread-2  ]: SQL status: SUCCESS 0 in 1 seconds
[0m08:53:08.483328 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m08:53:08.483808 [debug] [Thread-2  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
COMMIT
[0m08:53:08.922594 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0 seconds
[0m08:53:08.939876 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m08:53:08.940307 [debug] [Thread-2  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
drop view if exists airbnb.dev.fct_reviews__dbt_tmp cascade
[0m08:53:09.303182 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0 seconds
[0m08:53:09.319015 [debug] [Thread-2  ]: Timing info for model.dbtlearn.fct_reviews (execute): 2023-02-27 08:53:02.982463 => 2023-02-27 08:53:09.318919
[0m08:53:09.319479 [debug] [Thread-2  ]: On model.dbtlearn.fct_reviews: Close
[0m08:53:09.921899 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fbe9bbd6-c3b1-4d6a-8978-ac5ad969bac2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc29a891880>]}
[0m08:53:09.923070 [info ] [Thread-2  ]: 2 of 5 OK created sql incremental model dev.fct_reviews ........................ [[32mSUCCESS 0[0m in 7.01s]
[0m08:53:09.923995 [debug] [Thread-2  ]: Finished running node model.dbtlearn.fct_reviews
[0m08:53:09.924961 [debug] [Thread-4  ]: Began running node model.dbtlearn.mart_fullmoon_reviews
[0m08:53:09.925526 [info ] [Thread-4  ]: 5 of 5 START sql view model dev.mart_fullmoon_reviews .......................... [RUN]
[0m08:53:09.926915 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.dbtlearn.mart_fullmoon_reviews'
[0m08:53:09.927373 [debug] [Thread-4  ]: Began compiling node model.dbtlearn.mart_fullmoon_reviews
[0m08:53:09.933159 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtlearn.mart_fullmoon_reviews"
[0m08:53:09.934309 [debug] [Thread-4  ]: Timing info for model.dbtlearn.mart_fullmoon_reviews (compile): 2023-02-27 08:53:09.927670 => 2023-02-27 08:53:09.934210
[0m08:53:09.934761 [debug] [Thread-4  ]: Began executing node model.dbtlearn.mart_fullmoon_reviews
[0m08:53:09.941826 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbtlearn.mart_fullmoon_reviews"
[0m08:53:09.943965 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearn.mart_fullmoon_reviews"
[0m08:53:09.944264 [debug] [Thread-4  ]: On model.dbtlearn.mart_fullmoon_reviews: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.mart_fullmoon_reviews"} */
create or replace   view airbnb.dev.mart_fullmoon_reviews
  
   as (
    WITH fct_reviews AS (

    SELECT * FROM airbnb.dev.fct_reviews

),
full_moon_dates AS (

    SELECT * FROM airbnb.dev.seed_full_moon_dates
)

SELECT
    reviews.*,
    CASE
        WHEN fullmoon.full_moon_date IS NULL THEN 'not full moon'
        ELSE 'full moon' END AS is_full_moon
FROM fct_reviews AS reviews
LEFT JOIN full_moon_dates AS fullmoon
    ON (TO_DATE(reviews.review_date) = DATEADD(DAY, 1, fullmoon.full_moon_date))
  );
[0m08:53:09.944540 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m08:53:10.226901 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 4 seconds
[0m08:53:10.234520 [debug] [Thread-1  ]: Timing info for model.dbtlearn.dim_listings_w_hosts (execute): 2023-02-27 08:53:06.218125 => 2023-02-27 08:53:10.234405
[0m08:53:10.238886 [debug] [Thread-1  ]: On model.dbtlearn.dim_listings_w_hosts: Close
[0m08:53:11.097974 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fbe9bbd6-c3b1-4d6a-8978-ac5ad969bac2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2882bce80>]}
[0m08:53:11.100662 [info ] [Thread-1  ]: 4 of 5 OK created sql table model dev.dim_listings_w_hosts ..................... [[32mSUCCESS 1[0m in 4.89s]
[0m08:53:11.107383 [debug] [Thread-1  ]: Finished running node model.dbtlearn.dim_listings_w_hosts
[0m08:53:11.880792 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 2 seconds
[0m08:53:11.887639 [debug] [Thread-4  ]: Timing info for model.dbtlearn.mart_fullmoon_reviews (execute): 2023-02-27 08:53:09.935059 => 2023-02-27 08:53:11.887491
[0m08:53:11.888294 [debug] [Thread-4  ]: On model.dbtlearn.mart_fullmoon_reviews: Close
[0m08:53:12.597860 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fbe9bbd6-c3b1-4d6a-8978-ac5ad969bac2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2881bdd60>]}
[0m08:53:12.598883 [info ] [Thread-4  ]: 5 of 5 OK created sql view model dev.mart_fullmoon_reviews ..................... [[32mSUCCESS 1[0m in 2.67s]
[0m08:53:12.599852 [debug] [Thread-4  ]: Finished running node model.dbtlearn.mart_fullmoon_reviews
[0m08:53:12.602724 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:53:12.603653 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:53:12.603983 [debug] [MainThread]: Connection 'model.dbtlearn.dim_listings_w_hosts' was properly closed.
[0m08:53:12.604272 [debug] [MainThread]: Connection 'model.dbtlearn.fct_reviews' was properly closed.
[0m08:53:12.604551 [debug] [MainThread]: Connection 'model.dbtlearn.dim_listings_cleansed' was properly closed.
[0m08:53:12.604819 [debug] [MainThread]: Connection 'model.dbtlearn.mart_fullmoon_reviews' was properly closed.
[0m08:53:12.605235 [info ] [MainThread]: 
[0m08:53:12.605789 [info ] [MainThread]: Finished running 3 view models, 1 incremental model, 1 table model in 0 hours 0 minutes and 16.61 seconds (16.61s).
[0m08:53:12.606777 [debug] [MainThread]: Command end result
[0m08:53:12.616807 [info ] [MainThread]: 
[0m08:53:12.617322 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:53:12.617736 [info ] [MainThread]: 
[0m08:53:12.618139 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m08:53:12.618642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2a9624cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2881c8700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2881abbe0>]}
[0m08:53:12.619032 [debug] [MainThread]: Flushing usage events


============================== 2023-02-27 08:57:27.743929 | a09512e8-b23e-47dd-af2b-7d3ff43a6642 ==============================
[0m08:57:27.743929 [info ] [MainThread]: Running with dbt=1.4.3
[0m08:57:27.746327 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/katiehuang/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['mart_fullmoon_reviews'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m08:57:27.746581 [debug] [MainThread]: Tracking: tracking
[0m08:57:27.747393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed411a59d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed411a5d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed411a5c40>]}
[0m08:57:27.760258 [debug] [MainThread]: checksum: c7a5cda64f02d8b9dd20ef412f82fbb79fdce1bb359c3c5dae3d080de7f31bfd, vars: {}, profile: None, target: None, version: 1.4.3
[0m08:57:27.802688 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m08:57:27.803210 [debug] [MainThread]: Partial parsing: added file: dbtlearn://models/sources.yml
[0m08:57:27.803553 [debug] [MainThread]: Partial parsing: updated file: dbtlearn://models/mart/mart_fullmoon_reviews.sql
[0m08:57:27.822284 [debug] [MainThread]: 1699: static parser successfully parsed mart/mart_fullmoon_reviews.sql
[0m08:57:27.852995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a09512e8-b23e-47dd-af2b-7d3ff43a6642', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed502d69d0>]}
[0m08:57:27.862827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a09512e8-b23e-47dd-af2b-7d3ff43a6642', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed50267490>]}
[0m08:57:27.863217 [info ] [MainThread]: Found 8 models, 0 tests, 0 snapshots, 0 analyses, 304 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics
[0m08:57:27.863577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a09512e8-b23e-47dd-af2b-7d3ff43a6642', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed502150a0>]}
[0m08:57:27.865112 [info ] [MainThread]: 
[0m08:57:27.866728 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:57:27.867870 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_airbnb'
[0m08:57:27.884331 [debug] [ThreadPool]: Using snowflake connection "list_airbnb"
[0m08:57:27.884678 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb"} */
show terse schemas in database airbnb
    limit 10000
[0m08:57:27.884924 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:57:30.475636 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 3 seconds
[0m08:57:30.481605 [debug] [ThreadPool]: On list_airbnb: Close
[0m08:57:31.154744 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_airbnb_dev'
[0m08:57:31.168277 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m08:57:31.168682 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m08:57:31.169022 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:57:33.350906 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 2 seconds
[0m08:57:33.356549 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m08:57:34.068088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a09512e8-b23e-47dd-af2b-7d3ff43a6642', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed50267c70>]}
[0m08:57:34.069318 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:57:34.069910 [info ] [MainThread]: 
[0m08:57:34.077978 [debug] [Thread-1  ]: Began running node model.dbtlearn.mart_fullmoon_reviews
[0m08:57:34.078568 [info ] [Thread-1  ]: 1 of 1 START sql table model dev.mart_fullmoon_reviews ......................... [RUN]
[0m08:57:34.079516 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtlearn.mart_fullmoon_reviews'
[0m08:57:34.079879 [debug] [Thread-1  ]: Began compiling node model.dbtlearn.mart_fullmoon_reviews
[0m08:57:34.084933 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearn.mart_fullmoon_reviews"
[0m08:57:34.086430 [debug] [Thread-1  ]: Timing info for model.dbtlearn.mart_fullmoon_reviews (compile): 2023-02-27 08:57:34.080131 => 2023-02-27 08:57:34.086341
[0m08:57:34.086743 [debug] [Thread-1  ]: Began executing node model.dbtlearn.mart_fullmoon_reviews
[0m08:57:34.111497 [debug] [Thread-1  ]: Dropping relation "AIRBNB"."DEV"."MART_FULLMOON_REVIEWS" because it is of type view
[0m08:57:34.118473 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.mart_fullmoon_reviews"
[0m08:57:34.118693 [debug] [Thread-1  ]: On model.dbtlearn.mart_fullmoon_reviews: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.mart_fullmoon_reviews"} */
drop view if exists "AIRBNB"."DEV"."MART_FULLMOON_REVIEWS" cascade
[0m08:57:34.118879 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m08:57:35.961628 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2 seconds
[0m08:57:35.991535 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtlearn.mart_fullmoon_reviews"
[0m08:57:35.993586 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.mart_fullmoon_reviews"
[0m08:57:35.993855 [debug] [Thread-1  ]: On model.dbtlearn.mart_fullmoon_reviews: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.mart_fullmoon_reviews"} */
create or replace transient table airbnb.dev.mart_fullmoon_reviews  as
        (

WITH fct_reviews AS (

    SELECT * FROM airbnb.dev.fct_reviews

),
full_moon_dates AS (

    SELECT * FROM airbnb.dev.seed_full_moon_dates
)

SELECT
    reviews.*,
    CASE
        WHEN fullmoon.full_moon_date IS NULL THEN 'not full moon'
        ELSE 'full moon' END AS is_full_moon
FROM fct_reviews AS reviews
LEFT JOIN full_moon_dates AS fullmoon
    ON (TO_DATE(reviews.review_date) = DATEADD(DAY, 1, fullmoon.full_moon_date))
        );
[0m08:57:39.850032 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 4 seconds
[0m08:57:39.886141 [debug] [Thread-1  ]: Timing info for model.dbtlearn.mart_fullmoon_reviews (execute): 2023-02-27 08:57:34.086941 => 2023-02-27 08:57:39.886063
[0m08:57:39.886500 [debug] [Thread-1  ]: On model.dbtlearn.mart_fullmoon_reviews: Close
[0m08:57:40.575335 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a09512e8-b23e-47dd-af2b-7d3ff43a6642', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed502d6a90>]}
[0m08:57:40.576605 [info ] [Thread-1  ]: 1 of 1 OK created sql table model dev.mart_fullmoon_reviews .................... [[32mSUCCESS 1[0m in 6.50s]
[0m08:57:40.579529 [debug] [Thread-1  ]: Finished running node model.dbtlearn.mart_fullmoon_reviews
[0m08:57:40.582942 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:57:40.583850 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:57:40.584184 [debug] [MainThread]: Connection 'model.dbtlearn.mart_fullmoon_reviews' was properly closed.
[0m08:57:40.584558 [info ] [MainThread]: 
[0m08:57:40.585119 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 12.72 seconds (12.72s).
[0m08:57:40.585803 [debug] [MainThread]: Command end result
[0m08:57:40.595405 [info ] [MainThread]: 
[0m08:57:40.595923 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:57:40.596331 [info ] [MainThread]: 
[0m08:57:40.596723 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m08:57:40.597213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed629c6eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed50215070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed412c93a0>]}
[0m08:57:40.597573 [debug] [MainThread]: Flushing usage events


============================== 2023-02-27 09:02:32.240727 | bbe0cbc9-5120-415d-b5bb-53f64f4e8886 ==============================
[0m09:02:32.240727 [info ] [MainThread]: Running with dbt=1.4.3
[0m09:02:32.243231 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/katiehuang/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m09:02:32.243538 [debug] [MainThread]: Tracking: tracking
[0m09:02:32.244403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77f9022880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77f9022c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77f9022af0>]}
[0m09:02:32.257015 [debug] [MainThread]: checksum: c7a5cda64f02d8b9dd20ef412f82fbb79fdce1bb359c3c5dae3d080de7f31bfd, vars: {}, profile: None, target: None, version: 1.4.3
[0m09:02:32.299921 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m09:02:32.300507 [debug] [MainThread]: Partial parsing: updated file: dbtlearn://models/src/src_listings.sql
[0m09:02:32.300822 [debug] [MainThread]: Partial parsing: updated file: dbtlearn://models/src/src_reviews.sql
[0m09:02:32.301100 [debug] [MainThread]: Partial parsing: updated file: dbtlearn://models/src/src_hosts.sql
[0m09:02:32.318246 [debug] [MainThread]: 1699: static parser successfully parsed src/src_listings.sql
[0m09:02:32.332833 [debug] [MainThread]: 1699: static parser successfully parsed src/src_reviews.sql
[0m09:02:32.335740 [debug] [MainThread]: 1699: static parser successfully parsed src/src_hosts.sql
[0m09:02:32.337791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77f906fac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77f90864c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77f9086430>]}
[0m09:02:32.338123 [debug] [MainThread]: Flushing usage events
[0m09:02:33.610667 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbtlearn.src_listings' (models/src/src_listings.sql) depends on a source named 'airbnb.listings' which was not found


============================== 2023-02-27 09:02:53.072285 | bd21fc64-d7b8-4458-8170-4e1f0284bcab ==============================
[0m09:02:53.072285 [info ] [MainThread]: Running with dbt=1.4.3
[0m09:02:53.074298 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/katiehuang/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['sources'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m09:02:53.074562 [debug] [MainThread]: Tracking: tracking
[0m09:02:53.075024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf534ed910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf534edcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf534edb80>]}
[0m09:02:53.087215 [debug] [MainThread]: checksum: c7a5cda64f02d8b9dd20ef412f82fbb79fdce1bb359c3c5dae3d080de7f31bfd, vars: {}, profile: None, target: None, version: 1.4.3
[0m09:02:53.121288 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m09:02:53.121820 [debug] [MainThread]: Partial parsing: updated file: dbtlearn://models/src/src_reviews.sql
[0m09:02:53.122133 [debug] [MainThread]: Partial parsing: updated file: dbtlearn://models/src/src_listings.sql
[0m09:02:53.122419 [debug] [MainThread]: Partial parsing: updated file: dbtlearn://models/src/src_hosts.sql
[0m09:02:53.138296 [debug] [MainThread]: 1699: static parser successfully parsed src/src_reviews.sql
[0m09:02:53.152273 [debug] [MainThread]: 1699: static parser successfully parsed src/src_listings.sql
[0m09:02:53.155168 [debug] [MainThread]: 1699: static parser successfully parsed src/src_hosts.sql
[0m09:02:53.157266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf5369fb20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf536b7520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf536b7490>]}
[0m09:02:53.157583 [debug] [MainThread]: Flushing usage events
[0m09:02:54.537819 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbtlearn.src_reviews' (models/src/src_reviews.sql) depends on a source named 'airbnb.reviews' which was not found


============================== 2023-02-27 09:04:26.536162 | a9e7414b-7457-4629-b3f0-bcdd8bd2a482 ==============================
[0m09:04:26.536162 [info ] [MainThread]: Running with dbt=1.4.3
[0m09:04:26.539144 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/katiehuang/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'parse_only': False, 'which': 'compile', 'rpc_method': 'compile', 'indirect_selection': 'eager'}
[0m09:04:26.539421 [debug] [MainThread]: Tracking: tracking
[0m09:04:26.540500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b093939d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b09393d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b09393c40>]}
[0m09:04:26.554860 [debug] [MainThread]: checksum: c7a5cda64f02d8b9dd20ef412f82fbb79fdce1bb359c3c5dae3d080de7f31bfd, vars: {}, profile: None, target: None, version: 1.4.3
[0m09:04:26.595448 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 4 files changed.
[0m09:04:26.596053 [debug] [MainThread]: Partial parsing: updated file: dbtlearn://models/sources.yml
[0m09:04:26.596415 [debug] [MainThread]: Partial parsing: updated file: dbtlearn://models/src/src_hosts.sql
[0m09:04:26.596706 [debug] [MainThread]: Partial parsing: updated file: dbtlearn://models/src/src_listings.sql
[0m09:04:26.596986 [debug] [MainThread]: Partial parsing: updated file: dbtlearn://models/src/src_reviews.sql
[0m09:04:26.614241 [debug] [MainThread]: 1699: static parser successfully parsed src/src_hosts.sql
[0m09:04:26.628630 [debug] [MainThread]: 1699: static parser successfully parsed src/src_listings.sql
[0m09:04:26.631578 [debug] [MainThread]: 1699: static parser successfully parsed src/src_reviews.sql
[0m09:04:26.661580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a9e7414b-7457-4629-b3f0-bcdd8bd2a482', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b093d4640>]}
[0m09:04:26.669694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a9e7414b-7457-4629-b3f0-bcdd8bd2a482', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b094a5130>]}
[0m09:04:26.670059 [info ] [MainThread]: Found 8 models, 0 tests, 0 snapshots, 0 analyses, 304 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
[0m09:04:26.670401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a9e7414b-7457-4629-b3f0-bcdd8bd2a482', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b094a50a0>]}
[0m09:04:26.672112 [info ] [MainThread]: 
[0m09:04:26.673630 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m09:04:26.674870 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_airbnb_dev'
[0m09:04:26.690999 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m09:04:26.691456 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m09:04:26.691792 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:04:32.472464 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 6 seconds
[0m09:04:32.477825 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m09:04:33.263200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a9e7414b-7457-4629-b3f0-bcdd8bd2a482', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b0938e130>]}
[0m09:04:33.264576 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:04:33.265155 [info ] [MainThread]: 
[0m09:04:33.273040 [debug] [Thread-1  ]: Began running node model.dbtlearn.src_hosts
[0m09:04:33.273549 [debug] [Thread-2  ]: Began running node model.dbtlearn.src_listings
[0m09:04:33.273916 [debug] [Thread-3  ]: Began running node model.dbtlearn.src_reviews
[0m09:04:33.275901 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtlearn.src_hosts'
[0m09:04:33.276286 [debug] [Thread-4  ]: Began running node seed.dbtlearn.seed_full_moon_dates
[0m09:04:33.277045 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtlearn.src_listings'
[0m09:04:33.277754 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtlearn.src_reviews'
[0m09:04:33.278098 [debug] [Thread-1  ]: Began compiling node model.dbtlearn.src_hosts
[0m09:04:33.278888 [debug] [Thread-4  ]: Acquiring new snowflake connection 'seed.dbtlearn.seed_full_moon_dates'
[0m09:04:33.279256 [debug] [Thread-2  ]: Began compiling node model.dbtlearn.src_listings
[0m09:04:33.279595 [debug] [Thread-3  ]: Began compiling node model.dbtlearn.src_reviews
[0m09:04:33.283967 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearn.src_hosts"
[0m09:04:33.284335 [debug] [Thread-4  ]: Began compiling node seed.dbtlearn.seed_full_moon_dates
[0m09:04:33.288001 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtlearn.src_listings"
[0m09:04:33.291743 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtlearn.src_reviews"
[0m09:04:33.293738 [debug] [Thread-4  ]: Timing info for seed.dbtlearn.seed_full_moon_dates (compile): 2023-02-27 09:04:33.292110 => 2023-02-27 09:04:33.293658
[0m09:04:33.294276 [debug] [Thread-4  ]: Began executing node seed.dbtlearn.seed_full_moon_dates
[0m09:04:33.294650 [debug] [Thread-4  ]: Timing info for seed.dbtlearn.seed_full_moon_dates (execute): 2023-02-27 09:04:33.294584 => 2023-02-27 09:04:33.294603
[0m09:04:33.294893 [debug] [Thread-3  ]: Timing info for model.dbtlearn.src_reviews (compile): 2023-02-27 09:04:33.288397 => 2023-02-27 09:04:33.294836
[0m09:04:33.296791 [debug] [Thread-4  ]: Finished running node seed.dbtlearn.seed_full_moon_dates
[0m09:04:33.297068 [debug] [Thread-2  ]: Timing info for model.dbtlearn.src_listings (compile): 2023-02-27 09:04:33.284548 => 2023-02-27 09:04:33.297020
[0m09:04:33.297682 [debug] [Thread-3  ]: Finished running node model.dbtlearn.src_reviews
[0m09:04:33.297887 [debug] [Thread-1  ]: Timing info for model.dbtlearn.src_hosts (compile): 2023-02-27 09:04:33.279890 => 2023-02-27 09:04:33.297843
[0m09:04:33.298662 [debug] [Thread-2  ]: Finished running node model.dbtlearn.src_listings
[0m09:04:33.299419 [debug] [Thread-1  ]: Finished running node model.dbtlearn.src_hosts
[0m09:04:33.299829 [debug] [Thread-2  ]: Began running node model.dbtlearn.fct_reviews
[0m09:04:33.300369 [debug] [Thread-3  ]: Began running node model.dbtlearn.dim_listings_cleansed
[0m09:04:33.300930 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtlearn.fct_reviews'
[0m09:04:33.301214 [debug] [Thread-1  ]: Began running node model.dbtlearn.dim_hosts_cleansed
[0m09:04:33.301756 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtlearn.dim_listings_cleansed'
[0m09:04:33.302011 [debug] [Thread-2  ]: Began compiling node model.dbtlearn.fct_reviews
[0m09:04:33.302538 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtlearn.dim_hosts_cleansed'
[0m09:04:33.302755 [debug] [Thread-3  ]: Began compiling node model.dbtlearn.dim_listings_cleansed
[0m09:04:33.315523 [debug] [Thread-1  ]: Began compiling node model.dbtlearn.dim_hosts_cleansed
[0m09:04:33.318214 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtlearn.fct_reviews"
[0m09:04:33.327363 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtlearn.dim_listings_cleansed"
[0m09:04:33.333249 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearn.dim_hosts_cleansed"
[0m09:04:33.334066 [debug] [Thread-1  ]: Timing info for model.dbtlearn.dim_hosts_cleansed (compile): 2023-02-27 09:04:33.327522 => 2023-02-27 09:04:33.334006
[0m09:04:33.334291 [debug] [Thread-3  ]: Timing info for model.dbtlearn.dim_listings_cleansed (compile): 2023-02-27 09:04:33.318411 => 2023-02-27 09:04:33.334245
[0m09:04:33.334467 [debug] [Thread-2  ]: Timing info for model.dbtlearn.fct_reviews (compile): 2023-02-27 09:04:33.302920 => 2023-02-27 09:04:33.334433
[0m09:04:33.334663 [debug] [Thread-1  ]: Began executing node model.dbtlearn.dim_hosts_cleansed
[0m09:04:33.334880 [debug] [Thread-3  ]: Began executing node model.dbtlearn.dim_listings_cleansed
[0m09:04:33.335087 [debug] [Thread-2  ]: Began executing node model.dbtlearn.fct_reviews
[0m09:04:33.335283 [debug] [Thread-1  ]: Timing info for model.dbtlearn.dim_hosts_cleansed (execute): 2023-02-27 09:04:33.335239 => 2023-02-27 09:04:33.335248
[0m09:04:33.335470 [debug] [Thread-3  ]: Timing info for model.dbtlearn.dim_listings_cleansed (execute): 2023-02-27 09:04:33.335434 => 2023-02-27 09:04:33.335440
[0m09:04:33.335651 [debug] [Thread-2  ]: Timing info for model.dbtlearn.fct_reviews (execute): 2023-02-27 09:04:33.335616 => 2023-02-27 09:04:33.335621
[0m09:04:33.336273 [debug] [Thread-1  ]: Finished running node model.dbtlearn.dim_hosts_cleansed
[0m09:04:33.337025 [debug] [Thread-3  ]: Finished running node model.dbtlearn.dim_listings_cleansed
[0m09:04:33.337570 [debug] [Thread-2  ]: Finished running node model.dbtlearn.fct_reviews
[0m09:04:33.338327 [debug] [Thread-4  ]: Began running node model.dbtlearn.dim_listings_w_hosts
[0m09:04:33.338823 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.dbtlearn.dim_listings_w_hosts'
[0m09:04:33.339115 [debug] [Thread-1  ]: Began running node model.dbtlearn.mart_fullmoon_reviews
[0m09:04:33.339318 [debug] [Thread-4  ]: Began compiling node model.dbtlearn.dim_listings_w_hosts
[0m09:04:33.339820 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtlearn.mart_fullmoon_reviews'
[0m09:04:33.342694 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtlearn.dim_listings_w_hosts"
[0m09:04:33.342940 [debug] [Thread-1  ]: Began compiling node model.dbtlearn.mart_fullmoon_reviews
[0m09:04:33.347067 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearn.mart_fullmoon_reviews"
[0m09:04:33.347416 [debug] [Thread-4  ]: Timing info for model.dbtlearn.dim_listings_w_hosts (compile): 2023-02-27 09:04:33.339987 => 2023-02-27 09:04:33.347370
[0m09:04:33.347664 [debug] [Thread-4  ]: Began executing node model.dbtlearn.dim_listings_w_hosts
[0m09:04:33.347860 [debug] [Thread-4  ]: Timing info for model.dbtlearn.dim_listings_w_hosts (execute): 2023-02-27 09:04:33.347819 => 2023-02-27 09:04:33.347827
[0m09:04:33.348040 [debug] [Thread-1  ]: Timing info for model.dbtlearn.mart_fullmoon_reviews (compile): 2023-02-27 09:04:33.343166 => 2023-02-27 09:04:33.347993
[0m09:04:33.348604 [debug] [Thread-4  ]: Finished running node model.dbtlearn.dim_listings_w_hosts
[0m09:04:33.348827 [debug] [Thread-1  ]: Began executing node model.dbtlearn.mart_fullmoon_reviews
[0m09:04:33.349147 [debug] [Thread-1  ]: Timing info for model.dbtlearn.mart_fullmoon_reviews (execute): 2023-02-27 09:04:33.349098 => 2023-02-27 09:04:33.349106
[0m09:04:33.349712 [debug] [Thread-1  ]: Finished running node model.dbtlearn.mart_fullmoon_reviews
[0m09:04:33.350412 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:04:33.350599 [debug] [MainThread]: Connection 'model.dbtlearn.mart_fullmoon_reviews' was properly closed.
[0m09:04:33.350755 [debug] [MainThread]: Connection 'model.dbtlearn.fct_reviews' was properly closed.
[0m09:04:33.350903 [debug] [MainThread]: Connection 'model.dbtlearn.dim_listings_cleansed' was properly closed.
[0m09:04:33.351048 [debug] [MainThread]: Connection 'model.dbtlearn.dim_listings_w_hosts' was properly closed.
[0m09:04:33.351497 [debug] [MainThread]: Command end result
[0m09:04:33.357511 [info ] [MainThread]: Done.
[0m09:04:33.357903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b095a5040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b094e6730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b1a93dd00>]}
[0m09:04:33.358171 [debug] [MainThread]: Flushing usage events


============================== 2023-02-27 09:04:54.110919 | a9fbeb45-484c-4f29-a5d2-acb070a96f91 ==============================
[0m09:04:54.110919 [info ] [MainThread]: Running with dbt=1.4.3
[0m09:04:54.113260 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/katiehuang/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m09:04:54.113535 [debug] [MainThread]: Tracking: tracking
[0m09:04:54.114030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbb97fb910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbb97fbcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbb97fbb80>]}
[0m09:04:54.126540 [debug] [MainThread]: checksum: c7a5cda64f02d8b9dd20ef412f82fbb79fdce1bb359c3c5dae3d080de7f31bfd, vars: {}, profile: None, target: None, version: 1.4.3
[0m09:04:54.166292 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:04:54.166605 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:04:54.174513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a9fbeb45-484c-4f29-a5d2-acb070a96f91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbb99807f0>]}
[0m09:04:54.181910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a9fbeb45-484c-4f29-a5d2-acb070a96f91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbb989ca60>]}
[0m09:04:54.182286 [info ] [MainThread]: Found 8 models, 0 tests, 0 snapshots, 0 analyses, 304 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
[0m09:04:54.182630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a9fbeb45-484c-4f29-a5d2-acb070a96f91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbb989cdc0>]}
[0m09:04:54.184499 [info ] [MainThread]: 
[0m09:04:54.186097 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m09:04:54.187360 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_airbnb'
[0m09:04:54.204343 [debug] [ThreadPool]: Using snowflake connection "list_airbnb"
[0m09:04:54.204665 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb"} */
show terse schemas in database airbnb
    limit 10000
[0m09:04:54.204905 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:04:56.620056 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2 seconds
[0m09:04:56.625341 [debug] [ThreadPool]: On list_airbnb: Close
[0m09:04:58.024354 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_airbnb_dev'
[0m09:04:58.086117 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m09:04:58.086434 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m09:04:58.086648 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:05:00.254279 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 2 seconds
[0m09:05:00.259474 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m09:05:00.897383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a9fbeb45-484c-4f29-a5d2-acb070a96f91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbb989c9d0>]}
[0m09:05:00.898615 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:05:00.899195 [info ] [MainThread]: 
[0m09:05:00.907439 [debug] [Thread-1  ]: Began running node model.dbtlearn.src_hosts
[0m09:05:00.907948 [debug] [Thread-2  ]: Began running node model.dbtlearn.src_listings
[0m09:05:00.908718 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtlearn.src_hosts'
[0m09:05:00.909087 [debug] [Thread-3  ]: Began running node model.dbtlearn.src_reviews
[0m09:05:00.909837 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtlearn.src_listings'
[0m09:05:00.910228 [debug] [Thread-1  ]: Began compiling node model.dbtlearn.src_hosts
[0m09:05:00.910943 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtlearn.src_reviews'
[0m09:05:00.911267 [debug] [Thread-2  ]: Began compiling node model.dbtlearn.src_listings
[0m09:05:00.915689 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearn.src_hosts"
[0m09:05:00.916085 [debug] [Thread-3  ]: Began compiling node model.dbtlearn.src_reviews
[0m09:05:00.919452 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtlearn.src_listings"
[0m09:05:00.923436 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtlearn.src_reviews"
[0m09:05:00.924147 [debug] [Thread-1  ]: Timing info for model.dbtlearn.src_hosts (compile): 2023-02-27 09:05:00.911530 => 2023-02-27 09:05:00.924032
[0m09:05:00.926434 [debug] [Thread-1  ]: Finished running node model.dbtlearn.src_hosts
[0m09:05:00.926941 [debug] [Thread-3  ]: Timing info for model.dbtlearn.src_reviews (compile): 2023-02-27 09:05:00.919863 => 2023-02-27 09:05:00.926868
[0m09:05:00.927289 [debug] [Thread-2  ]: Timing info for model.dbtlearn.src_listings (compile): 2023-02-27 09:05:00.916328 => 2023-02-27 09:05:00.927238
[0m09:05:00.927994 [debug] [Thread-3  ]: Finished running node model.dbtlearn.src_reviews
[0m09:05:00.928330 [debug] [Thread-4  ]: Began running node model.dbtlearn.dim_hosts_cleansed
[0m09:05:00.929016 [debug] [Thread-2  ]: Finished running node model.dbtlearn.src_listings
[0m09:05:00.929500 [info ] [Thread-4  ]: 1 of 5 START sql view model dev.dim_hosts_cleansed ............................. [RUN]
[0m09:05:00.930114 [debug] [Thread-1  ]: Began running node model.dbtlearn.fct_reviews
[0m09:05:00.930700 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.dbtlearn.dim_hosts_cleansed'
[0m09:05:00.930988 [debug] [Thread-2  ]: Began running node model.dbtlearn.dim_listings_cleansed
[0m09:05:00.931324 [info ] [Thread-1  ]: 2 of 5 START sql incremental model dev.fct_reviews ............................. [RUN]
[0m09:05:00.931742 [debug] [Thread-4  ]: Began compiling node model.dbtlearn.dim_hosts_cleansed
[0m09:05:00.932064 [info ] [Thread-2  ]: 3 of 5 START sql view model dev.dim_listings_cleansed .......................... [RUN]
[0m09:05:00.932721 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtlearn.fct_reviews'
[0m09:05:00.947330 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtlearn.dim_hosts_cleansed"
[0m09:05:00.947894 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtlearn.dim_listings_cleansed'
[0m09:05:00.948147 [debug] [Thread-1  ]: Began compiling node model.dbtlearn.fct_reviews
[0m09:05:00.948454 [debug] [Thread-2  ]: Began compiling node model.dbtlearn.dim_listings_cleansed
[0m09:05:00.961004 [debug] [Thread-4  ]: Timing info for model.dbtlearn.dim_hosts_cleansed (compile): 2023-02-27 09:05:00.932906 => 2023-02-27 09:05:00.960937
[0m09:05:00.964721 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearn.fct_reviews"
[0m09:05:00.971310 [debug] [Thread-4  ]: Began executing node model.dbtlearn.dim_hosts_cleansed
[0m09:05:00.974172 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtlearn.dim_listings_cleansed"
[0m09:05:01.006937 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbtlearn.dim_hosts_cleansed"
[0m09:05:01.007220 [debug] [Thread-1  ]: Timing info for model.dbtlearn.fct_reviews (compile): 2023-02-27 09:05:00.948679 => 2023-02-27 09:05:01.007170
[0m09:05:01.007563 [debug] [Thread-1  ]: Began executing node model.dbtlearn.fct_reviews
[0m09:05:01.007780 [debug] [Thread-2  ]: Timing info for model.dbtlearn.dim_listings_cleansed (compile): 2023-02-27 09:05:00.964917 => 2023-02-27 09:05:01.007741
[0m09:05:01.020159 [debug] [Thread-2  ]: Began executing node model.dbtlearn.dim_listings_cleansed
[0m09:05:01.030063 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearn.dim_hosts_cleansed"
[0m09:05:01.033097 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbtlearn.dim_listings_cleansed"
[0m09:05:01.049118 [debug] [Thread-4  ]: On model.dbtlearn.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_hosts_cleansed"} */
create or replace   view airbnb.dev.dim_hosts_cleansed
  
   as (
    

WITH  __dbt__cte__src_hosts as (
WITH raw_hosts AS (
	SELECT * FROM airbnb.raw.raw_hosts
)

SELECT
    id AS host_id,
    name AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM raw_hosts
),src_hosts AS (
    SELECT * FROM __dbt__cte__src_hosts
)

SELECT 
    host_id,
    NVL(host_name, 'Anonymous') AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM src_hosts
  );
[0m09:05:01.053055 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m09:05:01.053397 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m09:05:01.053614 [debug] [Thread-1  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
create or replace  temporary view airbnb.dev.fct_reviews__dbt_tmp
  
   as (
    -- Doc | Config : https://docs.getdbt.com/reference/dbt-jinja-functions/config


-- dbt materializes the model as an incremental table. 
-- Read for difference btw table vs. incremental: https://docs.getdbt.com/docs/build/materializations

WITH  __dbt__cte__src_reviews as (
WITH raw_reviews AS (
	SELECT * FROM airbnb.raw.raw_reviews
)

SELECT
    listing_id,
    date AS review_date,
    reviewer_name,
    comments AS review_text,
    sentiment AS review_sentiment
FROM raw_reviews
),src_reviews AS (
    SELECT * FROM __dbt__cte__src_reviews
)

SELECT 
    listing_id,
    review_date,
    NVL(reviewer_name, 'Anonymous') AS reviewer_name,
    review_text,
    review_sentiment
FROM src_reviews
WHERE review_text IS NOT NULL


  and review_date > (select max(review_date) from airbnb.dev.fct_reviews)

  );
[0m09:05:01.054545 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m09:05:01.055980 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearn.dim_listings_cleansed"
[0m09:05:01.057283 [debug] [Thread-2  ]: On model.dbtlearn.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_cleansed"} */
create or replace   view airbnb.dev.dim_listings_cleansed
  
   as (
    


WITH  __dbt__cte__src_listings as (
WITH raw_listings AS (
	SELECT * FROM airbnb.raw.raw_listings
)

SELECT 
	id AS listing_id,
    name AS listing_name,
    listing_url,
    room_type,
    minimum_nights,
    host_id,
    price AS price_str,
    created_at,
    updated_at
FROM 
	raw_listings
),src_listings AS (
    SELECT * FROM __dbt__cte__src_listings
)

SELECT
    listing_id,
    listing_name,
    room_type,
    CASE 
        WHEN minimum_nights = 0 THEN 1 -- 0 night = 1 night, so we assign the value of 1 to indicate 1 night
        ELSE minimum_nights
    END AS minimum_nights,
    host_id,
    REPLACE( -- Parse string value into numerical form
        price_str, '$' -- Replace '$' with price_str value. In other words, to remove '$' from string.
        ) :: NUMBER (10, 2 -- Convert string type to numerical with 2 decimal places
    ) AS price,
    created_at,
    updated_at
    
FROM src_listings
  );
[0m09:05:01.057506 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m09:05:03.190739 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 2 seconds
[0m09:05:03.227310 [debug] [Thread-2  ]: Timing info for model.dbtlearn.dim_listings_cleansed (execute): 2023-02-27 09:05:01.030233 => 2023-02-27 09:05:03.227227
[0m09:05:03.227775 [debug] [Thread-2  ]: On model.dbtlearn.dim_listings_cleansed: Close
[0m09:05:03.245505 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 2 seconds
[0m09:05:03.248270 [debug] [Thread-4  ]: Timing info for model.dbtlearn.dim_hosts_cleansed (execute): 2023-02-27 09:05:00.974430 => 2023-02-27 09:05:03.248206
[0m09:05:03.249148 [debug] [Thread-4  ]: On model.dbtlearn.dim_hosts_cleansed: Close
[0m09:05:03.826779 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 3 seconds
[0m09:05:03.846230 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m09:05:03.846710 [debug] [Thread-1  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
describe table airbnb.dev.fct_reviews__dbt_tmp
[0m09:05:03.907749 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9fbeb45-484c-4f29-a5d2-acb070a96f91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbb9abf610>]}
[0m09:05:03.908987 [info ] [Thread-4  ]: 1 of 5 OK created sql view model dev.dim_hosts_cleansed ........................ [[32mSUCCESS 1[0m in 2.98s]
[0m09:05:03.909834 [debug] [Thread-4  ]: Finished running node model.dbtlearn.dim_hosts_cleansed
[0m09:05:03.927866 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9fbeb45-484c-4f29-a5d2-acb070a96f91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbb9ae8040>]}
[0m09:05:03.928682 [info ] [Thread-2  ]: 3 of 5 OK created sql view model dev.dim_listings_cleansed ..................... [[32mSUCCESS 1[0m in 2.98s]
[0m09:05:03.929367 [debug] [Thread-2  ]: Finished running node model.dbtlearn.dim_listings_cleansed
[0m09:05:03.930389 [debug] [Thread-3  ]: Began running node model.dbtlearn.dim_listings_w_hosts
[0m09:05:03.930920 [info ] [Thread-3  ]: 4 of 5 START sql table model dev.dim_listings_w_hosts .......................... [RUN]
[0m09:05:03.932017 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtlearn.dim_listings_w_hosts'
[0m09:05:03.932433 [debug] [Thread-3  ]: Began compiling node model.dbtlearn.dim_listings_w_hosts
[0m09:05:03.938210 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtlearn.dim_listings_w_hosts"
[0m09:05:03.939118 [debug] [Thread-3  ]: Timing info for model.dbtlearn.dim_listings_w_hosts (compile): 2023-02-27 09:05:03.932736 => 2023-02-27 09:05:03.939031
[0m09:05:03.939474 [debug] [Thread-3  ]: Began executing node model.dbtlearn.dim_listings_w_hosts
[0m09:05:03.970551 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbtlearn.dim_listings_w_hosts"
[0m09:05:03.972328 [debug] [Thread-3  ]: Using snowflake connection "model.dbtlearn.dim_listings_w_hosts"
[0m09:05:03.972525 [debug] [Thread-3  ]: On model.dbtlearn.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_w_hosts"} */
create or replace transient table airbnb.dev.dim_listings_w_hosts  as
        (WITH 
listings AS (
    SELECT * FROM airbnb.dev.dim_listings_cleansed
),
hosts AS (
    SELECT * FROM airbnb.dev.dim_hosts_cleansed
)

SELECT 
    listings.listing_id,
    listings.listing_name,
    listings.room_type,
    listings.minimum_nights,
    listings.price,
    listings.host_id,
    hosts.host_name,
    hosts.is_superhost AS host_is_superhost,
    listings.created_at,
    GREATEST(listings.updated_at, hosts.updated_at) AS updated_at -- Keep most recent updated_at
FROM listings
LEFT JOIN hosts
    ON listings.host_id = hosts.host_id
        );
[0m09:05:03.972710 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m09:05:04.321986 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0 seconds
[0m09:05:04.325929 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m09:05:04.326149 [debug] [Thread-1  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
describe table airbnb.dev.fct_reviews
[0m09:05:04.751302 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0 seconds
[0m09:05:04.781341 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m09:05:04.781718 [debug] [Thread-1  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
describe table airbnb.dev.fct_reviews__dbt_tmp
[0m09:05:05.188377 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0 seconds
[0m09:05:05.194365 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m09:05:05.194687 [debug] [Thread-1  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
describe table "AIRBNB"."DEV"."FCT_REVIEWS"
[0m09:05:05.582601 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0 seconds
[0m09:05:05.603947 [debug] [Thread-1  ]: 
    In "AIRBNB"."DEV"."FCT_REVIEWS":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m09:05:05.626957 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtlearn.fct_reviews"
[0m09:05:05.628109 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m09:05:05.628339 [debug] [Thread-1  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
-- back compat for old kwarg name
  
  begin;
[0m09:05:06.014923 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m09:05:06.016308 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m09:05:06.017003 [debug] [Thread-1  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
insert into airbnb.dev.fct_reviews ("LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT")
        (
            select "LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT"
            from airbnb.dev.fct_reviews__dbt_tmp
        );
[0m09:05:06.839087 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 3 seconds
[0m09:05:06.856274 [debug] [Thread-3  ]: Timing info for model.dbtlearn.dim_listings_w_hosts (execute): 2023-02-27 09:05:03.939707 => 2023-02-27 09:05:06.856158
[0m09:05:06.856803 [debug] [Thread-3  ]: On model.dbtlearn.dim_listings_w_hosts: Close
[0m09:05:07.544048 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9fbeb45-484c-4f29-a5d2-acb070a96f91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbaa5d5d90>]}
[0m09:05:07.545085 [info ] [Thread-3  ]: 4 of 5 OK created sql table model dev.dim_listings_w_hosts ..................... [[32mSUCCESS 1[0m in 3.61s]
[0m09:05:07.545888 [debug] [Thread-3  ]: Finished running node model.dbtlearn.dim_listings_w_hosts
[0m09:05:08.273983 [debug] [Thread-1  ]: SQL status: SUCCESS 0 in 2 seconds
[0m09:05:08.275316 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m09:05:08.275764 [debug] [Thread-1  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
COMMIT
[0m09:05:08.753324 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m09:05:08.770039 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m09:05:08.770464 [debug] [Thread-1  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
drop view if exists airbnb.dev.fct_reviews__dbt_tmp cascade
[0m09:05:09.188121 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m09:05:09.195023 [debug] [Thread-1  ]: Timing info for model.dbtlearn.fct_reviews (execute): 2023-02-27 09:05:01.007928 => 2023-02-27 09:05:09.194906
[0m09:05:09.195514 [debug] [Thread-1  ]: On model.dbtlearn.fct_reviews: Close
[0m09:05:10.065499 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9fbeb45-484c-4f29-a5d2-acb070a96f91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbb9a7d970>]}
[0m09:05:10.067011 [info ] [Thread-1  ]: 2 of 5 OK created sql incremental model dev.fct_reviews ........................ [[32mSUCCESS 0[0m in 9.13s]
[0m09:05:10.068029 [debug] [Thread-1  ]: Finished running node model.dbtlearn.fct_reviews
[0m09:05:10.069511 [debug] [Thread-2  ]: Began running node model.dbtlearn.mart_fullmoon_reviews
[0m09:05:10.070273 [info ] [Thread-2  ]: 5 of 5 START sql table model dev.mart_fullmoon_reviews ......................... [RUN]
[0m09:05:10.071437 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtlearn.mart_fullmoon_reviews'
[0m09:05:10.071851 [debug] [Thread-2  ]: Began compiling node model.dbtlearn.mart_fullmoon_reviews
[0m09:05:10.078200 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtlearn.mart_fullmoon_reviews"
[0m09:05:10.079111 [debug] [Thread-2  ]: Timing info for model.dbtlearn.mart_fullmoon_reviews (compile): 2023-02-27 09:05:10.072140 => 2023-02-27 09:05:10.079030
[0m09:05:10.079468 [debug] [Thread-2  ]: Began executing node model.dbtlearn.mart_fullmoon_reviews
[0m09:05:10.083486 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbtlearn.mart_fullmoon_reviews"
[0m09:05:10.085494 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearn.mart_fullmoon_reviews"
[0m09:05:10.085794 [debug] [Thread-2  ]: On model.dbtlearn.mart_fullmoon_reviews: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.mart_fullmoon_reviews"} */
create or replace transient table airbnb.dev.mart_fullmoon_reviews  as
        (

WITH fct_reviews AS (

    SELECT * FROM airbnb.dev.fct_reviews

),
full_moon_dates AS (

    SELECT * FROM airbnb.dev.seed_full_moon_dates
)

SELECT
    reviews.*,
    CASE
        WHEN fullmoon.full_moon_date IS NULL THEN 'not full moon'
        ELSE 'full moon' END AS is_full_moon
FROM fct_reviews AS reviews
LEFT JOIN full_moon_dates AS fullmoon
    ON (TO_DATE(reviews.review_date) = DATEADD(DAY, 1, fullmoon.full_moon_date))
        );
[0m09:05:10.086065 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m09:05:15.100924 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 5 seconds
[0m09:05:15.108281 [debug] [Thread-2  ]: Timing info for model.dbtlearn.mart_fullmoon_reviews (execute): 2023-02-27 09:05:10.079698 => 2023-02-27 09:05:15.108145
[0m09:05:15.108904 [debug] [Thread-2  ]: On model.dbtlearn.mart_fullmoon_reviews: Close
[0m09:05:15.714193 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9fbeb45-484c-4f29-a5d2-acb070a96f91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbaa4a66d0>]}
[0m09:05:15.715570 [info ] [Thread-2  ]: 5 of 5 OK created sql table model dev.mart_fullmoon_reviews .................... [[32mSUCCESS 1[0m in 5.64s]
[0m09:05:15.716553 [debug] [Thread-2  ]: Finished running node model.dbtlearn.mart_fullmoon_reviews
[0m09:05:15.719500 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m09:05:15.720542 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:05:15.720890 [debug] [MainThread]: Connection 'model.dbtlearn.fct_reviews' was properly closed.
[0m09:05:15.721206 [debug] [MainThread]: Connection 'model.dbtlearn.mart_fullmoon_reviews' was properly closed.
[0m09:05:15.721495 [debug] [MainThread]: Connection 'model.dbtlearn.dim_listings_w_hosts' was properly closed.
[0m09:05:15.721774 [debug] [MainThread]: Connection 'model.dbtlearn.dim_hosts_cleansed' was properly closed.
[0m09:05:15.722197 [info ] [MainThread]: 
[0m09:05:15.722731 [info ] [MainThread]: Finished running 2 view models, 2 table models, 1 incremental model in 0 hours 0 minutes and 21.54 seconds (21.54s).
[0m09:05:15.723690 [debug] [MainThread]: Command end result
[0m09:05:15.734086 [info ] [MainThread]: 
[0m09:05:15.734612 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:05:15.735031 [info ] [MainThread]: 
[0m09:05:15.735438 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m09:05:15.735945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbaa31bbb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbb9980970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbb93649d0>]}
[0m09:05:15.736355 [debug] [MainThread]: Flushing usage events


============================== 2023-02-27 09:07:57.352684 | 7ca2cbc9-0f34-47e9-bbc5-411d4ea2403a ==============================
[0m09:07:57.352684 [info ] [MainThread]: Running with dbt=1.4.3
[0m09:07:57.355147 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/katiehuang/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'source-freshness', 'rpc_method': 'source-freshness', 'indirect_selection': 'eager'}
[0m09:07:57.355444 [debug] [MainThread]: Tracking: tracking
[0m09:07:57.355912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5792ea9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5792ead90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5792eac40>]}
[0m09:07:57.368587 [debug] [MainThread]: checksum: c7a5cda64f02d8b9dd20ef412f82fbb79fdce1bb359c3c5dae3d080de7f31bfd, vars: {}, profile: None, target: None, version: 1.4.3
[0m09:07:57.409033 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:07:57.410142 [debug] [MainThread]: Partial parsing: updated file: dbtlearn://models/sources.yml
[0m09:07:57.428698 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_w_hosts.sql
[0m09:07:57.443445 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_cleansed.sql
[0m09:07:57.446574 [debug] [MainThread]: 1699: static parser successfully parsed src/src_listings.sql
[0m09:07:57.449703 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_hosts_cleansed.sql
[0m09:07:57.452568 [debug] [MainThread]: 1699: static parser successfully parsed src/src_hosts.sql
[0m09:07:57.456384 [debug] [MainThread]: 1699: static parser successfully parsed mart/mart_fullmoon_reviews.sql
[0m09:07:57.459343 [debug] [MainThread]: 1603: static parser failed on fct/fct_reviews.sql
[0m09:07:57.468490 [debug] [MainThread]: 1602: parser fallback to jinja rendering on fct/fct_reviews.sql
[0m09:07:57.469831 [debug] [MainThread]: 1699: static parser successfully parsed src/src_reviews.sql
[0m09:07:57.500884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7ca2cbc9-0f34-47e9-bbc5-411d4ea2403a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5680d0d90>]}
[0m09:07:57.509046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7ca2cbc9-0f34-47e9-bbc5-411d4ea2403a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe568078d30>]}
[0m09:07:57.509440 [info ] [MainThread]: Found 8 models, 0 tests, 0 snapshots, 0 analyses, 304 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
[0m09:07:57.509774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7ca2cbc9-0f34-47e9-bbc5-411d4ea2403a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe57946f400>]}
[0m09:07:57.511346 [info ] [MainThread]: 
[0m09:07:57.512890 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m09:07:57.514069 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_airbnb_dev'
[0m09:07:57.529497 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m09:07:57.529857 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m09:07:57.530108 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:08:00.793520 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 3 seconds
[0m09:08:00.798405 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m09:08:02.768697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7ca2cbc9-0f34-47e9-bbc5-411d4ea2403a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5680780d0>]}
[0m09:08:02.769924 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:08:02.770502 [info ] [MainThread]: 
[0m09:08:02.778443 [debug] [Thread-1  ]: Began running node source.dbtlearn.airbnb.reviews
[0m09:08:02.778889 [info ] [Thread-1  ]: 1 of 1 START freshness of airbnb.reviews ....................................... [RUN]
[0m09:08:02.779835 [debug] [Thread-1  ]: Acquiring new snowflake connection 'source.dbtlearn.airbnb.reviews'
[0m09:08:02.780180 [debug] [Thread-1  ]: Began compiling node source.dbtlearn.airbnb.reviews
[0m09:08:02.780531 [debug] [Thread-1  ]: Timing info for source.dbtlearn.airbnb.reviews (compile): 2023-02-27 09:08:02.780437 => 2023-02-27 09:08:02.780445
[0m09:08:02.780864 [debug] [Thread-1  ]: Began executing node source.dbtlearn.airbnb.reviews
[0m09:08:02.781683 [debug] [Thread-1  ]: Acquiring new snowflake connection 'source.dbtlearn.airbnb.reviews'
[0m09:08:02.795757 [debug] [Thread-1  ]: Using snowflake connection "source.dbtlearn.airbnb.reviews"
[0m09:08:02.796102 [debug] [Thread-1  ]: On source.dbtlearn.airbnb.reviews: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "source.dbtlearn.airbnb.reviews"} */
select
      max(date) as max_loaded_at,
      convert_timezone('UTC', current_timestamp()) as snapshotted_at
    from airbnb.raw.raw_reviews
[0m09:08:02.796353 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m09:08:05.166966 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2 seconds
[0m09:08:05.184308 [debug] [Thread-1  ]: On source.dbtlearn.airbnb.reviews: Close
[0m09:08:06.450858 [debug] [Thread-1  ]: Timing info for source.dbtlearn.airbnb.reviews (execute): 2023-02-27 09:08:02.781093 => 2023-02-27 09:08:06.450707
[0m09:08:06.452419 [error] [Thread-1  ]: 1 of 1 ERROR STALE freshness of airbnb.reviews ................................. [[31mERROR STALE[0m in 3.67s]
[0m09:08:06.455303 [debug] [Thread-1  ]: Finished running node source.dbtlearn.airbnb.reviews
[0m09:08:06.457857 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:08:06.458235 [debug] [MainThread]: Connection 'source.dbtlearn.airbnb.reviews' was properly closed.
[0m09:08:06.468465 [info ] [MainThread]: 
[0m09:08:06.468959 [info ] [MainThread]: Done.
[0m09:08:06.469452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe579400850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe579523c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe579523670>]}
[0m09:08:06.469840 [debug] [MainThread]: Flushing usage events


============================== 2023-02-28 04:17:54.234525 | 9cee8666-beaf-445c-8ccf-3b73406ec8b1 ==============================
[0m04:17:54.234525 [info ] [MainThread]: Running with dbt=1.5.0-a1
[0m04:17:54.235994 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/katiehuang/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'skip_profile_setup': False, 'which': 'init', 'indirect_selection': 'eager'}
[0m04:17:54.236278 [debug] [MainThread]: Tracking: tracking
[0m04:17:54.279173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c7a306eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c7a2cb880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c7a2eadf0>]}
[0m04:17:54.280564 [info ] [MainThread]: Setting up your profile.
[0m04:17:58.174614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c68a82be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c7a2ea310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c7a2eaca0>]}
[0m04:17:58.175810 [debug] [MainThread]: Flushing usage events


============================== 2023-02-28 04:38:09.421377 | 96974eae-b543-4b8a-9b72-bbfae4242bdc ==============================
[0m04:38:09.421377 [info ] [MainThread]: Running with dbt=1.4.3
[0m04:38:09.423271 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/katiehuang/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_name': 'dbtlearn', 'skip_profile_setup': False, 'which': 'init', 'indirect_selection': 'eager'}
[0m04:38:09.423543 [debug] [MainThread]: Tracking: tracking
[0m04:38:09.455952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8e008e370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8e0088610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8e0088ac0>]}
[0m04:38:09.457397 [info ] [MainThread]: Setting up your profile.
[0m04:38:13.843603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc912471f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8e00691f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8e0069310>]}
[0m04:38:13.845361 [debug] [MainThread]: Flushing usage events


============================== 2023-02-28 04:39:00.248963 | 75a478fb-3e78-418c-b24f-a04da465c24e ==============================
[0m04:39:00.248963 [info ] [MainThread]: Running with dbt=1.4.3
[0m04:39:00.251339 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/katiehuang/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m04:39:00.251666 [debug] [MainThread]: Tracking: tracking
[0m04:39:00.252535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff199374be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff199374e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1993740d0>]}
[0m04:39:00.265920 [debug] [MainThread]: checksum: c7a5cda64f02d8b9dd20ef412f82fbb79fdce1bb359c3c5dae3d080de7f31bfd, vars: {}, profile: None, target: None, version: 1.4.3
[0m04:39:00.311328 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m04:39:00.311818 [debug] [MainThread]: Partial parsing: added file: dbtlearn://snapshots/scd_raw_listings.sql
[0m04:39:00.312200 [debug] [MainThread]: Partial parsing: updated file: dbtlearn://models/sources.yml
[0m04:39:00.364115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '75a478fb-3e78-418c-b24f-a04da465c24e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1993f5c40>]}
[0m04:39:00.374870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '75a478fb-3e78-418c-b24f-a04da465c24e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1883b4c10>]}
[0m04:39:00.375272 [info ] [MainThread]: Found 8 models, 0 tests, 1 snapshot, 0 analyses, 304 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
[0m04:39:00.375610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '75a478fb-3e78-418c-b24f-a04da465c24e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1883b4fd0>]}
[0m04:39:00.377493 [info ] [MainThread]: 
[0m04:39:00.379032 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m04:39:00.380338 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_airbnb'
[0m04:39:00.396882 [debug] [ThreadPool]: Using snowflake connection "list_airbnb"
[0m04:39:00.397233 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb"} */
show terse schemas in database airbnb
    limit 10000
[0m04:39:00.397502 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:39:04.911380 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 5 seconds
[0m04:39:04.916250 [debug] [ThreadPool]: On list_airbnb: Close
[0m04:39:05.649703 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_airbnb_dev'
[0m04:39:05.661966 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m04:39:05.662357 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m04:39:05.662676 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:39:07.638989 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 2 seconds
[0m04:39:07.644655 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m04:39:08.270477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '75a478fb-3e78-418c-b24f-a04da465c24e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1883b4af0>]}
[0m04:39:08.271818 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m04:39:08.272410 [info ] [MainThread]: 
[0m04:39:08.279888 [debug] [Thread-1  ]: Began running node model.dbtlearn.src_hosts
[0m04:39:08.280386 [debug] [Thread-2  ]: Began running node model.dbtlearn.src_listings
[0m04:39:08.280756 [debug] [Thread-3  ]: Began running node model.dbtlearn.src_reviews
[0m04:39:08.281518 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtlearn.src_hosts'
[0m04:39:08.282310 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtlearn.src_listings'
[0m04:39:08.283007 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtlearn.src_reviews'
[0m04:39:08.283344 [debug] [Thread-1  ]: Began compiling node model.dbtlearn.src_hosts
[0m04:39:08.283716 [debug] [Thread-2  ]: Began compiling node model.dbtlearn.src_listings
[0m04:39:08.284055 [debug] [Thread-3  ]: Began compiling node model.dbtlearn.src_reviews
[0m04:39:08.288543 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearn.src_hosts"
[0m04:39:08.291983 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtlearn.src_listings"
[0m04:39:08.295329 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtlearn.src_reviews"
[0m04:39:08.297016 [debug] [Thread-3  ]: Timing info for model.dbtlearn.src_reviews (compile): 2023-02-28 04:39:08.292265 => 2023-02-28 04:39:08.296915
[0m04:39:08.297364 [debug] [Thread-1  ]: Timing info for model.dbtlearn.src_hosts (compile): 2023-02-28 04:39:08.284295 => 2023-02-28 04:39:08.297285
[0m04:39:08.297613 [debug] [Thread-2  ]: Timing info for model.dbtlearn.src_listings (compile): 2023-02-28 04:39:08.288792 => 2023-02-28 04:39:08.297570
[0m04:39:08.299640 [debug] [Thread-3  ]: Finished running node model.dbtlearn.src_reviews
[0m04:39:08.300352 [debug] [Thread-1  ]: Finished running node model.dbtlearn.src_hosts
[0m04:39:08.300976 [debug] [Thread-2  ]: Finished running node model.dbtlearn.src_listings
[0m04:39:08.301655 [debug] [Thread-4  ]: Began running node model.dbtlearn.fct_reviews
[0m04:39:08.302130 [debug] [Thread-1  ]: Began running node model.dbtlearn.dim_hosts_cleansed
[0m04:39:08.302441 [info ] [Thread-4  ]: 1 of 5 START sql incremental model dev.fct_reviews ............................. [RUN]
[0m04:39:08.302976 [info ] [Thread-1  ]: 2 of 5 START sql view model dev.dim_hosts_cleansed ............................. [RUN]
[0m04:39:08.303458 [debug] [Thread-2  ]: Began running node model.dbtlearn.dim_listings_cleansed
[0m04:39:08.303981 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.dbtlearn.fct_reviews'
[0m04:39:08.304487 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtlearn.dim_hosts_cleansed'
[0m04:39:08.304795 [info ] [Thread-2  ]: 3 of 5 START sql view model dev.dim_listings_cleansed .......................... [RUN]
[0m04:39:08.305194 [debug] [Thread-4  ]: Began compiling node model.dbtlearn.fct_reviews
[0m04:39:08.305451 [debug] [Thread-1  ]: Began compiling node model.dbtlearn.dim_hosts_cleansed
[0m04:39:08.305963 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtlearn.dim_listings_cleansed'
[0m04:39:08.337072 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearn.dim_hosts_cleansed"
[0m04:39:08.340839 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtlearn.fct_reviews"
[0m04:39:08.341082 [debug] [Thread-2  ]: Began compiling node model.dbtlearn.dim_listings_cleansed
[0m04:39:08.350456 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtlearn.dim_listings_cleansed"
[0m04:39:08.350841 [debug] [Thread-4  ]: Timing info for model.dbtlearn.fct_reviews (compile): 2023-02-28 04:39:08.306146 => 2023-02-28 04:39:08.350783
[0m04:39:08.351068 [debug] [Thread-1  ]: Timing info for model.dbtlearn.dim_hosts_cleansed (compile): 2023-02-28 04:39:08.318790 => 2023-02-28 04:39:08.351018
[0m04:39:08.351322 [debug] [Thread-4  ]: Began executing node model.dbtlearn.fct_reviews
[0m04:39:08.351547 [debug] [Thread-1  ]: Began executing node model.dbtlearn.dim_hosts_cleansed
[0m04:39:08.357344 [debug] [Thread-2  ]: Timing info for model.dbtlearn.dim_listings_cleansed (compile): 2023-02-28 04:39:08.341421 => 2023-02-28 04:39:08.357294
[0m04:39:08.382742 [debug] [Thread-2  ]: Began executing node model.dbtlearn.dim_listings_cleansed
[0m04:39:08.443508 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m04:39:08.447301 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbtlearn.dim_listings_cleansed"
[0m04:39:08.447503 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtlearn.dim_hosts_cleansed"
[0m04:39:08.447681 [debug] [Thread-4  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
create or replace  temporary view airbnb.dev.fct_reviews__dbt_tmp
  
   as (
    -- Doc | Config : https://docs.getdbt.com/reference/dbt-jinja-functions/config


-- dbt materializes the model as an incremental table. 
-- Read for difference btw table vs. incremental: https://docs.getdbt.com/docs/build/materializations

WITH  __dbt__cte__src_reviews as (
WITH raw_reviews AS (
	SELECT * FROM airbnb.raw.raw_reviews
)

SELECT
    listing_id,
    date AS review_date,
    reviewer_name,
    comments AS review_text,
    sentiment AS review_sentiment
FROM raw_reviews
),src_reviews AS (
    SELECT * FROM __dbt__cte__src_reviews
)

SELECT 
    listing_id,
    review_date,
    NVL(reviewer_name, 'Anonymous') AS reviewer_name,
    review_text,
    review_sentiment
FROM src_reviews
WHERE review_text IS NOT NULL


  and review_date > (select max(review_date) from airbnb.dev.fct_reviews)

  );
[0m04:39:08.448089 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m04:39:08.449905 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.dim_hosts_cleansed"
[0m04:39:08.451342 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearn.dim_listings_cleansed"
[0m04:39:08.451539 [debug] [Thread-1  ]: On model.dbtlearn.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_hosts_cleansed"} */
create or replace   view airbnb.dev.dim_hosts_cleansed
  
   as (
    

WITH  __dbt__cte__src_hosts as (
WITH raw_hosts AS (
	SELECT * FROM airbnb.raw.raw_hosts
)

SELECT
    id AS host_id,
    name AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM raw_hosts
),src_hosts AS (
    SELECT * FROM __dbt__cte__src_hosts
)

SELECT 
    host_id,
    NVL(host_name, 'Anonymous') AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM src_hosts
  );
[0m04:39:08.452250 [debug] [Thread-2  ]: On model.dbtlearn.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_cleansed"} */
create or replace   view airbnb.dev.dim_listings_cleansed
  
   as (
    


WITH  __dbt__cte__src_listings as (
WITH raw_listings AS (
	SELECT * FROM airbnb.raw.raw_listings
)

SELECT 
	id AS listing_id,
    name AS listing_name,
    listing_url,
    room_type,
    minimum_nights,
    host_id,
    price AS price_str,
    created_at,
    updated_at
FROM 
	raw_listings
),src_listings AS (
    SELECT * FROM __dbt__cte__src_listings
)

SELECT
    listing_id,
    listing_name,
    room_type,
    CASE 
        WHEN minimum_nights = 0 THEN 1 -- 0 night = 1 night, so we assign the value of 1 to indicate 1 night
        ELSE minimum_nights
    END AS minimum_nights,
    host_id,
    REPLACE( -- Parse string value into numerical form
        price_str, '$' -- Replace '$' with price_str value. In other words, to remove '$' from string.
        ) :: NUMBER (10, 2 -- Convert string type to numerical with 2 decimal places
    ) AS price,
    created_at,
    updated_at
    
FROM src_listings
  );
[0m04:39:08.452458 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:39:08.452704 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m04:39:10.852870 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2 seconds
[0m04:39:10.854237 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 2 seconds
[0m04:39:10.902398 [debug] [Thread-2  ]: Timing info for model.dbtlearn.dim_listings_cleansed (execute): 2023-02-28 04:39:08.388918 => 2023-02-28 04:39:10.902333
[0m04:39:10.905042 [debug] [Thread-1  ]: Timing info for model.dbtlearn.dim_hosts_cleansed (execute): 2023-02-28 04:39:08.363815 => 2023-02-28 04:39:10.905001
[0m04:39:10.905274 [debug] [Thread-2  ]: On model.dbtlearn.dim_listings_cleansed: Close
[0m04:39:10.905485 [debug] [Thread-1  ]: On model.dbtlearn.dim_hosts_cleansed: Close
[0m04:39:10.909068 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 2 seconds
[0m04:39:10.919400 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m04:39:10.920008 [debug] [Thread-4  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
describe table airbnb.dev.fct_reviews__dbt_tmp
[0m04:39:11.243231 [debug] [Thread-4  ]: SQL status: SUCCESS 5 in 0 seconds
[0m04:39:11.250470 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m04:39:11.250871 [debug] [Thread-4  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
describe table airbnb.dev.fct_reviews
[0m04:39:11.546250 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '75a478fb-3e78-418c-b24f-a04da465c24e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff19949ea00>]}
[0m04:39:11.547462 [info ] [Thread-2  ]: 3 of 5 OK created sql view model dev.dim_listings_cleansed ..................... [[32mSUCCESS 1[0m in 3.24s]
[0m04:39:11.548452 [debug] [Thread-2  ]: Finished running node model.dbtlearn.dim_listings_cleansed
[0m04:39:11.558403 [debug] [Thread-4  ]: SQL status: SUCCESS 5 in 0 seconds
[0m04:39:11.585790 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m04:39:11.586235 [debug] [Thread-4  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
describe table airbnb.dev.fct_reviews__dbt_tmp
[0m04:39:11.588138 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '75a478fb-3e78-418c-b24f-a04da465c24e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1aa73f550>]}
[0m04:39:11.588761 [info ] [Thread-1  ]: 2 of 5 OK created sql view model dev.dim_hosts_cleansed ........................ [[32mSUCCESS 1[0m in 3.28s]
[0m04:39:11.589281 [debug] [Thread-1  ]: Finished running node model.dbtlearn.dim_hosts_cleansed
[0m04:39:11.590526 [debug] [Thread-3  ]: Began running node model.dbtlearn.dim_listings_w_hosts
[0m04:39:11.590869 [info ] [Thread-3  ]: 4 of 5 START sql table model dev.dim_listings_w_hosts .......................... [RUN]
[0m04:39:11.591820 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtlearn.dim_listings_w_hosts'
[0m04:39:11.592086 [debug] [Thread-3  ]: Began compiling node model.dbtlearn.dim_listings_w_hosts
[0m04:39:11.596235 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtlearn.dim_listings_w_hosts"
[0m04:39:11.597707 [debug] [Thread-3  ]: Timing info for model.dbtlearn.dim_listings_w_hosts (compile): 2023-02-28 04:39:11.592271 => 2023-02-28 04:39:11.597645
[0m04:39:11.597974 [debug] [Thread-3  ]: Began executing node model.dbtlearn.dim_listings_w_hosts
[0m04:39:11.622694 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbtlearn.dim_listings_w_hosts"
[0m04:39:11.624539 [debug] [Thread-3  ]: Using snowflake connection "model.dbtlearn.dim_listings_w_hosts"
[0m04:39:11.624736 [debug] [Thread-3  ]: On model.dbtlearn.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_w_hosts"} */
create or replace transient table airbnb.dev.dim_listings_w_hosts  as
        (WITH 
listings AS (
    SELECT * FROM airbnb.dev.dim_listings_cleansed
),
hosts AS (
    SELECT * FROM airbnb.dev.dim_hosts_cleansed
)

SELECT 
    listings.listing_id,
    listings.listing_name,
    listings.room_type,
    listings.minimum_nights,
    listings.price,
    listings.host_id,
    hosts.host_name,
    hosts.is_superhost AS host_is_superhost,
    listings.created_at,
    GREATEST(listings.updated_at, hosts.updated_at) AS updated_at -- Keep most recent updated_at
FROM listings
LEFT JOIN hosts
    ON listings.host_id = hosts.host_id
        );
[0m04:39:11.624920 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m04:39:12.186994 [debug] [Thread-4  ]: SQL status: SUCCESS 5 in 1 seconds
[0m04:39:12.196479 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m04:39:12.196915 [debug] [Thread-4  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
describe table "AIRBNB"."DEV"."FCT_REVIEWS"
[0m04:39:12.565107 [debug] [Thread-4  ]: SQL status: SUCCESS 5 in 0 seconds
[0m04:39:12.587803 [debug] [Thread-4  ]: 
    In "AIRBNB"."DEV"."FCT_REVIEWS":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m04:39:12.627996 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbtlearn.fct_reviews"
[0m04:39:12.666885 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m04:39:12.673402 [debug] [Thread-4  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
-- back compat for old kwarg name
  
  begin;
[0m04:39:13.111598 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0 seconds
[0m04:39:13.112174 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m04:39:13.112516 [debug] [Thread-4  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
insert into airbnb.dev.fct_reviews ("LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT")
        (
            select "LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT"
            from airbnb.dev.fct_reviews__dbt_tmp
        );
[0m04:39:15.429923 [debug] [Thread-4  ]: SQL status: SUCCESS 0 in 2 seconds
[0m04:39:15.431190 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m04:39:15.431736 [debug] [Thread-4  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
COMMIT
[0m04:39:15.836328 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0 seconds
[0m04:39:15.853857 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m04:39:15.854214 [debug] [Thread-4  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
drop view if exists airbnb.dev.fct_reviews__dbt_tmp cascade
[0m04:39:16.129071 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 5 seconds
[0m04:39:16.146586 [debug] [Thread-3  ]: Timing info for model.dbtlearn.dim_listings_w_hosts (execute): 2023-02-28 04:39:11.598149 => 2023-02-28 04:39:16.146493
[0m04:39:16.146992 [debug] [Thread-3  ]: On model.dbtlearn.dim_listings_w_hosts: Close
[0m04:39:16.209563 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0 seconds
[0m04:39:16.214655 [debug] [Thread-4  ]: Timing info for model.dbtlearn.fct_reviews (execute): 2023-02-28 04:39:08.351716 => 2023-02-28 04:39:16.214569
[0m04:39:16.215079 [debug] [Thread-4  ]: On model.dbtlearn.fct_reviews: Close
[0m04:39:16.749749 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '75a478fb-3e78-418c-b24f-a04da465c24e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1aa85e460>]}
[0m04:39:16.751117 [info ] [Thread-3  ]: 4 of 5 OK created sql table model dev.dim_listings_w_hosts ..................... [[32mSUCCESS 1[0m in 5.16s]
[0m04:39:16.752227 [debug] [Thread-3  ]: Finished running node model.dbtlearn.dim_listings_w_hosts
[0m04:39:16.838630 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '75a478fb-3e78-418c-b24f-a04da465c24e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1aa719af0>]}
[0m04:39:16.839679 [info ] [Thread-4  ]: 1 of 5 OK created sql incremental model dev.fct_reviews ........................ [[32mSUCCESS 0[0m in 8.53s]
[0m04:39:16.840423 [debug] [Thread-4  ]: Finished running node model.dbtlearn.fct_reviews
[0m04:39:16.841512 [debug] [Thread-1  ]: Began running node model.dbtlearn.mart_fullmoon_reviews
[0m04:39:16.842027 [info ] [Thread-1  ]: 5 of 5 START sql table model dev.mart_fullmoon_reviews ......................... [RUN]
[0m04:39:16.843121 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtlearn.mart_fullmoon_reviews'
[0m04:39:16.843737 [debug] [Thread-1  ]: Began compiling node model.dbtlearn.mart_fullmoon_reviews
[0m04:39:16.849863 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearn.mart_fullmoon_reviews"
[0m04:39:16.850863 [debug] [Thread-1  ]: Timing info for model.dbtlearn.mart_fullmoon_reviews (compile): 2023-02-28 04:39:16.844118 => 2023-02-28 04:39:16.850780
[0m04:39:16.851213 [debug] [Thread-1  ]: Began executing node model.dbtlearn.mart_fullmoon_reviews
[0m04:39:16.855245 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtlearn.mart_fullmoon_reviews"
[0m04:39:16.857307 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.mart_fullmoon_reviews"
[0m04:39:16.857598 [debug] [Thread-1  ]: On model.dbtlearn.mart_fullmoon_reviews: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.mart_fullmoon_reviews"} */
create or replace transient table airbnb.dev.mart_fullmoon_reviews  as
        (

WITH fct_reviews AS (

    SELECT * FROM airbnb.dev.fct_reviews

),
full_moon_dates AS (

    SELECT * FROM airbnb.dev.seed_full_moon_dates
)

SELECT
    reviews.*,
    CASE
        WHEN fullmoon.full_moon_date IS NULL THEN 'not full moon'
        ELSE 'full moon' END AS is_full_moon
FROM fct_reviews AS reviews
LEFT JOIN full_moon_dates AS fullmoon
    ON (TO_DATE(reviews.review_date) = DATEADD(DAY, 1, fullmoon.full_moon_date))
        );
[0m04:39:16.857876 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:39:23.771562 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 7 seconds
[0m04:39:23.779368 [debug] [Thread-1  ]: Timing info for model.dbtlearn.mart_fullmoon_reviews (execute): 2023-02-28 04:39:16.851445 => 2023-02-28 04:39:23.779241
[0m04:39:23.779925 [debug] [Thread-1  ]: On model.dbtlearn.mart_fullmoon_reviews: Close
[0m04:39:24.353678 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '75a478fb-3e78-418c-b24f-a04da465c24e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff19956c580>]}
[0m04:39:24.354793 [info ] [Thread-1  ]: 5 of 5 OK created sql table model dev.mart_fullmoon_reviews .................... [[32mSUCCESS 1[0m in 7.51s]
[0m04:39:24.355730 [debug] [Thread-1  ]: Finished running node model.dbtlearn.mart_fullmoon_reviews
[0m04:39:24.358654 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m04:39:24.359654 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:39:24.359995 [debug] [MainThread]: Connection 'model.dbtlearn.mart_fullmoon_reviews' was properly closed.
[0m04:39:24.360290 [debug] [MainThread]: Connection 'model.dbtlearn.dim_listings_cleansed' was properly closed.
[0m04:39:24.360574 [debug] [MainThread]: Connection 'model.dbtlearn.dim_listings_w_hosts' was properly closed.
[0m04:39:24.360850 [debug] [MainThread]: Connection 'model.dbtlearn.fct_reviews' was properly closed.
[0m04:39:24.361321 [info ] [MainThread]: 
[0m04:39:24.361862 [info ] [MainThread]: Finished running 2 view models, 2 table models, 1 incremental model in 0 hours 0 minutes and 23.98 seconds (23.98s).
[0m04:39:24.362818 [debug] [MainThread]: Command end result
[0m04:39:24.374112 [info ] [MainThread]: 
[0m04:39:24.374661 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:39:24.375081 [info ] [MainThread]: 
[0m04:39:24.375466 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m04:39:24.375957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1aa739b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1aa739580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1aa739ee0>]}
[0m04:39:24.376360 [debug] [MainThread]: Flushing usage events


============================== 2023-02-28 04:39:30.596282 | a22c97ef-962e-4cc2-9914-ed52d95e131b ==============================
[0m04:39:30.596282 [info ] [MainThread]: Running with dbt=1.4.3
[0m04:39:30.598639 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/katiehuang/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'snapshot', 'rpc_method': 'snapshot', 'indirect_selection': 'eager'}
[0m04:39:30.598949 [debug] [MainThread]: Tracking: tracking
[0m04:39:30.599529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe611d73970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe611d73d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe611d73520>]}
[0m04:39:30.611746 [debug] [MainThread]: checksum: c7a5cda64f02d8b9dd20ef412f82fbb79fdce1bb359c3c5dae3d080de7f31bfd, vars: {}, profile: None, target: None, version: 1.4.3
[0m04:39:30.654567 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:39:30.654868 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:39:30.662799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a22c97ef-962e-4cc2-9914-ed52d95e131b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe601f1deb0>]}
[0m04:39:30.670702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a22c97ef-962e-4cc2-9914-ed52d95e131b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe601e66460>]}
[0m04:39:30.671056 [info ] [MainThread]: Found 8 models, 0 tests, 1 snapshot, 0 analyses, 304 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
[0m04:39:30.671381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a22c97ef-962e-4cc2-9914-ed52d95e131b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe601e66160>]}
[0m04:39:30.673006 [info ] [MainThread]: 
[0m04:39:30.674507 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m04:39:30.675525 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_airbnb'
[0m04:39:30.691878 [debug] [ThreadPool]: Using snowflake connection "list_airbnb"
[0m04:39:30.692216 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb"} */
show terse schemas in database airbnb
    limit 10000
[0m04:39:30.692459 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:39:32.862976 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2 seconds
[0m04:39:32.870758 [debug] [ThreadPool]: On list_airbnb: Close
[0m04:39:33.457654 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_airbnb_dev'
[0m04:39:33.525446 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m04:39:33.525778 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m04:39:33.525998 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:39:35.449745 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 2 seconds
[0m04:39:35.452245 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m04:39:36.046859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a22c97ef-962e-4cc2-9914-ed52d95e131b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe601efedf0>]}
[0m04:39:36.048223 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m04:39:36.048821 [info ] [MainThread]: 
[0m04:39:36.056413 [debug] [Thread-1  ]: Began running node snapshot.dbtlearn.scd_raw_listings
[0m04:39:36.057009 [info ] [Thread-1  ]: 1 of 1 START snapshot dev.scd_raw_listings ..................................... [RUN]
[0m04:39:36.057959 [debug] [Thread-1  ]: Acquiring new snowflake connection 'snapshot.dbtlearn.scd_raw_listings'
[0m04:39:36.058311 [debug] [Thread-1  ]: Began compiling node snapshot.dbtlearn.scd_raw_listings
[0m04:39:36.064051 [debug] [Thread-1  ]: Timing info for snapshot.dbtlearn.scd_raw_listings (compile): 2023-02-28 04:39:36.058573 => 2023-02-28 04:39:36.063947
[0m04:39:36.064469 [debug] [Thread-1  ]: Began executing node snapshot.dbtlearn.scd_raw_listings
[0m04:39:36.137683 [debug] [Thread-1  ]: Writing runtime sql for node "snapshot.dbtlearn.scd_raw_listings"
[0m04:39:36.139262 [debug] [Thread-1  ]: Using snowflake connection "snapshot.dbtlearn.scd_raw_listings"
[0m04:39:36.139465 [debug] [Thread-1  ]: On snapshot.dbtlearn.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "snapshot.dbtlearn.scd_raw_listings"} */
create or replace transient table airbnb.dev.scd_raw_listings  as
        (

    select *,
        md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(updated_at as varchar ), '')
        ) as dbt_scd_id,
        updated_at as dbt_updated_at,
        updated_at as dbt_valid_from,
        nullif(updated_at, updated_at) as dbt_valid_to
    from (
        



-- Base of a snapshot is ALWAYS a SELECT * statement
-- Doc | Snapshots: https://docs.getdbt.com/docs/build/snapshots

SELECT * FROM airbnb.raw.raw_listings

    ) sbq



        );
[0m04:39:36.139653 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:39:38.780634 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 3 seconds
[0m04:39:38.823289 [debug] [Thread-1  ]: Timing info for snapshot.dbtlearn.scd_raw_listings (execute): 2023-02-28 04:39:36.064729 => 2023-02-28 04:39:38.823211
[0m04:39:38.823659 [debug] [Thread-1  ]: On snapshot.dbtlearn.scd_raw_listings: Close
[0m04:39:39.395310 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a22c97ef-962e-4cc2-9914-ed52d95e131b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe601f65dc0>]}
[0m04:39:39.396819 [info ] [Thread-1  ]: 1 of 1 OK snapshotted dev.scd_raw_listings ..................................... [[32msuccess[0m in 3.34s]
[0m04:39:39.399753 [debug] [Thread-1  ]: Finished running node snapshot.dbtlearn.scd_raw_listings
[0m04:39:39.402922 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m04:39:39.403863 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:39:39.404199 [debug] [MainThread]: Connection 'snapshot.dbtlearn.scd_raw_listings' was properly closed.
[0m04:39:39.404560 [info ] [MainThread]: 
[0m04:39:39.405087 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 8.73 seconds (8.73s).
[0m04:39:39.405780 [debug] [MainThread]: Command end result
[0m04:39:39.416874 [info ] [MainThread]: 
[0m04:39:39.417424 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:39:39.417809 [info ] [MainThread]: 
[0m04:39:39.418141 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m04:39:39.418560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6108a42e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe611f707f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe601f2af40>]}
[0m04:39:39.418903 [debug] [MainThread]: Flushing usage events


============================== 2023-02-28 07:17:10.989749 | 0cb951a3-5612-4531-9925-6aca5f6d7b44 ==============================
[0m07:17:10.989749 [info ] [MainThread]: Running with dbt=1.4.3
[0m07:17:10.992151 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/katiehuang/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'snapshot', 'rpc_method': 'snapshot', 'indirect_selection': 'eager'}
[0m07:17:10.992474 [debug] [MainThread]: Tracking: tracking
[0m07:17:10.993185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbea148ca60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbea148cb20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbea148c9a0>]}
[0m07:17:11.006495 [debug] [MainThread]: checksum: c7a5cda64f02d8b9dd20ef412f82fbb79fdce1bb359c3c5dae3d080de7f31bfd, vars: {}, profile: None, target: None, version: 1.4.3
[0m07:17:11.052071 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:17:11.052393 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:17:11.060583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0cb951a3-5612-4531-9925-6aca5f6d7b44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe80316ee0>]}
[0m07:17:11.069413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0cb951a3-5612-4531-9925-6aca5f6d7b44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe802645b0>]}
[0m07:17:11.069918 [info ] [MainThread]: Found 8 models, 0 tests, 1 snapshot, 0 analyses, 304 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
[0m07:17:11.070273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0cb951a3-5612-4531-9925-6aca5f6d7b44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe80264220>]}
[0m07:17:11.072022 [info ] [MainThread]: 
[0m07:17:11.073624 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m07:17:11.074684 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_airbnb'
[0m07:17:11.092044 [debug] [ThreadPool]: Using snowflake connection "list_airbnb"
[0m07:17:11.092391 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb"} */
show terse schemas in database airbnb
    limit 10000
[0m07:17:11.092638 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:17:15.348728 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 4 seconds
[0m07:17:15.354071 [debug] [ThreadPool]: On list_airbnb: Close
[0m07:17:16.175051 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_airbnb_dev'
[0m07:17:16.194065 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m07:17:16.194693 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m07:17:16.195102 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:17:18.282171 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 2 seconds
[0m07:17:18.287913 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m07:17:18.955553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0cb951a3-5612-4531-9925-6aca5f6d7b44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe802f6eb0>]}
[0m07:17:18.958390 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:17:18.959401 [info ] [MainThread]: 
[0m07:17:19.030880 [debug] [Thread-1  ]: Began running node snapshot.dbtlearn.scd_raw_listings
[0m07:17:19.031336 [info ] [Thread-1  ]: 1 of 1 START snapshot dev.scd_raw_listings ..................................... [RUN]
[0m07:17:19.032001 [debug] [Thread-1  ]: Acquiring new snowflake connection 'snapshot.dbtlearn.scd_raw_listings'
[0m07:17:19.032248 [debug] [Thread-1  ]: Began compiling node snapshot.dbtlearn.scd_raw_listings
[0m07:17:19.035789 [debug] [Thread-1  ]: Timing info for snapshot.dbtlearn.scd_raw_listings (compile): 2023-02-28 07:17:19.032424 => 2023-02-28 07:17:19.035726
[0m07:17:19.036044 [debug] [Thread-1  ]: Began executing node snapshot.dbtlearn.scd_raw_listings
[0m07:17:19.096840 [debug] [Thread-1  ]: Using snowflake connection "snapshot.dbtlearn.scd_raw_listings"
[0m07:17:19.097133 [debug] [Thread-1  ]: On snapshot.dbtlearn.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "snapshot.dbtlearn.scd_raw_listings"} */
describe table "AIRBNB"."DEV"."SCD_RAW_LISTINGS"
[0m07:17:19.097319 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:17:21.779564 [debug] [Thread-1  ]: SQL status: SUCCESS 13 in 3 seconds
[0m07:17:21.846290 [debug] [Thread-1  ]: Using snowflake connection "snapshot.dbtlearn.scd_raw_listings"
[0m07:17:21.846700 [debug] [Thread-1  ]: On snapshot.dbtlearn.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "snapshot.dbtlearn.scd_raw_listings"} */
create or replace temporary table "AIRBNB"."DEV"."SCD_RAW_LISTINGS__dbt_tmp"  as
        (with snapshot_query as (

        



-- Base of a snapshot is ALWAYS a SELECT * statement
-- Doc | Snapshots: https://docs.getdbt.com/docs/build/snapshots

SELECT * FROM airbnb.raw.raw_listings


    ),

    snapshotted_data as (

        select *,
            id as dbt_unique_key

        from "AIRBNB"."DEV"."SCD_RAW_LISTINGS"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            id as dbt_unique_key,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            nullif(updated_at, updated_at) as dbt_valid_to,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(updated_at as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            id as dbt_unique_key,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            updated_at as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select
            *,
            id as dbt_unique_key
        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.dbt_valid_from < source_data.updated_at)
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.dbt_valid_from < source_data.updated_at)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where source_data.dbt_unique_key is null
    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m07:17:24.154753 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2 seconds
[0m07:17:24.163698 [debug] [Thread-1  ]: Using snowflake connection "snapshot.dbtlearn.scd_raw_listings"
[0m07:17:24.164470 [debug] [Thread-1  ]: On snapshot.dbtlearn.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "snapshot.dbtlearn.scd_raw_listings"} */
describe table "AIRBNB"."DEV"."SCD_RAW_LISTINGS__dbt_tmp"
[0m07:17:24.565154 [debug] [Thread-1  ]: SQL status: SUCCESS 15 in 0 seconds
[0m07:17:24.584627 [debug] [Thread-1  ]: Using snowflake connection "snapshot.dbtlearn.scd_raw_listings"
[0m07:17:24.585558 [debug] [Thread-1  ]: On snapshot.dbtlearn.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "snapshot.dbtlearn.scd_raw_listings"} */
describe table "AIRBNB"."DEV"."SCD_RAW_LISTINGS"
[0m07:17:25.074558 [debug] [Thread-1  ]: SQL status: SUCCESS 13 in 0 seconds
[0m07:17:25.087235 [debug] [Thread-1  ]: Using snowflake connection "snapshot.dbtlearn.scd_raw_listings"
[0m07:17:25.088031 [debug] [Thread-1  ]: On snapshot.dbtlearn.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "snapshot.dbtlearn.scd_raw_listings"} */
describe table "AIRBNB"."DEV"."SCD_RAW_LISTINGS__dbt_tmp"
[0m07:17:25.588835 [debug] [Thread-1  ]: SQL status: SUCCESS 15 in 1 seconds
[0m07:17:25.605188 [debug] [Thread-1  ]: Using snowflake connection "snapshot.dbtlearn.scd_raw_listings"
[0m07:17:25.605868 [debug] [Thread-1  ]: On snapshot.dbtlearn.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "snapshot.dbtlearn.scd_raw_listings"} */
describe table "AIRBNB"."DEV"."SCD_RAW_LISTINGS"
[0m07:17:26.052738 [debug] [Thread-1  ]: SQL status: SUCCESS 13 in 0 seconds
[0m07:17:26.075998 [debug] [Thread-1  ]: Using snowflake connection "snapshot.dbtlearn.scd_raw_listings"
[0m07:17:26.076940 [debug] [Thread-1  ]: On snapshot.dbtlearn.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "snapshot.dbtlearn.scd_raw_listings"} */
describe table "AIRBNB"."DEV"."SCD_RAW_LISTINGS__dbt_tmp"
[0m07:17:26.431749 [debug] [Thread-1  ]: SQL status: SUCCESS 15 in 0 seconds
[0m07:17:26.463503 [debug] [Thread-1  ]: Writing runtime sql for node "snapshot.dbtlearn.scd_raw_listings"
[0m07:17:26.466706 [debug] [Thread-1  ]: Using snowflake connection "snapshot.dbtlearn.scd_raw_listings"
[0m07:17:26.467104 [debug] [Thread-1  ]: On snapshot.dbtlearn.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "snapshot.dbtlearn.scd_raw_listings"} */
BEGIN
[0m07:17:26.960009 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m07:17:26.961858 [debug] [Thread-1  ]: Using snowflake connection "snapshot.dbtlearn.scd_raw_listings"
[0m07:17:26.962632 [debug] [Thread-1  ]: On snapshot.dbtlearn.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "snapshot.dbtlearn.scd_raw_listings"} */
merge into "AIRBNB"."DEV"."SCD_RAW_LISTINGS" as DBT_INTERNAL_DEST
    using "AIRBNB"."DEV"."SCD_RAW_LISTINGS__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     and DBT_INTERNAL_DEST.dbt_valid_to is null
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("ID", "LISTING_URL", "NAME", "ROOM_TYPE", "MINIMUM_NIGHTS", "HOST_ID", "PRICE", "CREATED_AT", "UPDATED_AT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("ID", "LISTING_URL", "NAME", "ROOM_TYPE", "MINIMUM_NIGHTS", "HOST_ID", "PRICE", "CREATED_AT", "UPDATED_AT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m07:17:28.148535 [debug] [Thread-1  ]: SQL status: SUCCESS 2 in 1 seconds
[0m07:17:28.149932 [debug] [Thread-1  ]: Using snowflake connection "snapshot.dbtlearn.scd_raw_listings"
[0m07:17:28.150488 [debug] [Thread-1  ]: On snapshot.dbtlearn.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "snapshot.dbtlearn.scd_raw_listings"} */
COMMIT
[0m07:17:28.967598 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1 seconds
[0m07:17:29.023353 [debug] [Thread-1  ]: Timing info for snapshot.dbtlearn.scd_raw_listings (execute): 2023-02-28 07:17:19.036205 => 2023-02-28 07:17:29.023220
[0m07:17:29.023787 [debug] [Thread-1  ]: On snapshot.dbtlearn.scd_raw_listings: Close
[0m07:17:29.724498 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0cb951a3-5612-4531-9925-6aca5f6d7b44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbea15749d0>]}
[0m07:17:29.727209 [info ] [Thread-1  ]: 1 of 1 OK snapshotted dev.scd_raw_listings ..................................... [[32msuccess[0m in 10.69s]
[0m07:17:29.731946 [debug] [Thread-1  ]: Finished running node snapshot.dbtlearn.scd_raw_listings
[0m07:17:29.739511 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m07:17:29.741008 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:17:29.741498 [debug] [MainThread]: Connection 'snapshot.dbtlearn.scd_raw_listings' was properly closed.
[0m07:17:29.741991 [info ] [MainThread]: 
[0m07:17:29.743032 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 18.67 seconds (18.67s).
[0m07:17:29.744252 [debug] [MainThread]: Command end result
[0m07:17:29.756697 [info ] [MainThread]: 
[0m07:17:29.757441 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:17:29.758151 [info ] [MainThread]: 
[0m07:17:29.758716 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m07:17:29.759690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe802643a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe80264520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe802644f0>]}
[0m07:17:29.760157 [debug] [MainThread]: Flushing usage events


============================== 2023-02-28 07:45:39.794655 | abb9c41e-c6ec-4b4a-94d0-3805c87bd5c4 ==============================
[0m07:45:39.794655 [info ] [MainThread]: Running with dbt=1.4.3
[0m07:45:39.797076 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/katiehuang/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m07:45:39.797422 [debug] [MainThread]: Tracking: tracking
[0m07:45:39.798137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd40ad4ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd40ad4ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd40ad4670>]}
[0m07:45:39.811185 [debug] [MainThread]: checksum: c7a5cda64f02d8b9dd20ef412f82fbb79fdce1bb359c3c5dae3d080de7f31bfd, vars: {}, profile: None, target: None, version: 1.4.3
[0m07:45:39.857324 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m07:45:39.857913 [debug] [MainThread]: Partial parsing: added file: dbtlearn://models/schema.yml
[0m07:45:39.905490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'abb9c41e-c6ec-4b4a-94d0-3805c87bd5c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd40b39580>]}
[0m07:45:39.913875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'abb9c41e-c6ec-4b4a-94d0-3805c87bd5c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd70836ee0>]}
[0m07:45:39.914241 [info ] [MainThread]: Found 8 models, 2 tests, 1 snapshot, 0 analyses, 304 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
[0m07:45:39.914554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'abb9c41e-c6ec-4b4a-94d0-3805c87bd5c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd70836af0>]}
[0m07:45:39.916198 [info ] [MainThread]: 
[0m07:45:39.917688 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m07:45:39.919157 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_airbnb_dev'
[0m07:45:39.934294 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m07:45:39.934626 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m07:45:39.934889 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:45:43.199654 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 3 seconds
[0m07:45:43.207799 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m07:45:43.859444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'abb9c41e-c6ec-4b4a-94d0-3805c87bd5c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd40a97340>]}
[0m07:45:43.861631 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:45:43.862486 [info ] [MainThread]: 
[0m07:45:43.871917 [debug] [Thread-1  ]: Began running node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m07:45:43.873060 [debug] [Thread-2  ]: Began running node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m07:45:43.873730 [info ] [Thread-1  ]: 1 of 2 START test not_null_dim_listings_cleansed_listing_id .................... [RUN]
[0m07:45:43.874646 [info ] [Thread-2  ]: 2 of 2 START test unique_dim_listings_cleansed_listing_id ...................... [RUN]
[0m07:45:43.876106 [debug] [Thread-1  ]: Acquiring new snowflake connection 'test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9'
[0m07:45:43.877279 [debug] [Thread-2  ]: Acquiring new snowflake connection 'test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e'
[0m07:45:43.877717 [debug] [Thread-1  ]: Began compiling node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m07:45:43.878158 [debug] [Thread-2  ]: Began compiling node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m07:45:43.911093 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m07:45:43.908896 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m07:45:43.912170 [debug] [Thread-2  ]: Timing info for test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e (compile): 2023-02-28 07:45:43.890504 => 2023-02-28 07:45:43.912097
[0m07:45:43.912400 [debug] [Thread-1  ]: Timing info for test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9 (compile): 2023-02-28 07:45:43.878504 => 2023-02-28 07:45:43.912351
[0m07:45:43.912630 [debug] [Thread-2  ]: Began executing node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m07:45:43.912861 [debug] [Thread-1  ]: Began executing node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m07:45:43.950136 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m07:45:43.952176 [debug] [Thread-2  ]: Writing runtime sql for node "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m07:45:43.953425 [debug] [Thread-2  ]: Using snowflake connection "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m07:45:43.954087 [debug] [Thread-1  ]: Using snowflake connection "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m07:45:43.954264 [debug] [Thread-2  ]: On test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    listing_id as unique_field,
    count(*) as n_records

from airbnb.dev.dim_listings_cleansed
where listing_id is not null
group by listing_id
having count(*) > 1



      
    ) dbt_internal_test
[0m07:45:43.954450 [debug] [Thread-1  ]: On test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select listing_id
from airbnb.dev.dim_listings_cleansed
where listing_id is null



      
    ) dbt_internal_test
[0m07:45:43.954631 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m07:45:43.954806 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:45:46.851543 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 3 seconds
[0m07:45:46.882736 [debug] [Thread-1  ]: Timing info for test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9 (execute): 2023-02-28 07:45:43.919337 => 2023-02-28 07:45:46.882573
[0m07:45:46.883313 [debug] [Thread-1  ]: On test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9: Close
[0m07:45:46.978465 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 3 seconds
[0m07:45:46.985317 [debug] [Thread-2  ]: Timing info for test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e (execute): 2023-02-28 07:45:43.913017 => 2023-02-28 07:45:46.985081
[0m07:45:46.986648 [debug] [Thread-2  ]: On test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e: Close
[0m07:45:47.538634 [info ] [Thread-1  ]: 1 of 2 PASS not_null_dim_listings_cleansed_listing_id .......................... [[32mPASS[0m in 3.66s]
[0m07:45:47.543937 [debug] [Thread-1  ]: Finished running node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m07:45:47.655659 [info ] [Thread-2  ]: 2 of 2 PASS unique_dim_listings_cleansed_listing_id ............................ [[32mPASS[0m in 3.78s]
[0m07:45:47.657926 [debug] [Thread-2  ]: Finished running node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m07:45:47.663526 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m07:45:47.664985 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:45:47.665431 [debug] [MainThread]: Connection 'test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9' was properly closed.
[0m07:45:47.665796 [debug] [MainThread]: Connection 'test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e' was properly closed.
[0m07:45:47.666303 [info ] [MainThread]: 
[0m07:45:47.667294 [info ] [MainThread]: Finished running 2 tests in 0 hours 0 minutes and 7.75 seconds (7.75s).
[0m07:45:47.668498 [debug] [MainThread]: Command end result
[0m07:45:47.685171 [info ] [MainThread]: 
[0m07:45:47.685964 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:45:47.686491 [info ] [MainThread]: 
[0m07:45:47.686976 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m07:45:47.687590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd62920bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd40b39940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd628eaee0>]}
[0m07:45:47.688086 [debug] [MainThread]: Flushing usage events


============================== 2023-02-28 07:53:00.652719 | 058d04a6-560f-4e80-8e09-206697dc4e0f ==============================
[0m07:53:00.652719 [info ] [MainThread]: Running with dbt=1.4.3
[0m07:53:00.655213 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/katiehuang/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m07:53:00.655514 [debug] [MainThread]: Tracking: tracking
[0m07:53:00.656381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f83a91859a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f83a9185a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f83a91858e0>]}
[0m07:53:00.669329 [debug] [MainThread]: checksum: c7a5cda64f02d8b9dd20ef412f82fbb79fdce1bb359c3c5dae3d080de7f31bfd, vars: {}, profile: None, target: None, version: 1.4.3
[0m07:53:00.714856 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m07:53:00.715591 [debug] [MainThread]: Partial parsing: updated file: dbtlearn://models/schema.yml
[0m07:53:00.734678 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_cleansed.sql
[0m07:53:00.809843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '058d04a6-560f-4e80-8e09-206697dc4e0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f839a8a0730>]}
[0m07:53:00.819109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '058d04a6-560f-4e80-8e09-206697dc4e0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f83a9241cd0>]}
[0m07:53:00.819518 [info ] [MainThread]: Found 8 models, 5 tests, 1 snapshot, 0 analyses, 304 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
[0m07:53:00.819845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '058d04a6-560f-4e80-8e09-206697dc4e0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f83a929cdf0>]}
[0m07:53:00.821793 [info ] [MainThread]: 
[0m07:53:00.823348 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m07:53:00.824874 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_airbnb_dev'
[0m07:53:00.840597 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m07:53:00.840930 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m07:53:00.841178 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:53:04.362120 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 4 seconds
[0m07:53:04.368450 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m07:53:05.290538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '058d04a6-560f-4e80-8e09-206697dc4e0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f83a92a4a30>]}
[0m07:53:05.291790 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:53:05.292291 [info ] [MainThread]: 
[0m07:53:05.299838 [debug] [Thread-1  ]: Began running node test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_room_apt__Private_room__Shared_room__Hotel_room.26a1684e3d
[0m07:53:05.300368 [debug] [Thread-2  ]: Began running node test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m07:53:05.300751 [debug] [Thread-3  ]: Began running node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m07:53:05.301614 [debug] [Thread-4  ]: Began running node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m07:53:05.301085 [info ] [Thread-1  ]: 1 of 5 START test accepted_values_dim_listings_cleansed_room_type__Entire_room_apt__Private_room__Shared_room__Hotel_room  [RUN]
[0m07:53:05.302113 [info ] [Thread-2  ]: 2 of 5 START test not_null_dim_listings_cleansed_host_id ....................... [RUN]
[0m07:53:05.302668 [info ] [Thread-3  ]: 3 of 5 START test not_null_dim_listings_cleansed_listing_id .................... [RUN]
[0m07:53:05.303259 [info ] [Thread-4  ]: 4 of 5 START test relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_  [RUN]
[0m07:53:05.304225 [debug] [Thread-1  ]: Acquiring new snowflake connection 'test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_room_apt__Private_room__Shared_room__Hotel_room.26a1684e3d'
[0m07:53:05.304910 [debug] [Thread-2  ]: Acquiring new snowflake connection 'test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be'
[0m07:53:05.305522 [debug] [Thread-3  ]: Acquiring new snowflake connection 'test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9'
[0m07:53:05.306124 [debug] [Thread-4  ]: Acquiring new snowflake connection 'test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad'
[0m07:53:05.306440 [debug] [Thread-1  ]: Began compiling node test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_room_apt__Private_room__Shared_room__Hotel_room.26a1684e3d
[0m07:53:05.306751 [debug] [Thread-2  ]: Began compiling node test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m07:53:05.307039 [debug] [Thread-3  ]: Began compiling node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m07:53:05.307343 [debug] [Thread-4  ]: Began compiling node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m07:53:05.315923 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_room_apt__Private_room__Shared_room__Hotel_room.26a1684e3d"
[0m07:53:05.327012 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m07:53:05.331123 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m07:53:05.336591 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m07:53:05.337342 [debug] [Thread-2  ]: Timing info for test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be (compile): 2023-02-28 07:53:05.316331 => 2023-02-28 07:53:05.337269
[0m07:53:05.337585 [debug] [Thread-3  ]: Timing info for test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9 (compile): 2023-02-28 07:53:05.327234 => 2023-02-28 07:53:05.337531
[0m07:53:05.337793 [debug] [Thread-1  ]: Timing info for test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_room_apt__Private_room__Shared_room__Hotel_room.26a1684e3d (compile): 2023-02-28 07:53:05.307568 => 2023-02-28 07:53:05.337746
[0m07:53:05.338008 [debug] [Thread-2  ]: Began executing node test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m07:53:05.338186 [debug] [Thread-4  ]: Timing info for test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad (compile): 2023-02-28 07:53:05.331330 => 2023-02-28 07:53:05.338151
[0m07:53:05.338398 [debug] [Thread-3  ]: Began executing node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m07:53:05.338748 [debug] [Thread-1  ]: Began executing node test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_room_apt__Private_room__Shared_room__Hotel_room.26a1684e3d
[0m07:53:05.351555 [debug] [Thread-4  ]: Began executing node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m07:53:05.360691 [debug] [Thread-2  ]: Writing runtime sql for node "test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m07:53:05.363227 [debug] [Thread-3  ]: Writing runtime sql for node "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m07:53:05.366758 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_room_apt__Private_room__Shared_room__Hotel_room.26a1684e3d"
[0m07:53:05.369131 [debug] [Thread-4  ]: Writing runtime sql for node "test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m07:53:05.370332 [debug] [Thread-3  ]: Using snowflake connection "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m07:53:05.370998 [debug] [Thread-2  ]: Using snowflake connection "test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m07:53:05.371862 [debug] [Thread-1  ]: Using snowflake connection "test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_room_apt__Private_room__Shared_room__Hotel_room.26a1684e3d"
[0m07:53:05.372024 [debug] [Thread-3  ]: On test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select listing_id
from airbnb.dev.dim_listings_cleansed
where listing_id is null



      
    ) dbt_internal_test
[0m07:53:05.373052 [debug] [Thread-4  ]: Using snowflake connection "test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m07:53:05.373228 [debug] [Thread-2  ]: On test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select host_id
from airbnb.dev.dim_listings_cleansed
where host_id is null



      
    ) dbt_internal_test
[0m07:53:05.373418 [debug] [Thread-1  ]: On test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_room_apt__Private_room__Shared_room__Hotel_room.26a1684e3d: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_room_apt__Private_room__Shared_room__Hotel_room.26a1684e3d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        room_type as value_field,
        count(*) as n_records

    from airbnb.dev.dim_listings_cleansed
    group by room_type

)

select *
from all_values
where value_field not in (
    'Entire room/apt','Private room','Shared room','Hotel room'
)



      
    ) dbt_internal_test
[0m07:53:05.373643 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m07:53:05.373826 [debug] [Thread-4  ]: On test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select host_id as from_field
    from airbnb.dev.dim_listings_cleansed
    where host_id is not null
),

parent as (
    select host_id as to_field
    from airbnb.dev.dim_hosts_cleansed
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m07:53:05.373997 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m07:53:05.374176 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:53:05.374606 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m07:53:08.507773 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 3 seconds
[0m07:53:08.531975 [debug] [Thread-3  ]: Timing info for test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9 (execute): 2023-02-28 07:53:05.360895 => 2023-02-28 07:53:08.531853
[0m07:53:08.532473 [debug] [Thread-3  ]: On test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9: Close
[0m07:53:08.549252 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 3 seconds
[0m07:53:08.552132 [debug] [Thread-2  ]: Timing info for test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be (execute): 2023-02-28 07:53:05.338899 => 2023-02-28 07:53:08.552053
[0m07:53:08.552479 [debug] [Thread-2  ]: On test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be: Close
[0m07:53:08.555701 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 3 seconds
[0m07:53:08.558651 [debug] [Thread-1  ]: Timing info for test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_room_apt__Private_room__Shared_room__Hotel_room.26a1684e3d (execute): 2023-02-28 07:53:05.363408 => 2023-02-28 07:53:08.558586
[0m07:53:08.559011 [debug] [Thread-1  ]: On test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_room_apt__Private_room__Shared_room__Hotel_room.26a1684e3d: Close
[0m07:53:09.332323 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 4 seconds
[0m07:53:09.338335 [debug] [Thread-4  ]: Timing info for test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad (execute): 2023-02-28 07:53:05.366938 => 2023-02-28 07:53:09.338215
[0m07:53:09.339008 [debug] [Thread-4  ]: On test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad: Close
[0m07:53:09.342601 [info ] [Thread-3  ]: 3 of 5 PASS not_null_dim_listings_cleansed_listing_id .......................... [[32mPASS[0m in 4.04s]
[0m07:53:09.343787 [info ] [Thread-2  ]: 2 of 5 PASS not_null_dim_listings_cleansed_host_id ............................. [[32mPASS[0m in 4.04s]
[0m07:53:09.347907 [debug] [Thread-3  ]: Finished running node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m07:53:09.345057 [error] [Thread-1  ]: 1 of 5 FAIL 1 accepted_values_dim_listings_cleansed_room_type__Entire_room_apt__Private_room__Shared_room__Hotel_room  [[31mFAIL 1[0m in 4.04s]
[0m07:53:09.349243 [debug] [Thread-2  ]: Finished running node test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m07:53:09.349800 [debug] [Thread-3  ]: Began running node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m07:53:09.350575 [debug] [Thread-1  ]: Finished running node test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_room_apt__Private_room__Shared_room__Hotel_room.26a1684e3d
[0m07:53:09.351682 [info ] [Thread-3  ]: 5 of 5 START test unique_dim_listings_cleansed_listing_id ...................... [RUN]
[0m07:53:09.353071 [debug] [Thread-3  ]: Acquiring new snowflake connection 'test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e'
[0m07:53:09.353677 [debug] [Thread-3  ]: Began compiling node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m07:53:09.364245 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m07:53:09.365040 [debug] [Thread-3  ]: Timing info for test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e (compile): 2023-02-28 07:53:09.353991 => 2023-02-28 07:53:09.364965
[0m07:53:09.365347 [debug] [Thread-3  ]: Began executing node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m07:53:09.368731 [debug] [Thread-3  ]: Writing runtime sql for node "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m07:53:09.370050 [debug] [Thread-3  ]: Using snowflake connection "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m07:53:09.370274 [debug] [Thread-3  ]: On test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    listing_id as unique_field,
    count(*) as n_records

from airbnb.dev.dim_listings_cleansed
where listing_id is not null
group by listing_id
having count(*) > 1



      
    ) dbt_internal_test
[0m07:53:09.370483 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m07:53:10.105017 [info ] [Thread-4  ]: 4 of 5 PASS relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_  [[32mPASS[0m in 4.80s]
[0m07:53:10.106035 [debug] [Thread-4  ]: Finished running node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m07:53:11.521512 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 2 seconds
[0m07:53:11.527663 [debug] [Thread-3  ]: Timing info for test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e (execute): 2023-02-28 07:53:09.365556 => 2023-02-28 07:53:11.527552
[0m07:53:11.528118 [debug] [Thread-3  ]: On test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e: Close
[0m07:53:12.657271 [info ] [Thread-3  ]: 5 of 5 PASS unique_dim_listings_cleansed_listing_id ............................ [[32mPASS[0m in 3.30s]
[0m07:53:12.658400 [debug] [Thread-3  ]: Finished running node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m07:53:12.662323 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m07:53:12.663319 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:53:12.663665 [debug] [MainThread]: Connection 'test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_room_apt__Private_room__Shared_room__Hotel_room.26a1684e3d' was properly closed.
[0m07:53:12.663964 [debug] [MainThread]: Connection 'test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be' was properly closed.
[0m07:53:12.664248 [debug] [MainThread]: Connection 'test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e' was properly closed.
[0m07:53:12.664517 [debug] [MainThread]: Connection 'test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad' was properly closed.
[0m07:53:12.664871 [info ] [MainThread]: 
[0m07:53:12.665385 [info ] [MainThread]: Finished running 5 tests in 0 hours 0 minutes and 11.84 seconds (11.84s).
[0m07:53:12.666424 [debug] [MainThread]: Command end result
[0m07:53:12.677539 [info ] [MainThread]: 
[0m07:53:12.678099 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m07:53:12.678505 [info ] [MainThread]: 
[0m07:53:12.678927 [error] [MainThread]: [31mFailure in test accepted_values_dim_listings_cleansed_room_type__Entire_room_apt__Private_room__Shared_room__Hotel_room (models/schema.yml)[0m
[0m07:53:12.679334 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m07:53:12.679720 [info ] [MainThread]: 
[0m07:53:12.680098 [info ] [MainThread]:   compiled Code at target/compiled/dbtlearn/models/schema.yml/accepted_values_dim_listings_c_9fcd3cfe888517e67ec95c75be12c62a.sql
[0m07:53:12.680476 [info ] [MainThread]: 
[0m07:53:12.680786 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m07:53:12.681226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f839a8f78e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f83a9241ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f83a9241d00>]}
[0m07:53:12.681644 [debug] [MainThread]: Flushing usage events


============================== 2023-02-28 07:54:16.770900 | b3b39b00-b082-485f-87be-13fccae49fc8 ==============================
[0m07:54:16.770900 [info ] [MainThread]: Running with dbt=1.4.3
[0m07:54:16.773179 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/katiehuang/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m07:54:16.773475 [debug] [MainThread]: Tracking: tracking
[0m07:54:16.774181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9749794a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9749794e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97497945e0>]}
[0m07:54:16.791232 [debug] [MainThread]: checksum: c7a5cda64f02d8b9dd20ef412f82fbb79fdce1bb359c3c5dae3d080de7f31bfd, vars: {}, profile: None, target: None, version: 1.4.3
[0m07:54:16.842827 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m07:54:16.843659 [debug] [MainThread]: Partial parsing: updated file: dbtlearn://models/schema.yml
[0m07:54:16.863172 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_cleansed.sql
[0m07:54:16.936926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b3b39b00-b082-485f-87be-13fccae49fc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9749832880>]}
[0m07:54:16.948126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b3b39b00-b082-485f-87be-13fccae49fc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9749791fd0>]}
[0m07:54:16.948611 [info ] [MainThread]: Found 8 models, 5 tests, 1 snapshot, 0 analyses, 304 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
[0m07:54:16.948945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b3b39b00-b082-485f-87be-13fccae49fc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9739548eb0>]}
[0m07:54:16.951026 [info ] [MainThread]: 
[0m07:54:16.952704 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m07:54:16.954382 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_airbnb_dev'
[0m07:54:16.969922 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m07:54:16.970301 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m07:54:16.970569 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:54:19.624760 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 3 seconds
[0m07:54:19.630815 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m07:54:20.449143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b3b39b00-b082-485f-87be-13fccae49fc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97497f9580>]}
[0m07:54:20.450631 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:54:20.451265 [info ] [MainThread]: 
[0m07:54:20.459453 [debug] [Thread-1  ]: Began running node test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m07:54:20.459956 [debug] [Thread-2  ]: Began running node test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m07:54:20.460352 [debug] [Thread-3  ]: Began running node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m07:54:20.461252 [debug] [Thread-4  ]: Began running node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m07:54:20.460703 [info ] [Thread-1  ]: 1 of 5 START test accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room  [RUN]
[0m07:54:20.461776 [info ] [Thread-2  ]: 2 of 5 START test not_null_dim_listings_cleansed_host_id ....................... [RUN]
[0m07:54:20.462334 [info ] [Thread-3  ]: 3 of 5 START test not_null_dim_listings_cleansed_listing_id .................... [RUN]
[0m07:54:20.463680 [debug] [Thread-1  ]: Acquiring new snowflake connection 'test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af'
[0m07:54:20.462678 [info ] [Thread-4  ]: 4 of 5 START test relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_  [RUN]
[0m07:54:20.464580 [debug] [Thread-2  ]: Acquiring new snowflake connection 'test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be'
[0m07:54:20.465256 [debug] [Thread-3  ]: Acquiring new snowflake connection 'test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9'
[0m07:54:20.465607 [debug] [Thread-1  ]: Began compiling node test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m07:54:20.466300 [debug] [Thread-4  ]: Acquiring new snowflake connection 'test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad'
[0m07:54:20.466619 [debug] [Thread-2  ]: Began compiling node test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m07:54:20.466919 [debug] [Thread-3  ]: Began compiling node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m07:54:20.476325 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m07:54:20.476744 [debug] [Thread-4  ]: Began compiling node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m07:54:20.487819 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m07:54:20.491857 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m07:54:20.497614 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m07:54:20.498317 [debug] [Thread-1  ]: Timing info for test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af (compile): 2023-02-28 07:54:20.467158 => 2023-02-28 07:54:20.498227
[0m07:54:20.498583 [debug] [Thread-1  ]: Began executing node test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m07:54:20.498836 [debug] [Thread-2  ]: Timing info for test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be (compile): 2023-02-28 07:54:20.477026 => 2023-02-28 07:54:20.498783
[0m07:54:20.516843 [debug] [Thread-2  ]: Began executing node test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m07:54:20.517091 [debug] [Thread-4  ]: Timing info for test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad (compile): 2023-02-28 07:54:20.492175 => 2023-02-28 07:54:20.517046
[0m07:54:20.521317 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m07:54:20.523921 [debug] [Thread-2  ]: Writing runtime sql for node "test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m07:54:20.524155 [debug] [Thread-3  ]: Timing info for test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9 (compile): 2023-02-28 07:54:20.488013 => 2023-02-28 07:54:20.524105
[0m07:54:20.524374 [debug] [Thread-4  ]: Began executing node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m07:54:20.524750 [debug] [Thread-3  ]: Began executing node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m07:54:20.527215 [debug] [Thread-4  ]: Writing runtime sql for node "test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m07:54:20.528197 [debug] [Thread-1  ]: Using snowflake connection "test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m07:54:20.531749 [debug] [Thread-3  ]: Writing runtime sql for node "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m07:54:20.532390 [debug] [Thread-2  ]: Using snowflake connection "test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m07:54:20.532636 [debug] [Thread-1  ]: On test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        room_type as value_field,
        count(*) as n_records

    from airbnb.dev.dim_listings_cleansed
    group by room_type

)

select *
from all_values
where value_field not in (
    'Entire home/apt','Private room','Shared room','Hotel room'
)



      
    ) dbt_internal_test
[0m07:54:20.532944 [debug] [Thread-2  ]: On test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select host_id
from airbnb.dev.dim_listings_cleansed
where host_id is null



      
    ) dbt_internal_test
[0m07:54:20.533983 [debug] [Thread-4  ]: Using snowflake connection "test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m07:54:20.534172 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:54:20.534379 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m07:54:20.535000 [debug] [Thread-3  ]: Using snowflake connection "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m07:54:20.535154 [debug] [Thread-4  ]: On test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select host_id as from_field
    from airbnb.dev.dim_listings_cleansed
    where host_id is not null
),

parent as (
    select host_id as to_field
    from airbnb.dev.dim_hosts_cleansed
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m07:54:20.536616 [debug] [Thread-3  ]: On test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select listing_id
from airbnb.dev.dim_listings_cleansed
where listing_id is null



      
    ) dbt_internal_test
[0m07:54:20.537813 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m07:54:20.538105 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m07:54:23.111681 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 3 seconds
[0m07:54:23.138060 [debug] [Thread-3  ]: Timing info for test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9 (execute): 2023-02-28 07:54:20.528366 => 2023-02-28 07:54:23.137944
[0m07:54:23.138495 [debug] [Thread-3  ]: On test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9: Close
[0m07:54:23.190324 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 3 seconds
[0m07:54:23.193763 [debug] [Thread-2  ]: Timing info for test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be (execute): 2023-02-28 07:54:20.521494 => 2023-02-28 07:54:23.193659
[0m07:54:23.194189 [debug] [Thread-2  ]: On test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be: Close
[0m07:54:23.302731 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 3 seconds
[0m07:54:23.308237 [debug] [Thread-1  ]: Timing info for test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af (execute): 2023-02-28 07:54:20.499061 => 2023-02-28 07:54:23.308099
[0m07:54:23.308833 [debug] [Thread-1  ]: On test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af: Close
[0m07:54:23.586481 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 3 seconds
[0m07:54:23.592111 [debug] [Thread-4  ]: Timing info for test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad (execute): 2023-02-28 07:54:20.524983 => 2023-02-28 07:54:23.591963
[0m07:54:23.592673 [debug] [Thread-4  ]: On test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad: Close
[0m07:54:23.828801 [info ] [Thread-3  ]: 3 of 5 PASS not_null_dim_listings_cleansed_listing_id .......................... [[32mPASS[0m in 3.36s]
[0m07:54:23.830347 [info ] [Thread-2  ]: 2 of 5 PASS not_null_dim_listings_cleansed_host_id ............................. [[32mPASS[0m in 3.37s]
[0m07:54:23.833624 [debug] [Thread-3  ]: Finished running node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m07:54:23.834217 [debug] [Thread-2  ]: Finished running node test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m07:54:23.834868 [debug] [Thread-3  ]: Began running node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m07:54:23.836050 [info ] [Thread-3  ]: 5 of 5 START test unique_dim_listings_cleansed_listing_id ...................... [RUN]
[0m07:54:23.837235 [debug] [Thread-3  ]: Acquiring new snowflake connection 'test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e'
[0m07:54:23.837639 [debug] [Thread-3  ]: Began compiling node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m07:54:23.849996 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m07:54:23.850803 [debug] [Thread-3  ]: Timing info for test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e (compile): 2023-02-28 07:54:23.837927 => 2023-02-28 07:54:23.850733
[0m07:54:23.851108 [debug] [Thread-3  ]: Began executing node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m07:54:23.855214 [debug] [Thread-3  ]: Writing runtime sql for node "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m07:54:23.856818 [debug] [Thread-3  ]: Using snowflake connection "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m07:54:23.857117 [debug] [Thread-3  ]: On test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    listing_id as unique_field,
    count(*) as n_records

from airbnb.dev.dim_listings_cleansed
where listing_id is not null
group by listing_id
having count(*) > 1



      
    ) dbt_internal_test
[0m07:54:23.857356 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m07:54:24.007876 [info ] [Thread-1  ]: 1 of 5 PASS accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room  [[32mPASS[0m in 3.54s]
[0m07:54:24.008989 [debug] [Thread-1  ]: Finished running node test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m07:54:24.242055 [info ] [Thread-4  ]: 4 of 5 PASS relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_  [[32mPASS[0m in 3.78s]
[0m07:54:24.242569 [debug] [Thread-4  ]: Finished running node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m07:54:26.101565 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 2 seconds
[0m07:54:26.108163 [debug] [Thread-3  ]: Timing info for test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e (execute): 2023-02-28 07:54:23.851307 => 2023-02-28 07:54:26.107968
[0m07:54:26.108784 [debug] [Thread-3  ]: On test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e: Close
[0m07:54:26.782836 [info ] [Thread-3  ]: 5 of 5 PASS unique_dim_listings_cleansed_listing_id ............................ [[32mPASS[0m in 2.95s]
[0m07:54:26.783509 [debug] [Thread-3  ]: Finished running node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m07:54:26.786347 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m07:54:26.787294 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:54:26.787629 [debug] [MainThread]: Connection 'test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af' was properly closed.
[0m07:54:26.787920 [debug] [MainThread]: Connection 'test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be' was properly closed.
[0m07:54:26.788198 [debug] [MainThread]: Connection 'test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e' was properly closed.
[0m07:54:26.788467 [debug] [MainThread]: Connection 'test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad' was properly closed.
[0m07:54:26.788879 [info ] [MainThread]: 
[0m07:54:26.789512 [info ] [MainThread]: Finished running 5 tests in 0 hours 0 minutes and 9.84 seconds (9.84s).
[0m07:54:26.790573 [debug] [MainThread]: Command end result
[0m07:54:26.801866 [info ] [MainThread]: 
[0m07:54:26.802480 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:54:26.802916 [info ] [MainThread]: 
[0m07:54:26.803345 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m07:54:26.803889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97498938e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9739548df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9739548f10>]}
[0m07:54:26.804336 [debug] [MainThread]: Flushing usage events


============================== 2023-02-28 08:03:22.721754 | e39c3edc-bdc4-4703-b9bd-ac27d4d1d862 ==============================
[0m08:03:22.721754 [info ] [MainThread]: Running with dbt=1.4.3
[0m08:03:22.724189 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/katiehuang/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m08:03:22.724484 [debug] [MainThread]: Tracking: tracking
[0m08:03:22.725083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb0eab940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb0eab9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb0eab880>]}
[0m08:03:22.738698 [debug] [MainThread]: checksum: c7a5cda64f02d8b9dd20ef412f82fbb79fdce1bb359c3c5dae3d080de7f31bfd, vars: {}, profile: None, target: None, version: 1.4.3
[0m08:03:22.786654 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m08:03:22.787143 [debug] [MainThread]: Partial parsing: added file: dbtlearn://tests/dim_listings_minimum_nights.sql
[0m08:03:22.827854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e39c3edc-bdc4-4703-b9bd-ac27d4d1d862', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb0e90310>]}
[0m08:03:22.836259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e39c3edc-bdc4-4703-b9bd-ac27d4d1d862', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbd2d79e80>]}
[0m08:03:22.836606 [info ] [MainThread]: Found 8 models, 6 tests, 1 snapshot, 0 analyses, 304 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
[0m08:03:22.836926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e39c3edc-bdc4-4703-b9bd-ac27d4d1d862', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbd2d79ee0>]}
[0m08:03:22.838907 [info ] [MainThread]: 
[0m08:03:22.840423 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:03:22.842019 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_airbnb_dev'
[0m08:03:22.857587 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m08:03:22.857919 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m08:03:22.858158 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:03:25.880180 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 3 seconds
[0m08:03:25.885272 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m08:03:26.757017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e39c3edc-bdc4-4703-b9bd-ac27d4d1d862', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb0e5d7c0>]}
[0m08:03:26.757799 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:03:26.758119 [info ] [MainThread]: 
[0m08:03:26.763006 [debug] [Thread-1  ]: Began running node test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m08:03:26.763370 [debug] [Thread-2  ]: Began running node test.dbtlearn.dim_listings_minimum_nights
[0m08:03:26.763761 [debug] [Thread-3  ]: Began running node test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m08:03:26.764252 [debug] [Thread-4  ]: Began running node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m08:03:26.763993 [info ] [Thread-1  ]: 1 of 6 START test accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room  [RUN]
[0m08:03:26.764583 [info ] [Thread-2  ]: 2 of 6 START test dim_listings_minimum_nights .................................. [RUN]
[0m08:03:26.764952 [info ] [Thread-3  ]: 3 of 6 START test not_null_dim_listings_cleansed_host_id ....................... [RUN]
[0m08:03:26.765176 [info ] [Thread-4  ]: 4 of 6 START test not_null_dim_listings_cleansed_listing_id .................... [RUN]
[0m08:03:26.765943 [debug] [Thread-1  ]: Acquiring new snowflake connection 'test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af'
[0m08:03:26.766421 [debug] [Thread-2  ]: Acquiring new snowflake connection 'test.dbtlearn.dim_listings_minimum_nights'
[0m08:03:26.766902 [debug] [Thread-3  ]: Acquiring new snowflake connection 'test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be'
[0m08:03:26.767345 [debug] [Thread-4  ]: Acquiring new snowflake connection 'test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9'
[0m08:03:26.767579 [debug] [Thread-1  ]: Began compiling node test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m08:03:26.767814 [debug] [Thread-2  ]: Began compiling node test.dbtlearn.dim_listings_minimum_nights
[0m08:03:26.768032 [debug] [Thread-3  ]: Began compiling node test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m08:03:26.768236 [debug] [Thread-4  ]: Began compiling node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m08:03:26.784175 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbtlearn.dim_listings_minimum_nights"
[0m08:03:26.787376 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m08:03:26.797996 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m08:03:26.803162 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m08:03:26.804191 [debug] [Thread-1  ]: Timing info for test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af (compile): 2023-02-28 08:03:26.768394 => 2023-02-28 08:03:26.804115
[0m08:03:26.804452 [debug] [Thread-1  ]: Began executing node test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m08:03:26.804748 [debug] [Thread-2  ]: Timing info for test.dbtlearn.dim_listings_minimum_nights (compile): 2023-02-28 08:03:26.781211 => 2023-02-28 08:03:26.804695
[0m08:03:26.817343 [debug] [Thread-4  ]: Timing info for test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9 (compile): 2023-02-28 08:03:26.798186 => 2023-02-28 08:03:26.817278
[0m08:03:26.817557 [debug] [Thread-3  ]: Timing info for test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be (compile): 2023-02-28 08:03:26.787653 => 2023-02-28 08:03:26.817520
[0m08:03:26.817769 [debug] [Thread-2  ]: Began executing node test.dbtlearn.dim_listings_minimum_nights
[0m08:03:26.827441 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m08:03:26.827725 [debug] [Thread-4  ]: Began executing node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m08:03:26.827947 [debug] [Thread-3  ]: Began executing node test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m08:03:26.830478 [debug] [Thread-2  ]: Writing runtime sql for node "test.dbtlearn.dim_listings_minimum_nights"
[0m08:03:26.833135 [debug] [Thread-4  ]: Writing runtime sql for node "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m08:03:26.835548 [debug] [Thread-3  ]: Writing runtime sql for node "test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m08:03:26.836705 [debug] [Thread-1  ]: Using snowflake connection "test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m08:03:26.837072 [debug] [Thread-1  ]: On test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        room_type as value_field,
        count(*) as n_records

    from airbnb.dev.dim_listings_cleansed
    group by room_type

)

select *
from all_values
where value_field not in (
    'Entire home/apt','Private room','Shared room','Hotel room'
)



      
    ) dbt_internal_test
[0m08:03:26.837329 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m08:03:26.838768 [debug] [Thread-2  ]: Using snowflake connection "test.dbtlearn.dim_listings_minimum_nights"
[0m08:03:26.839436 [debug] [Thread-3  ]: Using snowflake connection "test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m08:03:26.839639 [debug] [Thread-2  ]: On test.dbtlearn.dim_listings_minimum_nights: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.dim_listings_minimum_nights"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      SELECT * 
FROM airbnb.dev.dim_listings_cleansed
WHERE minimum_nights < 1
LIMIT 10

-- Query is written in such a way that the results returned must be zero to PASS the test.
      
    ) dbt_internal_test
[0m08:03:26.840282 [debug] [Thread-4  ]: Using snowflake connection "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m08:03:26.841045 [debug] [Thread-3  ]: On test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select host_id
from airbnb.dev.dim_listings_cleansed
where host_id is null



      
    ) dbt_internal_test
[0m08:03:26.841292 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m08:03:26.841483 [debug] [Thread-4  ]: On test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select listing_id
from airbnb.dev.dim_listings_cleansed
where listing_id is null



      
    ) dbt_internal_test
[0m08:03:26.841662 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m08:03:26.842537 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m08:03:29.456044 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 3 seconds
[0m08:03:29.481915 [debug] [Thread-1  ]: Timing info for test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af (execute): 2023-02-28 08:03:26.804970 => 2023-02-28 08:03:29.481804
[0m08:03:29.482376 [debug] [Thread-1  ]: On test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af: Close
[0m08:03:29.578228 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 3 seconds
[0m08:03:29.584117 [debug] [Thread-3  ]: Timing info for test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be (execute): 2023-02-28 08:03:26.833318 => 2023-02-28 08:03:29.583986
[0m08:03:29.584648 [debug] [Thread-3  ]: On test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be: Close
[0m08:03:29.792451 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 3 seconds
[0m08:03:29.797944 [debug] [Thread-2  ]: Timing info for test.dbtlearn.dim_listings_minimum_nights (execute): 2023-02-28 08:03:26.828106 => 2023-02-28 08:03:29.797767
[0m08:03:29.798733 [debug] [Thread-2  ]: On test.dbtlearn.dim_listings_minimum_nights: Close
[0m08:03:30.072499 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 3 seconds
[0m08:03:30.078084 [debug] [Thread-4  ]: Timing info for test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9 (execute): 2023-02-28 08:03:26.830759 => 2023-02-28 08:03:30.077956
[0m08:03:30.078606 [debug] [Thread-4  ]: On test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9: Close
[0m08:03:30.152821 [info ] [Thread-1  ]: 1 of 6 PASS accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room  [[32mPASS[0m in 3.39s]
[0m08:03:30.155492 [debug] [Thread-1  ]: Finished running node test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m08:03:30.156288 [debug] [Thread-1  ]: Began running node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m08:03:30.156886 [info ] [Thread-1  ]: 5 of 6 START test relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_  [RUN]
[0m08:03:30.158085 [debug] [Thread-1  ]: Acquiring new snowflake connection 'test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad'
[0m08:03:30.158527 [debug] [Thread-1  ]: Began compiling node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m08:03:30.174211 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m08:03:30.175348 [debug] [Thread-1  ]: Timing info for test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad (compile): 2023-02-28 08:03:30.158828 => 2023-02-28 08:03:30.175268
[0m08:03:30.175678 [debug] [Thread-1  ]: Began executing node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m08:03:30.179370 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m08:03:30.181356 [debug] [Thread-1  ]: Using snowflake connection "test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m08:03:30.181622 [debug] [Thread-1  ]: On test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select host_id as from_field
    from airbnb.dev.dim_listings_cleansed
    where host_id is not null
),

parent as (
    select host_id as to_field
    from airbnb.dev.dim_hosts_cleansed
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m08:03:30.181857 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m08:03:30.217775 [info ] [Thread-3  ]: 3 of 6 PASS not_null_dim_listings_cleansed_host_id ............................. [[32mPASS[0m in 3.45s]
[0m08:03:30.218436 [debug] [Thread-3  ]: Finished running node test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m08:03:30.218879 [debug] [Thread-3  ]: Began running node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m08:03:30.219291 [info ] [Thread-3  ]: 6 of 6 START test unique_dim_listings_cleansed_listing_id ...................... [RUN]
[0m08:03:30.220079 [debug] [Thread-3  ]: Acquiring new snowflake connection 'test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e'
[0m08:03:30.220370 [debug] [Thread-3  ]: Began compiling node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m08:03:30.229648 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m08:03:30.230343 [debug] [Thread-3  ]: Timing info for test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e (compile): 2023-02-28 08:03:30.220576 => 2023-02-28 08:03:30.230278
[0m08:03:30.230619 [debug] [Thread-3  ]: Began executing node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m08:03:30.233558 [debug] [Thread-3  ]: Writing runtime sql for node "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m08:03:30.234693 [debug] [Thread-3  ]: Using snowflake connection "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m08:03:30.234902 [debug] [Thread-3  ]: On test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    listing_id as unique_field,
    count(*) as n_records

from airbnb.dev.dim_listings_cleansed
where listing_id is not null
group by listing_id
having count(*) > 1



      
    ) dbt_internal_test
[0m08:03:30.235103 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m08:03:30.447528 [info ] [Thread-2  ]: 2 of 6 PASS dim_listings_minimum_nights ........................................ [[32mPASS[0m in 3.68s]
[0m08:03:30.448666 [debug] [Thread-2  ]: Finished running node test.dbtlearn.dim_listings_minimum_nights
[0m08:03:30.763589 [info ] [Thread-4  ]: 4 of 6 PASS not_null_dim_listings_cleansed_listing_id .......................... [[32mPASS[0m in 4.00s]
[0m08:03:30.764287 [debug] [Thread-4  ]: Finished running node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m08:03:32.293094 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 2 seconds
[0m08:03:32.299333 [debug] [Thread-3  ]: Timing info for test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e (execute): 2023-02-28 08:03:30.230794 => 2023-02-28 08:03:32.299190
[0m08:03:32.300353 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2 seconds
[0m08:03:32.300770 [debug] [Thread-3  ]: On test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e: Close
[0m08:03:32.304046 [debug] [Thread-1  ]: Timing info for test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad (execute): 2023-02-28 08:03:30.175886 => 2023-02-28 08:03:32.303956
[0m08:03:32.306555 [debug] [Thread-1  ]: On test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad: Close
[0m08:03:33.054801 [info ] [Thread-3  ]: 6 of 6 PASS unique_dim_listings_cleansed_listing_id ............................ [[32mPASS[0m in 2.83s]
[0m08:03:33.056441 [info ] [Thread-1  ]: 5 of 6 PASS relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_  [[32mPASS[0m in 2.90s]
[0m08:03:33.057673 [debug] [Thread-3  ]: Finished running node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m08:03:33.058228 [debug] [Thread-1  ]: Finished running node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m08:03:33.061035 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:03:33.061965 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:03:33.062301 [debug] [MainThread]: Connection 'test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad' was properly closed.
[0m08:03:33.062592 [debug] [MainThread]: Connection 'test.dbtlearn.dim_listings_minimum_nights' was properly closed.
[0m08:03:33.062869 [debug] [MainThread]: Connection 'test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e' was properly closed.
[0m08:03:33.063151 [debug] [MainThread]: Connection 'test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9' was properly closed.
[0m08:03:33.063525 [info ] [MainThread]: 
[0m08:03:33.064065 [info ] [MainThread]: Finished running 6 tests in 0 hours 0 minutes and 10.22 seconds (10.22s).
[0m08:03:33.065104 [debug] [MainThread]: Command end result
[0m08:03:33.075847 [info ] [MainThread]: 
[0m08:03:33.076347 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:03:33.076713 [info ] [MainThread]: 
[0m08:03:33.077047 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m08:03:33.077482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb0e5d9a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbd2d79f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbd2d79fd0>]}
[0m08:03:33.077831 [debug] [MainThread]: Flushing usage events


============================== 2023-02-28 08:04:06.880876 | f3f25d11-6cf4-4ac0-998f-0e8065092db4 ==============================
[0m08:04:06.880876 [info ] [MainThread]: Running with dbt=1.4.3
[0m08:04:06.883218 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/katiehuang/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m08:04:06.883474 [debug] [MainThread]: Tracking: tracking
[0m08:04:06.884316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe441eaf880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe441eafbe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe441eafac0>]}
[0m08:04:06.897101 [debug] [MainThread]: checksum: c7a5cda64f02d8b9dd20ef412f82fbb79fdce1bb359c3c5dae3d080de7f31bfd, vars: {}, profile: None, target: None, version: 1.4.3
[0m08:04:06.946535 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:04:06.947151 [debug] [MainThread]: Partial parsing: updated file: dbtlearn://tests/dim_listings_minimum_nights.sql
[0m08:04:06.987309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f3f25d11-6cf4-4ac0-998f-0e8065092db4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe441f39520>]}
[0m08:04:06.995643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f3f25d11-6cf4-4ac0-998f-0e8065092db4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe451d4a460>]}
[0m08:04:06.996001 [info ] [MainThread]: Found 8 models, 6 tests, 1 snapshot, 0 analyses, 304 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
[0m08:04:06.996319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f3f25d11-6cf4-4ac0-998f-0e8065092db4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe451ce9d30>]}
[0m08:04:06.998244 [info ] [MainThread]: 
[0m08:04:06.999770 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:04:07.001317 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_airbnb_dev'
[0m08:04:07.016910 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m08:04:07.017254 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m08:04:07.017507 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:04:10.164311 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 3 seconds
[0m08:04:10.170026 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m08:04:10.895161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f3f25d11-6cf4-4ac0-998f-0e8065092db4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe441ec7880>]}
[0m08:04:10.896485 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:04:10.897067 [info ] [MainThread]: 
[0m08:04:10.904322 [debug] [Thread-1  ]: Began running node test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m08:04:10.904840 [debug] [Thread-2  ]: Began running node test.dbtlearn.dim_listings_minimum_nights
[0m08:04:10.905401 [debug] [Thread-3  ]: Began running node test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m08:04:10.906102 [debug] [Thread-4  ]: Began running node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m08:04:10.905743 [info ] [Thread-1  ]: 1 of 6 START test accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room  [RUN]
[0m08:04:10.906594 [info ] [Thread-2  ]: 2 of 6 START test dim_listings_minimum_nights .................................. [RUN]
[0m08:04:10.907145 [info ] [Thread-3  ]: 3 of 6 START test not_null_dim_listings_cleansed_host_id ....................... [RUN]
[0m08:04:10.907635 [info ] [Thread-4  ]: 4 of 6 START test not_null_dim_listings_cleansed_listing_id .................... [RUN]
[0m08:04:10.908611 [debug] [Thread-1  ]: Acquiring new snowflake connection 'test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af'
[0m08:04:10.909315 [debug] [Thread-2  ]: Acquiring new snowflake connection 'test.dbtlearn.dim_listings_minimum_nights'
[0m08:04:10.909959 [debug] [Thread-3  ]: Acquiring new snowflake connection 'test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be'
[0m08:04:10.910611 [debug] [Thread-4  ]: Acquiring new snowflake connection 'test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9'
[0m08:04:10.910951 [debug] [Thread-1  ]: Began compiling node test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m08:04:10.911245 [debug] [Thread-2  ]: Began compiling node test.dbtlearn.dim_listings_minimum_nights
[0m08:04:10.911499 [debug] [Thread-3  ]: Began compiling node test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m08:04:10.911746 [debug] [Thread-4  ]: Began compiling node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m08:04:10.927668 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbtlearn.dim_listings_minimum_nights"
[0m08:04:10.933541 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m08:04:10.943160 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m08:04:10.948253 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m08:04:10.948935 [debug] [Thread-2  ]: Timing info for test.dbtlearn.dim_listings_minimum_nights (compile): 2023-02-28 08:04:10.924842 => 2023-02-28 08:04:10.948863
[0m08:04:10.949204 [debug] [Thread-2  ]: Began executing node test.dbtlearn.dim_listings_minimum_nights
[0m08:04:10.955788 [debug] [Thread-1  ]: Timing info for test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af (compile): 2023-02-28 08:04:10.911944 => 2023-02-28 08:04:10.955742
[0m08:04:10.956039 [debug] [Thread-1  ]: Began executing node test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m08:04:10.956220 [debug] [Thread-3  ]: Timing info for test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be (compile): 2023-02-28 08:04:10.933787 => 2023-02-28 08:04:10.956187
[0m08:04:10.962275 [debug] [Thread-4  ]: Timing info for test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9 (compile): 2023-02-28 08:04:10.943332 => 2023-02-28 08:04:10.962221
[0m08:04:10.984874 [debug] [Thread-2  ]: Writing runtime sql for node "test.dbtlearn.dim_listings_minimum_nights"
[0m08:04:10.985132 [debug] [Thread-3  ]: Began executing node test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m08:04:10.985608 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m08:04:10.985848 [debug] [Thread-4  ]: Began executing node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m08:04:10.988478 [debug] [Thread-3  ]: Writing runtime sql for node "test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m08:04:10.991173 [debug] [Thread-4  ]: Writing runtime sql for node "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m08:04:10.991848 [debug] [Thread-2  ]: Using snowflake connection "test.dbtlearn.dim_listings_minimum_nights"
[0m08:04:10.992960 [debug] [Thread-1  ]: Using snowflake connection "test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m08:04:10.993257 [debug] [Thread-2  ]: On test.dbtlearn.dim_listings_minimum_nights: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.dim_listings_minimum_nights"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      SELECT * 
FROM airbnb.dev.dim_listings_cleansed
WHERE minimum_nights < 60
LIMIT 10

-- Query is written in such a way that the results returned must be zero to PASS the test.
      
    ) dbt_internal_test
[0m08:04:10.993481 [debug] [Thread-1  ]: On test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        room_type as value_field,
        count(*) as n_records

    from airbnb.dev.dim_listings_cleansed
    group by room_type

)

select *
from all_values
where value_field not in (
    'Entire home/apt','Private room','Shared room','Hotel room'
)



      
    ) dbt_internal_test
[0m08:04:10.994130 [debug] [Thread-3  ]: Using snowflake connection "test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m08:04:10.994303 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m08:04:10.994515 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m08:04:10.995138 [debug] [Thread-4  ]: Using snowflake connection "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m08:04:10.995289 [debug] [Thread-3  ]: On test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select host_id
from airbnb.dev.dim_listings_cleansed
where host_id is null



      
    ) dbt_internal_test
[0m08:04:10.996620 [debug] [Thread-4  ]: On test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select listing_id
from airbnb.dev.dim_listings_cleansed
where listing_id is null



      
    ) dbt_internal_test
[0m08:04:10.997422 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m08:04:10.998183 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m08:04:13.772659 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 3 seconds
[0m08:04:13.798207 [debug] [Thread-4  ]: Timing info for test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9 (execute): 2023-02-28 08:04:10.988797 => 2023-02-28 08:04:13.798080
[0m08:04:13.798710 [debug] [Thread-4  ]: On test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9: Close
[0m08:04:13.835303 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 3 seconds
[0m08:04:13.841123 [debug] [Thread-2  ]: Timing info for test.dbtlearn.dim_listings_minimum_nights (execute): 2023-02-28 08:04:10.949428 => 2023-02-28 08:04:13.841036
[0m08:04:13.841474 [debug] [Thread-2  ]: On test.dbtlearn.dim_listings_minimum_nights: Close
[0m08:04:14.003139 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 3 seconds
[0m08:04:14.009016 [debug] [Thread-3  ]: Timing info for test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be (execute): 2023-02-28 08:04:10.986108 => 2023-02-28 08:04:14.008867
[0m08:04:14.009584 [debug] [Thread-3  ]: On test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be: Close
[0m08:04:14.063425 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 3 seconds
[0m08:04:14.068639 [debug] [Thread-1  ]: Timing info for test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af (execute): 2023-02-28 08:04:10.962442 => 2023-02-28 08:04:14.068493
[0m08:04:14.069358 [debug] [Thread-1  ]: On test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af: Close
[0m08:04:14.512789 [error] [Thread-2  ]: 2 of 6 FAIL 10 dim_listings_minimum_nights ..................................... [[31mFAIL 10[0m in 3.60s]
[0m08:04:14.515992 [debug] [Thread-2  ]: Finished running node test.dbtlearn.dim_listings_minimum_nights
[0m08:04:14.516720 [debug] [Thread-2  ]: Began running node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m08:04:14.518216 [info ] [Thread-2  ]: 5 of 6 START test relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_  [RUN]
[0m08:04:14.520008 [debug] [Thread-2  ]: Acquiring new snowflake connection 'test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad'
[0m08:04:14.520506 [debug] [Thread-2  ]: Began compiling node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m08:04:14.522920 [info ] [Thread-4  ]: 4 of 6 PASS not_null_dim_listings_cleansed_listing_id .......................... [[32mPASS[0m in 3.61s]
[0m08:04:14.523638 [debug] [Thread-4  ]: Finished running node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m08:04:14.530472 [debug] [Thread-4  ]: Began running node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m08:04:14.537323 [info ] [Thread-4  ]: 6 of 6 START test unique_dim_listings_cleansed_listing_id ...................... [RUN]
[0m08:04:14.538625 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m08:04:14.539247 [debug] [Thread-4  ]: Acquiring new snowflake connection 'test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e'
[0m08:04:14.539654 [debug] [Thread-4  ]: Began compiling node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m08:04:14.547933 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m08:04:14.548379 [debug] [Thread-2  ]: Timing info for test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad (compile): 2023-02-28 08:04:14.520812 => 2023-02-28 08:04:14.548314
[0m08:04:14.548651 [debug] [Thread-2  ]: Began executing node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m08:04:14.552085 [debug] [Thread-2  ]: Writing runtime sql for node "test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m08:04:14.552378 [debug] [Thread-4  ]: Timing info for test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e (compile): 2023-02-28 08:04:14.539884 => 2023-02-28 08:04:14.552329
[0m08:04:14.552632 [debug] [Thread-4  ]: Began executing node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m08:04:14.555442 [debug] [Thread-4  ]: Writing runtime sql for node "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m08:04:14.556584 [debug] [Thread-2  ]: Using snowflake connection "test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m08:04:14.556810 [debug] [Thread-2  ]: On test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select host_id as from_field
    from airbnb.dev.dim_listings_cleansed
    where host_id is not null
),

parent as (
    select host_id as to_field
    from airbnb.dev.dim_hosts_cleansed
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m08:04:14.557051 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m08:04:14.558089 [debug] [Thread-4  ]: Using snowflake connection "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m08:04:14.558274 [debug] [Thread-4  ]: On test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    listing_id as unique_field,
    count(*) as n_records

from airbnb.dev.dim_listings_cleansed
where listing_id is not null
group by listing_id
having count(*) > 1



      
    ) dbt_internal_test
[0m08:04:14.559012 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m08:04:14.774899 [info ] [Thread-1  ]: 1 of 6 PASS accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room  [[32mPASS[0m in 3.87s]
[0m08:04:14.776111 [debug] [Thread-1  ]: Finished running node test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m08:04:14.911299 [info ] [Thread-3  ]: 3 of 6 PASS not_null_dim_listings_cleansed_host_id ............................. [[32mPASS[0m in 4.00s]
[0m08:04:14.911765 [debug] [Thread-3  ]: Finished running node test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m08:04:16.831773 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 2 seconds
[0m08:04:16.836968 [debug] [Thread-2  ]: Timing info for test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad (execute): 2023-02-28 08:04:14.548869 => 2023-02-28 08:04:16.836803
[0m08:04:16.838305 [debug] [Thread-2  ]: On test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad: Close
[0m08:04:16.839210 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 2 seconds
[0m08:04:16.844570 [debug] [Thread-4  ]: Timing info for test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e (execute): 2023-02-28 08:04:14.552846 => 2023-02-28 08:04:16.844480
[0m08:04:16.844990 [debug] [Thread-4  ]: On test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e: Close
[0m08:04:17.669051 [info ] [Thread-4  ]: 6 of 6 PASS unique_dim_listings_cleansed_listing_id ............................ [[32mPASS[0m in 3.13s]
[0m08:04:17.670176 [debug] [Thread-4  ]: Finished running node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m08:04:17.681621 [info ] [Thread-2  ]: 5 of 6 PASS relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_  [[32mPASS[0m in 3.16s]
[0m08:04:17.682386 [debug] [Thread-2  ]: Finished running node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m08:04:17.685064 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:04:17.686008 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:04:17.686359 [debug] [MainThread]: Connection 'test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af' was properly closed.
[0m08:04:17.686655 [debug] [MainThread]: Connection 'test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad' was properly closed.
[0m08:04:17.686935 [debug] [MainThread]: Connection 'test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be' was properly closed.
[0m08:04:17.687217 [debug] [MainThread]: Connection 'test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e' was properly closed.
[0m08:04:17.687592 [info ] [MainThread]: 
[0m08:04:17.688115 [info ] [MainThread]: Finished running 6 tests in 0 hours 0 minutes and 10.69 seconds (10.69s).
[0m08:04:17.689103 [debug] [MainThread]: Command end result
[0m08:04:17.700296 [info ] [MainThread]: 
[0m08:04:17.700885 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m08:04:17.701289 [info ] [MainThread]: 
[0m08:04:17.701713 [error] [MainThread]: [31mFailure in test dim_listings_minimum_nights (tests/dim_listings_minimum_nights.sql)[0m
[0m08:04:17.702084 [error] [MainThread]:   Got 10 results, configured to fail if != 0
[0m08:04:17.702415 [info ] [MainThread]: 
[0m08:04:17.702742 [info ] [MainThread]:   compiled Code at target/compiled/dbtlearn/tests/dim_listings_minimum_nights.sql
[0m08:04:17.703112 [info ] [MainThread]: 
[0m08:04:17.703439 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m08:04:17.703935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe451d4aee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe451ce9cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe451ce9dc0>]}
[0m08:04:17.704322 [debug] [MainThread]: Flushing usage events


============================== 2023-02-28 08:06:41.065901 | a8172d91-8982-4e1e-ba8d-c0861eb3c266 ==============================
[0m08:06:41.065901 [info ] [MainThread]: Running with dbt=1.4.3
[0m08:06:41.068362 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/katiehuang/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'select': ['dim_listings_cleansed'], 'which': 'test', 'rpc_method': 'test'}
[0m08:06:41.068695 [debug] [MainThread]: Tracking: tracking
[0m08:06:41.069413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d89b929d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d89b92d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d89b924f0>]}
[0m08:06:41.082859 [debug] [MainThread]: checksum: c7a5cda64f02d8b9dd20ef412f82fbb79fdce1bb359c3c5dae3d080de7f31bfd, vars: {}, profile: None, target: None, version: 1.4.3
[0m08:06:41.130684 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:06:41.130993 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:06:41.139403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a8172d91-8982-4e1e-ba8d-c0861eb3c266', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d99a1b310>]}
[0m08:06:41.149165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a8172d91-8982-4e1e-ba8d-c0861eb3c266', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d78734850>]}
[0m08:06:41.149528 [info ] [MainThread]: Found 8 models, 6 tests, 1 snapshot, 0 analyses, 304 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
[0m08:06:41.149861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a8172d91-8982-4e1e-ba8d-c0861eb3c266', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d78734910>]}
[0m08:06:41.151617 [info ] [MainThread]: 
[0m08:06:41.153153 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:06:41.155092 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_airbnb_dev'
[0m08:06:41.171299 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m08:06:41.171640 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m08:06:41.171875 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:06:44.407864 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 3 seconds
[0m08:06:44.413781 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m08:06:45.712207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a8172d91-8982-4e1e-ba8d-c0861eb3c266', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d787341c0>]}
[0m08:06:45.713603 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:06:45.714210 [info ] [MainThread]: 
[0m08:06:45.721528 [debug] [Thread-1  ]: Began running node test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m08:06:45.722054 [debug] [Thread-2  ]: Began running node test.dbtlearn.dim_listings_minimum_nights
[0m08:06:45.722452 [debug] [Thread-3  ]: Began running node test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m08:06:45.722818 [info ] [Thread-1  ]: 1 of 6 START test accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room  [RUN]
[0m08:06:45.723612 [debug] [Thread-4  ]: Began running node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m08:06:45.723901 [info ] [Thread-2  ]: 2 of 6 START test dim_listings_minimum_nights .................................. [RUN]
[0m08:06:45.724485 [info ] [Thread-3  ]: 3 of 6 START test not_null_dim_listings_cleansed_host_id ....................... [RUN]
[0m08:06:45.725543 [debug] [Thread-1  ]: Acquiring new snowflake connection 'test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af'
[0m08:06:45.725928 [info ] [Thread-4  ]: 4 of 6 START test not_null_dim_listings_cleansed_listing_id .................... [RUN]
[0m08:06:45.726825 [debug] [Thread-2  ]: Acquiring new snowflake connection 'test.dbtlearn.dim_listings_minimum_nights'
[0m08:06:45.727526 [debug] [Thread-3  ]: Acquiring new snowflake connection 'test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be'
[0m08:06:45.727894 [debug] [Thread-1  ]: Began compiling node test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m08:06:45.728698 [debug] [Thread-4  ]: Acquiring new snowflake connection 'test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9'
[0m08:06:45.729061 [debug] [Thread-2  ]: Began compiling node test.dbtlearn.dim_listings_minimum_nights
[0m08:06:45.729379 [debug] [Thread-3  ]: Began compiling node test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m08:06:45.783613 [debug] [Thread-4  ]: Began compiling node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m08:06:45.793530 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m08:06:45.796130 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbtlearn.dim_listings_minimum_nights"
[0m08:06:45.805710 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m08:06:45.809756 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m08:06:45.813241 [debug] [Thread-1  ]: Timing info for test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af (compile): 2023-02-28 08:06:45.729644 => 2023-02-28 08:06:45.813160
[0m08:06:45.813529 [debug] [Thread-1  ]: Began executing node test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m08:06:45.813749 [debug] [Thread-2  ]: Timing info for test.dbtlearn.dim_listings_minimum_nights (compile): 2023-02-28 08:06:45.793788 => 2023-02-28 08:06:45.813693
[0m08:06:45.813939 [debug] [Thread-4  ]: Timing info for test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9 (compile): 2023-02-28 08:06:45.805893 => 2023-02-28 08:06:45.813904
[0m08:06:45.814096 [debug] [Thread-3  ]: Timing info for test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be (compile): 2023-02-28 08:06:45.796335 => 2023-02-28 08:06:45.814065
[0m08:06:45.825674 [debug] [Thread-2  ]: Began executing node test.dbtlearn.dim_listings_minimum_nights
[0m08:06:45.836457 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m08:06:45.836734 [debug] [Thread-4  ]: Began executing node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m08:06:45.836956 [debug] [Thread-3  ]: Began executing node test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m08:06:45.839477 [debug] [Thread-2  ]: Writing runtime sql for node "test.dbtlearn.dim_listings_minimum_nights"
[0m08:06:45.842128 [debug] [Thread-4  ]: Writing runtime sql for node "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m08:06:45.844570 [debug] [Thread-3  ]: Writing runtime sql for node "test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m08:06:45.845622 [debug] [Thread-1  ]: Using snowflake connection "test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m08:06:45.846074 [debug] [Thread-1  ]: On test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        room_type as value_field,
        count(*) as n_records

    from airbnb.dev.dim_listings_cleansed
    group by room_type

)

select *
from all_values
where value_field not in (
    'Entire home/apt','Private room','Shared room','Hotel room'
)



      
    ) dbt_internal_test
[0m08:06:45.846385 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m08:06:45.847063 [debug] [Thread-2  ]: Using snowflake connection "test.dbtlearn.dim_listings_minimum_nights"
[0m08:06:45.847661 [debug] [Thread-4  ]: Using snowflake connection "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m08:06:45.848549 [debug] [Thread-3  ]: Using snowflake connection "test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m08:06:45.849258 [debug] [Thread-2  ]: On test.dbtlearn.dim_listings_minimum_nights: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.dim_listings_minimum_nights"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      SELECT * 
FROM airbnb.dev.dim_listings_cleansed
WHERE minimum_nights < 60
LIMIT 10

-- Query is written in such a way that the results returned must be zero to PASS the test.
      
    ) dbt_internal_test
[0m08:06:45.849455 [debug] [Thread-4  ]: On test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select listing_id
from airbnb.dev.dim_listings_cleansed
where listing_id is null



      
    ) dbt_internal_test
[0m08:06:45.850147 [debug] [Thread-3  ]: On test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select host_id
from airbnb.dev.dim_listings_cleansed
where host_id is null



      
    ) dbt_internal_test
[0m08:06:45.850365 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m08:06:45.850558 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m08:06:45.850745 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m08:06:48.621900 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 3 seconds
[0m08:06:48.648930 [debug] [Thread-2  ]: Timing info for test.dbtlearn.dim_listings_minimum_nights (execute): 2023-02-28 08:06:45.837111 => 2023-02-28 08:06:48.648814
[0m08:06:48.649380 [debug] [Thread-2  ]: On test.dbtlearn.dim_listings_minimum_nights: Close
[0m08:06:48.652036 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 3 seconds
[0m08:06:48.654440 [debug] [Thread-4  ]: Timing info for test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9 (execute): 2023-02-28 08:06:45.839738 => 2023-02-28 08:06:48.654373
[0m08:06:48.655332 [debug] [Thread-4  ]: On test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9: Close
[0m08:06:49.015031 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 3 seconds
[0m08:06:49.019730 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 3 seconds
[0m08:06:49.023175 [debug] [Thread-1  ]: Timing info for test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af (execute): 2023-02-28 08:06:45.814225 => 2023-02-28 08:06:49.023077
[0m08:06:49.026925 [debug] [Thread-3  ]: Timing info for test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be (execute): 2023-02-28 08:06:45.842320 => 2023-02-28 08:06:49.026832
[0m08:06:49.028076 [debug] [Thread-1  ]: On test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af: Close
[0m08:06:49.029187 [debug] [Thread-3  ]: On test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be: Close
[0m08:06:49.396475 [error] [Thread-2  ]: 2 of 6 FAIL 10 dim_listings_minimum_nights ..................................... [[31mFAIL 10[0m in 3.67s]
[0m08:06:49.399496 [debug] [Thread-2  ]: Finished running node test.dbtlearn.dim_listings_minimum_nights
[0m08:06:49.400289 [debug] [Thread-2  ]: Began running node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m08:06:49.401164 [info ] [Thread-2  ]: 5 of 6 START test relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_  [RUN]
[0m08:06:49.402318 [debug] [Thread-2  ]: Acquiring new snowflake connection 'test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad'
[0m08:06:49.402792 [debug] [Thread-2  ]: Began compiling node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m08:06:49.419224 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m08:06:49.420135 [info ] [Thread-4  ]: 4 of 6 PASS not_null_dim_listings_cleansed_listing_id .......................... [[32mPASS[0m in 3.69s]
[0m08:06:49.420862 [debug] [Thread-4  ]: Finished running node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m08:06:49.421372 [debug] [Thread-4  ]: Began running node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m08:06:49.421846 [info ] [Thread-4  ]: 6 of 6 START test unique_dim_listings_cleansed_listing_id ...................... [RUN]
[0m08:06:49.422707 [debug] [Thread-4  ]: Acquiring new snowflake connection 'test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e'
[0m08:06:49.423011 [debug] [Thread-4  ]: Began compiling node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m08:06:49.429596 [debug] [Thread-2  ]: Timing info for test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad (compile): 2023-02-28 08:06:49.404100 => 2023-02-28 08:06:49.429517
[0m08:06:49.431921 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m08:06:49.432194 [debug] [Thread-2  ]: Began executing node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m08:06:49.435264 [debug] [Thread-2  ]: Writing runtime sql for node "test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m08:06:49.435715 [debug] [Thread-4  ]: Timing info for test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e (compile): 2023-02-28 08:06:49.423229 => 2023-02-28 08:06:49.435645
[0m08:06:49.436036 [debug] [Thread-4  ]: Began executing node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m08:06:49.439092 [debug] [Thread-4  ]: Writing runtime sql for node "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m08:06:49.440243 [debug] [Thread-2  ]: Using snowflake connection "test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m08:06:49.440515 [debug] [Thread-2  ]: On test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select host_id as from_field
    from airbnb.dev.dim_listings_cleansed
    where host_id is not null
),

parent as (
    select host_id as to_field
    from airbnb.dev.dim_hosts_cleansed
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m08:06:49.440741 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m08:06:49.441780 [debug] [Thread-4  ]: Using snowflake connection "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m08:06:49.441982 [debug] [Thread-4  ]: On test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    listing_id as unique_field,
    count(*) as n_records

from airbnb.dev.dim_listings_cleansed
where listing_id is not null
group by listing_id
having count(*) > 1



      
    ) dbt_internal_test
[0m08:06:49.442727 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m08:06:49.700046 [info ] [Thread-1  ]: 1 of 6 PASS accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room  [[32mPASS[0m in 3.97s]
[0m08:06:49.701085 [debug] [Thread-1  ]: Finished running node test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m08:06:49.712006 [info ] [Thread-3  ]: 3 of 6 PASS not_null_dim_listings_cleansed_host_id ............................. [[32mPASS[0m in 3.98s]
[0m08:06:49.712700 [debug] [Thread-3  ]: Finished running node test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m08:06:51.741288 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 2 seconds
[0m08:06:51.742977 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 2 seconds
[0m08:06:51.748065 [debug] [Thread-2  ]: Timing info for test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad (execute): 2023-02-28 08:06:49.432508 => 2023-02-28 08:06:51.747937
[0m08:06:51.751174 [debug] [Thread-4  ]: Timing info for test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e (execute): 2023-02-28 08:06:49.436272 => 2023-02-28 08:06:51.751087
[0m08:06:51.751630 [debug] [Thread-2  ]: On test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad: Close
[0m08:06:51.751994 [debug] [Thread-4  ]: On test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e: Close
[0m08:06:52.704709 [info ] [Thread-2  ]: 5 of 6 PASS relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_  [[32mPASS[0m in 3.30s]
[0m08:06:52.706981 [info ] [Thread-4  ]: 6 of 6 PASS unique_dim_listings_cleansed_listing_id ............................ [[32mPASS[0m in 3.28s]
[0m08:06:52.707815 [debug] [Thread-2  ]: Finished running node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m08:06:52.708430 [debug] [Thread-4  ]: Finished running node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m08:06:52.711443 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:06:52.712365 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:06:52.712698 [debug] [MainThread]: Connection 'test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af' was properly closed.
[0m08:06:52.712997 [debug] [MainThread]: Connection 'test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad' was properly closed.
[0m08:06:52.713282 [debug] [MainThread]: Connection 'test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be' was properly closed.
[0m08:06:52.713563 [debug] [MainThread]: Connection 'test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e' was properly closed.
[0m08:06:52.713928 [info ] [MainThread]: 
[0m08:06:52.714438 [info ] [MainThread]: Finished running 6 tests in 0 hours 0 minutes and 11.56 seconds (11.56s).
[0m08:06:52.715424 [debug] [MainThread]: Command end result
[0m08:06:52.726922 [info ] [MainThread]: 
[0m08:06:52.727500 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m08:06:52.727910 [info ] [MainThread]: 
[0m08:06:52.728319 [error] [MainThread]: [31mFailure in test dim_listings_minimum_nights (tests/dim_listings_minimum_nights.sql)[0m
[0m08:06:52.728721 [error] [MainThread]:   Got 10 results, configured to fail if != 0
[0m08:06:52.729094 [info ] [MainThread]: 
[0m08:06:52.729465 [info ] [MainThread]:   compiled Code at target/compiled/dbtlearn/tests/dim_listings_minimum_nights.sql
[0m08:06:52.729837 [info ] [MainThread]: 
[0m08:06:52.730158 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m08:06:52.730619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d89b45b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d89bf59a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d89bf5fd0>]}
[0m08:06:52.731021 [debug] [MainThread]: Flushing usage events


============================== 2023-02-28 08:07:10.372136 | 25ee70a8-df39-47be-bf7e-5b0cabb1e2d5 ==============================
[0m08:07:10.372136 [info ] [MainThread]: Running with dbt=1.4.3
[0m08:07:10.374507 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/katiehuang/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'select': ['dim_hosts_cleansed'], 'which': 'test', 'rpc_method': 'test'}
[0m08:07:10.374808 [debug] [MainThread]: Tracking: tracking
[0m08:07:10.375645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9717057f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd971705e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9717055b0>]}
[0m08:07:10.388238 [debug] [MainThread]: checksum: c7a5cda64f02d8b9dd20ef412f82fbb79fdce1bb359c3c5dae3d080de7f31bfd, vars: {}, profile: None, target: None, version: 1.4.3
[0m08:07:10.433279 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:07:10.433854 [debug] [MainThread]: Partial parsing: updated file: dbtlearn://tests/dim_listings_minimum_nights.sql
[0m08:07:10.474028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '25ee70a8-df39-47be-bf7e-5b0cabb1e2d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd971767640>]}
[0m08:07:10.482289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '25ee70a8-df39-47be-bf7e-5b0cabb1e2d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9505c2550>]}
[0m08:07:10.482651 [info ] [MainThread]: Found 8 models, 6 tests, 1 snapshot, 0 analyses, 304 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
[0m08:07:10.482970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '25ee70a8-df39-47be-bf7e-5b0cabb1e2d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd950561e50>]}
[0m08:07:10.484503 [info ] [MainThread]: 
[0m08:07:10.486022 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:07:10.487423 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_airbnb_dev'
[0m08:07:10.502689 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m08:07:10.503019 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m08:07:10.503273 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:07:13.466835 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 3 seconds
[0m08:07:13.471724 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m08:07:14.215735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '25ee70a8-df39-47be-bf7e-5b0cabb1e2d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9505c2d30>]}
[0m08:07:14.217056 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:07:14.217645 [info ] [MainThread]: 
[0m08:07:14.225777 [debug] [Thread-1  ]: Began running node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m08:07:14.226230 [info ] [Thread-1  ]: 1 of 1 START test relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_  [RUN]
[0m08:07:14.227149 [debug] [Thread-1  ]: Acquiring new snowflake connection 'test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad'
[0m08:07:14.227494 [debug] [Thread-1  ]: Began compiling node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m08:07:14.245889 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m08:07:14.246636 [debug] [Thread-1  ]: Timing info for test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad (compile): 2023-02-28 08:07:14.227736 => 2023-02-28 08:07:14.246552
[0m08:07:14.246920 [debug] [Thread-1  ]: Began executing node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m08:07:14.271754 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m08:07:14.273105 [debug] [Thread-1  ]: Using snowflake connection "test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m08:07:14.273300 [debug] [Thread-1  ]: On test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select host_id as from_field
    from airbnb.dev.dim_listings_cleansed
    where host_id is not null
),

parent as (
    select host_id as to_field
    from airbnb.dev.dim_hosts_cleansed
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m08:07:14.273482 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m08:07:16.607663 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2 seconds
[0m08:07:16.633413 [debug] [Thread-1  ]: Timing info for test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad (execute): 2023-02-28 08:07:14.247107 => 2023-02-28 08:07:16.633297
[0m08:07:16.633868 [debug] [Thread-1  ]: On test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad: Close
[0m08:07:17.514006 [info ] [Thread-1  ]: 1 of 1 PASS relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_  [[32mPASS[0m in 3.29s]
[0m08:07:17.517384 [debug] [Thread-1  ]: Finished running node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m08:07:17.520765 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:07:17.521708 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:07:17.522050 [debug] [MainThread]: Connection 'test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad' was properly closed.
[0m08:07:17.522414 [info ] [MainThread]: 
[0m08:07:17.522959 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 7.04 seconds (7.04s).
[0m08:07:17.523630 [debug] [MainThread]: Command end result
[0m08:07:17.534772 [info ] [MainThread]: 
[0m08:07:17.535322 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:07:17.535735 [info ] [MainThread]: 
[0m08:07:17.536125 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m08:07:17.536609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd971767880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9505c2fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd950561df0>]}
[0m08:07:17.537025 [debug] [MainThread]: Flushing usage events


============================== 2023-02-28 08:13:22.693747 | 998671af-e9b3-4797-8f6d-31a85601251d ==============================
[0m08:13:22.693747 [info ] [MainThread]: Running with dbt=1.4.3
[0m08:13:22.696131 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/katiehuang/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'select': ['SELECT', 'consistent_created_at'], 'which': 'test', 'rpc_method': 'test'}
[0m08:13:22.696544 [debug] [MainThread]: Tracking: tracking
[0m08:13:22.697308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf41379a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf41379e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf41379d00>]}
[0m08:13:22.710915 [debug] [MainThread]: checksum: c7a5cda64f02d8b9dd20ef412f82fbb79fdce1bb359c3c5dae3d080de7f31bfd, vars: {}, profile: None, target: None, version: 1.4.3
[0m08:13:22.766034 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m08:13:22.766563 [debug] [MainThread]: Partial parsing: added file: dbtlearn://tests/consistent_created_at.sql
[0m08:13:22.807727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '998671af-e9b3-4797-8f6d-31a85601251d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf41366700>]}
[0m08:13:22.817132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '998671af-e9b3-4797-8f6d-31a85601251d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf5033cdf0>]}
[0m08:13:22.817517 [info ] [MainThread]: Found 8 models, 7 tests, 1 snapshot, 0 analyses, 304 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
[0m08:13:22.817853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '998671af-e9b3-4797-8f6d-31a85601251d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf5033c070>]}
[0m08:13:22.818871 [warn ] [MainThread]: The selection criterion 'SELECT' does not match any nodes
[0m08:13:22.820300 [info ] [MainThread]: 
[0m08:13:22.822035 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:13:22.825715 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_airbnb_dev'
[0m08:13:22.841287 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m08:13:22.841623 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m08:13:22.841866 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:13:26.540408 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 4 seconds
[0m08:13:26.545425 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m08:13:27.469418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '998671af-e9b3-4797-8f6d-31a85601251d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf41379ac0>]}
[0m08:13:27.470507 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:13:27.470991 [info ] [MainThread]: 
[0m08:13:27.476904 [debug] [Thread-1  ]: Began running node test.dbtlearn.consistent_created_at
[0m08:13:27.477292 [info ] [Thread-1  ]: 1 of 1 START test consistent_created_at ........................................ [RUN]
[0m08:13:27.478094 [debug] [Thread-1  ]: Acquiring new snowflake connection 'test.dbtlearn.consistent_created_at'
[0m08:13:27.478388 [debug] [Thread-1  ]: Began compiling node test.dbtlearn.consistent_created_at
[0m08:13:27.480753 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbtlearn.consistent_created_at"
[0m08:13:27.481754 [debug] [Thread-1  ]: Timing info for test.dbtlearn.consistent_created_at (compile): 2023-02-28 08:13:27.478595 => 2023-02-28 08:13:27.481663
[0m08:13:27.482095 [debug] [Thread-1  ]: Began executing node test.dbtlearn.consistent_created_at
[0m08:13:27.509539 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbtlearn.consistent_created_at"
[0m08:13:27.510795 [debug] [Thread-1  ]: Using snowflake connection "test.dbtlearn.consistent_created_at"
[0m08:13:27.511001 [debug] [Thread-1  ]: On test.dbtlearn.consistent_created_at: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.consistent_created_at"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- Checks that there is no review date that is submitted before its listing was created

SELECT *
FROM AIRBNB.DEV.DIM_LISTINGS_CLEANSED AS listings
LEFT JOIN AIRBNB.DEV.FCT_REVIEWS AS reviews
	ON listings.listing_id = reviews.listing_id
WHERE reviews.review_date <  listings.created_at
      
    ) dbt_internal_test
[0m08:13:27.511187 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m08:13:30.434985 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 3 seconds
[0m08:13:30.461830 [debug] [Thread-1  ]: Timing info for test.dbtlearn.consistent_created_at (execute): 2023-02-28 08:13:27.482318 => 2023-02-28 08:13:30.461696
[0m08:13:30.462286 [debug] [Thread-1  ]: On test.dbtlearn.consistent_created_at: Close
[0m08:13:31.460871 [info ] [Thread-1  ]: 1 of 1 PASS consistent_created_at .............................................. [[32mPASS[0m in 3.98s]
[0m08:13:31.464903 [debug] [Thread-1  ]: Finished running node test.dbtlearn.consistent_created_at
[0m08:13:31.468260 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:13:31.469228 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:13:31.469581 [debug] [MainThread]: Connection 'test.dbtlearn.consistent_created_at' was properly closed.
[0m08:13:31.469960 [info ] [MainThread]: 
[0m08:13:31.470518 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 8.65 seconds (8.65s).
[0m08:13:31.471212 [debug] [MainThread]: Command end result
[0m08:13:31.484704 [info ] [MainThread]: 
[0m08:13:31.485331 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:13:31.485787 [info ] [MainThread]: 
[0m08:13:31.486209 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m08:13:31.486673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf50422d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf416b3be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf416b30d0>]}
[0m08:13:31.487040 [debug] [MainThread]: Flushing usage events


============================== 2023-02-28 08:39:03.278800 | 9b09deb7-9a6a-4291-b6c3-9318cfb5daee ==============================
[0m08:39:03.278800 [info ] [MainThread]: Running with dbt=1.4.3
[0m08:39:03.281471 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/katiehuang/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'select': ['dim_listings_cleansed'], 'which': 'test', 'rpc_method': 'test'}
[0m08:39:03.282058 [debug] [MainThread]: Tracking: tracking
[0m08:39:03.282951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3491748e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb349174970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb349174820>]}
[0m08:39:03.295774 [debug] [MainThread]: checksum: c7a5cda64f02d8b9dd20ef412f82fbb79fdce1bb359c3c5dae3d080de7f31bfd, vars: {}, profile: None, target: None, version: 1.4.3
[0m08:39:03.343353 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 1 files changed.
[0m08:39:03.343875 [debug] [MainThread]: Partial parsing: added file: dbtlearn://macros/no_nulls_in_columns.sql
[0m08:39:03.344133 [debug] [MainThread]: Partial parsing: added file: dbtlearn://tests/no_nulls_in_dim_listings.sql
[0m08:39:03.344425 [debug] [MainThread]: Partial parsing: updated file: dbtlearn://tests/consistent_created_at.sql
[0m08:39:03.393560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9b09deb7-9a6a-4291-b6c3-9318cfb5daee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3491f43a0>]}
[0m08:39:03.402365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9b09deb7-9a6a-4291-b6c3-9318cfb5daee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb35a5c7f10>]}
[0m08:39:03.402770 [info ] [MainThread]: Found 8 models, 8 tests, 1 snapshot, 0 analyses, 305 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
[0m08:39:03.403101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9b09deb7-9a6a-4291-b6c3-9318cfb5daee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb35a5f1ee0>]}
[0m08:39:03.405041 [info ] [MainThread]: 
[0m08:39:03.406614 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:39:03.408735 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_airbnb_dev'
[0m08:39:03.424550 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m08:39:03.424923 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m08:39:03.425182 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:39:06.613429 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 3 seconds
[0m08:39:06.618232 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m08:39:07.419771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9b09deb7-9a6a-4291-b6c3-9318cfb5daee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb35a5f1ee0>]}
[0m08:39:07.421223 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:39:07.421838 [info ] [MainThread]: 
[0m08:39:07.429018 [debug] [Thread-1  ]: Began running node test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m08:39:07.429657 [debug] [Thread-2  ]: Began running node test.dbtlearn.consistent_created_at
[0m08:39:07.430659 [debug] [Thread-3  ]: Began running node test.dbtlearn.dim_listings_minimum_nights
[0m08:39:07.431053 [debug] [Thread-4  ]: Began running node test.dbtlearn.no_nulls_in_dim_listings
[0m08:39:07.430240 [info ] [Thread-1  ]: 1 of 8 START test accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room  [RUN]
[0m08:39:07.431573 [info ] [Thread-2  ]: 2 of 8 START test consistent_created_at ........................................ [RUN]
[0m08:39:07.432105 [info ] [Thread-3  ]: 3 of 8 START test dim_listings_minimum_nights .................................. [RUN]
[0m08:39:07.433533 [debug] [Thread-1  ]: Acquiring new snowflake connection 'test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af'
[0m08:39:07.432684 [info ] [Thread-4  ]: 4 of 8 START test no_nulls_in_dim_listings ..................................... [RUN]
[0m08:39:07.434463 [debug] [Thread-2  ]: Acquiring new snowflake connection 'test.dbtlearn.consistent_created_at'
[0m08:39:07.435169 [debug] [Thread-3  ]: Acquiring new snowflake connection 'test.dbtlearn.dim_listings_minimum_nights'
[0m08:39:07.435516 [debug] [Thread-1  ]: Began compiling node test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m08:39:07.436284 [debug] [Thread-4  ]: Acquiring new snowflake connection 'test.dbtlearn.no_nulls_in_dim_listings'
[0m08:39:07.436628 [debug] [Thread-2  ]: Began compiling node test.dbtlearn.consistent_created_at
[0m08:39:07.436951 [debug] [Thread-3  ]: Began compiling node test.dbtlearn.dim_listings_minimum_nights
[0m08:39:07.449861 [debug] [Thread-4  ]: Began compiling node test.dbtlearn.no_nulls_in_dim_listings
[0m08:39:07.456448 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m08:39:07.459427 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbtlearn.consistent_created_at"
[0m08:39:07.462720 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbtlearn.dim_listings_minimum_nights"
[0m08:39:07.473887 [debug] [Thread-4  ]: Using snowflake connection "test.dbtlearn.no_nulls_in_dim_listings"
[0m08:39:07.474331 [debug] [Thread-4  ]: On test.dbtlearn.no_nulls_in_dim_listings: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.no_nulls_in_dim_listings"} */
describe table airbnb.dev.dim_listings_cleansed
[0m08:39:07.474624 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m08:39:07.476137 [debug] [Thread-2  ]: Timing info for test.dbtlearn.consistent_created_at (compile): 2023-02-28 08:39:07.456660 => 2023-02-28 08:39:07.476061
[0m08:39:07.476526 [debug] [Thread-2  ]: Began executing node test.dbtlearn.consistent_created_at
[0m08:39:07.476770 [debug] [Thread-1  ]: Timing info for test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af (compile): 2023-02-28 08:39:07.437195 => 2023-02-28 08:39:07.476730
[0m08:39:07.482649 [debug] [Thread-3  ]: Timing info for test.dbtlearn.dim_listings_minimum_nights (compile): 2023-02-28 08:39:07.459627 => 2023-02-28 08:39:07.482606
[0m08:39:07.496079 [debug] [Thread-1  ]: Began executing node test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m08:39:07.501900 [debug] [Thread-2  ]: Writing runtime sql for node "test.dbtlearn.consistent_created_at"
[0m08:39:07.502186 [debug] [Thread-3  ]: Began executing node test.dbtlearn.dim_listings_minimum_nights
[0m08:39:07.504547 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m08:39:07.507296 [debug] [Thread-3  ]: Writing runtime sql for node "test.dbtlearn.dim_listings_minimum_nights"
[0m08:39:07.508459 [debug] [Thread-2  ]: Using snowflake connection "test.dbtlearn.consistent_created_at"
[0m08:39:07.508730 [debug] [Thread-2  ]: On test.dbtlearn.consistent_created_at: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.consistent_created_at"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- Checks that there is no review date that is submitted before its listing was created

SELECT *
FROM airbnb.dev.dim_listings_cleansed AS listings
INNER JOIN airbnb.dev.fct_reviews AS reviews
	USING (listing_id)
WHERE reviews.review_date <=  listings.created_at
      
    ) dbt_internal_test
[0m08:39:07.509666 [debug] [Thread-1  ]: Using snowflake connection "test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m08:39:07.509861 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m08:39:07.510075 [debug] [Thread-1  ]: On test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        room_type as value_field,
        count(*) as n_records

    from airbnb.dev.dim_listings_cleansed
    group by room_type

)

select *
from all_values
where value_field not in (
    'Entire home/apt','Private room','Shared room','Hotel room'
)



      
    ) dbt_internal_test
[0m08:39:07.510663 [debug] [Thread-3  ]: Using snowflake connection "test.dbtlearn.dim_listings_minimum_nights"
[0m08:39:07.511496 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m08:39:07.511698 [debug] [Thread-3  ]: On test.dbtlearn.dim_listings_minimum_nights: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.dim_listings_minimum_nights"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      SELECT * 
FROM airbnb.dev.dim_listings_cleansed
WHERE minimum_nights < 1
LIMIT 10

-- Query is written in such a way that the results returned must be zero to PASS the test.
      
    ) dbt_internal_test
[0m08:39:07.513095 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m08:39:10.337213 [debug] [Thread-4  ]: SQL status: SUCCESS 8 in 3 seconds
[0m08:39:10.338307 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 3 seconds
[0m08:39:10.350309 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbtlearn.no_nulls_in_dim_listings"
[0m08:39:10.377017 [debug] [Thread-1  ]: Timing info for test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af (execute): 2023-02-28 08:39:07.502374 => 2023-02-28 08:39:10.376885
[0m08:39:10.377573 [debug] [Thread-1  ]: On test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af: Close
[0m08:39:10.379962 [debug] [Thread-4  ]: Timing info for test.dbtlearn.no_nulls_in_dim_listings (compile): 2023-02-28 08:39:07.462930 => 2023-02-28 08:39:10.379865
[0m08:39:10.381131 [debug] [Thread-4  ]: Began executing node test.dbtlearn.no_nulls_in_dim_listings
[0m08:39:10.384846 [debug] [Thread-4  ]: Writing runtime sql for node "test.dbtlearn.no_nulls_in_dim_listings"
[0m08:39:10.387318 [debug] [Thread-4  ]: Using snowflake connection "test.dbtlearn.no_nulls_in_dim_listings"
[0m08:39:10.387619 [debug] [Thread-4  ]: On test.dbtlearn.no_nulls_in_dim_listings: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.no_nulls_in_dim_listings"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

    SELECT * 
    FROM airbnb.dev.dim_listings_cleansed
    WHERE
        LISTING_ID IS NULL OR
        LISTING_NAME IS NULL OR
        ROOM_TYPE IS NULL OR
        MINIMUM_NIGHTS IS NULL OR
        HOST_ID IS NULL OR
        PRICE IS NULL OR
        CREATED_AT IS NULL OR
        UPDATED_AT IS NULL OR
        
        FALSE -- To terminates the iteration

      
    ) dbt_internal_test
[0m08:39:10.490095 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 3 seconds
[0m08:39:10.497563 [debug] [Thread-3  ]: Timing info for test.dbtlearn.dim_listings_minimum_nights (execute): 2023-02-28 08:39:07.505166 => 2023-02-28 08:39:10.497206
[0m08:39:10.498628 [debug] [Thread-3  ]: On test.dbtlearn.dim_listings_minimum_nights: Close
[0m08:39:11.096320 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 1 seconds
[0m08:39:11.100961 [debug] [Thread-4  ]: Timing info for test.dbtlearn.no_nulls_in_dim_listings (execute): 2023-02-28 08:39:10.381516 => 2023-02-28 08:39:11.100821
[0m08:39:11.102929 [debug] [Thread-4  ]: On test.dbtlearn.no_nulls_in_dim_listings: Close
[0m08:39:11.125270 [info ] [Thread-1  ]: 1 of 8 PASS accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room  [[32mPASS[0m in 3.69s]
[0m08:39:11.129613 [debug] [Thread-1  ]: Finished running node test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m08:39:11.130661 [debug] [Thread-1  ]: Began running node test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m08:39:11.131857 [info ] [Thread-1  ]: 5 of 8 START test not_null_dim_listings_cleansed_host_id ....................... [RUN]
[0m08:39:11.133275 [debug] [Thread-1  ]: Acquiring new snowflake connection 'test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be'
[0m08:39:11.133692 [debug] [Thread-1  ]: Began compiling node test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m08:39:11.146675 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m08:39:11.147968 [debug] [Thread-1  ]: Timing info for test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be (compile): 2023-02-28 08:39:11.133973 => 2023-02-28 08:39:11.147876
[0m08:39:11.148343 [debug] [Thread-1  ]: Began executing node test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m08:39:11.151490 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m08:39:11.152956 [debug] [Thread-1  ]: Using snowflake connection "test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m08:39:11.153249 [debug] [Thread-1  ]: On test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select host_id
from airbnb.dev.dim_listings_cleansed
where host_id is null



      
    ) dbt_internal_test
[0m08:39:11.153485 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m08:39:11.503064 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 4 seconds
[0m08:39:11.504334 [info ] [Thread-3  ]: 3 of 8 PASS dim_listings_minimum_nights ........................................ [[32mPASS[0m in 4.07s]
[0m08:39:11.507625 [debug] [Thread-2  ]: Timing info for test.dbtlearn.consistent_created_at (execute): 2023-02-28 08:39:07.476922 => 2023-02-28 08:39:11.507544
[0m08:39:11.508736 [debug] [Thread-3  ]: Finished running node test.dbtlearn.dim_listings_minimum_nights
[0m08:39:11.509103 [debug] [Thread-2  ]: On test.dbtlearn.consistent_created_at: Close
[0m08:39:11.509993 [debug] [Thread-3  ]: Began running node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m08:39:11.512343 [info ] [Thread-3  ]: 6 of 8 START test not_null_dim_listings_cleansed_listing_id .................... [RUN]
[0m08:39:11.513397 [debug] [Thread-3  ]: Acquiring new snowflake connection 'test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9'
[0m08:39:11.514498 [debug] [Thread-3  ]: Began compiling node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m08:39:11.520925 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m08:39:11.522243 [debug] [Thread-3  ]: Timing info for test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9 (compile): 2023-02-28 08:39:11.514841 => 2023-02-28 08:39:11.522168
[0m08:39:11.522772 [debug] [Thread-3  ]: Began executing node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m08:39:11.525411 [debug] [Thread-3  ]: Writing runtime sql for node "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m08:39:11.526627 [debug] [Thread-3  ]: Using snowflake connection "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m08:39:11.527002 [debug] [Thread-3  ]: On test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select listing_id
from airbnb.dev.dim_listings_cleansed
where listing_id is null



      
    ) dbt_internal_test
[0m08:39:11.527287 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m08:39:11.874698 [info ] [Thread-4  ]: 4 of 8 PASS no_nulls_in_dim_listings ........................................... [[32mPASS[0m in 4.44s]
[0m08:39:11.876253 [debug] [Thread-4  ]: Finished running node test.dbtlearn.no_nulls_in_dim_listings
[0m08:39:11.876717 [debug] [Thread-4  ]: Began running node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m08:39:11.877136 [info ] [Thread-4  ]: 7 of 8 START test relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_  [RUN]
[0m08:39:11.878260 [debug] [Thread-4  ]: Acquiring new snowflake connection 'test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad'
[0m08:39:11.878806 [debug] [Thread-4  ]: Began compiling node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m08:39:11.892335 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m08:39:11.893124 [debug] [Thread-4  ]: Timing info for test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad (compile): 2023-02-28 08:39:11.879076 => 2023-02-28 08:39:11.893041
[0m08:39:11.893478 [debug] [Thread-4  ]: Began executing node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m08:39:11.896826 [debug] [Thread-4  ]: Writing runtime sql for node "test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m08:39:11.899074 [debug] [Thread-4  ]: Using snowflake connection "test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m08:39:11.899330 [debug] [Thread-4  ]: On test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select host_id as from_field
    from airbnb.dev.dim_listings_cleansed
    where host_id is not null
),

parent as (
    select host_id as to_field
    from airbnb.dev.dim_hosts_cleansed
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m08:39:11.899561 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m08:39:12.234690 [info ] [Thread-2  ]: 2 of 8 PASS consistent_created_at .............................................. [[32mPASS[0m in 4.80s]
[0m08:39:12.248161 [debug] [Thread-2  ]: Finished running node test.dbtlearn.consistent_created_at
[0m08:39:12.254976 [debug] [Thread-2  ]: Began running node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m08:39:12.261114 [info ] [Thread-2  ]: 8 of 8 START test unique_dim_listings_cleansed_listing_id ...................... [RUN]
[0m08:39:12.280760 [debug] [Thread-2  ]: Acquiring new snowflake connection 'test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e'
[0m08:39:12.293673 [debug] [Thread-2  ]: Began compiling node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m08:39:12.312172 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m08:39:12.356840 [debug] [Thread-2  ]: Timing info for test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e (compile): 2023-02-28 08:39:12.293895 => 2023-02-28 08:39:12.356744
[0m08:39:12.369664 [debug] [Thread-2  ]: Began executing node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m08:39:12.378535 [debug] [Thread-2  ]: Writing runtime sql for node "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m08:39:12.395870 [debug] [Thread-2  ]: Using snowflake connection "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m08:39:12.402394 [debug] [Thread-2  ]: On test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    listing_id as unique_field,
    count(*) as n_records

from airbnb.dev.dim_listings_cleansed
where listing_id is not null
group by listing_id
having count(*) > 1



      
    ) dbt_internal_test
[0m08:39:12.402622 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m08:39:13.175231 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2 seconds
[0m08:39:13.177473 [debug] [Thread-1  ]: Timing info for test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be (execute): 2023-02-28 08:39:11.148579 => 2023-02-28 08:39:13.177402
[0m08:39:13.177761 [debug] [Thread-1  ]: On test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be: Close
[0m08:39:13.599501 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 2 seconds
[0m08:39:13.601854 [debug] [Thread-3  ]: Timing info for test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9 (execute): 2023-02-28 08:39:11.523014 => 2023-02-28 08:39:13.601665
[0m08:39:13.604082 [debug] [Thread-3  ]: On test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9: Close
[0m08:39:13.969154 [info ] [Thread-1  ]: 5 of 8 PASS not_null_dim_listings_cleansed_host_id ............................. [[32mPASS[0m in 2.84s]
[0m08:39:13.970846 [debug] [Thread-1  ]: Finished running node test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m08:39:14.024917 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 2 seconds
[0m08:39:14.029437 [debug] [Thread-4  ]: Timing info for test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad (execute): 2023-02-28 08:39:11.893731 => 2023-02-28 08:39:14.029299
[0m08:39:14.030006 [debug] [Thread-4  ]: On test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad: Close
[0m08:39:14.434046 [info ] [Thread-3  ]: 6 of 8 PASS not_null_dim_listings_cleansed_listing_id .......................... [[32mPASS[0m in 2.92s]
[0m08:39:14.435152 [debug] [Thread-3  ]: Finished running node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m08:39:14.584426 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 2 seconds
[0m08:39:14.591020 [debug] [Thread-2  ]: Timing info for test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e (execute): 2023-02-28 08:39:12.376156 => 2023-02-28 08:39:14.590813
[0m08:39:14.591748 [debug] [Thread-2  ]: On test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e: Close
[0m08:39:14.734928 [info ] [Thread-4  ]: 7 of 8 PASS relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_  [[32mPASS[0m in 2.86s]
[0m08:39:14.736801 [debug] [Thread-4  ]: Finished running node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m08:39:15.603165 [info ] [Thread-2  ]: 8 of 8 PASS unique_dim_listings_cleansed_listing_id ............................ [[32mPASS[0m in 3.32s]
[0m08:39:15.604970 [debug] [Thread-2  ]: Finished running node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m08:39:15.609887 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:39:15.611432 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:39:15.612167 [debug] [MainThread]: Connection 'test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be' was properly closed.
[0m08:39:15.612814 [debug] [MainThread]: Connection 'test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e' was properly closed.
[0m08:39:15.613597 [debug] [MainThread]: Connection 'test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9' was properly closed.
[0m08:39:15.614194 [debug] [MainThread]: Connection 'test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad' was properly closed.
[0m08:39:15.614925 [info ] [MainThread]: 
[0m08:39:15.615724 [info ] [MainThread]: Finished running 8 tests in 0 hours 0 minutes and 12.21 seconds (12.21s).
[0m08:39:15.617551 [debug] [MainThread]: Command end result
[0m08:39:15.635815 [info ] [MainThread]: 
[0m08:39:15.636449 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:39:15.636890 [info ] [MainThread]: 
[0m08:39:15.637297 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m08:39:15.637815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb35a6612e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb35a5f1fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb35a5f1fd0>]}
[0m08:39:15.638238 [debug] [MainThread]: Flushing usage events


============================== 2023-03-02 05:08:56.758186 | 1bf2628b-404c-4992-afe7-0d7c6e3d1eed ==============================
[0m05:08:56.758186 [info ] [MainThread]: Running with dbt=1.4.3
[0m05:08:56.761162 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/katiehuang/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'select': ['dim_listings_cleansed'], 'which': 'test', 'rpc_method': 'test'}
[0m05:08:56.761517 [debug] [MainThread]: Tracking: tracking
[0m05:08:56.762412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa989ccaa90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa989ccae50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa989cca5b0>]}
[0m05:08:56.777911 [debug] [MainThread]: checksum: c7a5cda64f02d8b9dd20ef412f82fbb79fdce1bb359c3c5dae3d080de7f31bfd, vars: {}, profile: None, target: None, version: 1.4.3
[0m05:08:56.833671 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 3 files changed.
[0m05:08:56.834195 [debug] [MainThread]: Partial parsing: added file: dbtlearn://macros/positive_value.sql
[0m05:08:56.834671 [debug] [MainThread]: Partial parsing: updated file: dbtlearn://models/schema.yml
[0m05:08:56.835062 [debug] [MainThread]: Partial parsing: updated file: dbtlearn://macros/no_nulls_in_columns.sql
[0m05:08:56.835289 [debug] [MainThread]: Partial parsing: updated file: dbtlearn://tests/no_nulls_in_dim_listings.sql
[0m05:08:56.857544 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_cleansed.sql
[0m05:08:56.956067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1bf2628b-404c-4992-afe7-0d7c6e3d1eed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9784146d0>]}
[0m05:08:56.965977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1bf2628b-404c-4992-afe7-0d7c6e3d1eed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa989d13fa0>]}
[0m05:08:56.966395 [info ] [MainThread]: Found 8 models, 9 tests, 1 snapshot, 0 analyses, 306 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
[0m05:08:56.966720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1bf2628b-404c-4992-afe7-0d7c6e3d1eed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa989d1d0d0>]}
[0m05:08:56.968668 [info ] [MainThread]: 
[0m05:08:56.970343 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m05:08:56.971779 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_airbnb_dev'
[0m05:08:56.987449 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m05:08:56.987799 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m05:08:56.988060 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:09:00.074011 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 3 seconds
[0m05:09:00.077637 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m05:09:00.717669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1bf2628b-404c-4992-afe7-0d7c6e3d1eed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa989cfdd90>]}
[0m05:09:00.718571 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m05:09:00.718925 [info ] [MainThread]: 
[0m05:09:00.725938 [debug] [Thread-1  ]: Began running node test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m05:09:00.726299 [debug] [Thread-2  ]: Began running node test.dbtlearn.consistent_created_at
[0m05:09:00.726627 [debug] [Thread-3  ]: Began running node test.dbtlearn.dim_listings_minimum_nights
[0m05:09:00.727173 [debug] [Thread-4  ]: Began running node test.dbtlearn.no_nulls_in_dim_listings
[0m05:09:00.726879 [info ] [Thread-1  ]: 1 of 9 START test accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room  [RUN]
[0m05:09:00.727539 [info ] [Thread-2  ]: 2 of 9 START test consistent_created_at ........................................ [RUN]
[0m05:09:00.727926 [info ] [Thread-3  ]: 3 of 9 START test dim_listings_minimum_nights .................................. [RUN]
[0m05:09:00.728290 [info ] [Thread-4  ]: 4 of 9 START test no_nulls_in_dim_listings ..................................... [RUN]
[0m05:09:00.729037 [debug] [Thread-1  ]: Acquiring new snowflake connection 'test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af'
[0m05:09:00.729607 [debug] [Thread-2  ]: Acquiring new snowflake connection 'test.dbtlearn.consistent_created_at'
[0m05:09:00.730108 [debug] [Thread-3  ]: Acquiring new snowflake connection 'test.dbtlearn.dim_listings_minimum_nights'
[0m05:09:00.730649 [debug] [Thread-4  ]: Acquiring new snowflake connection 'test.dbtlearn.no_nulls_in_dim_listings'
[0m05:09:00.730891 [debug] [Thread-1  ]: Began compiling node test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m05:09:00.731108 [debug] [Thread-2  ]: Began compiling node test.dbtlearn.consistent_created_at
[0m05:09:00.731306 [debug] [Thread-3  ]: Began compiling node test.dbtlearn.dim_listings_minimum_nights
[0m05:09:00.731499 [debug] [Thread-4  ]: Began compiling node test.dbtlearn.no_nulls_in_dim_listings
[0m05:09:00.738587 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m05:09:00.742427 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbtlearn.consistent_created_at"
[0m05:09:00.745219 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbtlearn.dim_listings_minimum_nights"
[0m05:09:00.756696 [debug] [Thread-4  ]: Using snowflake connection "test.dbtlearn.no_nulls_in_dim_listings"
[0m05:09:00.757290 [debug] [Thread-4  ]: On test.dbtlearn.no_nulls_in_dim_listings: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.no_nulls_in_dim_listings"} */
describe table airbnb.dev.dim_listings_cleansed
[0m05:09:00.757626 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m05:09:00.759496 [debug] [Thread-3  ]: Timing info for test.dbtlearn.dim_listings_minimum_nights (compile): 2023-03-02 05:09:00.742733 => 2023-03-02 05:09:00.759406
[0m05:09:00.759790 [debug] [Thread-3  ]: Began executing node test.dbtlearn.dim_listings_minimum_nights
[0m05:09:00.765188 [debug] [Thread-2  ]: Timing info for test.dbtlearn.consistent_created_at (compile): 2023-03-02 05:09:00.738837 => 2023-03-02 05:09:00.765122
[0m05:09:00.778567 [debug] [Thread-1  ]: Timing info for test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af (compile): 2023-03-02 05:09:00.731651 => 2023-03-02 05:09:00.778479
[0m05:09:00.778876 [debug] [Thread-2  ]: Began executing node test.dbtlearn.consistent_created_at
[0m05:09:00.785985 [debug] [Thread-1  ]: Began executing node test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m05:09:00.786681 [debug] [Thread-3  ]: Writing runtime sql for node "test.dbtlearn.dim_listings_minimum_nights"
[0m05:09:00.789333 [debug] [Thread-2  ]: Writing runtime sql for node "test.dbtlearn.consistent_created_at"
[0m05:09:00.793241 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m05:09:00.794445 [debug] [Thread-3  ]: Using snowflake connection "test.dbtlearn.dim_listings_minimum_nights"
[0m05:09:00.795264 [debug] [Thread-2  ]: Using snowflake connection "test.dbtlearn.consistent_created_at"
[0m05:09:00.795470 [debug] [Thread-3  ]: On test.dbtlearn.dim_listings_minimum_nights: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.dim_listings_minimum_nights"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      SELECT * 
FROM airbnb.dev.dim_listings_cleansed
WHERE minimum_nights < 1
LIMIT 10

-- Query is written in such a way that the results returned must be zero to PASS the test.
      
    ) dbt_internal_test
[0m05:09:00.795725 [debug] [Thread-2  ]: On test.dbtlearn.consistent_created_at: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.consistent_created_at"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- Checks that there is no review date that is submitted before its listing was created

SELECT *
FROM airbnb.dev.dim_listings_cleansed AS listings
INNER JOIN airbnb.dev.fct_reviews AS reviews
	USING (listing_id)
WHERE reviews.review_date <=  listings.created_at
      
    ) dbt_internal_test
[0m05:09:00.796628 [debug] [Thread-1  ]: Using snowflake connection "test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m05:09:00.796833 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m05:09:00.797037 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m05:09:00.797236 [debug] [Thread-1  ]: On test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        room_type as value_field,
        count(*) as n_records

    from airbnb.dev.dim_listings_cleansed
    group by room_type

)

select *
from all_values
where value_field not in (
    'Entire home/apt','Private room','Shared room','Hotel room'
)



      
    ) dbt_internal_test
[0m05:09:00.798682 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m05:09:03.300242 [debug] [Thread-4  ]: SQL status: SUCCESS 8 in 3 seconds
[0m05:09:03.305497 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbtlearn.no_nulls_in_dim_listings"
[0m05:09:03.306154 [debug] [Thread-4  ]: Timing info for test.dbtlearn.no_nulls_in_dim_listings (compile): 2023-03-02 05:09:00.745461 => 2023-03-02 05:09:03.306091
[0m05:09:03.306415 [debug] [Thread-4  ]: Began executing node test.dbtlearn.no_nulls_in_dim_listings
[0m05:09:03.309239 [debug] [Thread-4  ]: Writing runtime sql for node "test.dbtlearn.no_nulls_in_dim_listings"
[0m05:09:03.310691 [debug] [Thread-4  ]: Using snowflake connection "test.dbtlearn.no_nulls_in_dim_listings"
[0m05:09:03.310903 [debug] [Thread-4  ]: On test.dbtlearn.no_nulls_in_dim_listings: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.no_nulls_in_dim_listings"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- Testing `no_nulls_in_columns` macro on `dim_listings_cleansed table`



    SELECT * 
    FROM airbnb.dev.dim_listings_cleansed
    WHERE
        -- Interested in columns where column name is null OR... iterates to next column
            LISTING_ID IS NULL OR
        -- Interested in columns where column name is null OR... iterates to next column
            LISTING_NAME IS NULL OR
        -- Interested in columns where column name is null OR... iterates to next column
            ROOM_TYPE IS NULL OR
        -- Interested in columns where column name is null OR... iterates to next column
            MINIMUM_NIGHTS IS NULL OR
        -- Interested in columns where column name is null OR... iterates to next column
            HOST_ID IS NULL OR
        -- Interested in columns where column name is null OR... iterates to next column
            PRICE IS NULL OR
        -- Interested in columns where column name is null OR... iterates to next column
            CREATED_AT IS NULL OR
        -- Interested in columns where column name is null OR... iterates to next column
            UPDATED_AT IS NULL OR
        
        FALSE -- To terminate the iteration

      
    ) dbt_internal_test
[0m05:09:05.013395 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 4 seconds
[0m05:09:05.014759 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 4 seconds
[0m05:09:05.025508 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 2 seconds
[0m05:09:05.034491 [debug] [Thread-1  ]: Timing info for test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af (execute): 2023-03-02 05:09:00.789912 => 2023-03-02 05:09:05.034391
[0m05:09:05.036288 [debug] [Thread-3  ]: Timing info for test.dbtlearn.dim_listings_minimum_nights (execute): 2023-03-02 05:09:00.759973 => 2023-03-02 05:09:05.036231
[0m05:09:05.037900 [debug] [Thread-4  ]: Timing info for test.dbtlearn.no_nulls_in_dim_listings (execute): 2023-03-02 05:09:03.306577 => 2023-03-02 05:09:05.037846
[0m05:09:05.038173 [debug] [Thread-1  ]: On test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af: Close
[0m05:09:05.038408 [debug] [Thread-3  ]: On test.dbtlearn.dim_listings_minimum_nights: Close
[0m05:09:05.038621 [debug] [Thread-4  ]: On test.dbtlearn.no_nulls_in_dim_listings: Close
[0m05:09:05.149006 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 4 seconds
[0m05:09:05.153168 [debug] [Thread-2  ]: Timing info for test.dbtlearn.consistent_created_at (execute): 2023-03-02 05:09:00.786930 => 2023-03-02 05:09:05.153024
[0m05:09:05.153754 [debug] [Thread-2  ]: On test.dbtlearn.consistent_created_at: Close
[0m05:09:06.150676 [info ] [Thread-4  ]: 4 of 9 PASS no_nulls_in_dim_listings ........................................... [[32mPASS[0m in 5.42s]
[0m05:09:06.155099 [debug] [Thread-4  ]: Finished running node test.dbtlearn.no_nulls_in_dim_listings
[0m05:09:06.152059 [info ] [Thread-2  ]: 2 of 9 PASS consistent_created_at .............................................. [[32mPASS[0m in 5.42s]
[0m05:09:06.155630 [debug] [Thread-4  ]: Began running node test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m05:09:06.152920 [info ] [Thread-1  ]: 1 of 9 PASS accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room  [[32mPASS[0m in 5.42s]
[0m05:09:06.156074 [debug] [Thread-2  ]: Finished running node test.dbtlearn.consistent_created_at
[0m05:09:06.153608 [info ] [Thread-3  ]: 3 of 9 PASS dim_listings_minimum_nights ........................................ [[32mPASS[0m in 5.42s]
[0m05:09:06.156428 [info ] [Thread-4  ]: 5 of 9 START test not_null_dim_listings_cleansed_host_id ....................... [RUN]
[0m05:09:06.157066 [debug] [Thread-1  ]: Finished running node test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m05:09:06.157409 [debug] [Thread-2  ]: Began running node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m05:09:06.157725 [debug] [Thread-3  ]: Finished running node test.dbtlearn.dim_listings_minimum_nights
[0m05:09:06.158254 [debug] [Thread-4  ]: Acquiring new snowflake connection 'test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be'
[0m05:09:06.158554 [debug] [Thread-1  ]: Began running node test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m05:09:06.158818 [info ] [Thread-2  ]: 6 of 9 START test not_null_dim_listings_cleansed_listing_id .................... [RUN]
[0m05:09:06.159231 [debug] [Thread-3  ]: Began running node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m05:09:06.159494 [debug] [Thread-4  ]: Began compiling node test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m05:09:06.159706 [info ] [Thread-1  ]: 7 of 9 START test positive_value_dim_listings_cleansed_minimum_nights .......... [RUN]
[0m05:09:06.160289 [debug] [Thread-2  ]: Acquiring new snowflake connection 'test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9'
[0m05:09:06.160512 [info ] [Thread-3  ]: 8 of 9 START test relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_  [RUN]
[0m05:09:06.168358 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m05:09:06.168946 [debug] [Thread-1  ]: Acquiring new snowflake connection 'test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313'
[0m05:09:06.169211 [debug] [Thread-2  ]: Began compiling node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m05:09:06.169673 [debug] [Thread-3  ]: Acquiring new snowflake connection 'test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad'
[0m05:09:06.170073 [debug] [Thread-1  ]: Began compiling node test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m05:09:06.175211 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m05:09:06.175664 [debug] [Thread-3  ]: Began compiling node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m05:09:06.179793 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313"
[0m05:09:06.180069 [debug] [Thread-4  ]: Timing info for test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be (compile): 2023-03-02 05:09:06.160776 => 2023-03-02 05:09:06.180003
[0m05:09:06.185788 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m05:09:06.186262 [debug] [Thread-4  ]: Began executing node test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m05:09:06.186621 [debug] [Thread-2  ]: Timing info for test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9 (compile): 2023-03-02 05:09:06.170389 => 2023-03-02 05:09:06.186554
[0m05:09:06.189034 [debug] [Thread-4  ]: Writing runtime sql for node "test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m05:09:06.189401 [debug] [Thread-2  ]: Began executing node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m05:09:06.189636 [debug] [Thread-1  ]: Timing info for test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313 (compile): 2023-03-02 05:09:06.175879 => 2023-03-02 05:09:06.189591
[0m05:09:06.189841 [debug] [Thread-3  ]: Timing info for test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad (compile): 2023-03-02 05:09:06.180388 => 2023-03-02 05:09:06.189783
[0m05:09:06.192276 [debug] [Thread-2  ]: Writing runtime sql for node "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m05:09:06.192591 [debug] [Thread-1  ]: Began executing node test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m05:09:06.192844 [debug] [Thread-3  ]: Began executing node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m05:09:06.193537 [debug] [Thread-4  ]: Using snowflake connection "test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m05:09:06.196004 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313"
[0m05:09:06.198285 [debug] [Thread-3  ]: Writing runtime sql for node "test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m05:09:06.198558 [debug] [Thread-4  ]: On test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select host_id
from airbnb.dev.dim_listings_cleansed
where host_id is null



      
    ) dbt_internal_test
[0m05:09:06.199260 [debug] [Thread-2  ]: Using snowflake connection "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m05:09:06.199623 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m05:09:06.199944 [debug] [Thread-2  ]: On test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select listing_id
from airbnb.dev.dim_listings_cleansed
where listing_id is null



      
    ) dbt_internal_test
[0m05:09:06.200562 [debug] [Thread-1  ]: Using snowflake connection "test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313"
[0m05:09:06.201566 [debug] [Thread-3  ]: Using snowflake connection "test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m05:09:06.202392 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m05:09:06.202684 [debug] [Thread-1  ]: On test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

    SELECT * FROM airbnb.dev.dim_listings_cleansed
    WHERE minimum_nights < 1


      
    ) dbt_internal_test
[0m05:09:06.203426 [debug] [Thread-3  ]: On test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select host_id as from_field
    from airbnb.dev.dim_listings_cleansed
    where host_id is not null
),

parent as (
    select host_id as to_field
    from airbnb.dev.dim_hosts_cleansed
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m05:09:06.204439 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m05:09:06.205155 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m05:09:09.103882 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 3 seconds
[0m05:09:09.107646 [debug] [Thread-1  ]: Timing info for test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313 (execute): 2023-03-02 05:09:06.193757 => 2023-03-02 05:09:09.107566
[0m05:09:09.108091 [debug] [Thread-1  ]: On test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313: Close
[0m05:09:09.621244 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 3 seconds
[0m05:09:09.622506 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 3 seconds
[0m05:09:09.626398 [debug] [Thread-4  ]: Timing info for test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be (execute): 2023-03-02 05:09:06.186839 => 2023-03-02 05:09:09.626285
[0m05:09:09.628730 [debug] [Thread-2  ]: Timing info for test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9 (execute): 2023-03-02 05:09:06.190106 => 2023-03-02 05:09:09.628651
[0m05:09:09.629074 [debug] [Thread-4  ]: On test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be: Close
[0m05:09:09.629287 [debug] [Thread-2  ]: On test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9: Close
[0m05:09:09.746885 [info ] [Thread-1  ]: 7 of 9 PASS positive_value_dim_listings_cleansed_minimum_nights ................ [[32mPASS[0m in 3.58s]
[0m05:09:09.747867 [debug] [Thread-1  ]: Finished running node test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m05:09:09.748556 [debug] [Thread-1  ]: Began running node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m05:09:09.749118 [info ] [Thread-1  ]: 9 of 9 START test unique_dim_listings_cleansed_listing_id ...................... [RUN]
[0m05:09:09.750310 [debug] [Thread-1  ]: Acquiring new snowflake connection 'test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e'
[0m05:09:09.750654 [debug] [Thread-1  ]: Began compiling node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m05:09:09.758188 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m05:09:09.758947 [debug] [Thread-1  ]: Timing info for test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e (compile): 2023-03-02 05:09:09.750834 => 2023-03-02 05:09:09.758883
[0m05:09:09.759213 [debug] [Thread-1  ]: Began executing node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m05:09:09.761766 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m05:09:09.763001 [debug] [Thread-1  ]: Using snowflake connection "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m05:09:09.763230 [debug] [Thread-1  ]: On test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    listing_id as unique_field,
    count(*) as n_records

from airbnb.dev.dim_listings_cleansed
where listing_id is not null
group by listing_id
having count(*) > 1



      
    ) dbt_internal_test
[0m05:09:09.763419 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m05:09:09.848054 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 4 seconds
[0m05:09:09.852865 [debug] [Thread-3  ]: Timing info for test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad (execute): 2023-03-02 05:09:06.196237 => 2023-03-02 05:09:09.852777
[0m05:09:09.853221 [debug] [Thread-3  ]: On test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad: Close
[0m05:09:10.195060 [info ] [Thread-4  ]: 5 of 9 PASS not_null_dim_listings_cleansed_host_id ............................. [[32mPASS[0m in 4.04s]
[0m05:09:10.195729 [debug] [Thread-4  ]: Finished running node test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m05:09:10.219801 [info ] [Thread-2  ]: 6 of 9 PASS not_null_dim_listings_cleansed_listing_id .......................... [[32mPASS[0m in 4.06s]
[0m05:09:10.220367 [debug] [Thread-2  ]: Finished running node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m05:09:10.506410 [info ] [Thread-3  ]: 8 of 9 PASS relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_  [[32mPASS[0m in 4.34s]
[0m05:09:10.507340 [debug] [Thread-3  ]: Finished running node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m05:09:11.898940 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2 seconds
[0m05:09:11.904972 [debug] [Thread-1  ]: Timing info for test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e (execute): 2023-03-02 05:09:09.759376 => 2023-03-02 05:09:11.904844
[0m05:09:11.905493 [debug] [Thread-1  ]: On test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e: Close
[0m05:09:12.585592 [info ] [Thread-1  ]: 9 of 9 PASS unique_dim_listings_cleansed_listing_id ............................ [[32mPASS[0m in 2.84s]
[0m05:09:12.586625 [debug] [Thread-1  ]: Finished running node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m05:09:12.589719 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m05:09:12.590306 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:09:12.590506 [debug] [MainThread]: Connection 'test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e' was properly closed.
[0m05:09:12.590672 [debug] [MainThread]: Connection 'test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9' was properly closed.
[0m05:09:12.590826 [debug] [MainThread]: Connection 'test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad' was properly closed.
[0m05:09:12.590977 [debug] [MainThread]: Connection 'test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be' was properly closed.
[0m05:09:12.591192 [info ] [MainThread]: 
[0m05:09:12.591488 [info ] [MainThread]: Finished running 9 tests in 0 hours 0 minutes and 15.62 seconds (15.62s).
[0m05:09:12.592168 [debug] [MainThread]: Command end result
[0m05:09:12.600815 [info ] [MainThread]: 
[0m05:09:12.601265 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:09:12.601568 [info ] [MainThread]: 
[0m05:09:12.601839 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
[0m05:09:12.602191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9996ab640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa99951b9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa989d1d070>]}
[0m05:09:12.602473 [debug] [MainThread]: Flushing usage events


============================== 2023-03-02 05:19:55.332379 | 091a4942-2cc0-4d1d-b387-455f071ab57f ==============================
[0m05:19:55.332379 [info ] [MainThread]: Running with dbt=1.4.3
[0m05:19:55.333985 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/katiehuang/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'deps', 'rpc_method': 'deps', 'indirect_selection': 'eager'}
[0m05:19:55.334217 [debug] [MainThread]: Tracking: tracking
[0m05:19:55.356551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95a17ecd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95b1927730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95b1940190>]}
[0m05:19:55.359285 [debug] [MainThread]: Set downloads directory='/var/folders/q3/w322smt942d2fh0zxg4b_rfc0000gn/T/dbt-downloads-0p09k8y3'
[0m05:19:55.360128 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m05:19:55.514198 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m05:19:55.514733 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m05:19:55.592977 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m05:19:55.602744 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m05:19:56.071235 [info ] [MainThread]:   Installed from version 1.0.0
[0m05:19:56.071695 [info ] [MainThread]:   Up to date!
[0m05:19:56.072110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '091a4942-2cc0-4d1d-b387-455f071ab57f', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95b1927730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95a180ec10>]}
[0m05:19:56.072983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95b191b430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95a17ec070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95a17ec610>]}
[0m05:19:56.073254 [debug] [MainThread]: Flushing usage events


============================== 2023-03-02 05:24:21.943770 | c2642223-1bff-4490-ba7a-e2396be81ba6 ==============================
[0m05:24:21.943770 [info ] [MainThread]: Running with dbt=1.4.3
[0m05:24:21.947005 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/katiehuang/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m05:24:21.947311 [debug] [MainThread]: Tracking: tracking
[0m05:24:21.948291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91d133aa90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91d133ae80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91d133ad90>]}
[0m05:24:21.969967 [debug] [MainThread]: checksum: c7a5cda64f02d8b9dd20ef412f82fbb79fdce1bb359c3c5dae3d080de7f31bfd, vars: {}, profile: None, target: None, version: 1.4.3
[0m05:24:21.983317 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m05:24:21.983736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c2642223-1bff-4490-ba7a-e2396be81ba6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91d12fdca0>]}
[0m05:24:23.061405 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_w_hosts.sql
[0m05:24:23.074137 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_cleansed.sql
[0m05:24:23.076878 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_hosts_cleansed.sql
[0m05:24:23.079455 [debug] [MainThread]: 1603: static parser failed on fct/fct_reviews.sql
[0m05:24:23.102930 [debug] [MainThread]: 1602: parser fallback to jinja rendering on fct/fct_reviews.sql
[0m05:24:23.104371 [debug] [MainThread]: 1699: static parser successfully parsed mart/mart_fullmoon_reviews.sql
[0m05:24:23.107103 [debug] [MainThread]: 1699: static parser successfully parsed src/src_reviews.sql
[0m05:24:23.109950 [debug] [MainThread]: 1699: static parser successfully parsed src/src_listings.sql
[0m05:24:23.112369 [debug] [MainThread]: 1699: static parser successfully parsed src/src_hosts.sql
[0m05:24:23.297593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c2642223-1bff-4490-ba7a-e2396be81ba6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91b01ac190>]}
[0m05:24:23.308755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c2642223-1bff-4490-ba7a-e2396be81ba6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91d1391e80>]}
[0m05:24:23.309102 [info ] [MainThread]: Found 8 models, 9 tests, 1 snapshot, 0 analyses, 418 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
[0m05:24:23.309413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c2642223-1bff-4490-ba7a-e2396be81ba6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91d13249d0>]}
[0m05:24:23.311179 [info ] [MainThread]: 
[0m05:24:23.312664 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m05:24:23.313834 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_airbnb'
[0m05:24:23.329628 [debug] [ThreadPool]: Using snowflake connection "list_airbnb"
[0m05:24:23.329908 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb"} */
show terse schemas in database airbnb
    limit 10000
[0m05:24:23.330131 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:24:25.505845 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2 seconds
[0m05:24:25.511196 [debug] [ThreadPool]: On list_airbnb: Close
[0m05:24:26.124162 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_airbnb_dev'
[0m05:24:26.146356 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m05:24:26.147003 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m05:24:26.147421 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:24:28.164683 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 2 seconds
[0m05:24:28.169750 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m05:24:28.790365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c2642223-1bff-4490-ba7a-e2396be81ba6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91d0e4e730>]}
[0m05:24:28.793283 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m05:24:28.794339 [info ] [MainThread]: 
[0m05:24:28.806737 [debug] [Thread-1  ]: Began running node model.dbtlearn.src_hosts
[0m05:24:28.807580 [debug] [Thread-2  ]: Began running node model.dbtlearn.src_listings
[0m05:24:28.808734 [debug] [Thread-3  ]: Began running node model.dbtlearn.src_reviews
[0m05:24:28.810267 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtlearn.src_hosts'
[0m05:24:28.811479 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtlearn.src_listings'
[0m05:24:28.812383 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtlearn.src_reviews'
[0m05:24:28.812926 [debug] [Thread-1  ]: Began compiling node model.dbtlearn.src_hosts
[0m05:24:28.813439 [debug] [Thread-2  ]: Began compiling node model.dbtlearn.src_listings
[0m05:24:28.813852 [debug] [Thread-3  ]: Began compiling node model.dbtlearn.src_reviews
[0m05:24:28.820005 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearn.src_hosts"
[0m05:24:28.824749 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtlearn.src_listings"
[0m05:24:28.828723 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtlearn.src_reviews"
[0m05:24:28.830763 [debug] [Thread-3  ]: Timing info for model.dbtlearn.src_reviews (compile): 2023-03-02 05:24:28.825118 => 2023-03-02 05:24:28.830632
[0m05:24:28.831116 [debug] [Thread-1  ]: Timing info for model.dbtlearn.src_hosts (compile): 2023-03-02 05:24:28.814159 => 2023-03-02 05:24:28.831057
[0m05:24:28.831357 [debug] [Thread-2  ]: Timing info for model.dbtlearn.src_listings (compile): 2023-03-02 05:24:28.820482 => 2023-03-02 05:24:28.831313
[0m05:24:28.833643 [debug] [Thread-3  ]: Finished running node model.dbtlearn.src_reviews
[0m05:24:28.834427 [debug] [Thread-1  ]: Finished running node model.dbtlearn.src_hosts
[0m05:24:28.835143 [debug] [Thread-2  ]: Finished running node model.dbtlearn.src_listings
[0m05:24:28.835789 [debug] [Thread-4  ]: Began running node model.dbtlearn.fct_reviews
[0m05:24:28.836317 [debug] [Thread-1  ]: Began running node model.dbtlearn.dim_hosts_cleansed
[0m05:24:28.836664 [info ] [Thread-4  ]: 1 of 5 START sql incremental model dev.fct_reviews ............................. [RUN]
[0m05:24:28.837581 [debug] [Thread-2  ]: Began running node model.dbtlearn.dim_listings_cleansed
[0m05:24:28.837284 [info ] [Thread-1  ]: 2 of 5 START sql view model dev.dim_hosts_cleansed ............................. [RUN]
[0m05:24:28.838270 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.dbtlearn.fct_reviews'
[0m05:24:28.839194 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtlearn.dim_hosts_cleansed'
[0m05:24:28.838608 [info ] [Thread-2  ]: 3 of 5 START sql view model dev.dim_listings_cleansed .......................... [RUN]
[0m05:24:28.839587 [debug] [Thread-4  ]: Began compiling node model.dbtlearn.fct_reviews
[0m05:24:28.839819 [debug] [Thread-1  ]: Began compiling node model.dbtlearn.dim_hosts_cleansed
[0m05:24:28.840318 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtlearn.dim_listings_cleansed'
[0m05:24:28.866546 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearn.dim_hosts_cleansed"
[0m05:24:28.867129 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtlearn.fct_reviews"
[0m05:24:28.867371 [debug] [Thread-2  ]: Began compiling node model.dbtlearn.dim_listings_cleansed
[0m05:24:28.918401 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtlearn.dim_listings_cleansed"
[0m05:24:28.918924 [debug] [Thread-4  ]: Timing info for model.dbtlearn.fct_reviews (compile): 2023-03-02 05:24:28.840503 => 2023-03-02 05:24:28.918858
[0m05:24:28.919160 [debug] [Thread-1  ]: Timing info for model.dbtlearn.dim_hosts_cleansed (compile): 2023-03-02 05:24:28.852637 => 2023-03-02 05:24:28.919107
[0m05:24:28.919409 [debug] [Thread-4  ]: Began executing node model.dbtlearn.fct_reviews
[0m05:24:28.919704 [debug] [Thread-1  ]: Began executing node model.dbtlearn.dim_hosts_cleansed
[0m05:24:28.925184 [debug] [Thread-2  ]: Timing info for model.dbtlearn.dim_listings_cleansed (compile): 2023-03-02 05:24:28.867781 => 2023-03-02 05:24:28.925131
[0m05:24:28.975468 [debug] [Thread-2  ]: Began executing node model.dbtlearn.dim_listings_cleansed
[0m05:24:29.002465 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtlearn.dim_hosts_cleansed"
[0m05:24:29.005542 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbtlearn.dim_listings_cleansed"
[0m05:24:29.006449 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m05:24:29.006788 [debug] [Thread-4  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
create or replace  temporary view airbnb.dev.fct_reviews__dbt_tmp
  
   as (
    -- Doc | Config : https://docs.getdbt.com/reference/dbt-jinja-functions/config


-- dbt materializes the model as an incremental table. 
-- Read for difference btw table vs. incremental: https://docs.getdbt.com/docs/build/materializations

WITH  __dbt__cte__src_reviews as (
WITH raw_reviews AS (
	SELECT * FROM airbnb.raw.raw_reviews
)

SELECT
    listing_id,
    date AS review_date,
    reviewer_name,
    comments AS review_text,
    sentiment AS review_sentiment
FROM raw_reviews
),src_reviews AS (
    SELECT * FROM __dbt__cte__src_reviews
)

SELECT 
    
    
md5(cast(coalesce(cast(listing_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(review_date as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(reviewer_name as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(review_text as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as review_id,
    listing_id,
    review_date,
    NVL(reviewer_name, 'Anonymous') AS reviewer_name,
    review_text,
    review_sentiment
FROM src_reviews
WHERE review_text IS NOT NULL


  and review_date > (select max(review_date) from airbnb.dev.fct_reviews)

  );
[0m05:24:29.007012 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m05:24:29.008770 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearn.dim_listings_cleansed"
[0m05:24:29.010206 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.dim_hosts_cleansed"
[0m05:24:29.010387 [debug] [Thread-2  ]: On model.dbtlearn.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_cleansed"} */
create or replace   view airbnb.dev.dim_listings_cleansed
  
   as (
    


WITH  __dbt__cte__src_listings as (
WITH raw_listings AS (
	SELECT * FROM airbnb.raw.raw_listings
)

SELECT 
	id AS listing_id,
    name AS listing_name,
    listing_url,
    room_type,
    minimum_nights,
    host_id,
    price AS price_str,
    created_at,
    updated_at
FROM 
	raw_listings
),src_listings AS (
    SELECT * FROM __dbt__cte__src_listings
)

SELECT
    listing_id,
    listing_name,
    room_type,
    CASE 
        WHEN minimum_nights = 0 THEN 1 -- 0 night = 1 night, so we assign the value of 1 to indicate 1 night
        ELSE minimum_nights
    END AS minimum_nights,
    host_id,
    REPLACE( -- Parse string value into numerical form
        price_str, '$' -- Replace '$' with price_str value. In other words, to remove '$' from string.
        ) :: NUMBER (10, 2 -- Convert string type to numerical with 2 decimal places
    ) AS price,
    created_at,
    updated_at
    
FROM src_listings
  );
[0m05:24:29.010585 [debug] [Thread-1  ]: On model.dbtlearn.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_hosts_cleansed"} */
create or replace   view airbnb.dev.dim_hosts_cleansed
  
   as (
    

WITH  __dbt__cte__src_hosts as (
WITH raw_hosts AS (
	SELECT * FROM airbnb.raw.raw_hosts
)

SELECT
    id AS host_id,
    name AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM raw_hosts
),src_hosts AS (
    SELECT * FROM __dbt__cte__src_hosts
)

SELECT 
    host_id,
    NVL(host_name, 'Anonymous') AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM src_hosts
  );
[0m05:24:29.011296 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m05:24:29.011525 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m05:24:31.380102 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 2 seconds
[0m05:24:31.412357 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m05:24:31.413283 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2 seconds
[0m05:24:31.413900 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 2 seconds
[0m05:24:31.414165 [debug] [Thread-4  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
describe table airbnb.dev.fct_reviews__dbt_tmp
[0m05:24:31.449932 [debug] [Thread-2  ]: Timing info for model.dbtlearn.dim_listings_cleansed (execute): 2023-03-02 05:24:28.987915 => 2023-03-02 05:24:31.449878
[0m05:24:31.450614 [debug] [Thread-1  ]: Timing info for model.dbtlearn.dim_hosts_cleansed (execute): 2023-03-02 05:24:28.943993 => 2023-03-02 05:24:31.450574
[0m05:24:31.451327 [debug] [Thread-2  ]: On model.dbtlearn.dim_listings_cleansed: Close
[0m05:24:31.451556 [debug] [Thread-1  ]: On model.dbtlearn.dim_hosts_cleansed: Close
[0m05:24:31.768144 [debug] [Thread-4  ]: SQL status: SUCCESS 6 in 0 seconds
[0m05:24:31.782810 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m05:24:31.783748 [debug] [Thread-4  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
describe table airbnb.dev.fct_reviews
[0m05:24:32.070081 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c2642223-1bff-4490-ba7a-e2396be81ba6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91d15127f0>]}
[0m05:24:32.072895 [info ] [Thread-1  ]: 2 of 5 OK created sql view model dev.dim_hosts_cleansed ........................ [[32mSUCCESS 1[0m in 3.23s]
[0m05:24:32.075235 [debug] [Thread-1  ]: Finished running node model.dbtlearn.dim_hosts_cleansed
[0m05:24:32.094889 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c2642223-1bff-4490-ba7a-e2396be81ba6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91d164fcd0>]}
[0m05:24:32.096920 [info ] [Thread-2  ]: 3 of 5 OK created sql view model dev.dim_listings_cleansed ..................... [[32mSUCCESS 1[0m in 3.25s]
[0m05:24:32.098137 [debug] [Thread-2  ]: Finished running node model.dbtlearn.dim_listings_cleansed
[0m05:24:32.101489 [debug] [Thread-3  ]: Began running node model.dbtlearn.dim_listings_w_hosts
[0m05:24:32.104151 [debug] [Thread-4  ]: SQL status: SUCCESS 5 in 0 seconds
[0m05:24:32.105737 [info ] [Thread-3  ]: 4 of 5 START sql table model dev.dim_listings_w_hosts .......................... [RUN]
[0m05:24:32.120157 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtlearn.dim_listings_w_hosts'
[0m05:24:32.126893 [debug] [Thread-3  ]: Began compiling node model.dbtlearn.dim_listings_w_hosts
[0m05:24:32.138023 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtlearn.dim_listings_w_hosts"
[0m05:24:32.139647 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m05:24:32.139970 [debug] [Thread-4  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
describe table airbnb.dev.fct_reviews__dbt_tmp
[0m05:24:32.141324 [debug] [Thread-3  ]: Timing info for model.dbtlearn.dim_listings_w_hosts (compile): 2023-03-02 05:24:32.133072 => 2023-03-02 05:24:32.141254
[0m05:24:32.141684 [debug] [Thread-3  ]: Began executing node model.dbtlearn.dim_listings_w_hosts
[0m05:24:32.167155 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbtlearn.dim_listings_w_hosts"
[0m05:24:32.169253 [debug] [Thread-3  ]: Using snowflake connection "model.dbtlearn.dim_listings_w_hosts"
[0m05:24:32.169463 [debug] [Thread-3  ]: On model.dbtlearn.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_w_hosts"} */
create or replace transient table airbnb.dev.dim_listings_w_hosts  as
        (WITH 
listings AS (
    SELECT * FROM airbnb.dev.dim_listings_cleansed
),
hosts AS (
    SELECT * FROM airbnb.dev.dim_hosts_cleansed
)

SELECT 
    listings.listing_id,
    listings.listing_name,
    listings.room_type,
    listings.minimum_nights,
    listings.price,
    listings.host_id,
    hosts.host_name,
    hosts.is_superhost AS host_is_superhost,
    listings.created_at,
    GREATEST(listings.updated_at, hosts.updated_at) AS updated_at -- Keep most recent updated_at
FROM listings
LEFT JOIN hosts
    ON listings.host_id = hosts.host_id
        );
[0m05:24:32.169645 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m05:24:32.491016 [debug] [Thread-4  ]: SQL status: SUCCESS 6 in 0 seconds
[0m05:24:32.494918 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m05:24:32.495140 [debug] [Thread-4  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
describe table "AIRBNB"."DEV"."FCT_REVIEWS"
[0m05:24:32.801341 [debug] [Thread-4  ]: SQL status: SUCCESS 5 in 0 seconds
[0m05:24:32.827712 [debug] [Thread-4  ]: 
    In "AIRBNB"."DEV"."FCT_REVIEWS":
        Schema changed: True
        Source columns not in target: [SnowflakeColumn(column='REVIEW_ID', dtype='VARCHAR', char_size=32, numeric_precision=None, numeric_scale=None)]
        Target columns not in source: []
        New column types: []
  
[0m05:24:32.828460 [debug] [Thread-4  ]: Timing info for model.dbtlearn.fct_reviews (execute): 2023-03-02 05:24:28.919896 => 2023-03-02 05:24:32.828362
[0m05:24:32.828808 [debug] [Thread-4  ]: On model.dbtlearn.fct_reviews: Close
[0m05:24:33.541012 [debug] [Thread-4  ]: Compilation Error in model fct_reviews (models/fct/fct_reviews.sql)
  
                The source and target schemas on this incremental model are out of sync!
                They can be reconciled in several ways:
                  - set the `on_schema_change` config to either append_new_columns or sync_all_columns, depending on your situation.
                  - Re-run the incremental model with `full_refresh: True` to update the target schema.
                  - update the schema manually and re-run the process.
  
                Additional troubleshooting context:
                   Source columns not in target: [SnowflakeColumn(column='REVIEW_ID', dtype='VARCHAR', char_size=32, numeric_precision=None, numeric_scale=None)]
                   Target columns not in source: []
                   New column types: []
            
  
  > in macro process_schema_changes (macros/materializations/models/incremental/on_schema_change.sql)
  > called by macro materialization_incremental_snowflake (macros/materializations/incremental.sql)
  > called by model fct_reviews (models/fct/fct_reviews.sql)
[0m05:24:33.542772 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c2642223-1bff-4490-ba7a-e2396be81ba6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91b0129820>]}
[0m05:24:33.544166 [error] [Thread-4  ]: 1 of 5 ERROR creating sql incremental model dev.fct_reviews .................... [[31mERROR[0m in 4.70s]
[0m05:24:33.545152 [debug] [Thread-4  ]: Finished running node model.dbtlearn.fct_reviews
[0m05:24:33.546531 [debug] [Thread-2  ]: Began running node model.dbtlearn.mart_fullmoon_reviews
[0m05:24:33.547243 [info ] [Thread-2  ]: 5 of 5 SKIP relation dev.mart_fullmoon_reviews ................................. [[33mSKIP[0m]
[0m05:24:33.548079 [debug] [Thread-2  ]: Finished running node model.dbtlearn.mart_fullmoon_reviews
[0m05:24:36.666285 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 4 seconds
[0m05:24:36.688201 [debug] [Thread-3  ]: Timing info for model.dbtlearn.dim_listings_w_hosts (execute): 2023-03-02 05:24:32.141889 => 2023-03-02 05:24:36.688066
[0m05:24:36.688908 [debug] [Thread-3  ]: On model.dbtlearn.dim_listings_w_hosts: Close
[0m05:24:37.283122 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c2642223-1bff-4490-ba7a-e2396be81ba6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91b018d5b0>]}
[0m05:24:37.285232 [info ] [Thread-3  ]: 4 of 5 OK created sql table model dev.dim_listings_w_hosts ..................... [[32mSUCCESS 1[0m in 5.16s]
[0m05:24:37.288384 [debug] [Thread-3  ]: Finished running node model.dbtlearn.dim_listings_w_hosts
[0m05:24:37.295170 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m05:24:37.297172 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:24:37.297785 [debug] [MainThread]: Connection 'model.dbtlearn.dim_hosts_cleansed' was properly closed.
[0m05:24:37.298221 [debug] [MainThread]: Connection 'model.dbtlearn.dim_listings_cleansed' was properly closed.
[0m05:24:37.298604 [debug] [MainThread]: Connection 'model.dbtlearn.dim_listings_w_hosts' was properly closed.
[0m05:24:37.298999 [debug] [MainThread]: Connection 'model.dbtlearn.fct_reviews' was properly closed.
[0m05:24:37.299678 [info ] [MainThread]: 
[0m05:24:37.300474 [info ] [MainThread]: Finished running 2 view models, 1 incremental model, 2 table models in 0 hours 0 minutes and 13.99 seconds (13.99s).
[0m05:24:37.301972 [debug] [MainThread]: Command end result
[0m05:24:37.321582 [info ] [MainThread]: 
[0m05:24:37.322237 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m05:24:37.322667 [info ] [MainThread]: 
[0m05:24:37.323087 [error] [MainThread]: [33mCompilation Error in model fct_reviews (models/fct/fct_reviews.sql)[0m
[0m05:24:37.323486 [error] [MainThread]:   
[0m05:24:37.323867 [error] [MainThread]:                 The source and target schemas on this incremental model are out of sync!
[0m05:24:37.324250 [error] [MainThread]:                 They can be reconciled in several ways:
[0m05:24:37.324621 [error] [MainThread]:                   - set the `on_schema_change` config to either append_new_columns or sync_all_columns, depending on your situation.
[0m05:24:37.324993 [error] [MainThread]:                   - Re-run the incremental model with `full_refresh: True` to update the target schema.
[0m05:24:37.325361 [error] [MainThread]:                   - update the schema manually and re-run the process.
[0m05:24:37.325727 [error] [MainThread]:   
[0m05:24:37.326100 [error] [MainThread]:                 Additional troubleshooting context:
[0m05:24:37.326479 [error] [MainThread]:                    Source columns not in target: [SnowflakeColumn(column='REVIEW_ID', dtype='VARCHAR', char_size=32, numeric_precision=None, numeric_scale=None)]
[0m05:24:37.326857 [error] [MainThread]:                    Target columns not in source: []
[0m05:24:37.327241 [error] [MainThread]:                    New column types: []
[0m05:24:37.327619 [error] [MainThread]:             
[0m05:24:37.327997 [error] [MainThread]:   
[0m05:24:37.328372 [error] [MainThread]:   > in macro process_schema_changes (macros/materializations/models/incremental/on_schema_change.sql)
[0m05:24:37.328753 [error] [MainThread]:   > called by macro materialization_incremental_snowflake (macros/materializations/incremental.sql)
[0m05:24:37.329126 [error] [MainThread]:   > called by model fct_reviews (models/fct/fct_reviews.sql)
[0m05:24:37.329529 [info ] [MainThread]: 
[0m05:24:37.329897 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=1 TOTAL=5
[0m05:24:37.330395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91d12fdb80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91d12fd9a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91d12fdb50>]}
[0m05:24:37.330800 [debug] [MainThread]: Flushing usage events


============================== 2023-03-02 05:24:51.697646 | 6551c49d-ce92-41da-bfc4-e493b925fa27 ==============================
[0m05:24:51.697646 [info ] [MainThread]: Running with dbt=1.4.3
[0m05:24:51.700030 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/katiehuang/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'full_refresh': True, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m05:24:51.700304 [debug] [MainThread]: Tracking: tracking
[0m05:24:51.701071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4b9522b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4b9522f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4b9522e50>]}
[0m05:24:51.720964 [debug] [MainThread]: checksum: c7a5cda64f02d8b9dd20ef412f82fbb79fdce1bb359c3c5dae3d080de7f31bfd, vars: {}, profile: None, target: None, version: 1.4.3
[0m05:24:51.783234 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:24:51.783550 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:24:51.791728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6551c49d-ce92-41da-bfc4-e493b925fa27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4ca5b4b80>]}
[0m05:24:51.802449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6551c49d-ce92-41da-bfc4-e493b925fa27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4b95a24f0>]}
[0m05:24:51.802829 [info ] [MainThread]: Found 8 models, 9 tests, 1 snapshot, 0 analyses, 418 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
[0m05:24:51.803157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6551c49d-ce92-41da-bfc4-e493b925fa27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4b95a2400>]}
[0m05:24:51.805096 [info ] [MainThread]: 
[0m05:24:51.806619 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m05:24:51.807816 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_airbnb'
[0m05:24:51.823832 [debug] [ThreadPool]: Using snowflake connection "list_airbnb"
[0m05:24:51.824170 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb"} */
show terse schemas in database airbnb
    limit 10000
[0m05:24:51.824420 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:24:54.075820 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2 seconds
[0m05:24:54.080578 [debug] [ThreadPool]: On list_airbnb: Close
[0m05:24:54.693257 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_airbnb_dev'
[0m05:24:54.706678 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m05:24:54.707086 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m05:24:54.707406 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:24:58.185554 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 3 seconds
[0m05:24:58.191944 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m05:24:58.801449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6551c49d-ce92-41da-bfc4-e493b925fa27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4b967be50>]}
[0m05:24:58.805434 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m05:24:58.807721 [info ] [MainThread]: 
[0m05:24:58.819239 [debug] [Thread-1  ]: Began running node model.dbtlearn.src_hosts
[0m05:24:58.819931 [debug] [Thread-2  ]: Began running node model.dbtlearn.src_listings
[0m05:24:58.820414 [debug] [Thread-3  ]: Began running node model.dbtlearn.src_reviews
[0m05:24:58.821393 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtlearn.src_hosts'
[0m05:24:58.822360 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtlearn.src_listings'
[0m05:24:58.823493 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtlearn.src_reviews'
[0m05:24:58.824485 [debug] [Thread-1  ]: Began compiling node model.dbtlearn.src_hosts
[0m05:24:58.825243 [debug] [Thread-2  ]: Began compiling node model.dbtlearn.src_listings
[0m05:24:58.825914 [debug] [Thread-3  ]: Began compiling node model.dbtlearn.src_reviews
[0m05:24:58.834311 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearn.src_hosts"
[0m05:24:58.839142 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtlearn.src_listings"
[0m05:24:58.843465 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtlearn.src_reviews"
[0m05:24:58.844417 [debug] [Thread-1  ]: Timing info for model.dbtlearn.src_hosts (compile): 2023-03-02 05:24:58.826295 => 2023-03-02 05:24:58.844331
[0m05:24:58.844720 [debug] [Thread-2  ]: Timing info for model.dbtlearn.src_listings (compile): 2023-03-02 05:24:58.834742 => 2023-03-02 05:24:58.844655
[0m05:24:58.844946 [debug] [Thread-3  ]: Timing info for model.dbtlearn.src_reviews (compile): 2023-03-02 05:24:58.839538 => 2023-03-02 05:24:58.844904
[0m05:24:58.846878 [debug] [Thread-1  ]: Finished running node model.dbtlearn.src_hosts
[0m05:24:58.847565 [debug] [Thread-2  ]: Finished running node model.dbtlearn.src_listings
[0m05:24:58.848184 [debug] [Thread-3  ]: Finished running node model.dbtlearn.src_reviews
[0m05:24:58.849009 [debug] [Thread-4  ]: Began running node model.dbtlearn.dim_hosts_cleansed
[0m05:24:58.849365 [debug] [Thread-1  ]: Began running node model.dbtlearn.dim_listings_cleansed
[0m05:24:58.849703 [info ] [Thread-4  ]: 1 of 5 START sql view model dev.dim_hosts_cleansed ............................. [RUN]
[0m05:24:58.850179 [debug] [Thread-2  ]: Began running node model.dbtlearn.fct_reviews
[0m05:24:58.850491 [info ] [Thread-1  ]: 2 of 5 START sql view model dev.dim_listings_cleansed .......................... [RUN]
[0m05:24:58.851219 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.dbtlearn.dim_hosts_cleansed'
[0m05:24:58.851530 [info ] [Thread-2  ]: 3 of 5 START sql incremental model dev.fct_reviews ............................. [RUN]
[0m05:24:58.852213 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtlearn.dim_listings_cleansed'
[0m05:24:58.852490 [debug] [Thread-4  ]: Began compiling node model.dbtlearn.dim_hosts_cleansed
[0m05:24:58.853044 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtlearn.fct_reviews'
[0m05:24:58.853308 [debug] [Thread-1  ]: Began compiling node model.dbtlearn.dim_listings_cleansed
[0m05:24:58.866256 [debug] [Thread-2  ]: Began compiling node model.dbtlearn.fct_reviews
[0m05:24:58.870059 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtlearn.dim_hosts_cleansed"
[0m05:24:58.886562 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearn.dim_listings_cleansed"
[0m05:24:58.916262 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtlearn.fct_reviews"
[0m05:24:58.916809 [debug] [Thread-4  ]: Timing info for model.dbtlearn.dim_hosts_cleansed (compile): 2023-03-02 05:24:58.853511 => 2023-03-02 05:24:58.916744
[0m05:24:58.917106 [debug] [Thread-4  ]: Began executing node model.dbtlearn.dim_hosts_cleansed
[0m05:24:58.917337 [debug] [Thread-1  ]: Timing info for model.dbtlearn.dim_listings_cleansed (compile): 2023-03-02 05:24:58.870332 => 2023-03-02 05:24:58.917282
[0m05:24:58.930268 [debug] [Thread-2  ]: Timing info for model.dbtlearn.fct_reviews (compile): 2023-03-02 05:24:58.876651 => 2023-03-02 05:24:58.930185
[0m05:24:58.930545 [debug] [Thread-1  ]: Began executing node model.dbtlearn.dim_listings_cleansed
[0m05:24:58.949426 [debug] [Thread-2  ]: Began executing node model.dbtlearn.fct_reviews
[0m05:24:58.951032 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbtlearn.dim_hosts_cleansed"
[0m05:24:58.953999 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtlearn.dim_listings_cleansed"
[0m05:24:59.009376 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.dim_listings_cleansed"
[0m05:24:59.010522 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearn.dim_hosts_cleansed"
[0m05:24:59.010917 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbtlearn.fct_reviews"
[0m05:24:59.011093 [debug] [Thread-1  ]: On model.dbtlearn.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_cleansed"} */
create or replace   view airbnb.dev.dim_listings_cleansed
  
   as (
    


WITH  __dbt__cte__src_listings as (
WITH raw_listings AS (
	SELECT * FROM airbnb.raw.raw_listings
)

SELECT 
	id AS listing_id,
    name AS listing_name,
    listing_url,
    room_type,
    minimum_nights,
    host_id,
    price AS price_str,
    created_at,
    updated_at
FROM 
	raw_listings
),src_listings AS (
    SELECT * FROM __dbt__cte__src_listings
)

SELECT
    listing_id,
    listing_name,
    room_type,
    CASE 
        WHEN minimum_nights = 0 THEN 1 -- 0 night = 1 night, so we assign the value of 1 to indicate 1 night
        ELSE minimum_nights
    END AS minimum_nights,
    host_id,
    REPLACE( -- Parse string value into numerical form
        price_str, '$' -- Replace '$' with price_str value. In other words, to remove '$' from string.
        ) :: NUMBER (10, 2 -- Convert string type to numerical with 2 decimal places
    ) AS price,
    created_at,
    updated_at
    
FROM src_listings
  );
[0m05:24:59.011279 [debug] [Thread-4  ]: On model.dbtlearn.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_hosts_cleansed"} */
create or replace   view airbnb.dev.dim_hosts_cleansed
  
   as (
    

WITH  __dbt__cte__src_hosts as (
WITH raw_hosts AS (
	SELECT * FROM airbnb.raw.raw_hosts
)

SELECT
    id AS host_id,
    name AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM raw_hosts
),src_hosts AS (
    SELECT * FROM __dbt__cte__src_hosts
)

SELECT 
    host_id,
    NVL(host_name, 'Anonymous') AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM src_hosts
  );
[0m05:24:59.011580 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m05:24:59.011780 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m05:24:59.014689 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m05:24:59.015558 [debug] [Thread-2  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
create or replace transient table airbnb.dev.fct_reviews  as
        (-- Doc | Config : https://docs.getdbt.com/reference/dbt-jinja-functions/config


-- dbt materializes the model as an incremental table. 
-- Read for difference btw table vs. incremental: https://docs.getdbt.com/docs/build/materializations

WITH  __dbt__cte__src_reviews as (
WITH raw_reviews AS (
	SELECT * FROM airbnb.raw.raw_reviews
)

SELECT
    listing_id,
    date AS review_date,
    reviewer_name,
    comments AS review_text,
    sentiment AS review_sentiment
FROM raw_reviews
),src_reviews AS (
    SELECT * FROM __dbt__cte__src_reviews
)

SELECT 
    
    
md5(cast(coalesce(cast(listing_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(review_date as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(reviewer_name as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(review_text as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as review_id,
    listing_id,
    review_date,
    NVL(reviewer_name, 'Anonymous') AS reviewer_name,
    review_text,
    review_sentiment
FROM src_reviews
WHERE review_text IS NOT NULL


        );
[0m05:24:59.016393 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m05:25:01.208096 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 2 seconds
[0m05:25:01.253939 [debug] [Thread-4  ]: Timing info for model.dbtlearn.dim_hosts_cleansed (execute): 2023-03-02 05:24:58.917539 => 2023-03-02 05:25:01.253837
[0m05:25:01.254404 [debug] [Thread-4  ]: On model.dbtlearn.dim_hosts_cleansed: Close
[0m05:25:01.257066 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2 seconds
[0m05:25:01.260056 [debug] [Thread-1  ]: Timing info for model.dbtlearn.dim_listings_cleansed (execute): 2023-03-02 05:24:58.951231 => 2023-03-02 05:25:01.260000
[0m05:25:01.260399 [debug] [Thread-1  ]: On model.dbtlearn.dim_listings_cleansed: Close
[0m05:25:01.827746 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6551c49d-ce92-41da-bfc4-e493b925fa27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4b967be50>]}
[0m05:25:01.829715 [info ] [Thread-4  ]: 1 of 5 OK created sql view model dev.dim_hosts_cleansed ........................ [[32mSUCCESS 1[0m in 2.98s]
[0m05:25:01.830763 [debug] [Thread-4  ]: Finished running node model.dbtlearn.dim_hosts_cleansed
[0m05:25:01.896708 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6551c49d-ce92-41da-bfc4-e493b925fa27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4b9782790>]}
[0m05:25:01.898720 [info ] [Thread-1  ]: 2 of 5 OK created sql view model dev.dim_listings_cleansed ..................... [[32mSUCCESS 1[0m in 3.04s]
[0m05:25:01.899776 [debug] [Thread-1  ]: Finished running node model.dbtlearn.dim_listings_cleansed
[0m05:25:01.901264 [debug] [Thread-3  ]: Began running node model.dbtlearn.dim_listings_w_hosts
[0m05:25:01.901923 [info ] [Thread-3  ]: 4 of 5 START sql table model dev.dim_listings_w_hosts .......................... [RUN]
[0m05:25:01.903298 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtlearn.dim_listings_w_hosts'
[0m05:25:01.903821 [debug] [Thread-3  ]: Began compiling node model.dbtlearn.dim_listings_w_hosts
[0m05:25:01.911887 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtlearn.dim_listings_w_hosts"
[0m05:25:01.913046 [debug] [Thread-3  ]: Timing info for model.dbtlearn.dim_listings_w_hosts (compile): 2023-03-02 05:25:01.904144 => 2023-03-02 05:25:01.912937
[0m05:25:01.913509 [debug] [Thread-3  ]: Began executing node model.dbtlearn.dim_listings_w_hosts
[0m05:25:01.930779 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbtlearn.dim_listings_w_hosts"
[0m05:25:01.932962 [debug] [Thread-3  ]: Using snowflake connection "model.dbtlearn.dim_listings_w_hosts"
[0m05:25:01.933192 [debug] [Thread-3  ]: On model.dbtlearn.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_w_hosts"} */
create or replace transient table airbnb.dev.dim_listings_w_hosts  as
        (WITH 
listings AS (
    SELECT * FROM airbnb.dev.dim_listings_cleansed
),
hosts AS (
    SELECT * FROM airbnb.dev.dim_hosts_cleansed
)

SELECT 
    listings.listing_id,
    listings.listing_name,
    listings.room_type,
    listings.minimum_nights,
    listings.price,
    listings.host_id,
    hosts.host_name,
    hosts.is_superhost AS host_is_superhost,
    listings.created_at,
    GREATEST(listings.updated_at, hosts.updated_at) AS updated_at -- Keep most recent updated_at
FROM listings
LEFT JOIN hosts
    ON listings.host_id = hosts.host_id
        );
[0m05:25:01.933390 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m05:25:05.030410 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 3 seconds
[0m05:25:05.055762 [debug] [Thread-3  ]: Timing info for model.dbtlearn.dim_listings_w_hosts (execute): 2023-03-02 05:25:01.913799 => 2023-03-02 05:25:05.055561
[0m05:25:05.056678 [debug] [Thread-3  ]: On model.dbtlearn.dim_listings_w_hosts: Close
[0m05:25:05.651522 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6551c49d-ce92-41da-bfc4-e493b925fa27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4b97824f0>]}
[0m05:25:05.653673 [info ] [Thread-3  ]: 4 of 5 OK created sql table model dev.dim_listings_w_hosts ..................... [[32mSUCCESS 1[0m in 3.75s]
[0m05:25:05.654968 [debug] [Thread-3  ]: Finished running node model.dbtlearn.dim_listings_w_hosts
[0m05:25:06.978425 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 8 seconds
[0m05:25:07.001362 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m05:25:07.001930 [debug] [Thread-2  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
drop view if exists airbnb.dev.fct_reviews__dbt_tmp cascade
[0m05:25:07.298601 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0 seconds
[0m05:25:07.309685 [debug] [Thread-2  ]: Timing info for model.dbtlearn.fct_reviews (execute): 2023-03-02 05:24:58.954201 => 2023-03-02 05:25:07.309268
[0m05:25:07.310931 [debug] [Thread-2  ]: On model.dbtlearn.fct_reviews: Close
[0m05:25:07.900616 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6551c49d-ce92-41da-bfc4-e493b925fa27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4b973b160>]}
[0m05:25:07.903036 [info ] [Thread-2  ]: 3 of 5 OK created sql incremental model dev.fct_reviews ........................ [[32mSUCCESS 1[0m in 9.05s]
[0m05:25:07.903830 [debug] [Thread-2  ]: Finished running node model.dbtlearn.fct_reviews
[0m05:25:07.905113 [debug] [Thread-1  ]: Began running node model.dbtlearn.mart_fullmoon_reviews
[0m05:25:07.905893 [info ] [Thread-1  ]: 5 of 5 START sql table model dev.mart_fullmoon_reviews ......................... [RUN]
[0m05:25:07.907234 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtlearn.mart_fullmoon_reviews'
[0m05:25:07.907692 [debug] [Thread-1  ]: Began compiling node model.dbtlearn.mart_fullmoon_reviews
[0m05:25:07.915532 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearn.mart_fullmoon_reviews"
[0m05:25:07.916700 [debug] [Thread-1  ]: Timing info for model.dbtlearn.mart_fullmoon_reviews (compile): 2023-03-02 05:25:07.907995 => 2023-03-02 05:25:07.916608
[0m05:25:07.917057 [debug] [Thread-1  ]: Began executing node model.dbtlearn.mart_fullmoon_reviews
[0m05:25:07.921123 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtlearn.mart_fullmoon_reviews"
[0m05:25:07.923194 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.mart_fullmoon_reviews"
[0m05:25:07.923705 [debug] [Thread-1  ]: On model.dbtlearn.mart_fullmoon_reviews: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.mart_fullmoon_reviews"} */
create or replace transient table airbnb.dev.mart_fullmoon_reviews  as
        (

WITH fct_reviews AS (

    SELECT * FROM airbnb.dev.fct_reviews

),
full_moon_dates AS (

    SELECT * FROM airbnb.dev.seed_full_moon_dates
)

SELECT
    reviews.*,
    CASE
        WHEN fullmoon.full_moon_date IS NULL THEN 'not full moon'
        ELSE 'full moon' END AS is_full_moon
FROM fct_reviews AS reviews
LEFT JOIN full_moon_dates AS fullmoon
    ON (TO_DATE(reviews.review_date) = DATEADD(DAY, 1, fullmoon.full_moon_date))
        );
[0m05:25:07.923976 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m05:25:13.219924 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 5 seconds
[0m05:25:13.227271 [debug] [Thread-1  ]: Timing info for model.dbtlearn.mart_fullmoon_reviews (execute): 2023-03-02 05:25:07.917295 => 2023-03-02 05:25:13.227120
[0m05:25:13.227914 [debug] [Thread-1  ]: On model.dbtlearn.mart_fullmoon_reviews: Close
[0m05:25:13.859529 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6551c49d-ce92-41da-bfc4-e493b925fa27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4b98f8c10>]}
[0m05:25:13.860519 [info ] [Thread-1  ]: 5 of 5 OK created sql table model dev.mart_fullmoon_reviews .................... [[32mSUCCESS 1[0m in 5.95s]
[0m05:25:13.861354 [debug] [Thread-1  ]: Finished running node model.dbtlearn.mart_fullmoon_reviews
[0m05:25:13.864176 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m05:25:13.865186 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:25:13.865550 [debug] [MainThread]: Connection 'model.dbtlearn.mart_fullmoon_reviews' was properly closed.
[0m05:25:13.865855 [debug] [MainThread]: Connection 'model.dbtlearn.fct_reviews' was properly closed.
[0m05:25:13.866151 [debug] [MainThread]: Connection 'model.dbtlearn.dim_listings_w_hosts' was properly closed.
[0m05:25:13.866452 [debug] [MainThread]: Connection 'model.dbtlearn.dim_hosts_cleansed' was properly closed.
[0m05:25:13.866905 [info ] [MainThread]: 
[0m05:25:13.867462 [info ] [MainThread]: Finished running 2 view models, 2 table models, 1 incremental model in 0 hours 0 minutes and 22.06 seconds (22.06s).
[0m05:25:13.868461 [debug] [MainThread]: Command end result
[0m05:25:13.883387 [info ] [MainThread]: 
[0m05:25:13.883906 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:25:13.884280 [info ] [MainThread]: 
[0m05:25:13.884621 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m05:25:13.885074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff48804a940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff48804ab20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4b9698df0>]}
[0m05:25:13.885463 [debug] [MainThread]: Flushing usage events


============================== 2023-03-02 05:29:02.278057 | 8147fba1-c521-47ee-82c6-b81aabbdbd62 ==============================
[0m05:29:02.278057 [info ] [MainThread]: Running with dbt=1.4.3
[0m05:29:02.280399 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/katiehuang/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['fct_reviews'], 'full_refresh': True, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m05:29:02.280690 [debug] [MainThread]: Tracking: tracking
[0m05:29:02.281545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc189accac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc189accee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc189accdf0>]}
[0m05:29:02.301585 [debug] [MainThread]: checksum: c7a5cda64f02d8b9dd20ef412f82fbb79fdce1bb359c3c5dae3d080de7f31bfd, vars: {}, profile: None, target: None, version: 1.4.3
[0m05:29:02.365808 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:29:02.366117 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:29:02.374443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8147fba1-c521-47ee-82c6-b81aabbdbd62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc179d0bb50>]}
[0m05:29:02.385600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8147fba1-c521-47ee-82c6-b81aabbdbd62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc179c0a4f0>]}
[0m05:29:02.386026 [info ] [MainThread]: Found 8 models, 9 tests, 1 snapshot, 0 analyses, 418 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
[0m05:29:02.386348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8147fba1-c521-47ee-82c6-b81aabbdbd62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc179c0a4c0>]}
[0m05:29:02.388059 [info ] [MainThread]: 
[0m05:29:02.389588 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m05:29:02.390695 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_airbnb'
[0m05:29:02.407269 [debug] [ThreadPool]: Using snowflake connection "list_airbnb"
[0m05:29:02.407617 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb"} */
show terse schemas in database airbnb
    limit 10000
[0m05:29:02.407860 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:29:04.722791 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2 seconds
[0m05:29:04.727708 [debug] [ThreadPool]: On list_airbnb: Close
[0m05:29:05.374446 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_airbnb_dev'
[0m05:29:05.387582 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m05:29:05.387986 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m05:29:05.388310 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:29:07.106888 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 2 seconds
[0m05:29:07.111722 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m05:29:07.729735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8147fba1-c521-47ee-82c6-b81aabbdbd62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc179d13070>]}
[0m05:29:07.731087 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m05:29:07.731699 [info ] [MainThread]: 
[0m05:29:07.740439 [debug] [Thread-1  ]: Began running node model.dbtlearn.fct_reviews
[0m05:29:07.741025 [info ] [Thread-1  ]: 1 of 1 START sql incremental model dev.fct_reviews ............................. [RUN]
[0m05:29:07.742030 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtlearn.fct_reviews'
[0m05:29:07.742391 [debug] [Thread-1  ]: Began compiling node model.dbtlearn.fct_reviews
[0m05:29:07.775996 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearn.fct_reviews"
[0m05:29:07.793417 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearn.fct_reviews"
[0m05:29:07.793876 [debug] [Thread-1  ]: Timing info for model.dbtlearn.fct_reviews (compile): 2023-03-02 05:29:07.742642 => 2023-03-02 05:29:07.793804
[0m05:29:07.794119 [debug] [Thread-1  ]: Began executing node model.dbtlearn.fct_reviews
[0m05:29:07.854642 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtlearn.fct_reviews"
[0m05:29:07.856579 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m05:29:07.856777 [debug] [Thread-1  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
create or replace transient table airbnb.dev.fct_reviews  as
        (-- Doc | Config : https://docs.getdbt.com/reference/dbt-jinja-functions/config


-- dbt materializes the model as an incremental table. 
-- Read for difference btw table vs. incremental: https://docs.getdbt.com/docs/build/materializations

WITH  __dbt__cte__src_reviews as (
WITH raw_reviews AS (
	SELECT * FROM airbnb.raw.raw_reviews
)

SELECT
    listing_id,
    date AS review_date,
    reviewer_name,
    comments AS review_text,
    sentiment AS review_sentiment
FROM raw_reviews
),src_reviews AS (
    SELECT * FROM __dbt__cte__src_reviews
)

SELECT 
    
    
md5(cast(coalesce(cast(listing_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(review_date as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(reviewer_name as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(review_text as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as review_id,
    listing_id,
    review_date,
    NVL(reviewer_name, 'Anonymous') AS reviewer_name,
    review_text,
    review_sentiment
FROM src_reviews
WHERE review_text IS NOT NULL


        );
[0m05:29:07.856965 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m05:29:13.764657 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 6 seconds
[0m05:29:13.784716 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m05:29:13.785576 [debug] [Thread-1  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
drop view if exists airbnb.dev.fct_reviews__dbt_tmp cascade
[0m05:29:14.098354 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m05:29:14.154348 [debug] [Thread-1  ]: Timing info for model.dbtlearn.fct_reviews (execute): 2023-03-02 05:29:07.794281 => 2023-03-02 05:29:14.154258
[0m05:29:14.154718 [debug] [Thread-1  ]: On model.dbtlearn.fct_reviews: Close
[0m05:29:14.767745 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8147fba1-c521-47ee-82c6-b81aabbdbd62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc189abfc70>]}
[0m05:29:14.770634 [info ] [Thread-1  ]: 1 of 1 OK created sql incremental model dev.fct_reviews ........................ [[32mSUCCESS 1[0m in 7.03s]
[0m05:29:14.778876 [debug] [Thread-1  ]: Finished running node model.dbtlearn.fct_reviews
[0m05:29:14.783642 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m05:29:14.785147 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:29:14.785495 [debug] [MainThread]: Connection 'model.dbtlearn.fct_reviews' was properly closed.
[0m05:29:14.785985 [info ] [MainThread]: 
[0m05:29:14.786570 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 12.40 seconds (12.40s).
[0m05:29:14.787391 [debug] [MainThread]: Command end result
[0m05:29:14.804153 [info ] [MainThread]: 
[0m05:29:14.804769 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:29:14.805184 [info ] [MainThread]: 
[0m05:29:14.805573 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m05:29:14.806066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc179ce48e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc179f87370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc179f87550>]}
[0m05:29:14.806463 [debug] [MainThread]: Flushing usage events


============================== 2023-03-02 05:48:29.970498 | 8bed294b-089b-4dec-8e15-bdc42ce97205 ==============================
[0m05:48:29.970498 [info ] [MainThread]: Running with dbt=1.4.3
[0m05:48:29.972915 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/katiehuang/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'compile': True, 'which': 'generate', 'rpc_method': 'docs.generate', 'indirect_selection': 'eager'}
[0m05:48:29.973290 [debug] [MainThread]: Tracking: tracking
[0m05:48:29.974026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf393818b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf39381c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf39381b20>]}
[0m05:48:29.994349 [debug] [MainThread]: checksum: c7a5cda64f02d8b9dd20ef412f82fbb79fdce1bb359c3c5dae3d080de7f31bfd, vars: {}, profile: None, target: None, version: 1.4.3
[0m05:48:30.064287 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m05:48:30.065033 [debug] [MainThread]: Partial parsing: updated file: dbtlearn://models/schema.yml
[0m05:48:30.065374 [debug] [MainThread]: Partial parsing: updated file: dbtlearn://tests/no_nulls_in_dim_listings.sql
[0m05:48:30.065664 [debug] [MainThread]: Partial parsing: updated file: dbtlearn://models/fct/fct_reviews.sql
[0m05:48:30.085351 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_cleansed.sql
[0m05:48:30.099745 [debug] [MainThread]: 1603: static parser failed on fct/fct_reviews.sql
[0m05:48:30.123500 [debug] [MainThread]: 1602: parser fallback to jinja rendering on fct/fct_reviews.sql
[0m05:48:30.207552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8bed294b-089b-4dec-8e15-bdc42ce97205', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf393c9850>]}
[0m05:48:30.220836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8bed294b-089b-4dec-8e15-bdc42ce97205', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf3940fac0>]}
[0m05:48:30.221234 [info ] [MainThread]: Found 8 models, 9 tests, 1 snapshot, 0 analyses, 418 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
[0m05:48:30.221563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8bed294b-089b-4dec-8e15-bdc42ce97205', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf5a767f70>]}
[0m05:48:30.223805 [info ] [MainThread]: 
[0m05:48:30.225397 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m05:48:30.271658 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_airbnb_dev'
[0m05:48:30.286915 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m05:48:30.287189 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m05:48:30.287407 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:48:32.593550 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 2 seconds
[0m05:48:32.599360 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m05:48:33.189638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8bed294b-089b-4dec-8e15-bdc42ce97205', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf482073a0>]}
[0m05:48:33.190975 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m05:48:33.191560 [info ] [MainThread]: 
[0m05:48:33.198648 [debug] [Thread-1  ]: Began running node model.dbtlearn.src_hosts
[0m05:48:33.199149 [debug] [Thread-2  ]: Began running node model.dbtlearn.src_listings
[0m05:48:33.199539 [debug] [Thread-3  ]: Began running node model.dbtlearn.src_reviews
[0m05:48:33.200318 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtlearn.src_hosts'
[0m05:48:33.200913 [debug] [Thread-4  ]: Began running node seed.dbtlearn.seed_full_moon_dates
[0m05:48:33.201652 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtlearn.src_listings'
[0m05:48:33.202340 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtlearn.src_reviews'
[0m05:48:33.202688 [debug] [Thread-1  ]: Began compiling node model.dbtlearn.src_hosts
[0m05:48:33.203468 [debug] [Thread-4  ]: Acquiring new snowflake connection 'seed.dbtlearn.seed_full_moon_dates'
[0m05:48:33.203829 [debug] [Thread-2  ]: Began compiling node model.dbtlearn.src_listings
[0m05:48:33.204180 [debug] [Thread-3  ]: Began compiling node model.dbtlearn.src_reviews
[0m05:48:33.208728 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearn.src_hosts"
[0m05:48:33.209073 [debug] [Thread-4  ]: Began compiling node seed.dbtlearn.seed_full_moon_dates
[0m05:48:33.212658 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtlearn.src_listings"
[0m05:48:33.216512 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtlearn.src_reviews"
[0m05:48:33.219021 [debug] [Thread-4  ]: Timing info for seed.dbtlearn.seed_full_moon_dates (compile): 2023-03-02 05:48:33.216983 => 2023-03-02 05:48:33.218941
[0m05:48:33.219608 [debug] [Thread-4  ]: Began executing node seed.dbtlearn.seed_full_moon_dates
[0m05:48:33.219932 [debug] [Thread-4  ]: Timing info for seed.dbtlearn.seed_full_moon_dates (execute): 2023-03-02 05:48:33.219863 => 2023-03-02 05:48:33.219883
[0m05:48:33.220186 [debug] [Thread-1  ]: Timing info for model.dbtlearn.src_hosts (compile): 2023-03-02 05:48:33.204443 => 2023-03-02 05:48:33.220146
[0m05:48:33.221897 [debug] [Thread-4  ]: Finished running node seed.dbtlearn.seed_full_moon_dates
[0m05:48:33.222144 [debug] [Thread-2  ]: Timing info for model.dbtlearn.src_listings (compile): 2023-03-02 05:48:33.209283 => 2023-03-02 05:48:33.222092
[0m05:48:33.222377 [debug] [Thread-3  ]: Timing info for model.dbtlearn.src_reviews (compile): 2023-03-02 05:48:33.212933 => 2023-03-02 05:48:33.222339
[0m05:48:33.222982 [debug] [Thread-1  ]: Finished running node model.dbtlearn.src_hosts
[0m05:48:33.223330 [debug] [Thread-4  ]: Began running node snapshot.dbtlearn.scd_raw_listings
[0m05:48:33.224076 [debug] [Thread-2  ]: Finished running node model.dbtlearn.src_listings
[0m05:48:33.224718 [debug] [Thread-3  ]: Finished running node model.dbtlearn.src_reviews
[0m05:48:33.225388 [debug] [Thread-4  ]: Acquiring new snowflake connection 'snapshot.dbtlearn.scd_raw_listings'
[0m05:48:33.225798 [debug] [Thread-2  ]: Began running node model.dbtlearn.dim_hosts_cleansed
[0m05:48:33.226311 [debug] [Thread-4  ]: Began compiling node snapshot.dbtlearn.scd_raw_listings
[0m05:48:33.226616 [debug] [Thread-1  ]: Began running node model.dbtlearn.dim_listings_cleansed
[0m05:48:33.226872 [debug] [Thread-3  ]: Began running node model.dbtlearn.fct_reviews
[0m05:48:33.227370 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtlearn.dim_hosts_cleansed'
[0m05:48:33.231082 [debug] [Thread-4  ]: Timing info for snapshot.dbtlearn.scd_raw_listings (compile): 2023-03-02 05:48:33.227545 => 2023-03-02 05:48:33.231034
[0m05:48:33.231575 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtlearn.dim_listings_cleansed'
[0m05:48:33.232016 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtlearn.fct_reviews'
[0m05:48:33.232237 [debug] [Thread-2  ]: Began compiling node model.dbtlearn.dim_hosts_cleansed
[0m05:48:33.232462 [debug] [Thread-4  ]: Began executing node snapshot.dbtlearn.scd_raw_listings
[0m05:48:33.232679 [debug] [Thread-1  ]: Began compiling node model.dbtlearn.dim_listings_cleansed
[0m05:48:33.232884 [debug] [Thread-3  ]: Began compiling node model.dbtlearn.fct_reviews
[0m05:48:33.239004 [debug] [Thread-4  ]: Timing info for snapshot.dbtlearn.scd_raw_listings (execute): 2023-03-02 05:48:33.238946 => 2023-03-02 05:48:33.238957
[0m05:48:33.240679 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtlearn.dim_hosts_cleansed"
[0m05:48:33.256560 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearn.dim_listings_cleansed"
[0m05:48:33.257227 [debug] [Thread-4  ]: Finished running node snapshot.dbtlearn.scd_raw_listings
[0m05:48:33.268812 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtlearn.fct_reviews"
[0m05:48:33.269525 [debug] [Thread-1  ]: Timing info for model.dbtlearn.dim_listings_cleansed (compile): 2023-03-02 05:48:33.240869 => 2023-03-02 05:48:33.269475
[0m05:48:33.269741 [debug] [Thread-3  ]: Timing info for model.dbtlearn.fct_reviews (compile): 2023-03-02 05:48:33.247193 => 2023-03-02 05:48:33.269697
[0m05:48:33.269967 [debug] [Thread-1  ]: Began executing node model.dbtlearn.dim_listings_cleansed
[0m05:48:33.270221 [debug] [Thread-3  ]: Began executing node model.dbtlearn.fct_reviews
[0m05:48:33.270411 [debug] [Thread-2  ]: Timing info for model.dbtlearn.dim_hosts_cleansed (compile): 2023-03-02 05:48:33.233039 => 2023-03-02 05:48:33.270371
[0m05:48:33.270594 [debug] [Thread-1  ]: Timing info for model.dbtlearn.dim_listings_cleansed (execute): 2023-03-02 05:48:33.270557 => 2023-03-02 05:48:33.270564
[0m05:48:33.270817 [debug] [Thread-3  ]: Timing info for model.dbtlearn.fct_reviews (execute): 2023-03-02 05:48:33.270781 => 2023-03-02 05:48:33.270786
[0m05:48:33.271024 [debug] [Thread-2  ]: Began executing node model.dbtlearn.dim_hosts_cleansed
[0m05:48:33.271574 [debug] [Thread-1  ]: Finished running node model.dbtlearn.dim_listings_cleansed
[0m05:48:33.272101 [debug] [Thread-3  ]: Finished running node model.dbtlearn.fct_reviews
[0m05:48:33.272303 [debug] [Thread-2  ]: Timing info for model.dbtlearn.dim_hosts_cleansed (execute): 2023-03-02 05:48:33.272266 => 2023-03-02 05:48:33.272272
[0m05:48:33.273321 [debug] [Thread-2  ]: Finished running node model.dbtlearn.dim_hosts_cleansed
[0m05:48:33.273603 [debug] [Thread-4  ]: Began running node test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m05:48:33.273871 [debug] [Thread-2  ]: Began running node test.dbtlearn.dim_listings_minimum_nights
[0m05:48:33.274094 [debug] [Thread-1  ]: Began running node test.dbtlearn.no_nulls_in_dim_listings
[0m05:48:33.274378 [debug] [Thread-3  ]: Began running node test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m05:48:33.274823 [debug] [Thread-4  ]: Acquiring new snowflake connection 'test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af'
[0m05:48:33.275357 [debug] [Thread-2  ]: Acquiring new snowflake connection 'test.dbtlearn.dim_listings_minimum_nights'
[0m05:48:33.275787 [debug] [Thread-1  ]: Acquiring new snowflake connection 'test.dbtlearn.no_nulls_in_dim_listings'
[0m05:48:33.276285 [debug] [Thread-3  ]: Acquiring new snowflake connection 'test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be'
[0m05:48:33.276521 [debug] [Thread-4  ]: Began compiling node test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m05:48:33.276744 [debug] [Thread-2  ]: Began compiling node test.dbtlearn.dim_listings_minimum_nights
[0m05:48:33.276954 [debug] [Thread-1  ]: Began compiling node test.dbtlearn.no_nulls_in_dim_listings
[0m05:48:33.277150 [debug] [Thread-3  ]: Began compiling node test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m05:48:33.283360 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m05:48:33.285931 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbtlearn.dim_listings_minimum_nights"
[0m05:48:33.298334 [debug] [Thread-1  ]: Using snowflake connection "test.dbtlearn.no_nulls_in_dim_listings"
[0m05:48:33.307628 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m05:48:33.308048 [debug] [Thread-1  ]: On test.dbtlearn.no_nulls_in_dim_listings: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.no_nulls_in_dim_listings"} */
describe table airbnb.dev.dim_listings_cleansed
[0m05:48:33.308350 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m05:48:33.309975 [debug] [Thread-2  ]: Timing info for test.dbtlearn.dim_listings_minimum_nights (compile): 2023-03-02 05:48:33.283559 => 2023-03-02 05:48:33.309915
[0m05:48:33.310205 [debug] [Thread-4  ]: Timing info for test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af (compile): 2023-03-02 05:48:33.277295 => 2023-03-02 05:48:33.310154
[0m05:48:33.310399 [debug] [Thread-3  ]: Timing info for test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be (compile): 2023-03-02 05:48:33.298511 => 2023-03-02 05:48:33.310362
[0m05:48:33.310614 [debug] [Thread-2  ]: Began executing node test.dbtlearn.dim_listings_minimum_nights
[0m05:48:33.310991 [debug] [Thread-4  ]: Began executing node test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m05:48:33.311537 [debug] [Thread-3  ]: Began executing node test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m05:48:33.311769 [debug] [Thread-2  ]: Timing info for test.dbtlearn.dim_listings_minimum_nights (execute): 2023-03-02 05:48:33.311718 => 2023-03-02 05:48:33.311729
[0m05:48:33.311989 [debug] [Thread-4  ]: Timing info for test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af (execute): 2023-03-02 05:48:33.311948 => 2023-03-02 05:48:33.311954
[0m05:48:33.312505 [debug] [Thread-3  ]: Timing info for test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be (execute): 2023-03-02 05:48:33.312468 => 2023-03-02 05:48:33.312473
[0m05:48:33.313113 [debug] [Thread-2  ]: Finished running node test.dbtlearn.dim_listings_minimum_nights
[0m05:48:33.313683 [debug] [Thread-4  ]: Finished running node test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m05:48:33.314249 [debug] [Thread-3  ]: Finished running node test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m05:48:33.314571 [debug] [Thread-2  ]: Began running node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m05:48:33.314910 [debug] [Thread-4  ]: Began running node test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m05:48:33.315230 [debug] [Thread-3  ]: Began running node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m05:48:33.315912 [debug] [Thread-2  ]: Acquiring new snowflake connection 'test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9'
[0m05:48:33.316346 [debug] [Thread-4  ]: Acquiring new snowflake connection 'test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313'
[0m05:48:33.316774 [debug] [Thread-3  ]: Acquiring new snowflake connection 'test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e'
[0m05:48:33.316982 [debug] [Thread-2  ]: Began compiling node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m05:48:33.317186 [debug] [Thread-4  ]: Began compiling node test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m05:48:33.317379 [debug] [Thread-3  ]: Began compiling node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m05:48:33.321668 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m05:48:33.325282 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313"
[0m05:48:33.331800 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m05:48:33.332520 [debug] [Thread-2  ]: Timing info for test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9 (compile): 2023-03-02 05:48:33.317523 => 2023-03-02 05:48:33.332470
[0m05:48:33.332742 [debug] [Thread-3  ]: Timing info for test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e (compile): 2023-03-02 05:48:33.325473 => 2023-03-02 05:48:33.332692
[0m05:48:33.332972 [debug] [Thread-2  ]: Began executing node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m05:48:33.333193 [debug] [Thread-3  ]: Began executing node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m05:48:33.333421 [debug] [Thread-2  ]: Timing info for test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9 (execute): 2023-03-02 05:48:33.333376 => 2023-03-02 05:48:33.333385
[0m05:48:33.333613 [debug] [Thread-4  ]: Timing info for test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313 (compile): 2023-03-02 05:48:33.321869 => 2023-03-02 05:48:33.333572
[0m05:48:33.333787 [debug] [Thread-3  ]: Timing info for test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e (execute): 2023-03-02 05:48:33.333751 => 2023-03-02 05:48:33.333757
[0m05:48:33.334356 [debug] [Thread-2  ]: Finished running node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m05:48:33.334583 [debug] [Thread-4  ]: Began executing node test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m05:48:33.335120 [debug] [Thread-3  ]: Finished running node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m05:48:33.335402 [debug] [Thread-2  ]: Began running node model.dbtlearn.mart_fullmoon_reviews
[0m05:48:33.335676 [debug] [Thread-4  ]: Timing info for test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313 (execute): 2023-03-02 05:48:33.335634 => 2023-03-02 05:48:33.335640
[0m05:48:33.335958 [debug] [Thread-3  ]: Began running node test.dbtlearn.consistent_created_at
[0m05:48:33.336460 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtlearn.mart_fullmoon_reviews'
[0m05:48:33.337020 [debug] [Thread-4  ]: Finished running node test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m05:48:33.337451 [debug] [Thread-3  ]: Acquiring new snowflake connection 'test.dbtlearn.consistent_created_at'
[0m05:48:33.337658 [debug] [Thread-2  ]: Began compiling node model.dbtlearn.mart_fullmoon_reviews
[0m05:48:33.337939 [debug] [Thread-4  ]: Began running node model.dbtlearn.dim_listings_w_hosts
[0m05:48:33.338190 [debug] [Thread-3  ]: Began compiling node test.dbtlearn.consistent_created_at
[0m05:48:33.341467 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtlearn.mart_fullmoon_reviews"
[0m05:48:33.341957 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.dbtlearn.dim_listings_w_hosts'
[0m05:48:33.344971 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbtlearn.consistent_created_at"
[0m05:48:33.345294 [debug] [Thread-4  ]: Began compiling node model.dbtlearn.dim_listings_w_hosts
[0m05:48:33.348268 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtlearn.dim_listings_w_hosts"
[0m05:48:33.348651 [debug] [Thread-3  ]: Timing info for test.dbtlearn.consistent_created_at (compile): 2023-03-02 05:48:33.342131 => 2023-03-02 05:48:33.348604
[0m05:48:33.348899 [debug] [Thread-2  ]: Timing info for model.dbtlearn.mart_fullmoon_reviews (compile): 2023-03-02 05:48:33.338342 => 2023-03-02 05:48:33.348854
[0m05:48:33.349115 [debug] [Thread-3  ]: Began executing node test.dbtlearn.consistent_created_at
[0m05:48:33.349344 [debug] [Thread-2  ]: Began executing node model.dbtlearn.mart_fullmoon_reviews
[0m05:48:33.349506 [debug] [Thread-4  ]: Timing info for model.dbtlearn.dim_listings_w_hosts (compile): 2023-03-02 05:48:33.345553 => 2023-03-02 05:48:33.349472
[0m05:48:33.349710 [debug] [Thread-3  ]: Timing info for test.dbtlearn.consistent_created_at (execute): 2023-03-02 05:48:33.349665 => 2023-03-02 05:48:33.349673
[0m05:48:33.349908 [debug] [Thread-2  ]: Timing info for model.dbtlearn.mart_fullmoon_reviews (execute): 2023-03-02 05:48:33.349869 => 2023-03-02 05:48:33.349875
[0m05:48:33.350114 [debug] [Thread-4  ]: Began executing node model.dbtlearn.dim_listings_w_hosts
[0m05:48:33.350673 [debug] [Thread-3  ]: Finished running node test.dbtlearn.consistent_created_at
[0m05:48:33.351222 [debug] [Thread-2  ]: Finished running node model.dbtlearn.mart_fullmoon_reviews
[0m05:48:33.351420 [debug] [Thread-4  ]: Timing info for model.dbtlearn.dim_listings_w_hosts (execute): 2023-03-02 05:48:33.351380 => 2023-03-02 05:48:33.351386
[0m05:48:33.351715 [debug] [Thread-3  ]: Began running node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m05:48:33.352412 [debug] [Thread-4  ]: Finished running node model.dbtlearn.dim_listings_w_hosts
[0m05:48:33.352852 [debug] [Thread-3  ]: Acquiring new snowflake connection 'test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad'
[0m05:48:33.353156 [debug] [Thread-3  ]: Began compiling node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m05:48:33.359866 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m05:48:33.360324 [debug] [Thread-3  ]: Timing info for test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad (compile): 2023-03-02 05:48:33.353307 => 2023-03-02 05:48:33.360277
[0m05:48:33.360556 [debug] [Thread-3  ]: Began executing node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m05:48:33.360746 [debug] [Thread-3  ]: Timing info for test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad (execute): 2023-03-02 05:48:33.360705 => 2023-03-02 05:48:33.360712
[0m05:48:33.361284 [debug] [Thread-3  ]: Finished running node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m05:48:35.340211 [debug] [Thread-1  ]: SQL status: SUCCESS 8 in 2 seconds
[0m05:48:35.347305 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbtlearn.no_nulls_in_dim_listings"
[0m05:48:35.349984 [debug] [Thread-1  ]: Timing info for test.dbtlearn.no_nulls_in_dim_listings (compile): 2023-03-02 05:48:33.286119 => 2023-03-02 05:48:35.349865
[0m05:48:35.350455 [debug] [Thread-1  ]: Began executing node test.dbtlearn.no_nulls_in_dim_listings
[0m05:48:35.350833 [debug] [Thread-1  ]: Timing info for test.dbtlearn.no_nulls_in_dim_listings (execute): 2023-03-02 05:48:35.350748 => 2023-03-02 05:48:35.350770
[0m05:48:35.351202 [debug] [Thread-1  ]: On test.dbtlearn.no_nulls_in_dim_listings: Close
[0m05:48:36.002953 [debug] [Thread-1  ]: Finished running node test.dbtlearn.no_nulls_in_dim_listings
[0m05:48:36.006934 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:48:36.007317 [debug] [MainThread]: Connection 'test.dbtlearn.no_nulls_in_dim_listings' was properly closed.
[0m05:48:36.007614 [debug] [MainThread]: Connection 'model.dbtlearn.mart_fullmoon_reviews' was properly closed.
[0m05:48:36.007910 [debug] [MainThread]: Connection 'test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad' was properly closed.
[0m05:48:36.008185 [debug] [MainThread]: Connection 'model.dbtlearn.dim_listings_w_hosts' was properly closed.
[0m05:48:36.009775 [debug] [MainThread]: Command end result
[0m05:48:36.025845 [info ] [MainThread]: Done.
[0m05:48:36.031609 [debug] [MainThread]: Acquiring new snowflake connection 'generate_catalog'
[0m05:48:36.031932 [info ] [MainThread]: Building catalog
[0m05:48:36.034748 [debug] [ThreadPool]: Acquiring new snowflake connection 'airbnb.information_schema'
[0m05:48:36.044898 [debug] [ThreadPool]: Using snowflake connection "airbnb.information_schema"
[0m05:48:36.045223 [debug] [ThreadPool]: On airbnb.information_schema: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "airbnb.information_schema"} */
with tables as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",
              table_type as "table_type",
              comment as "table_comment",

              -- note: this is the _role_ that owns the table
              table_owner as "table_owner",

              'Clustering Key' as "stats:clustering_key:label",
              clustering_key as "stats:clustering_key:value",
              'The key used to cluster this table' as "stats:clustering_key:description",
              (clustering_key is not null) as "stats:clustering_key:include",

              'Row Count' as "stats:row_count:label",
              row_count as "stats:row_count:value",
              'An approximate count of rows in this table' as "stats:row_count:description",
              (row_count is not null) as "stats:row_count:include",

              'Approximate Size' as "stats:bytes:label",
              bytes as "stats:bytes:value",
              'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
              (bytes is not null) as "stats:bytes:include",

              'Last Modified' as "stats:last_modified:label",
              to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
              'The timestamp for last update/change' as "stats:last_modified:description",
              (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"

          from airbnb.INFORMATION_SCHEMA.tables

      ),

      columns as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",

              column_name as "column_name",
              ordinal_position as "column_index",
              data_type as "column_type",
              comment as "column_comment"

          from airbnb.INFORMATION_SCHEMA.columns
      )

      select *
      from tables
      join columns using ("table_database", "table_schema", "table_name")
      where (upper("table_schema") = upper('dev') or upper("table_schema") = upper('raw'))
      order by "column_index"
[0m05:48:36.045462 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:48:40.162692 [debug] [ThreadPool]: SQL status: SUCCESS 69 in 4 seconds
[0m05:48:40.215994 [debug] [ThreadPool]: On airbnb.information_schema: Close
[0m05:48:40.871341 [info ] [MainThread]: Catalog written to /Users/katiehuang/Documents/Data Science/Courses/Udemy dbt Airbnb Project/dbtlearn/target/catalog.json
[0m05:48:40.872049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf393818b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf395b8cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf395b84c0>]}
[0m05:48:40.872450 [debug] [MainThread]: Flushing usage events
[0m05:48:42.470029 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m05:48:42.471047 [debug] [MainThread]: Connection 'airbnb.information_schema' was properly closed.


============================== 2023-03-02 05:53:17.171630 | 48bf7c69-3449-4ccd-a10a-ca550c325457 ==============================
[0m05:53:17.171630 [info ] [MainThread]: Running with dbt=1.4.3
[0m05:53:17.173872 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/katiehuang/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'port': 8080, 'open_browser': True, 'which': 'serve', 'indirect_selection': 'eager'}
[0m05:53:17.174169 [debug] [MainThread]: Tracking: tracking
[0m05:53:17.174753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc81a9aa30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc81a9ae20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc81a9ad00>]}
[0m05:53:17.178108 [info ] [MainThread]: Serving docs at 0.0.0.0:8080
[0m05:53:17.178460 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8080
[0m05:53:17.178734 [info ] [MainThread]: 
[0m05:53:17.178991 [info ] [MainThread]: 
[0m05:53:17.179237 [info ] [MainThread]: Press Ctrl+C to exit.
[0m06:15:59.665528 [debug] [MainThread]: Flushing usage events
[0m06:16:01.210926 [info ] [MainThread]: ctrl-c


============================== 2023-03-02 06:16:11.116630 | e57aa6a0-fb0f-4bcc-b855-ec5123dc0b51 ==============================
[0m06:16:11.116630 [info ] [MainThread]: Running with dbt=1.4.3
[0m06:16:11.118722 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/katiehuang/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'compile': True, 'which': 'generate', 'rpc_method': 'docs.generate', 'indirect_selection': 'eager'}
[0m06:16:11.119045 [debug] [MainThread]: Tracking: tracking
[0m06:16:11.119519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94812f69d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94812f6dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94812f6ca0>]}
[0m06:16:11.140012 [debug] [MainThread]: checksum: c7a5cda64f02d8b9dd20ef412f82fbb79fdce1bb359c3c5dae3d080de7f31bfd, vars: {}, profile: None, target: None, version: 1.4.3
[0m06:16:11.206134 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m06:16:11.206647 [debug] [MainThread]: Partial parsing: added file: dbtlearn://models/docs.md
[0m06:16:11.207150 [debug] [MainThread]: Partial parsing: updated file: dbtlearn://models/schema.yml
[0m06:16:11.226005 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_cleansed.sql
[0m06:16:11.315062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e57aa6a0-fb0f-4bcc-b855-ec5123dc0b51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9492841910>]}
[0m06:16:11.326564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e57aa6a0-fb0f-4bcc-b855-ec5123dc0b51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9481341550>]}
[0m06:16:11.326950 [info ] [MainThread]: Found 8 models, 12 tests, 1 snapshot, 0 analyses, 418 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
[0m06:16:11.327274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e57aa6a0-fb0f-4bcc-b855-ec5123dc0b51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94812fa2b0>]}
[0m06:16:11.329463 [info ] [MainThread]: 
[0m06:16:11.330979 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m06:16:11.332311 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_airbnb_dev'
[0m06:16:11.347378 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m06:16:11.347662 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m06:16:11.347904 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:16:13.664612 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 2 seconds
[0m06:16:13.670509 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m06:16:14.277567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e57aa6a0-fb0f-4bcc-b855-ec5123dc0b51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94812f60a0>]}
[0m06:16:14.279473 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:16:14.280178 [info ] [MainThread]: 
[0m06:16:14.290801 [debug] [Thread-1  ]: Began running node model.dbtlearn.src_hosts
[0m06:16:14.291665 [debug] [Thread-2  ]: Began running node model.dbtlearn.src_listings
[0m06:16:14.292284 [debug] [Thread-3  ]: Began running node model.dbtlearn.src_reviews
[0m06:16:14.293415 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtlearn.src_hosts'
[0m06:16:14.294161 [debug] [Thread-4  ]: Began running node seed.dbtlearn.seed_full_moon_dates
[0m06:16:14.295076 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtlearn.src_listings'
[0m06:16:14.295926 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtlearn.src_reviews'
[0m06:16:14.296356 [debug] [Thread-1  ]: Began compiling node model.dbtlearn.src_hosts
[0m06:16:14.297315 [debug] [Thread-4  ]: Acquiring new snowflake connection 'seed.dbtlearn.seed_full_moon_dates'
[0m06:16:14.297770 [debug] [Thread-2  ]: Began compiling node model.dbtlearn.src_listings
[0m06:16:14.298162 [debug] [Thread-3  ]: Began compiling node model.dbtlearn.src_reviews
[0m06:16:14.303752 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearn.src_hosts"
[0m06:16:14.304250 [debug] [Thread-4  ]: Began compiling node seed.dbtlearn.seed_full_moon_dates
[0m06:16:14.308972 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtlearn.src_listings"
[0m06:16:14.313203 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtlearn.src_reviews"
[0m06:16:14.315774 [debug] [Thread-4  ]: Timing info for seed.dbtlearn.seed_full_moon_dates (compile): 2023-03-02 06:16:14.313604 => 2023-03-02 06:16:14.315678
[0m06:16:14.316429 [debug] [Thread-4  ]: Began executing node seed.dbtlearn.seed_full_moon_dates
[0m06:16:14.316741 [debug] [Thread-4  ]: Timing info for seed.dbtlearn.seed_full_moon_dates (execute): 2023-03-02 06:16:14.316666 => 2023-03-02 06:16:14.316688
[0m06:16:14.318708 [debug] [Thread-4  ]: Finished running node seed.dbtlearn.seed_full_moon_dates
[0m06:16:14.319206 [debug] [Thread-4  ]: Began running node snapshot.dbtlearn.scd_raw_listings
[0m06:16:14.319583 [debug] [Thread-1  ]: Timing info for model.dbtlearn.src_hosts (compile): 2023-03-02 06:16:14.298464 => 2023-03-02 06:16:14.319533
[0m06:16:14.320206 [debug] [Thread-4  ]: Acquiring new snowflake connection 'snapshot.dbtlearn.scd_raw_listings'
[0m06:16:14.320441 [debug] [Thread-2  ]: Timing info for model.dbtlearn.src_listings (compile): 2023-03-02 06:16:14.304517 => 2023-03-02 06:16:14.320392
[0m06:16:14.321168 [debug] [Thread-1  ]: Finished running node model.dbtlearn.src_hosts
[0m06:16:14.321396 [debug] [Thread-3  ]: Timing info for model.dbtlearn.src_reviews (compile): 2023-03-02 06:16:14.309395 => 2023-03-02 06:16:14.321352
[0m06:16:14.321642 [debug] [Thread-4  ]: Began compiling node snapshot.dbtlearn.scd_raw_listings
[0m06:16:14.322319 [debug] [Thread-2  ]: Finished running node model.dbtlearn.src_listings
[0m06:16:14.323093 [debug] [Thread-3  ]: Finished running node model.dbtlearn.src_reviews
[0m06:16:14.323458 [debug] [Thread-1  ]: Began running node model.dbtlearn.dim_hosts_cleansed
[0m06:16:14.328842 [debug] [Thread-4  ]: Timing info for snapshot.dbtlearn.scd_raw_listings (compile): 2023-03-02 06:16:14.323643 => 2023-03-02 06:16:14.328790
[0m06:16:14.329635 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtlearn.dim_hosts_cleansed'
[0m06:16:14.329895 [debug] [Thread-2  ]: Began running node model.dbtlearn.dim_listings_cleansed
[0m06:16:14.330161 [debug] [Thread-3  ]: Began running node model.dbtlearn.fct_reviews
[0m06:16:14.330360 [debug] [Thread-4  ]: Began executing node snapshot.dbtlearn.scd_raw_listings
[0m06:16:14.330571 [debug] [Thread-1  ]: Began compiling node model.dbtlearn.dim_hosts_cleansed
[0m06:16:14.331009 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtlearn.dim_listings_cleansed'
[0m06:16:14.331439 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtlearn.fct_reviews'
[0m06:16:14.331643 [debug] [Thread-4  ]: Timing info for snapshot.dbtlearn.scd_raw_listings (execute): 2023-03-02 06:16:14.331597 => 2023-03-02 06:16:14.331605
[0m06:16:14.338337 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearn.dim_hosts_cleansed"
[0m06:16:14.338562 [debug] [Thread-2  ]: Began compiling node model.dbtlearn.dim_listings_cleansed
[0m06:16:14.338782 [debug] [Thread-3  ]: Began compiling node model.dbtlearn.fct_reviews
[0m06:16:14.339358 [debug] [Thread-4  ]: Finished running node snapshot.dbtlearn.scd_raw_listings
[0m06:16:14.348926 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtlearn.dim_listings_cleansed"
[0m06:16:14.355500 [debug] [Thread-1  ]: Timing info for model.dbtlearn.dim_hosts_cleansed (compile): 2023-03-02 06:16:14.331797 => 2023-03-02 06:16:14.355446
[0m06:16:14.385160 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtlearn.fct_reviews"
[0m06:16:14.385627 [debug] [Thread-1  ]: Began executing node model.dbtlearn.dim_hosts_cleansed
[0m06:16:14.386081 [debug] [Thread-2  ]: Timing info for model.dbtlearn.dim_listings_cleansed (compile): 2023-03-02 06:16:14.339610 => 2023-03-02 06:16:14.386001
[0m06:16:14.386336 [debug] [Thread-1  ]: Timing info for model.dbtlearn.dim_hosts_cleansed (execute): 2023-03-02 06:16:14.386276 => 2023-03-02 06:16:14.386297
[0m06:16:14.386634 [debug] [Thread-2  ]: Began executing node model.dbtlearn.dim_listings_cleansed
[0m06:16:14.387355 [debug] [Thread-1  ]: Finished running node model.dbtlearn.dim_hosts_cleansed
[0m06:16:14.387615 [debug] [Thread-2  ]: Timing info for model.dbtlearn.dim_listings_cleansed (execute): 2023-03-02 06:16:14.387563 => 2023-03-02 06:16:14.387571
[0m06:16:14.387875 [debug] [Thread-3  ]: Timing info for model.dbtlearn.fct_reviews (compile): 2023-03-02 06:16:14.349170 => 2023-03-02 06:16:14.387810
[0m06:16:14.388798 [debug] [Thread-2  ]: Finished running node model.dbtlearn.dim_listings_cleansed
[0m06:16:14.389161 [debug] [Thread-4  ]: Began running node test.dbtlearn.not_null_dim_hosts_cleansed_host_id.de84c3da05
[0m06:16:14.389425 [debug] [Thread-1  ]: Began running node test.dbtlearn.not_null_dim_hosts_cleansed_host_name.42386c5830
[0m06:16:14.389665 [debug] [Thread-3  ]: Began executing node model.dbtlearn.fct_reviews
[0m06:16:14.390004 [debug] [Thread-2  ]: Began running node test.dbtlearn.unique_dim_hosts_cleansed_host_id.d7e4771347
[0m06:16:14.390640 [debug] [Thread-4  ]: Acquiring new snowflake connection 'test.dbtlearn.not_null_dim_hosts_cleansed_host_id.de84c3da05'
[0m06:16:14.391795 [debug] [Thread-1  ]: Acquiring new snowflake connection 'test.dbtlearn.not_null_dim_hosts_cleansed_host_name.42386c5830'
[0m06:16:14.392058 [debug] [Thread-3  ]: Timing info for model.dbtlearn.fct_reviews (execute): 2023-03-02 06:16:14.391998 => 2023-03-02 06:16:14.392007
[0m06:16:14.392596 [debug] [Thread-2  ]: Acquiring new snowflake connection 'test.dbtlearn.unique_dim_hosts_cleansed_host_id.d7e4771347'
[0m06:16:14.392858 [debug] [Thread-4  ]: Began compiling node test.dbtlearn.not_null_dim_hosts_cleansed_host_id.de84c3da05
[0m06:16:14.393106 [debug] [Thread-1  ]: Began compiling node test.dbtlearn.not_null_dim_hosts_cleansed_host_name.42386c5830
[0m06:16:14.393786 [debug] [Thread-3  ]: Finished running node model.dbtlearn.fct_reviews
[0m06:16:14.394043 [debug] [Thread-2  ]: Began compiling node test.dbtlearn.unique_dim_hosts_cleansed_host_id.d7e4771347
[0m06:16:14.403938 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbtlearn.not_null_dim_hosts_cleansed_host_id.de84c3da05"
[0m06:16:14.407961 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbtlearn.not_null_dim_hosts_cleansed_host_name.42386c5830"
[0m06:16:14.408333 [debug] [Thread-3  ]: Began running node model.dbtlearn.dim_listings_w_hosts
[0m06:16:14.416628 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbtlearn.unique_dim_hosts_cleansed_host_id.d7e4771347"
[0m06:16:14.417347 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtlearn.dim_listings_w_hosts'
[0m06:16:14.417766 [debug] [Thread-3  ]: Began compiling node model.dbtlearn.dim_listings_w_hosts
[0m06:16:14.418012 [debug] [Thread-4  ]: Timing info for test.dbtlearn.not_null_dim_hosts_cleansed_host_id.de84c3da05 (compile): 2023-03-02 06:16:14.394232 => 2023-03-02 06:16:14.417953
[0m06:16:14.421063 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtlearn.dim_listings_w_hosts"
[0m06:16:14.421373 [debug] [Thread-4  ]: Began executing node test.dbtlearn.not_null_dim_hosts_cleansed_host_id.de84c3da05
[0m06:16:14.421563 [debug] [Thread-1  ]: Timing info for test.dbtlearn.not_null_dim_hosts_cleansed_host_name.42386c5830 (compile): 2023-03-02 06:16:14.404176 => 2023-03-02 06:16:14.421518
[0m06:16:14.421763 [debug] [Thread-2  ]: Timing info for test.dbtlearn.unique_dim_hosts_cleansed_host_id.d7e4771347 (compile): 2023-03-02 06:16:14.408517 => 2023-03-02 06:16:14.421730
[0m06:16:14.422008 [debug] [Thread-4  ]: Timing info for test.dbtlearn.not_null_dim_hosts_cleansed_host_id.de84c3da05 (execute): 2023-03-02 06:16:14.421959 => 2023-03-02 06:16:14.421969
[0m06:16:14.422232 [debug] [Thread-1  ]: Began executing node test.dbtlearn.not_null_dim_hosts_cleansed_host_name.42386c5830
[0m06:16:14.422463 [debug] [Thread-2  ]: Began executing node test.dbtlearn.unique_dim_hosts_cleansed_host_id.d7e4771347
[0m06:16:14.423074 [debug] [Thread-4  ]: Finished running node test.dbtlearn.not_null_dim_hosts_cleansed_host_id.de84c3da05
[0m06:16:14.423283 [debug] [Thread-3  ]: Timing info for model.dbtlearn.dim_listings_w_hosts (compile): 2023-03-02 06:16:14.418173 => 2023-03-02 06:16:14.423246
[0m06:16:14.423472 [debug] [Thread-1  ]: Timing info for test.dbtlearn.not_null_dim_hosts_cleansed_host_name.42386c5830 (execute): 2023-03-02 06:16:14.423421 => 2023-03-02 06:16:14.423429
[0m06:16:14.423681 [debug] [Thread-2  ]: Timing info for test.dbtlearn.unique_dim_hosts_cleansed_host_id.d7e4771347 (execute): 2023-03-02 06:16:14.423644 => 2023-03-02 06:16:14.423650
[0m06:16:14.423966 [debug] [Thread-4  ]: Began running node test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m06:16:14.424248 [debug] [Thread-3  ]: Began executing node model.dbtlearn.dim_listings_w_hosts
[0m06:16:14.424807 [debug] [Thread-1  ]: Finished running node test.dbtlearn.not_null_dim_hosts_cleansed_host_name.42386c5830
[0m06:16:14.425344 [debug] [Thread-2  ]: Finished running node test.dbtlearn.unique_dim_hosts_cleansed_host_id.d7e4771347
[0m06:16:14.425786 [debug] [Thread-4  ]: Acquiring new snowflake connection 'test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af'
[0m06:16:14.425993 [debug] [Thread-3  ]: Timing info for model.dbtlearn.dim_listings_w_hosts (execute): 2023-03-02 06:16:14.425950 => 2023-03-02 06:16:14.425955
[0m06:16:14.426286 [debug] [Thread-1  ]: Began running node test.dbtlearn.dim_listings_minimum_nights
[0m06:16:14.426597 [debug] [Thread-2  ]: Began running node test.dbtlearn.no_nulls_in_dim_listings
[0m06:16:14.426834 [debug] [Thread-4  ]: Began compiling node test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m06:16:14.427381 [debug] [Thread-3  ]: Finished running node model.dbtlearn.dim_listings_w_hosts
[0m06:16:14.427824 [debug] [Thread-1  ]: Acquiring new snowflake connection 'test.dbtlearn.dim_listings_minimum_nights'
[0m06:16:14.428253 [debug] [Thread-2  ]: Acquiring new snowflake connection 'test.dbtlearn.no_nulls_in_dim_listings'
[0m06:16:14.434586 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m06:16:14.434936 [debug] [Thread-3  ]: Began running node test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m06:16:14.435215 [debug] [Thread-1  ]: Began compiling node test.dbtlearn.dim_listings_minimum_nights
[0m06:16:14.435436 [debug] [Thread-2  ]: Began compiling node test.dbtlearn.no_nulls_in_dim_listings
[0m06:16:14.435969 [debug] [Thread-3  ]: Acquiring new snowflake connection 'test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be'
[0m06:16:14.438751 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbtlearn.dim_listings_minimum_nights"
[0m06:16:14.445307 [debug] [Thread-4  ]: Timing info for test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af (compile): 2023-03-02 06:16:14.428411 => 2023-03-02 06:16:14.445255
[0m06:16:14.451846 [debug] [Thread-3  ]: Began compiling node test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m06:16:14.452162 [debug] [Thread-2  ]: Using snowflake connection "test.dbtlearn.no_nulls_in_dim_listings"
[0m06:16:14.452485 [debug] [Thread-4  ]: Began executing node test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m06:16:14.456518 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m06:16:14.456757 [debug] [Thread-2  ]: On test.dbtlearn.no_nulls_in_dim_listings: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.no_nulls_in_dim_listings"} */
describe table airbnb.dev.dim_listings_cleansed
[0m06:16:14.457014 [debug] [Thread-4  ]: Timing info for test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af (execute): 2023-03-02 06:16:14.456963 => 2023-03-02 06:16:14.456973
[0m06:16:14.457226 [debug] [Thread-1  ]: Timing info for test.dbtlearn.dim_listings_minimum_nights (compile): 2023-03-02 06:16:14.436149 => 2023-03-02 06:16:14.457181
[0m06:16:14.457458 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m06:16:14.458076 [debug] [Thread-4  ]: Finished running node test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m06:16:14.458318 [debug] [Thread-1  ]: Began executing node test.dbtlearn.dim_listings_minimum_nights
[0m06:16:14.458514 [debug] [Thread-3  ]: Timing info for test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be (compile): 2023-03-02 06:16:14.452654 => 2023-03-02 06:16:14.458477
[0m06:16:14.459031 [debug] [Thread-4  ]: Began running node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m06:16:14.459609 [debug] [Thread-1  ]: Timing info for test.dbtlearn.dim_listings_minimum_nights (execute): 2023-03-02 06:16:14.459562 => 2023-03-02 06:16:14.459569
[0m06:16:14.459929 [debug] [Thread-3  ]: Began executing node test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m06:16:14.460407 [debug] [Thread-4  ]: Acquiring new snowflake connection 'test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9'
[0m06:16:14.461499 [debug] [Thread-1  ]: Finished running node test.dbtlearn.dim_listings_minimum_nights
[0m06:16:14.461776 [debug] [Thread-3  ]: Timing info for test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be (execute): 2023-03-02 06:16:14.461724 => 2023-03-02 06:16:14.461732
[0m06:16:14.462003 [debug] [Thread-4  ]: Began compiling node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m06:16:14.462294 [debug] [Thread-1  ]: Began running node test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m06:16:14.463077 [debug] [Thread-3  ]: Finished running node test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m06:16:14.468846 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m06:16:14.469367 [debug] [Thread-1  ]: Acquiring new snowflake connection 'test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313'
[0m06:16:14.469677 [debug] [Thread-3  ]: Began running node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m06:16:14.470329 [debug] [Thread-1  ]: Began compiling node test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m06:16:14.470836 [debug] [Thread-3  ]: Acquiring new snowflake connection 'test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad'
[0m06:16:14.474668 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313"
[0m06:16:14.474917 [debug] [Thread-4  ]: Timing info for test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9 (compile): 2023-03-02 06:16:14.463553 => 2023-03-02 06:16:14.474870
[0m06:16:14.475139 [debug] [Thread-3  ]: Began compiling node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m06:16:14.475451 [debug] [Thread-4  ]: Began executing node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m06:16:14.480853 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m06:16:14.481123 [debug] [Thread-4  ]: Timing info for test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9 (execute): 2023-03-02 06:16:14.481066 => 2023-03-02 06:16:14.481077
[0m06:16:14.481408 [debug] [Thread-1  ]: Timing info for test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313 (compile): 2023-03-02 06:16:14.471024 => 2023-03-02 06:16:14.481364
[0m06:16:14.482032 [debug] [Thread-4  ]: Finished running node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m06:16:14.482268 [debug] [Thread-1  ]: Began executing node test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m06:16:14.482464 [debug] [Thread-3  ]: Timing info for test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad (compile): 2023-03-02 06:16:14.475647 => 2023-03-02 06:16:14.482428
[0m06:16:14.482733 [debug] [Thread-4  ]: Began running node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m06:16:14.482990 [debug] [Thread-1  ]: Timing info for test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313 (execute): 2023-03-02 06:16:14.482952 => 2023-03-02 06:16:14.482958
[0m06:16:14.483197 [debug] [Thread-3  ]: Began executing node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m06:16:14.483651 [debug] [Thread-4  ]: Acquiring new snowflake connection 'test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e'
[0m06:16:14.484208 [debug] [Thread-1  ]: Finished running node test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m06:16:14.484415 [debug] [Thread-3  ]: Timing info for test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad (execute): 2023-03-02 06:16:14.484372 => 2023-03-02 06:16:14.484378
[0m06:16:14.484632 [debug] [Thread-4  ]: Began compiling node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m06:16:14.484910 [debug] [Thread-1  ]: Began running node model.dbtlearn.mart_fullmoon_reviews
[0m06:16:14.485481 [debug] [Thread-3  ]: Finished running node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m06:16:14.489583 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m06:16:14.490075 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtlearn.mart_fullmoon_reviews'
[0m06:16:14.490371 [debug] [Thread-3  ]: Began running node test.dbtlearn.consistent_created_at
[0m06:16:14.490696 [debug] [Thread-1  ]: Began compiling node model.dbtlearn.mart_fullmoon_reviews
[0m06:16:14.491199 [debug] [Thread-3  ]: Acquiring new snowflake connection 'test.dbtlearn.consistent_created_at'
[0m06:16:14.494428 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearn.mart_fullmoon_reviews"
[0m06:16:14.494650 [debug] [Thread-4  ]: Timing info for test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e (compile): 2023-03-02 06:16:14.485643 => 2023-03-02 06:16:14.494603
[0m06:16:14.494874 [debug] [Thread-3  ]: Began compiling node test.dbtlearn.consistent_created_at
[0m06:16:14.495151 [debug] [Thread-4  ]: Began executing node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m06:16:14.498061 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbtlearn.consistent_created_at"
[0m06:16:14.498328 [debug] [Thread-4  ]: Timing info for test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e (execute): 2023-03-02 06:16:14.498277 => 2023-03-02 06:16:14.498286
[0m06:16:14.498530 [debug] [Thread-1  ]: Timing info for model.dbtlearn.mart_fullmoon_reviews (compile): 2023-03-02 06:16:14.491375 => 2023-03-02 06:16:14.498497
[0m06:16:14.499134 [debug] [Thread-4  ]: Finished running node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m06:16:14.499396 [debug] [Thread-1  ]: Began executing node model.dbtlearn.mart_fullmoon_reviews
[0m06:16:14.499596 [debug] [Thread-3  ]: Timing info for test.dbtlearn.consistent_created_at (compile): 2023-03-02 06:16:14.495311 => 2023-03-02 06:16:14.499561
[0m06:16:14.499876 [debug] [Thread-1  ]: Timing info for model.dbtlearn.mart_fullmoon_reviews (execute): 2023-03-02 06:16:14.499839 => 2023-03-02 06:16:14.499844
[0m06:16:14.500090 [debug] [Thread-3  ]: Began executing node test.dbtlearn.consistent_created_at
[0m06:16:14.500648 [debug] [Thread-1  ]: Finished running node model.dbtlearn.mart_fullmoon_reviews
[0m06:16:14.500845 [debug] [Thread-3  ]: Timing info for test.dbtlearn.consistent_created_at (execute): 2023-03-02 06:16:14.500805 => 2023-03-02 06:16:14.500810
[0m06:16:14.505169 [debug] [Thread-3  ]: Finished running node test.dbtlearn.consistent_created_at
[0m06:16:16.599233 [debug] [Thread-2  ]: SQL status: SUCCESS 8 in 2 seconds
[0m06:16:16.606249 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbtlearn.no_nulls_in_dim_listings"
[0m06:16:16.608374 [debug] [Thread-2  ]: Timing info for test.dbtlearn.no_nulls_in_dim_listings (compile): 2023-03-02 06:16:14.438977 => 2023-03-02 06:16:16.608242
[0m06:16:16.608867 [debug] [Thread-2  ]: Began executing node test.dbtlearn.no_nulls_in_dim_listings
[0m06:16:16.609249 [debug] [Thread-2  ]: Timing info for test.dbtlearn.no_nulls_in_dim_listings (execute): 2023-03-02 06:16:16.609164 => 2023-03-02 06:16:16.609184
[0m06:16:16.609623 [debug] [Thread-2  ]: On test.dbtlearn.no_nulls_in_dim_listings: Close
[0m06:16:17.301225 [debug] [Thread-2  ]: Finished running node test.dbtlearn.no_nulls_in_dim_listings
[0m06:16:17.304988 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:16:17.305523 [debug] [MainThread]: Connection 'model.dbtlearn.mart_fullmoon_reviews' was properly closed.
[0m06:16:17.305856 [debug] [MainThread]: Connection 'test.dbtlearn.no_nulls_in_dim_listings' was properly closed.
[0m06:16:17.306149 [debug] [MainThread]: Connection 'test.dbtlearn.consistent_created_at' was properly closed.
[0m06:16:17.306435 [debug] [MainThread]: Connection 'test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e' was properly closed.
[0m06:16:17.308229 [debug] [MainThread]: Command end result
[0m06:16:17.327850 [info ] [MainThread]: Done.
[0m06:16:17.333669 [debug] [MainThread]: Acquiring new snowflake connection 'generate_catalog'
[0m06:16:17.334008 [info ] [MainThread]: Building catalog
[0m06:16:17.336749 [debug] [ThreadPool]: Acquiring new snowflake connection 'airbnb.information_schema'
[0m06:16:17.346623 [debug] [ThreadPool]: Using snowflake connection "airbnb.information_schema"
[0m06:16:17.346886 [debug] [ThreadPool]: On airbnb.information_schema: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "airbnb.information_schema"} */
with tables as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",
              table_type as "table_type",
              comment as "table_comment",

              -- note: this is the _role_ that owns the table
              table_owner as "table_owner",

              'Clustering Key' as "stats:clustering_key:label",
              clustering_key as "stats:clustering_key:value",
              'The key used to cluster this table' as "stats:clustering_key:description",
              (clustering_key is not null) as "stats:clustering_key:include",

              'Row Count' as "stats:row_count:label",
              row_count as "stats:row_count:value",
              'An approximate count of rows in this table' as "stats:row_count:description",
              (row_count is not null) as "stats:row_count:include",

              'Approximate Size' as "stats:bytes:label",
              bytes as "stats:bytes:value",
              'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
              (bytes is not null) as "stats:bytes:include",

              'Last Modified' as "stats:last_modified:label",
              to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
              'The timestamp for last update/change' as "stats:last_modified:description",
              (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"

          from airbnb.INFORMATION_SCHEMA.tables

      ),

      columns as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",

              column_name as "column_name",
              ordinal_position as "column_index",
              data_type as "column_type",
              comment as "column_comment"

          from airbnb.INFORMATION_SCHEMA.columns
      )

      select *
      from tables
      join columns using ("table_database", "table_schema", "table_name")
      where (upper("table_schema") = upper('dev') or upper("table_schema") = upper('raw'))
      order by "column_index"
[0m06:16:17.347108 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:16:21.072838 [debug] [ThreadPool]: SQL status: SUCCESS 69 in 4 seconds
[0m06:16:21.115025 [debug] [ThreadPool]: On airbnb.information_schema: Close
[0m06:16:21.855202 [info ] [MainThread]: Catalog written to /Users/katiehuang/Documents/Data Science/Courses/Udemy dbt Airbnb Project/dbtlearn/target/catalog.json
[0m06:16:21.855904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94812f69d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9492c9df10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9492c9d700>]}
[0m06:16:21.856374 [debug] [MainThread]: Flushing usage events
[0m06:16:23.122513 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m06:16:23.123760 [debug] [MainThread]: Connection 'airbnb.information_schema' was properly closed.


============================== 2023-03-02 06:16:29.065280 | a50adba9-79fc-4d14-9536-4eb3bc5f41f1 ==============================
[0m06:16:29.065280 [info ] [MainThread]: Running with dbt=1.4.3
[0m06:16:29.067502 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/katiehuang/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'port': 8080, 'open_browser': True, 'which': 'serve', 'indirect_selection': 'eager'}
[0m06:16:29.067886 [debug] [MainThread]: Tracking: tracking
[0m06:16:29.068342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6e2443a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6e2443e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6e2443d60>]}
[0m06:16:29.071186 [info ] [MainThread]: Serving docs at 0.0.0.0:8080
[0m06:16:29.071591 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8080
[0m06:16:29.071863 [info ] [MainThread]: 
[0m06:16:29.072128 [info ] [MainThread]: 
[0m06:16:29.072376 [info ] [MainThread]: Press Ctrl+C to exit.
[0m07:21:39.784773 [debug] [MainThread]: Flushing usage events
[0m07:21:41.313931 [info ] [MainThread]: ctrl-c


============================== 2023-03-02 07:22:06.983125 | 8a8269c2-7042-4a31-8d19-a7ef58e7b470 ==============================
[0m07:22:06.983125 [info ] [MainThread]: Running with dbt=1.4.3
[0m07:22:06.985479 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/katiehuang/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'compile': True, 'which': 'generate', 'rpc_method': 'docs.generate', 'indirect_selection': 'eager'}
[0m07:22:06.985771 [debug] [MainThread]: Tracking: tracking
[0m07:22:06.986492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7f8fbbac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7f8fbbeb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7f8fbbd90>]}
[0m07:22:07.006451 [debug] [MainThread]: checksum: c7a5cda64f02d8b9dd20ef412f82fbb79fdce1bb359c3c5dae3d080de7f31bfd, vars: {}, profile: None, target: None, version: 1.4.3
[0m07:22:07.074638 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m07:22:07.075200 [debug] [MainThread]: Partial parsing: added file: dbtlearn://models/overview.md
[0m07:22:07.090768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8a8269c2-7042-4a31-8d19-a7ef58e7b470', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb80aa00a90>]}
[0m07:22:07.101729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8a8269c2-7042-4a31-8d19-a7ef58e7b470', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7c827ad90>]}
[0m07:22:07.102088 [info ] [MainThread]: Found 8 models, 12 tests, 1 snapshot, 0 analyses, 418 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
[0m07:22:07.102410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8a8269c2-7042-4a31-8d19-a7ef58e7b470', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7f8fc22b0>]}
[0m07:22:07.104616 [info ] [MainThread]: 
[0m07:22:07.106131 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m07:22:07.107565 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_airbnb_dev'
[0m07:22:07.123073 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m07:22:07.123438 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m07:22:07.123695 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:22:10.389206 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 3 seconds
[0m07:22:10.395044 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m07:22:11.728054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8a8269c2-7042-4a31-8d19-a7ef58e7b470', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7c827aca0>]}
[0m07:22:11.729434 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:22:11.730055 [info ] [MainThread]: 
[0m07:22:11.737018 [debug] [Thread-1  ]: Began running node model.dbtlearn.src_hosts
[0m07:22:11.737563 [debug] [Thread-2  ]: Began running node model.dbtlearn.src_listings
[0m07:22:11.738360 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtlearn.src_hosts'
[0m07:22:11.738963 [debug] [Thread-3  ]: Began running node model.dbtlearn.src_reviews
[0m07:22:11.739404 [debug] [Thread-4  ]: Began running node seed.dbtlearn.seed_full_moon_dates
[0m07:22:11.740143 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtlearn.src_listings'
[0m07:22:11.740531 [debug] [Thread-1  ]: Began compiling node model.dbtlearn.src_hosts
[0m07:22:11.741297 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtlearn.src_reviews'
[0m07:22:11.742025 [debug] [Thread-4  ]: Acquiring new snowflake connection 'seed.dbtlearn.seed_full_moon_dates'
[0m07:22:11.742359 [debug] [Thread-2  ]: Began compiling node model.dbtlearn.src_listings
[0m07:22:11.748582 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearn.src_hosts"
[0m07:22:11.748966 [debug] [Thread-3  ]: Began compiling node model.dbtlearn.src_reviews
[0m07:22:11.749253 [debug] [Thread-4  ]: Began compiling node seed.dbtlearn.seed_full_moon_dates
[0m07:22:11.752941 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtlearn.src_listings"
[0m07:22:11.757203 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtlearn.src_reviews"
[0m07:22:11.759442 [debug] [Thread-4  ]: Timing info for seed.dbtlearn.seed_full_moon_dates (compile): 2023-03-02 07:22:11.757579 => 2023-03-02 07:22:11.759365
[0m07:22:11.759832 [debug] [Thread-1  ]: Timing info for model.dbtlearn.src_hosts (compile): 2023-03-02 07:22:11.742656 => 2023-03-02 07:22:11.759788
[0m07:22:11.760196 [debug] [Thread-4  ]: Began executing node seed.dbtlearn.seed_full_moon_dates
[0m07:22:11.762048 [debug] [Thread-1  ]: Finished running node model.dbtlearn.src_hosts
[0m07:22:11.762280 [debug] [Thread-2  ]: Timing info for model.dbtlearn.src_listings (compile): 2023-03-02 07:22:11.749452 => 2023-03-02 07:22:11.762232
[0m07:22:11.762547 [debug] [Thread-4  ]: Timing info for seed.dbtlearn.seed_full_moon_dates (execute): 2023-03-02 07:22:11.762501 => 2023-03-02 07:22:11.762509
[0m07:22:11.762781 [debug] [Thread-3  ]: Timing info for model.dbtlearn.src_reviews (compile): 2023-03-02 07:22:11.753397 => 2023-03-02 07:22:11.762735
[0m07:22:11.763103 [debug] [Thread-1  ]: Began running node snapshot.dbtlearn.scd_raw_listings
[0m07:22:11.763853 [debug] [Thread-2  ]: Finished running node model.dbtlearn.src_listings
[0m07:22:11.764585 [debug] [Thread-4  ]: Finished running node seed.dbtlearn.seed_full_moon_dates
[0m07:22:11.765277 [debug] [Thread-3  ]: Finished running node model.dbtlearn.src_reviews
[0m07:22:11.765859 [debug] [Thread-1  ]: Acquiring new snowflake connection 'snapshot.dbtlearn.scd_raw_listings'
[0m07:22:11.766207 [debug] [Thread-2  ]: Began running node model.dbtlearn.dim_hosts_cleansed
[0m07:22:11.766718 [debug] [Thread-4  ]: Began running node model.dbtlearn.dim_listings_cleansed
[0m07:22:11.767041 [debug] [Thread-1  ]: Began compiling node snapshot.dbtlearn.scd_raw_listings
[0m07:22:11.767340 [debug] [Thread-3  ]: Began running node model.dbtlearn.fct_reviews
[0m07:22:11.767821 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtlearn.dim_hosts_cleansed'
[0m07:22:11.768292 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.dbtlearn.dim_listings_cleansed'
[0m07:22:11.772132 [debug] [Thread-1  ]: Timing info for snapshot.dbtlearn.scd_raw_listings (compile): 2023-03-02 07:22:11.768457 => 2023-03-02 07:22:11.772080
[0m07:22:11.772645 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtlearn.fct_reviews'
[0m07:22:11.772876 [debug] [Thread-2  ]: Began compiling node model.dbtlearn.dim_hosts_cleansed
[0m07:22:11.773105 [debug] [Thread-4  ]: Began compiling node model.dbtlearn.dim_listings_cleansed
[0m07:22:11.773337 [debug] [Thread-1  ]: Began executing node snapshot.dbtlearn.scd_raw_listings
[0m07:22:11.773552 [debug] [Thread-3  ]: Began compiling node model.dbtlearn.fct_reviews
[0m07:22:11.800194 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtlearn.dim_hosts_cleansed"
[0m07:22:11.802102 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtlearn.dim_listings_cleansed"
[0m07:22:11.802303 [debug] [Thread-1  ]: Timing info for snapshot.dbtlearn.scd_raw_listings (execute): 2023-03-02 07:22:11.802253 => 2023-03-02 07:22:11.802262
[0m07:22:11.835316 [debug] [Thread-1  ]: Finished running node snapshot.dbtlearn.scd_raw_listings
[0m07:22:11.837914 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtlearn.fct_reviews"
[0m07:22:11.838446 [debug] [Thread-2  ]: Timing info for model.dbtlearn.dim_hosts_cleansed (compile): 2023-03-02 07:22:11.773709 => 2023-03-02 07:22:11.838395
[0m07:22:11.838672 [debug] [Thread-4  ]: Timing info for model.dbtlearn.dim_listings_cleansed (compile): 2023-03-02 07:22:11.780027 => 2023-03-02 07:22:11.838623
[0m07:22:11.838938 [debug] [Thread-2  ]: Began executing node model.dbtlearn.dim_hosts_cleansed
[0m07:22:11.839180 [debug] [Thread-3  ]: Timing info for model.dbtlearn.fct_reviews (compile): 2023-03-02 07:22:11.802467 => 2023-03-02 07:22:11.839139
[0m07:22:11.839373 [debug] [Thread-4  ]: Began executing node model.dbtlearn.dim_listings_cleansed
[0m07:22:11.839582 [debug] [Thread-2  ]: Timing info for model.dbtlearn.dim_hosts_cleansed (execute): 2023-03-02 07:22:11.839536 => 2023-03-02 07:22:11.839544
[0m07:22:11.839813 [debug] [Thread-3  ]: Began executing node model.dbtlearn.fct_reviews
[0m07:22:11.840003 [debug] [Thread-4  ]: Timing info for model.dbtlearn.dim_listings_cleansed (execute): 2023-03-02 07:22:11.839966 => 2023-03-02 07:22:11.839971
[0m07:22:11.840576 [debug] [Thread-2  ]: Finished running node model.dbtlearn.dim_hosts_cleansed
[0m07:22:11.840788 [debug] [Thread-3  ]: Timing info for model.dbtlearn.fct_reviews (execute): 2023-03-02 07:22:11.840747 => 2023-03-02 07:22:11.840753
[0m07:22:11.841360 [debug] [Thread-4  ]: Finished running node model.dbtlearn.dim_listings_cleansed
[0m07:22:11.842043 [debug] [Thread-3  ]: Finished running node model.dbtlearn.fct_reviews
[0m07:22:11.842428 [debug] [Thread-1  ]: Began running node test.dbtlearn.not_null_dim_hosts_cleansed_host_id.de84c3da05
[0m07:22:11.842699 [debug] [Thread-4  ]: Began running node test.dbtlearn.not_null_dim_hosts_cleansed_host_name.42386c5830
[0m07:22:11.842922 [debug] [Thread-2  ]: Began running node test.dbtlearn.unique_dim_hosts_cleansed_host_id.d7e4771347
[0m07:22:11.843729 [debug] [Thread-1  ]: Acquiring new snowflake connection 'test.dbtlearn.not_null_dim_hosts_cleansed_host_id.de84c3da05'
[0m07:22:11.844024 [debug] [Thread-3  ]: Began running node model.dbtlearn.dim_listings_w_hosts
[0m07:22:11.844480 [debug] [Thread-4  ]: Acquiring new snowflake connection 'test.dbtlearn.not_null_dim_hosts_cleansed_host_name.42386c5830'
[0m07:22:11.844921 [debug] [Thread-2  ]: Acquiring new snowflake connection 'test.dbtlearn.unique_dim_hosts_cleansed_host_id.d7e4771347'
[0m07:22:11.845145 [debug] [Thread-1  ]: Began compiling node test.dbtlearn.not_null_dim_hosts_cleansed_host_id.de84c3da05
[0m07:22:11.845624 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtlearn.dim_listings_w_hosts'
[0m07:22:11.845844 [debug] [Thread-4  ]: Began compiling node test.dbtlearn.not_null_dim_hosts_cleansed_host_name.42386c5830
[0m07:22:11.846061 [debug] [Thread-2  ]: Began compiling node test.dbtlearn.unique_dim_hosts_cleansed_host_id.d7e4771347
[0m07:22:11.857973 [debug] [Thread-3  ]: Began compiling node model.dbtlearn.dim_listings_w_hosts
[0m07:22:11.859623 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbtlearn.not_null_dim_hosts_cleansed_host_id.de84c3da05"
[0m07:22:11.863623 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbtlearn.not_null_dim_hosts_cleansed_host_name.42386c5830"
[0m07:22:11.869984 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbtlearn.unique_dim_hosts_cleansed_host_id.d7e4771347"
[0m07:22:11.873076 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtlearn.dim_listings_w_hosts"
[0m07:22:11.873958 [debug] [Thread-1  ]: Timing info for test.dbtlearn.not_null_dim_hosts_cleansed_host_id.de84c3da05 (compile): 2023-03-02 07:22:11.846223 => 2023-03-02 07:22:11.873891
[0m07:22:11.874238 [debug] [Thread-1  ]: Began executing node test.dbtlearn.not_null_dim_hosts_cleansed_host_id.de84c3da05
[0m07:22:11.874460 [debug] [Thread-4  ]: Timing info for test.dbtlearn.not_null_dim_hosts_cleansed_host_name.42386c5830 (compile): 2023-03-02 07:22:11.859840 => 2023-03-02 07:22:11.874411
[0m07:22:11.874646 [debug] [Thread-2  ]: Timing info for test.dbtlearn.unique_dim_hosts_cleansed_host_id.d7e4771347 (compile): 2023-03-02 07:22:11.863823 => 2023-03-02 07:22:11.874613
[0m07:22:11.874819 [debug] [Thread-1  ]: Timing info for test.dbtlearn.not_null_dim_hosts_cleansed_host_id.de84c3da05 (execute): 2023-03-02 07:22:11.874780 => 2023-03-02 07:22:11.874788
[0m07:22:11.875070 [debug] [Thread-4  ]: Began executing node test.dbtlearn.not_null_dim_hosts_cleansed_host_name.42386c5830
[0m07:22:11.875282 [debug] [Thread-3  ]: Timing info for model.dbtlearn.dim_listings_w_hosts (compile): 2023-03-02 07:22:11.870221 => 2023-03-02 07:22:11.875241
[0m07:22:11.875478 [debug] [Thread-2  ]: Began executing node test.dbtlearn.unique_dim_hosts_cleansed_host_id.d7e4771347
[0m07:22:11.876074 [debug] [Thread-1  ]: Finished running node test.dbtlearn.not_null_dim_hosts_cleansed_host_id.de84c3da05
[0m07:22:11.876286 [debug] [Thread-4  ]: Timing info for test.dbtlearn.not_null_dim_hosts_cleansed_host_name.42386c5830 (execute): 2023-03-02 07:22:11.876245 => 2023-03-02 07:22:11.876251
[0m07:22:11.876510 [debug] [Thread-3  ]: Began executing node model.dbtlearn.dim_listings_w_hosts
[0m07:22:11.876710 [debug] [Thread-2  ]: Timing info for test.dbtlearn.unique_dim_hosts_cleansed_host_id.d7e4771347 (execute): 2023-03-02 07:22:11.876673 => 2023-03-02 07:22:11.876679
[0m07:22:11.876988 [debug] [Thread-1  ]: Began running node test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m07:22:11.877578 [debug] [Thread-4  ]: Finished running node test.dbtlearn.not_null_dim_hosts_cleansed_host_name.42386c5830
[0m07:22:11.877780 [debug] [Thread-3  ]: Timing info for model.dbtlearn.dim_listings_w_hosts (execute): 2023-03-02 07:22:11.877744 => 2023-03-02 07:22:11.877749
[0m07:22:11.878345 [debug] [Thread-2  ]: Finished running node test.dbtlearn.unique_dim_hosts_cleansed_host_id.d7e4771347
[0m07:22:11.878800 [debug] [Thread-1  ]: Acquiring new snowflake connection 'test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af'
[0m07:22:11.879081 [debug] [Thread-4  ]: Began running node test.dbtlearn.dim_listings_minimum_nights
[0m07:22:11.879684 [debug] [Thread-3  ]: Finished running node model.dbtlearn.dim_listings_w_hosts
[0m07:22:11.879972 [debug] [Thread-2  ]: Began running node test.dbtlearn.no_nulls_in_dim_listings
[0m07:22:11.880237 [debug] [Thread-1  ]: Began compiling node test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m07:22:11.880690 [debug] [Thread-4  ]: Acquiring new snowflake connection 'test.dbtlearn.dim_listings_minimum_nights'
[0m07:22:11.880979 [debug] [Thread-3  ]: Began running node test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m07:22:11.881465 [debug] [Thread-2  ]: Acquiring new snowflake connection 'test.dbtlearn.no_nulls_in_dim_listings'
[0m07:22:11.893089 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m07:22:11.893324 [debug] [Thread-4  ]: Began compiling node test.dbtlearn.dim_listings_minimum_nights
[0m07:22:11.893799 [debug] [Thread-3  ]: Acquiring new snowflake connection 'test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be'
[0m07:22:11.894015 [debug] [Thread-2  ]: Began compiling node test.dbtlearn.no_nulls_in_dim_listings
[0m07:22:11.896717 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbtlearn.dim_listings_minimum_nights"
[0m07:22:11.897011 [debug] [Thread-3  ]: Began compiling node test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m07:22:11.903526 [debug] [Thread-1  ]: Timing info for test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af (compile): 2023-03-02 07:22:11.881638 => 2023-03-02 07:22:11.903474
[0m07:22:11.910070 [debug] [Thread-2  ]: Using snowflake connection "test.dbtlearn.no_nulls_in_dim_listings"
[0m07:22:11.914093 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m07:22:11.914397 [debug] [Thread-1  ]: Began executing node test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m07:22:11.914608 [debug] [Thread-2  ]: On test.dbtlearn.no_nulls_in_dim_listings: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.no_nulls_in_dim_listings"} */
describe table airbnb.dev.dim_listings_cleansed
[0m07:22:11.914818 [debug] [Thread-4  ]: Timing info for test.dbtlearn.dim_listings_minimum_nights (compile): 2023-03-02 07:22:11.894264 => 2023-03-02 07:22:11.914774
[0m07:22:11.915068 [debug] [Thread-1  ]: Timing info for test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af (execute): 2023-03-02 07:22:11.915022 => 2023-03-02 07:22:11.915031
[0m07:22:11.915286 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m07:22:11.915515 [debug] [Thread-4  ]: Began executing node test.dbtlearn.dim_listings_minimum_nights
[0m07:22:11.915704 [debug] [Thread-3  ]: Timing info for test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be (compile): 2023-03-02 07:22:11.910288 => 2023-03-02 07:22:11.915670
[0m07:22:11.916261 [debug] [Thread-1  ]: Finished running node test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m07:22:11.916773 [debug] [Thread-4  ]: Timing info for test.dbtlearn.dim_listings_minimum_nights (execute): 2023-03-02 07:22:11.916727 => 2023-03-02 07:22:11.916733
[0m07:22:11.917581 [debug] [Thread-3  ]: Began executing node test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m07:22:11.918425 [debug] [Thread-1  ]: Began running node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m07:22:11.919105 [debug] [Thread-4  ]: Finished running node test.dbtlearn.dim_listings_minimum_nights
[0m07:22:11.919333 [debug] [Thread-3  ]: Timing info for test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be (execute): 2023-03-02 07:22:11.919283 => 2023-03-02 07:22:11.919291
[0m07:22:11.919985 [debug] [Thread-1  ]: Acquiring new snowflake connection 'test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9'
[0m07:22:11.920607 [debug] [Thread-4  ]: Began running node test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m07:22:11.921204 [debug] [Thread-3  ]: Finished running node test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m07:22:11.921754 [debug] [Thread-1  ]: Began compiling node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m07:22:11.922235 [debug] [Thread-4  ]: Acquiring new snowflake connection 'test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313'
[0m07:22:11.922524 [debug] [Thread-3  ]: Began running node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m07:22:11.926656 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m07:22:11.926952 [debug] [Thread-4  ]: Began compiling node test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m07:22:11.927448 [debug] [Thread-3  ]: Acquiring new snowflake connection 'test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad'
[0m07:22:11.932337 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313"
[0m07:22:11.932650 [debug] [Thread-3  ]: Began compiling node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m07:22:11.932928 [debug] [Thread-1  ]: Timing info for test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9 (compile): 2023-03-02 07:22:11.922757 => 2023-03-02 07:22:11.932879
[0m07:22:11.942726 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m07:22:11.942976 [debug] [Thread-1  ]: Began executing node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m07:22:11.943293 [debug] [Thread-4  ]: Timing info for test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313 (compile): 2023-03-02 07:22:11.927690 => 2023-03-02 07:22:11.943240
[0m07:22:11.943506 [debug] [Thread-1  ]: Timing info for test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9 (execute): 2023-03-02 07:22:11.943455 => 2023-03-02 07:22:11.943465
[0m07:22:11.943774 [debug] [Thread-4  ]: Began executing node test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m07:22:11.944370 [debug] [Thread-1  ]: Finished running node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m07:22:11.944581 [debug] [Thread-3  ]: Timing info for test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad (compile): 2023-03-02 07:22:11.933107 => 2023-03-02 07:22:11.944539
[0m07:22:11.944764 [debug] [Thread-4  ]: Timing info for test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313 (execute): 2023-03-02 07:22:11.944725 => 2023-03-02 07:22:11.944731
[0m07:22:11.945055 [debug] [Thread-1  ]: Began running node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m07:22:11.945325 [debug] [Thread-3  ]: Began executing node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m07:22:11.945876 [debug] [Thread-4  ]: Finished running node test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m07:22:11.946328 [debug] [Thread-1  ]: Acquiring new snowflake connection 'test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e'
[0m07:22:11.946528 [debug] [Thread-3  ]: Timing info for test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad (execute): 2023-03-02 07:22:11.946489 => 2023-03-02 07:22:11.946495
[0m07:22:11.946818 [debug] [Thread-4  ]: Began running node model.dbtlearn.mart_fullmoon_reviews
[0m07:22:11.947078 [debug] [Thread-1  ]: Began compiling node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m07:22:11.947607 [debug] [Thread-3  ]: Finished running node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m07:22:11.948041 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.dbtlearn.mart_fullmoon_reviews'
[0m07:22:11.951910 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m07:22:11.952225 [debug] [Thread-3  ]: Began running node test.dbtlearn.consistent_created_at
[0m07:22:11.952499 [debug] [Thread-4  ]: Began compiling node model.dbtlearn.mart_fullmoon_reviews
[0m07:22:11.953018 [debug] [Thread-3  ]: Acquiring new snowflake connection 'test.dbtlearn.consistent_created_at'
[0m07:22:11.956342 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtlearn.mart_fullmoon_reviews"
[0m07:22:11.956596 [debug] [Thread-3  ]: Began compiling node test.dbtlearn.consistent_created_at
[0m07:22:11.956813 [debug] [Thread-1  ]: Timing info for test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e (compile): 2023-03-02 07:22:11.948200 => 2023-03-02 07:22:11.956771
[0m07:22:11.959618 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbtlearn.consistent_created_at"
[0m07:22:11.959896 [debug] [Thread-1  ]: Began executing node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m07:22:11.960165 [debug] [Thread-4  ]: Timing info for model.dbtlearn.mart_fullmoon_reviews (compile): 2023-03-02 07:22:11.953221 => 2023-03-02 07:22:11.960128
[0m07:22:11.960343 [debug] [Thread-1  ]: Timing info for test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e (execute): 2023-03-02 07:22:11.960305 => 2023-03-02 07:22:11.960312
[0m07:22:11.960573 [debug] [Thread-4  ]: Began executing node model.dbtlearn.mart_fullmoon_reviews
[0m07:22:11.961180 [debug] [Thread-1  ]: Finished running node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m07:22:11.961375 [debug] [Thread-3  ]: Timing info for test.dbtlearn.consistent_created_at (compile): 2023-03-02 07:22:11.957007 => 2023-03-02 07:22:11.961336
[0m07:22:11.961571 [debug] [Thread-4  ]: Timing info for model.dbtlearn.mart_fullmoon_reviews (execute): 2023-03-02 07:22:11.961530 => 2023-03-02 07:22:11.961536
[0m07:22:11.961879 [debug] [Thread-3  ]: Began executing node test.dbtlearn.consistent_created_at
[0m07:22:11.962427 [debug] [Thread-4  ]: Finished running node model.dbtlearn.mart_fullmoon_reviews
[0m07:22:11.962631 [debug] [Thread-3  ]: Timing info for test.dbtlearn.consistent_created_at (execute): 2023-03-02 07:22:11.962594 => 2023-03-02 07:22:11.962599
[0m07:22:11.963259 [debug] [Thread-3  ]: Finished running node test.dbtlearn.consistent_created_at
[0m07:22:13.888371 [debug] [Thread-2  ]: SQL status: SUCCESS 8 in 2 seconds
[0m07:22:13.895432 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbtlearn.no_nulls_in_dim_listings"
[0m07:22:13.896479 [debug] [Thread-2  ]: Timing info for test.dbtlearn.no_nulls_in_dim_listings (compile): 2023-03-02 07:22:11.897199 => 2023-03-02 07:22:13.896375
[0m07:22:13.896951 [debug] [Thread-2  ]: Began executing node test.dbtlearn.no_nulls_in_dim_listings
[0m07:22:13.897332 [debug] [Thread-2  ]: Timing info for test.dbtlearn.no_nulls_in_dim_listings (execute): 2023-03-02 07:22:13.897251 => 2023-03-02 07:22:13.897269
[0m07:22:13.897707 [debug] [Thread-2  ]: On test.dbtlearn.no_nulls_in_dim_listings: Close
[0m07:22:14.597519 [debug] [Thread-2  ]: Finished running node test.dbtlearn.no_nulls_in_dim_listings
[0m07:22:14.600374 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:22:14.600748 [debug] [MainThread]: Connection 'test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e' was properly closed.
[0m07:22:14.601044 [debug] [MainThread]: Connection 'test.dbtlearn.no_nulls_in_dim_listings' was properly closed.
[0m07:22:14.601323 [debug] [MainThread]: Connection 'test.dbtlearn.consistent_created_at' was properly closed.
[0m07:22:14.601594 [debug] [MainThread]: Connection 'model.dbtlearn.mart_fullmoon_reviews' was properly closed.
[0m07:22:14.603359 [debug] [MainThread]: Command end result
[0m07:22:14.619181 [info ] [MainThread]: Done.
[0m07:22:14.624926 [debug] [MainThread]: Acquiring new snowflake connection 'generate_catalog'
[0m07:22:14.625251 [info ] [MainThread]: Building catalog
[0m07:22:14.628101 [debug] [ThreadPool]: Acquiring new snowflake connection 'airbnb.information_schema'
[0m07:22:14.639066 [debug] [ThreadPool]: Using snowflake connection "airbnb.information_schema"
[0m07:22:14.639373 [debug] [ThreadPool]: On airbnb.information_schema: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "airbnb.information_schema"} */
with tables as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",
              table_type as "table_type",
              comment as "table_comment",

              -- note: this is the _role_ that owns the table
              table_owner as "table_owner",

              'Clustering Key' as "stats:clustering_key:label",
              clustering_key as "stats:clustering_key:value",
              'The key used to cluster this table' as "stats:clustering_key:description",
              (clustering_key is not null) as "stats:clustering_key:include",

              'Row Count' as "stats:row_count:label",
              row_count as "stats:row_count:value",
              'An approximate count of rows in this table' as "stats:row_count:description",
              (row_count is not null) as "stats:row_count:include",

              'Approximate Size' as "stats:bytes:label",
              bytes as "stats:bytes:value",
              'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
              (bytes is not null) as "stats:bytes:include",

              'Last Modified' as "stats:last_modified:label",
              to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
              'The timestamp for last update/change' as "stats:last_modified:description",
              (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"

          from airbnb.INFORMATION_SCHEMA.tables

      ),

      columns as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",

              column_name as "column_name",
              ordinal_position as "column_index",
              data_type as "column_type",
              comment as "column_comment"

          from airbnb.INFORMATION_SCHEMA.columns
      )

      select *
      from tables
      join columns using ("table_database", "table_schema", "table_name")
      where (upper("table_schema") = upper('raw') or upper("table_schema") = upper('dev'))
      order by "column_index"
[0m07:22:14.639618 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:22:18.579288 [debug] [ThreadPool]: SQL status: SUCCESS 69 in 4 seconds
[0m07:22:18.621395 [debug] [ThreadPool]: On airbnb.information_schema: Close
[0m07:22:19.337161 [info ] [MainThread]: Catalog written to /Users/katiehuang/Documents/Data Science/Courses/Udemy dbt Airbnb Project/dbtlearn/target/catalog.json
[0m07:22:19.337749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7f8fbbac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb80ac3c6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb80ac3cd90>]}
[0m07:22:19.338233 [debug] [MainThread]: Flushing usage events
[0m07:22:20.612890 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m07:22:20.614212 [debug] [MainThread]: Connection 'airbnb.information_schema' was properly closed.


============================== 2023-03-02 07:22:26.048294 | 742a2d52-8007-4c62-acee-881c0c576b8c ==============================
[0m07:22:26.048294 [info ] [MainThread]: Running with dbt=1.4.3
[0m07:22:26.050551 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/katiehuang/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'port': 8080, 'open_browser': True, 'which': 'serve', 'indirect_selection': 'eager'}
[0m07:22:26.050953 [debug] [MainThread]: Tracking: tracking
[0m07:22:26.051590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0118e4b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0118e4eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0118e4df0>]}
[0m07:22:26.054708 [info ] [MainThread]: Serving docs at 0.0.0.0:8080
[0m07:22:26.055157 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8080
[0m07:22:26.055438 [info ] [MainThread]: 
[0m07:22:26.055702 [info ] [MainThread]: 
[0m07:22:26.055952 [info ] [MainThread]: Press Ctrl+C to exit.
[0m07:23:52.240062 [debug] [MainThread]: Flushing usage events
[0m07:23:53.818040 [info ] [MainThread]: ctrl-c


============================== 2023-03-02 07:32:00.017897 | bdc65ff2-b9d6-47c5-9c10-5050442006d2 ==============================
[0m07:32:00.017897 [info ] [MainThread]: Running with dbt=1.4.3
[0m07:32:00.020654 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/katiehuang/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'compile': True, 'which': 'generate', 'rpc_method': 'docs.generate', 'indirect_selection': 'eager'}
[0m07:32:00.021145 [debug] [MainThread]: Tracking: tracking
[0m07:32:00.022022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84b1337880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84b1337c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84b1337af0>]}
[0m07:32:00.042329 [debug] [MainThread]: checksum: c7a5cda64f02d8b9dd20ef412f82fbb79fdce1bb359c3c5dae3d080de7f31bfd, vars: {}, profile: None, target: None, version: 1.4.3
[0m07:32:00.058612 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m07:32:00.059016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'bdc65ff2-b9d6-47c5-9c10-5050442006d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84b1319eb0>]}
[0m07:32:01.138785 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_w_hosts.sql
[0m07:32:01.152188 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_cleansed.sql
[0m07:32:01.154990 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_hosts_cleansed.sql
[0m07:32:01.157829 [debug] [MainThread]: 1603: static parser failed on fct/fct_reviews.sql
[0m07:32:01.181641 [debug] [MainThread]: 1602: parser fallback to jinja rendering on fct/fct_reviews.sql
[0m07:32:01.183154 [debug] [MainThread]: 1699: static parser successfully parsed mart/mart_fullmoon_reviews.sql
[0m07:32:01.185734 [debug] [MainThread]: 1699: static parser successfully parsed src/src_reviews.sql
[0m07:32:01.188218 [debug] [MainThread]: 1699: static parser successfully parsed src/src_listings.sql
[0m07:32:01.190994 [debug] [MainThread]: 1699: static parser successfully parsed src/src_hosts.sql
[0m07:32:01.386999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bdc65ff2-b9d6-47c5-9c10-5050442006d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84b1470880>]}
[0m07:32:01.398561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bdc65ff2-b9d6-47c5-9c10-5050442006d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84c2896b80>]}
[0m07:32:01.398905 [info ] [MainThread]: Found 8 models, 12 tests, 1 snapshot, 0 analyses, 418 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
[0m07:32:01.399224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bdc65ff2-b9d6-47c5-9c10-5050442006d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84c2896910>]}
[0m07:32:01.401525 [info ] [MainThread]: 
[0m07:32:01.403084 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m07:32:01.404454 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_airbnb_dev'
[0m07:32:01.419609 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m07:32:01.419910 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m07:32:01.420149 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:32:03.598643 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 2 seconds
[0m07:32:03.604176 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m07:32:04.528887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bdc65ff2-b9d6-47c5-9c10-5050442006d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84b1470cd0>]}
[0m07:32:04.529957 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:32:04.530469 [info ] [MainThread]: 
[0m07:32:04.536854 [debug] [Thread-1  ]: Began running node model.dbtlearn.src_hosts
[0m07:32:04.537295 [debug] [Thread-2  ]: Began running node model.dbtlearn.src_listings
[0m07:32:04.537626 [debug] [Thread-3  ]: Began running node model.dbtlearn.src_reviews
[0m07:32:04.538489 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtlearn.src_hosts'
[0m07:32:04.538847 [debug] [Thread-4  ]: Began running node seed.dbtlearn.seed_full_moon_dates
[0m07:32:04.539539 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtlearn.src_listings'
[0m07:32:04.540138 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtlearn.src_reviews'
[0m07:32:04.540444 [debug] [Thread-1  ]: Began compiling node model.dbtlearn.src_hosts
[0m07:32:04.541153 [debug] [Thread-4  ]: Acquiring new snowflake connection 'seed.dbtlearn.seed_full_moon_dates'
[0m07:32:04.541447 [debug] [Thread-2  ]: Began compiling node model.dbtlearn.src_listings
[0m07:32:04.541731 [debug] [Thread-3  ]: Began compiling node model.dbtlearn.src_reviews
[0m07:32:04.546322 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearn.src_hosts"
[0m07:32:04.546661 [debug] [Thread-4  ]: Began compiling node seed.dbtlearn.seed_full_moon_dates
[0m07:32:04.549846 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtlearn.src_listings"
[0m07:32:04.553199 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtlearn.src_reviews"
[0m07:32:04.555595 [debug] [Thread-4  ]: Timing info for seed.dbtlearn.seed_full_moon_dates (compile): 2023-03-02 07:32:04.553617 => 2023-03-02 07:32:04.555519
[0m07:32:04.556148 [debug] [Thread-4  ]: Began executing node seed.dbtlearn.seed_full_moon_dates
[0m07:32:04.556457 [debug] [Thread-4  ]: Timing info for seed.dbtlearn.seed_full_moon_dates (execute): 2023-03-02 07:32:04.556386 => 2023-03-02 07:32:04.556406
[0m07:32:04.556743 [debug] [Thread-1  ]: Timing info for model.dbtlearn.src_hosts (compile): 2023-03-02 07:32:04.541954 => 2023-03-02 07:32:04.556699
[0m07:32:04.558266 [debug] [Thread-4  ]: Finished running node seed.dbtlearn.seed_full_moon_dates
[0m07:32:04.558462 [debug] [Thread-3  ]: Timing info for model.dbtlearn.src_reviews (compile): 2023-03-02 07:32:04.550064 => 2023-03-02 07:32:04.558421
[0m07:32:04.558656 [debug] [Thread-2  ]: Timing info for model.dbtlearn.src_listings (compile): 2023-03-02 07:32:04.546849 => 2023-03-02 07:32:04.558623
[0m07:32:04.559198 [debug] [Thread-1  ]: Finished running node model.dbtlearn.src_hosts
[0m07:32:04.559507 [debug] [Thread-4  ]: Began running node snapshot.dbtlearn.scd_raw_listings
[0m07:32:04.560163 [debug] [Thread-3  ]: Finished running node model.dbtlearn.src_reviews
[0m07:32:04.560707 [debug] [Thread-2  ]: Finished running node model.dbtlearn.src_listings
[0m07:32:04.561288 [debug] [Thread-4  ]: Acquiring new snowflake connection 'snapshot.dbtlearn.scd_raw_listings'
[0m07:32:04.561636 [debug] [Thread-3  ]: Began running node model.dbtlearn.dim_hosts_cleansed
[0m07:32:04.562068 [debug] [Thread-4  ]: Began compiling node snapshot.dbtlearn.scd_raw_listings
[0m07:32:04.562336 [debug] [Thread-1  ]: Began running node model.dbtlearn.dim_listings_cleansed
[0m07:32:04.562562 [debug] [Thread-2  ]: Began running node model.dbtlearn.fct_reviews
[0m07:32:04.562991 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtlearn.dim_hosts_cleansed'
[0m07:32:04.567830 [debug] [Thread-4  ]: Timing info for snapshot.dbtlearn.scd_raw_listings (compile): 2023-03-02 07:32:04.563153 => 2023-03-02 07:32:04.567772
[0m07:32:04.568347 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtlearn.dim_listings_cleansed'
[0m07:32:04.568826 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtlearn.fct_reviews'
[0m07:32:04.569055 [debug] [Thread-3  ]: Began compiling node model.dbtlearn.dim_hosts_cleansed
[0m07:32:04.569290 [debug] [Thread-4  ]: Began executing node snapshot.dbtlearn.scd_raw_listings
[0m07:32:04.569506 [debug] [Thread-1  ]: Began compiling node model.dbtlearn.dim_listings_cleansed
[0m07:32:04.569708 [debug] [Thread-2  ]: Began compiling node model.dbtlearn.fct_reviews
[0m07:32:04.614443 [debug] [Thread-4  ]: Timing info for snapshot.dbtlearn.scd_raw_listings (execute): 2023-03-02 07:32:04.614359 => 2023-03-02 07:32:04.614376
[0m07:32:04.616628 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtlearn.dim_hosts_cleansed"
[0m07:32:04.626541 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearn.dim_listings_cleansed"
[0m07:32:04.639769 [debug] [Thread-4  ]: Finished running node snapshot.dbtlearn.scd_raw_listings
[0m07:32:04.645270 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtlearn.fct_reviews"
[0m07:32:04.646005 [debug] [Thread-1  ]: Timing info for model.dbtlearn.dim_listings_cleansed (compile): 2023-03-02 07:32:04.616844 => 2023-03-02 07:32:04.645952
[0m07:32:04.646255 [debug] [Thread-1  ]: Began executing node model.dbtlearn.dim_listings_cleansed
[0m07:32:04.646498 [debug] [Thread-1  ]: Timing info for model.dbtlearn.dim_listings_cleansed (execute): 2023-03-02 07:32:04.646436 => 2023-03-02 07:32:04.646446
[0m07:32:04.647134 [debug] [Thread-1  ]: Finished running node model.dbtlearn.dim_listings_cleansed
[0m07:32:04.647479 [debug] [Thread-2  ]: Timing info for model.dbtlearn.fct_reviews (compile): 2023-03-02 07:32:04.626715 => 2023-03-02 07:32:04.647437
[0m07:32:04.647878 [debug] [Thread-2  ]: Began executing node model.dbtlearn.fct_reviews
[0m07:32:04.648102 [debug] [Thread-3  ]: Timing info for model.dbtlearn.dim_hosts_cleansed (compile): 2023-03-02 07:32:04.569860 => 2023-03-02 07:32:04.648064
[0m07:32:04.648273 [debug] [Thread-2  ]: Timing info for model.dbtlearn.fct_reviews (execute): 2023-03-02 07:32:04.648237 => 2023-03-02 07:32:04.648242
[0m07:32:04.648502 [debug] [Thread-4  ]: Began running node test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m07:32:04.648776 [debug] [Thread-1  ]: Began running node test.dbtlearn.dim_listings_minimum_nights
[0m07:32:04.648974 [debug] [Thread-3  ]: Began executing node model.dbtlearn.dim_hosts_cleansed
[0m07:32:04.649535 [debug] [Thread-2  ]: Finished running node model.dbtlearn.fct_reviews
[0m07:32:04.650024 [debug] [Thread-4  ]: Acquiring new snowflake connection 'test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af'
[0m07:32:04.650469 [debug] [Thread-1  ]: Acquiring new snowflake connection 'test.dbtlearn.dim_listings_minimum_nights'
[0m07:32:04.650666 [debug] [Thread-3  ]: Timing info for model.dbtlearn.dim_hosts_cleansed (execute): 2023-03-02 07:32:04.650624 => 2023-03-02 07:32:04.650630
[0m07:32:04.650934 [debug] [Thread-2  ]: Began running node test.dbtlearn.no_nulls_in_dim_listings
[0m07:32:04.651159 [debug] [Thread-4  ]: Began compiling node test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m07:32:04.651492 [debug] [Thread-1  ]: Began compiling node test.dbtlearn.dim_listings_minimum_nights
[0m07:32:04.652042 [debug] [Thread-3  ]: Finished running node model.dbtlearn.dim_hosts_cleansed
[0m07:32:04.652465 [debug] [Thread-2  ]: Acquiring new snowflake connection 'test.dbtlearn.no_nulls_in_dim_listings'
[0m07:32:04.659008 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m07:32:04.661731 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbtlearn.dim_listings_minimum_nights"
[0m07:32:04.662052 [debug] [Thread-3  ]: Began running node test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m07:32:04.662280 [debug] [Thread-2  ]: Began compiling node test.dbtlearn.no_nulls_in_dim_listings
[0m07:32:04.663101 [debug] [Thread-3  ]: Acquiring new snowflake connection 'test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be'
[0m07:32:04.675498 [debug] [Thread-2  ]: Using snowflake connection "test.dbtlearn.no_nulls_in_dim_listings"
[0m07:32:04.675760 [debug] [Thread-3  ]: Began compiling node test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m07:32:04.676037 [debug] [Thread-2  ]: On test.dbtlearn.no_nulls_in_dim_listings: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.no_nulls_in_dim_listings"} */
describe table airbnb.dev.dim_listings_cleansed
[0m07:32:04.676278 [debug] [Thread-4  ]: Timing info for test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af (compile): 2023-03-02 07:32:04.652616 => 2023-03-02 07:32:04.676232
[0m07:32:04.676446 [debug] [Thread-1  ]: Timing info for test.dbtlearn.dim_listings_minimum_nights (compile): 2023-03-02 07:32:04.659177 => 2023-03-02 07:32:04.676414
[0m07:32:04.685676 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m07:32:04.685880 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m07:32:04.686118 [debug] [Thread-4  ]: Began executing node test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m07:32:04.686327 [debug] [Thread-1  ]: Began executing node test.dbtlearn.dim_listings_minimum_nights
[0m07:32:04.687287 [debug] [Thread-4  ]: Timing info for test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af (execute): 2023-03-02 07:32:04.687231 => 2023-03-02 07:32:04.687241
[0m07:32:04.687535 [debug] [Thread-1  ]: Timing info for test.dbtlearn.dim_listings_minimum_nights (execute): 2023-03-02 07:32:04.687481 => 2023-03-02 07:32:04.687489
[0m07:32:04.688171 [debug] [Thread-4  ]: Finished running node test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m07:32:04.689322 [debug] [Thread-1  ]: Finished running node test.dbtlearn.dim_listings_minimum_nights
[0m07:32:04.689508 [debug] [Thread-3  ]: Timing info for test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be (compile): 2023-03-02 07:32:04.676577 => 2023-03-02 07:32:04.689471
[0m07:32:04.689861 [debug] [Thread-4  ]: Began running node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m07:32:04.690222 [debug] [Thread-1  ]: Began running node test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m07:32:04.690687 [debug] [Thread-3  ]: Began executing node test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m07:32:04.691494 [debug] [Thread-4  ]: Acquiring new snowflake connection 'test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9'
[0m07:32:04.691994 [debug] [Thread-1  ]: Acquiring new snowflake connection 'test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313'
[0m07:32:04.692542 [debug] [Thread-3  ]: Timing info for test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be (execute): 2023-03-02 07:32:04.692493 => 2023-03-02 07:32:04.692500
[0m07:32:04.692771 [debug] [Thread-4  ]: Began compiling node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m07:32:04.692993 [debug] [Thread-1  ]: Began compiling node test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m07:32:04.693584 [debug] [Thread-3  ]: Finished running node test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m07:32:04.697875 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m07:32:04.701615 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313"
[0m07:32:04.701954 [debug] [Thread-3  ]: Began running node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m07:32:04.702596 [debug] [Thread-3  ]: Acquiring new snowflake connection 'test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e'
[0m07:32:04.702870 [debug] [Thread-3  ]: Began compiling node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m07:32:04.709641 [debug] [Thread-1  ]: Timing info for test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313 (compile): 2023-03-02 07:32:04.698103 => 2023-03-02 07:32:04.709593
[0m07:32:04.709959 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m07:32:04.710137 [debug] [Thread-4  ]: Timing info for test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9 (compile): 2023-03-02 07:32:04.693791 => 2023-03-02 07:32:04.710103
[0m07:32:04.710344 [debug] [Thread-1  ]: Began executing node test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m07:32:04.710613 [debug] [Thread-4  ]: Began executing node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m07:32:04.710842 [debug] [Thread-1  ]: Timing info for test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313 (execute): 2023-03-02 07:32:04.710799 => 2023-03-02 07:32:04.710806
[0m07:32:04.711051 [debug] [Thread-4  ]: Timing info for test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9 (execute): 2023-03-02 07:32:04.711012 => 2023-03-02 07:32:04.711018
[0m07:32:04.711232 [debug] [Thread-3  ]: Timing info for test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e (compile): 2023-03-02 07:32:04.703078 => 2023-03-02 07:32:04.711202
[0m07:32:04.711772 [debug] [Thread-1  ]: Finished running node test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m07:32:04.712310 [debug] [Thread-4  ]: Finished running node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m07:32:04.712524 [debug] [Thread-3  ]: Began executing node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m07:32:04.712808 [debug] [Thread-1  ]: Began running node model.dbtlearn.mart_fullmoon_reviews
[0m07:32:04.713127 [debug] [Thread-4  ]: Began running node test.dbtlearn.consistent_created_at
[0m07:32:04.713366 [debug] [Thread-3  ]: Timing info for test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e (execute): 2023-03-02 07:32:04.713324 => 2023-03-02 07:32:04.713330
[0m07:32:04.713807 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtlearn.mart_fullmoon_reviews'
[0m07:32:04.714241 [debug] [Thread-4  ]: Acquiring new snowflake connection 'test.dbtlearn.consistent_created_at'
[0m07:32:04.714749 [debug] [Thread-3  ]: Finished running node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m07:32:04.714962 [debug] [Thread-1  ]: Began compiling node model.dbtlearn.mart_fullmoon_reviews
[0m07:32:04.715177 [debug] [Thread-4  ]: Began compiling node test.dbtlearn.consistent_created_at
[0m07:32:04.715448 [debug] [Thread-3  ]: Began running node model.dbtlearn.dim_listings_w_hosts
[0m07:32:04.718874 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearn.mart_fullmoon_reviews"
[0m07:32:04.721685 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbtlearn.consistent_created_at"
[0m07:32:04.722171 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtlearn.dim_listings_w_hosts'
[0m07:32:04.722532 [debug] [Thread-3  ]: Began compiling node model.dbtlearn.dim_listings_w_hosts
[0m07:32:04.725577 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtlearn.dim_listings_w_hosts"
[0m07:32:04.725940 [debug] [Thread-1  ]: Timing info for model.dbtlearn.mart_fullmoon_reviews (compile): 2023-03-02 07:32:04.715635 => 2023-03-02 07:32:04.725893
[0m07:32:04.726158 [debug] [Thread-4  ]: Timing info for test.dbtlearn.consistent_created_at (compile): 2023-03-02 07:32:04.719062 => 2023-03-02 07:32:04.726112
[0m07:32:04.726392 [debug] [Thread-1  ]: Began executing node model.dbtlearn.mart_fullmoon_reviews
[0m07:32:04.726631 [debug] [Thread-4  ]: Began executing node test.dbtlearn.consistent_created_at
[0m07:32:04.726809 [debug] [Thread-3  ]: Timing info for model.dbtlearn.dim_listings_w_hosts (compile): 2023-03-02 07:32:04.722740 => 2023-03-02 07:32:04.726770
[0m07:32:04.728456 [debug] [Thread-1  ]: Timing info for model.dbtlearn.mart_fullmoon_reviews (execute): 2023-03-02 07:32:04.728406 => 2023-03-02 07:32:04.728414
[0m07:32:04.728668 [debug] [Thread-4  ]: Timing info for test.dbtlearn.consistent_created_at (execute): 2023-03-02 07:32:04.728621 => 2023-03-02 07:32:04.728628
[0m07:32:04.728889 [debug] [Thread-3  ]: Began executing node model.dbtlearn.dim_listings_w_hosts
[0m07:32:04.729443 [debug] [Thread-1  ]: Finished running node model.dbtlearn.mart_fullmoon_reviews
[0m07:32:04.729965 [debug] [Thread-4  ]: Finished running node test.dbtlearn.consistent_created_at
[0m07:32:04.730171 [debug] [Thread-3  ]: Timing info for model.dbtlearn.dim_listings_w_hosts (execute): 2023-03-02 07:32:04.730132 => 2023-03-02 07:32:04.730138
[0m07:32:04.730453 [debug] [Thread-1  ]: Began running node test.dbtlearn.not_null_dim_hosts_cleansed_host_id.de84c3da05
[0m07:32:04.730783 [debug] [Thread-4  ]: Began running node test.dbtlearn.not_null_dim_hosts_cleansed_host_name.42386c5830
[0m07:32:04.731385 [debug] [Thread-3  ]: Finished running node model.dbtlearn.dim_listings_w_hosts
[0m07:32:04.731824 [debug] [Thread-1  ]: Acquiring new snowflake connection 'test.dbtlearn.not_null_dim_hosts_cleansed_host_id.de84c3da05'
[0m07:32:04.732247 [debug] [Thread-4  ]: Acquiring new snowflake connection 'test.dbtlearn.not_null_dim_hosts_cleansed_host_name.42386c5830'
[0m07:32:04.732517 [debug] [Thread-3  ]: Began running node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m07:32:04.732771 [debug] [Thread-1  ]: Began compiling node test.dbtlearn.not_null_dim_hosts_cleansed_host_id.de84c3da05
[0m07:32:04.732983 [debug] [Thread-4  ]: Began compiling node test.dbtlearn.not_null_dim_hosts_cleansed_host_name.42386c5830
[0m07:32:04.733413 [debug] [Thread-3  ]: Acquiring new snowflake connection 'test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad'
[0m07:32:04.737390 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbtlearn.not_null_dim_hosts_cleansed_host_id.de84c3da05"
[0m07:32:04.741292 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbtlearn.not_null_dim_hosts_cleansed_host_name.42386c5830"
[0m07:32:04.741546 [debug] [Thread-3  ]: Began compiling node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m07:32:04.746964 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m07:32:04.747334 [debug] [Thread-4  ]: Timing info for test.dbtlearn.not_null_dim_hosts_cleansed_host_name.42386c5830 (compile): 2023-03-02 07:32:04.737577 => 2023-03-02 07:32:04.747289
[0m07:32:04.747541 [debug] [Thread-1  ]: Timing info for test.dbtlearn.not_null_dim_hosts_cleansed_host_id.de84c3da05 (compile): 2023-03-02 07:32:04.733568 => 2023-03-02 07:32:04.747499
[0m07:32:04.747779 [debug] [Thread-4  ]: Began executing node test.dbtlearn.not_null_dim_hosts_cleansed_host_name.42386c5830
[0m07:32:04.748042 [debug] [Thread-1  ]: Began executing node test.dbtlearn.not_null_dim_hosts_cleansed_host_id.de84c3da05
[0m07:32:04.748241 [debug] [Thread-3  ]: Timing info for test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad (compile): 2023-03-02 07:32:04.741870 => 2023-03-02 07:32:04.748203
[0m07:32:04.748417 [debug] [Thread-4  ]: Timing info for test.dbtlearn.not_null_dim_hosts_cleansed_host_name.42386c5830 (execute): 2023-03-02 07:32:04.748374 => 2023-03-02 07:32:04.748381
[0m07:32:04.748614 [debug] [Thread-1  ]: Timing info for test.dbtlearn.not_null_dim_hosts_cleansed_host_id.de84c3da05 (execute): 2023-03-02 07:32:04.748574 => 2023-03-02 07:32:04.748580
[0m07:32:04.748822 [debug] [Thread-3  ]: Began executing node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m07:32:04.749379 [debug] [Thread-4  ]: Finished running node test.dbtlearn.not_null_dim_hosts_cleansed_host_name.42386c5830
[0m07:32:04.750122 [debug] [Thread-1  ]: Finished running node test.dbtlearn.not_null_dim_hosts_cleansed_host_id.de84c3da05
[0m07:32:04.750328 [debug] [Thread-3  ]: Timing info for test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad (execute): 2023-03-02 07:32:04.750288 => 2023-03-02 07:32:04.750293
[0m07:32:04.750610 [debug] [Thread-4  ]: Began running node test.dbtlearn.unique_dim_hosts_cleansed_host_id.d7e4771347
[0m07:32:04.751285 [debug] [Thread-3  ]: Finished running node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m07:32:04.751713 [debug] [Thread-4  ]: Acquiring new snowflake connection 'test.dbtlearn.unique_dim_hosts_cleansed_host_id.d7e4771347'
[0m07:32:04.752022 [debug] [Thread-4  ]: Began compiling node test.dbtlearn.unique_dim_hosts_cleansed_host_id.d7e4771347
[0m07:32:04.755788 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbtlearn.unique_dim_hosts_cleansed_host_id.d7e4771347"
[0m07:32:04.756195 [debug] [Thread-4  ]: Timing info for test.dbtlearn.unique_dim_hosts_cleansed_host_id.d7e4771347 (compile): 2023-03-02 07:32:04.752182 => 2023-03-02 07:32:04.756149
[0m07:32:04.756416 [debug] [Thread-4  ]: Began executing node test.dbtlearn.unique_dim_hosts_cleansed_host_id.d7e4771347
[0m07:32:04.756603 [debug] [Thread-4  ]: Timing info for test.dbtlearn.unique_dim_hosts_cleansed_host_id.d7e4771347 (execute): 2023-03-02 07:32:04.756564 => 2023-03-02 07:32:04.756570
[0m07:32:04.757144 [debug] [Thread-4  ]: Finished running node test.dbtlearn.unique_dim_hosts_cleansed_host_id.d7e4771347
[0m07:32:06.807395 [debug] [Thread-2  ]: SQL status: SUCCESS 8 in 2 seconds
[0m07:32:06.814155 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbtlearn.no_nulls_in_dim_listings"
[0m07:32:06.815288 [debug] [Thread-2  ]: Timing info for test.dbtlearn.no_nulls_in_dim_listings (compile): 2023-03-02 07:32:04.663285 => 2023-03-02 07:32:06.815173
[0m07:32:06.815790 [debug] [Thread-2  ]: Began executing node test.dbtlearn.no_nulls_in_dim_listings
[0m07:32:06.816193 [debug] [Thread-2  ]: Timing info for test.dbtlearn.no_nulls_in_dim_listings (execute): 2023-03-02 07:32:06.816101 => 2023-03-02 07:32:06.816124
[0m07:32:06.816559 [debug] [Thread-2  ]: On test.dbtlearn.no_nulls_in_dim_listings: Close
[0m07:32:07.423580 [debug] [Thread-2  ]: Finished running node test.dbtlearn.no_nulls_in_dim_listings
[0m07:32:07.426580 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:32:07.426957 [debug] [MainThread]: Connection 'test.dbtlearn.not_null_dim_hosts_cleansed_host_id.de84c3da05' was properly closed.
[0m07:32:07.427257 [debug] [MainThread]: Connection 'test.dbtlearn.no_nulls_in_dim_listings' was properly closed.
[0m07:32:07.427537 [debug] [MainThread]: Connection 'test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad' was properly closed.
[0m07:32:07.427813 [debug] [MainThread]: Connection 'test.dbtlearn.unique_dim_hosts_cleansed_host_id.d7e4771347' was properly closed.
[0m07:32:07.429555 [debug] [MainThread]: Command end result
[0m07:32:07.446922 [info ] [MainThread]: Done.
[0m07:32:07.454968 [debug] [MainThread]: Acquiring new snowflake connection 'generate_catalog'
[0m07:32:07.455290 [info ] [MainThread]: Building catalog
[0m07:32:07.459726 [debug] [ThreadPool]: Acquiring new snowflake connection 'airbnb.information_schema'
[0m07:32:07.469901 [debug] [ThreadPool]: Using snowflake connection "airbnb.information_schema"
[0m07:32:07.470213 [debug] [ThreadPool]: On airbnb.information_schema: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "airbnb.information_schema"} */
with tables as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",
              table_type as "table_type",
              comment as "table_comment",

              -- note: this is the _role_ that owns the table
              table_owner as "table_owner",

              'Clustering Key' as "stats:clustering_key:label",
              clustering_key as "stats:clustering_key:value",
              'The key used to cluster this table' as "stats:clustering_key:description",
              (clustering_key is not null) as "stats:clustering_key:include",

              'Row Count' as "stats:row_count:label",
              row_count as "stats:row_count:value",
              'An approximate count of rows in this table' as "stats:row_count:description",
              (row_count is not null) as "stats:row_count:include",

              'Approximate Size' as "stats:bytes:label",
              bytes as "stats:bytes:value",
              'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
              (bytes is not null) as "stats:bytes:include",

              'Last Modified' as "stats:last_modified:label",
              to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
              'The timestamp for last update/change' as "stats:last_modified:description",
              (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"

          from airbnb.INFORMATION_SCHEMA.tables

      ),

      columns as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",

              column_name as "column_name",
              ordinal_position as "column_index",
              data_type as "column_type",
              comment as "column_comment"

          from airbnb.INFORMATION_SCHEMA.columns
      )

      select *
      from tables
      join columns using ("table_database", "table_schema", "table_name")
      where (upper("table_schema") = upper('dev') or upper("table_schema") = upper('raw'))
      order by "column_index"
[0m07:32:07.470432 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:32:11.173570 [debug] [ThreadPool]: SQL status: SUCCESS 69 in 4 seconds
[0m07:32:11.224664 [debug] [ThreadPool]: On airbnb.information_schema: Close
[0m07:32:11.996500 [info ] [MainThread]: Catalog written to /Users/katiehuang/Documents/Data Science/Courses/Udemy dbt Airbnb Project/dbtlearn/target/catalog.json
[0m07:32:11.997138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84b1337880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8490163400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84901633d0>]}
[0m07:32:11.997517 [debug] [MainThread]: Flushing usage events
[0m07:32:13.322648 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m07:32:13.323640 [debug] [MainThread]: Connection 'airbnb.information_schema' was properly closed.


============================== 2023-03-02 07:32:57.629934 | 90a74d54-0ce9-4ad0-bc65-95c5a261a05a ==============================
[0m07:32:57.629934 [info ] [MainThread]: Running with dbt=1.4.3
[0m07:32:57.632297 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/katiehuang/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'port': 8080, 'open_browser': True, 'which': 'serve', 'indirect_selection': 'eager'}
[0m07:32:57.632581 [debug] [MainThread]: Tracking: tracking
[0m07:32:57.633292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d494f3b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d494f3c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d494f3e50>]}
[0m07:32:57.636973 [info ] [MainThread]: Serving docs at 0.0.0.0:8080
[0m07:32:57.637361 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8080
[0m07:32:57.637645 [info ] [MainThread]: 
[0m07:32:57.637893 [info ] [MainThread]: 
[0m07:32:57.638143 [info ] [MainThread]: Press Ctrl+C to exit.
[0m07:33:53.936115 [debug] [MainThread]: Flushing usage events
[0m07:33:55.328362 [info ] [MainThread]: ctrl-c


============================== 2023-03-07 06:57:05.898994 | 74c96c61-787a-46ef-9c19-ddee61be10ec ==============================
[0m06:57:05.898994 [info ] [MainThread]: Running with dbt=1.4.3
[0m06:57:05.901365 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/katiehuang/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'parse_only': False, 'which': 'compile', 'rpc_method': 'compile', 'indirect_selection': 'eager'}
[0m06:57:05.901712 [debug] [MainThread]: Tracking: tracking
[0m06:57:05.902446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb121243370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb121243ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb121243dc0>]}
[0m06:57:05.923332 [debug] [MainThread]: checksum: c7a5cda64f02d8b9dd20ef412f82fbb79fdce1bb359c3c5dae3d080de7f31bfd, vars: {}, profile: None, target: None, version: 1.4.3
[0m06:57:05.998064 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m06:57:05.998584 [debug] [MainThread]: Partial parsing: added file: dbtlearn://analyses/full_moon_no_sleep.sql
[0m06:57:05.999097 [debug] [MainThread]: Partial parsing: updated file: dbtlearn://models/schema.yml
[0m06:57:06.019487 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_hosts_cleansed.sql
[0m06:57:06.101597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '74c96c61-787a-46ef-9c19-ddee61be10ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1120db4c0>]}
[0m06:57:06.113831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '74c96c61-787a-46ef-9c19-ddee61be10ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb111fef340>]}
[0m06:57:06.114193 [info ] [MainThread]: Found 8 models, 13 tests, 1 snapshot, 1 analysis, 418 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
[0m06:57:06.114521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '74c96c61-787a-46ef-9c19-ddee61be10ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb111fef310>]}
[0m06:57:06.116827 [info ] [MainThread]: 
[0m06:57:06.118346 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m06:57:06.119657 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_airbnb_dev'
[0m06:57:06.134839 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m06:57:06.135169 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m06:57:06.135427 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:57:09.232967 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 3 seconds
[0m06:57:09.239676 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m06:57:09.947730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '74c96c61-787a-46ef-9c19-ddee61be10ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1120a1e50>]}
[0m06:57:09.949010 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:57:09.949598 [info ] [MainThread]: 
[0m06:57:09.956347 [debug] [Thread-1  ]: Began running node model.dbtlearn.src_hosts
[0m06:57:09.956838 [debug] [Thread-2  ]: Began running node model.dbtlearn.src_listings
[0m06:57:09.957244 [debug] [Thread-3  ]: Began running node model.dbtlearn.src_reviews
[0m06:57:09.957990 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtlearn.src_hosts'
[0m06:57:09.958359 [debug] [Thread-4  ]: Began running node seed.dbtlearn.seed_full_moon_dates
[0m06:57:09.959150 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtlearn.src_listings'
[0m06:57:09.959885 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtlearn.src_reviews'
[0m06:57:09.960248 [debug] [Thread-1  ]: Began compiling node model.dbtlearn.src_hosts
[0m06:57:09.960996 [debug] [Thread-4  ]: Acquiring new snowflake connection 'seed.dbtlearn.seed_full_moon_dates'
[0m06:57:09.961324 [debug] [Thread-2  ]: Began compiling node model.dbtlearn.src_listings
[0m06:57:09.961717 [debug] [Thread-3  ]: Began compiling node model.dbtlearn.src_reviews
[0m06:57:09.968499 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearn.src_hosts"
[0m06:57:09.968856 [debug] [Thread-4  ]: Began compiling node seed.dbtlearn.seed_full_moon_dates
[0m06:57:09.973266 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtlearn.src_listings"
[0m06:57:09.977155 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtlearn.src_reviews"
[0m06:57:09.979298 [debug] [Thread-4  ]: Timing info for seed.dbtlearn.seed_full_moon_dates (compile): 2023-03-07 06:57:09.977480 => 2023-03-07 06:57:09.979223
[0m06:57:09.979961 [debug] [Thread-4  ]: Began executing node seed.dbtlearn.seed_full_moon_dates
[0m06:57:09.980354 [debug] [Thread-4  ]: Timing info for seed.dbtlearn.seed_full_moon_dates (execute): 2023-03-07 06:57:09.980274 => 2023-03-07 06:57:09.980304
[0m06:57:09.982266 [debug] [Thread-4  ]: Finished running node seed.dbtlearn.seed_full_moon_dates
[0m06:57:09.982530 [debug] [Thread-3  ]: Timing info for model.dbtlearn.src_reviews (compile): 2023-03-07 06:57:09.973628 => 2023-03-07 06:57:09.982478
[0m06:57:09.982746 [debug] [Thread-2  ]: Timing info for model.dbtlearn.src_listings (compile): 2023-03-07 06:57:09.969097 => 2023-03-07 06:57:09.982699
[0m06:57:09.983078 [debug] [Thread-4  ]: Began running node snapshot.dbtlearn.scd_raw_listings
[0m06:57:09.983305 [debug] [Thread-1  ]: Timing info for model.dbtlearn.src_hosts (compile): 2023-03-07 06:57:09.962020 => 2023-03-07 06:57:09.983265
[0m06:57:09.983992 [debug] [Thread-3  ]: Finished running node model.dbtlearn.src_reviews
[0m06:57:09.984662 [debug] [Thread-2  ]: Finished running node model.dbtlearn.src_listings
[0m06:57:09.985364 [debug] [Thread-4  ]: Acquiring new snowflake connection 'snapshot.dbtlearn.scd_raw_listings'
[0m06:57:09.985982 [debug] [Thread-1  ]: Finished running node model.dbtlearn.src_hosts
[0m06:57:09.986540 [debug] [Thread-3  ]: Began running node model.dbtlearn.fct_reviews
[0m06:57:09.986780 [debug] [Thread-4  ]: Began compiling node snapshot.dbtlearn.scd_raw_listings
[0m06:57:09.987049 [debug] [Thread-2  ]: Began running node model.dbtlearn.dim_listings_cleansed
[0m06:57:09.987576 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtlearn.fct_reviews'
[0m06:57:09.987892 [debug] [Thread-1  ]: Began running node model.dbtlearn.dim_hosts_cleansed
[0m06:57:09.991574 [debug] [Thread-4  ]: Timing info for snapshot.dbtlearn.scd_raw_listings (compile): 2023-03-07 06:57:09.988040 => 2023-03-07 06:57:09.991526
[0m06:57:09.992074 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtlearn.dim_listings_cleansed'
[0m06:57:09.992306 [debug] [Thread-3  ]: Began compiling node model.dbtlearn.fct_reviews
[0m06:57:09.992761 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtlearn.dim_hosts_cleansed'
[0m06:57:09.992989 [debug] [Thread-4  ]: Began executing node snapshot.dbtlearn.scd_raw_listings
[0m06:57:09.993209 [debug] [Thread-2  ]: Began compiling node model.dbtlearn.dim_listings_cleansed
[0m06:57:10.006039 [debug] [Thread-1  ]: Began compiling node model.dbtlearn.dim_hosts_cleansed
[0m06:57:10.024898 [debug] [Thread-4  ]: Timing info for snapshot.dbtlearn.scd_raw_listings (execute): 2023-03-07 06:57:10.024831 => 2023-03-07 06:57:10.024844
[0m06:57:10.029142 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtlearn.fct_reviews"
[0m06:57:10.039712 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtlearn.dim_listings_cleansed"
[0m06:57:10.046036 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearn.dim_hosts_cleansed"
[0m06:57:10.046720 [debug] [Thread-4  ]: Finished running node snapshot.dbtlearn.scd_raw_listings
[0m06:57:10.048182 [debug] [Thread-2  ]: Timing info for model.dbtlearn.dim_listings_cleansed (compile): 2023-03-07 06:57:10.029343 => 2023-03-07 06:57:10.048123
[0m06:57:10.048408 [debug] [Thread-1  ]: Timing info for model.dbtlearn.dim_hosts_cleansed (compile): 2023-03-07 06:57:10.039887 => 2023-03-07 06:57:10.048360
[0m06:57:10.048595 [debug] [Thread-3  ]: Timing info for model.dbtlearn.fct_reviews (compile): 2023-03-07 06:57:09.993372 => 2023-03-07 06:57:10.048561
[0m06:57:10.048797 [debug] [Thread-2  ]: Began executing node model.dbtlearn.dim_listings_cleansed
[0m06:57:10.049015 [debug] [Thread-1  ]: Began executing node model.dbtlearn.dim_hosts_cleansed
[0m06:57:10.049218 [debug] [Thread-3  ]: Began executing node model.dbtlearn.fct_reviews
[0m06:57:10.049416 [debug] [Thread-2  ]: Timing info for model.dbtlearn.dim_listings_cleansed (execute): 2023-03-07 06:57:10.049376 => 2023-03-07 06:57:10.049383
[0m06:57:10.049625 [debug] [Thread-1  ]: Timing info for model.dbtlearn.dim_hosts_cleansed (execute): 2023-03-07 06:57:10.049587 => 2023-03-07 06:57:10.049593
[0m06:57:10.049807 [debug] [Thread-3  ]: Timing info for model.dbtlearn.fct_reviews (execute): 2023-03-07 06:57:10.049773 => 2023-03-07 06:57:10.049778
[0m06:57:10.050406 [debug] [Thread-2  ]: Finished running node model.dbtlearn.dim_listings_cleansed
[0m06:57:10.050968 [debug] [Thread-1  ]: Finished running node model.dbtlearn.dim_hosts_cleansed
[0m06:57:10.051517 [debug] [Thread-3  ]: Finished running node model.dbtlearn.fct_reviews
[0m06:57:10.052349 [debug] [Thread-3  ]: Began running node test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m06:57:10.052673 [debug] [Thread-4  ]: Began running node test.dbtlearn.dim_listings_minimum_nights
[0m06:57:10.053151 [debug] [Thread-3  ]: Acquiring new snowflake connection 'test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af'
[0m06:57:10.053445 [debug] [Thread-2  ]: Began running node test.dbtlearn.no_nulls_in_dim_listings
[0m06:57:10.053907 [debug] [Thread-4  ]: Acquiring new snowflake connection 'test.dbtlearn.dim_listings_minimum_nights'
[0m06:57:10.054132 [debug] [Thread-1  ]: Began running node test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m06:57:10.054342 [debug] [Thread-3  ]: Began compiling node test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m06:57:10.054795 [debug] [Thread-2  ]: Acquiring new snowflake connection 'test.dbtlearn.no_nulls_in_dim_listings'
[0m06:57:10.055001 [debug] [Thread-4  ]: Began compiling node test.dbtlearn.dim_listings_minimum_nights
[0m06:57:10.055435 [debug] [Thread-1  ]: Acquiring new snowflake connection 'test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be'
[0m06:57:10.061822 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m06:57:10.062093 [debug] [Thread-2  ]: Began compiling node test.dbtlearn.no_nulls_in_dim_listings
[0m06:57:10.064731 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbtlearn.dim_listings_minimum_nights"
[0m06:57:10.064985 [debug] [Thread-1  ]: Began compiling node test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m06:57:10.078013 [debug] [Thread-2  ]: Using snowflake connection "test.dbtlearn.no_nulls_in_dim_listings"
[0m06:57:10.084267 [debug] [Thread-2  ]: On test.dbtlearn.no_nulls_in_dim_listings: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.no_nulls_in_dim_listings"} */
describe table airbnb.dev.dim_listings_cleansed
[0m06:57:10.084492 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m06:57:10.085376 [debug] [Thread-4  ]: Timing info for test.dbtlearn.dim_listings_minimum_nights (compile): 2023-03-07 06:57:10.062262 => 2023-03-07 06:57:10.085317
[0m06:57:10.088903 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m06:57:10.089148 [debug] [Thread-4  ]: Began executing node test.dbtlearn.dim_listings_minimum_nights
[0m06:57:10.089992 [debug] [Thread-3  ]: Timing info for test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af (compile): 2023-03-07 06:57:10.055598 => 2023-03-07 06:57:10.089944
[0m06:57:10.090245 [debug] [Thread-4  ]: Timing info for test.dbtlearn.dim_listings_minimum_nights (execute): 2023-03-07 06:57:10.090191 => 2023-03-07 06:57:10.090203
[0m06:57:10.090547 [debug] [Thread-3  ]: Began executing node test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m06:57:10.091171 [debug] [Thread-4  ]: Finished running node test.dbtlearn.dim_listings_minimum_nights
[0m06:57:10.091388 [debug] [Thread-1  ]: Timing info for test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be (compile): 2023-03-07 06:57:10.078185 => 2023-03-07 06:57:10.091340
[0m06:57:10.091758 [debug] [Thread-3  ]: Timing info for test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af (execute): 2023-03-07 06:57:10.091710 => 2023-03-07 06:57:10.091718
[0m06:57:10.092403 [debug] [Thread-4  ]: Began running node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m06:57:10.092694 [debug] [Thread-1  ]: Began executing node test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m06:57:10.093306 [debug] [Thread-3  ]: Finished running node test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m06:57:10.094099 [debug] [Thread-4  ]: Acquiring new snowflake connection 'test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9'
[0m06:57:10.094313 [debug] [Thread-1  ]: Timing info for test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be (execute): 2023-03-07 06:57:10.094268 => 2023-03-07 06:57:10.094275
[0m06:57:10.094634 [debug] [Thread-3  ]: Began running node test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m06:57:10.094917 [debug] [Thread-4  ]: Began compiling node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m06:57:10.095492 [debug] [Thread-1  ]: Finished running node test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m06:57:10.095962 [debug] [Thread-3  ]: Acquiring new snowflake connection 'test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313'
[0m06:57:10.101488 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m06:57:10.101824 [debug] [Thread-1  ]: Began running node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m06:57:10.102097 [debug] [Thread-3  ]: Began compiling node test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m06:57:10.102621 [debug] [Thread-1  ]: Acquiring new snowflake connection 'test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e'
[0m06:57:10.107322 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313"
[0m06:57:10.107592 [debug] [Thread-1  ]: Began compiling node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m06:57:10.107802 [debug] [Thread-4  ]: Timing info for test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9 (compile): 2023-03-07 06:57:10.096138 => 2023-03-07 06:57:10.107758
[0m06:57:10.114441 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m06:57:10.114745 [debug] [Thread-4  ]: Began executing node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m06:57:10.115044 [debug] [Thread-3  ]: Timing info for test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313 (compile): 2023-03-07 06:57:10.102828 => 2023-03-07 06:57:10.114990
[0m06:57:10.115293 [debug] [Thread-4  ]: Timing info for test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9 (execute): 2023-03-07 06:57:10.115238 => 2023-03-07 06:57:10.115249
[0m06:57:10.115549 [debug] [Thread-3  ]: Began executing node test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m06:57:10.115747 [debug] [Thread-1  ]: Timing info for test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e (compile): 2023-03-07 06:57:10.108023 => 2023-03-07 06:57:10.115712
[0m06:57:10.116294 [debug] [Thread-4  ]: Finished running node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m06:57:10.116512 [debug] [Thread-3  ]: Timing info for test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313 (execute): 2023-03-07 06:57:10.116468 => 2023-03-07 06:57:10.116474
[0m06:57:10.116738 [debug] [Thread-1  ]: Began executing node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m06:57:10.117022 [debug] [Thread-4  ]: Began running node model.dbtlearn.dim_listings_w_hosts
[0m06:57:10.117656 [debug] [Thread-3  ]: Finished running node test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m06:57:10.117871 [debug] [Thread-1  ]: Timing info for test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e (execute): 2023-03-07 06:57:10.117832 => 2023-03-07 06:57:10.117838
[0m06:57:10.118328 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.dbtlearn.dim_listings_w_hosts'
[0m06:57:10.118611 [debug] [Thread-3  ]: Began running node test.dbtlearn.accepted_values_dim_hosts_cleansed_is_superhost__t__f.d6051554e4
[0m06:57:10.119205 [debug] [Thread-1  ]: Finished running node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m06:57:10.119422 [debug] [Thread-4  ]: Began compiling node model.dbtlearn.dim_listings_w_hosts
[0m06:57:10.119864 [debug] [Thread-3  ]: Acquiring new snowflake connection 'test.dbtlearn.accepted_values_dim_hosts_cleansed_is_superhost__t__f.d6051554e4'
[0m06:57:10.120144 [debug] [Thread-1  ]: Began running node test.dbtlearn.not_null_dim_hosts_cleansed_host_id.de84c3da05
[0m06:57:10.123298 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtlearn.dim_listings_w_hosts"
[0m06:57:10.123551 [debug] [Thread-3  ]: Began compiling node test.dbtlearn.accepted_values_dim_hosts_cleansed_is_superhost__t__f.d6051554e4
[0m06:57:10.124129 [debug] [Thread-1  ]: Acquiring new snowflake connection 'test.dbtlearn.not_null_dim_hosts_cleansed_host_id.de84c3da05'
[0m06:57:10.128951 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbtlearn.accepted_values_dim_hosts_cleansed_is_superhost__t__f.d6051554e4"
[0m06:57:10.129220 [debug] [Thread-1  ]: Began compiling node test.dbtlearn.not_null_dim_hosts_cleansed_host_id.de84c3da05
[0m06:57:10.129530 [debug] [Thread-4  ]: Timing info for model.dbtlearn.dim_listings_w_hosts (compile): 2023-03-07 06:57:10.120344 => 2023-03-07 06:57:10.129483
[0m06:57:10.133543 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbtlearn.not_null_dim_hosts_cleansed_host_id.de84c3da05"
[0m06:57:10.133829 [debug] [Thread-4  ]: Began executing node model.dbtlearn.dim_listings_w_hosts
[0m06:57:10.134087 [debug] [Thread-3  ]: Timing info for test.dbtlearn.accepted_values_dim_hosts_cleansed_is_superhost__t__f.d6051554e4 (compile): 2023-03-07 06:57:10.124353 => 2023-03-07 06:57:10.134040
[0m06:57:10.134319 [debug] [Thread-4  ]: Timing info for model.dbtlearn.dim_listings_w_hosts (execute): 2023-03-07 06:57:10.134278 => 2023-03-07 06:57:10.134286
[0m06:57:10.134541 [debug] [Thread-3  ]: Began executing node test.dbtlearn.accepted_values_dim_hosts_cleansed_is_superhost__t__f.d6051554e4
[0m06:57:10.135149 [debug] [Thread-4  ]: Finished running node model.dbtlearn.dim_listings_w_hosts
[0m06:57:10.135374 [debug] [Thread-3  ]: Timing info for test.dbtlearn.accepted_values_dim_hosts_cleansed_is_superhost__t__f.d6051554e4 (execute): 2023-03-07 06:57:10.135327 => 2023-03-07 06:57:10.135334
[0m06:57:10.135591 [debug] [Thread-1  ]: Timing info for test.dbtlearn.not_null_dim_hosts_cleansed_host_id.de84c3da05 (compile): 2023-03-07 06:57:10.129679 => 2023-03-07 06:57:10.135549
[0m06:57:10.135854 [debug] [Thread-4  ]: Began running node test.dbtlearn.not_null_dim_hosts_cleansed_host_name.42386c5830
[0m06:57:10.136461 [debug] [Thread-3  ]: Finished running node test.dbtlearn.accepted_values_dim_hosts_cleansed_is_superhost__t__f.d6051554e4
[0m06:57:10.136673 [debug] [Thread-1  ]: Began executing node test.dbtlearn.not_null_dim_hosts_cleansed_host_id.de84c3da05
[0m06:57:10.137118 [debug] [Thread-4  ]: Acquiring new snowflake connection 'test.dbtlearn.not_null_dim_hosts_cleansed_host_name.42386c5830'
[0m06:57:10.137404 [debug] [Thread-3  ]: Began running node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m06:57:10.137652 [debug] [Thread-1  ]: Timing info for test.dbtlearn.not_null_dim_hosts_cleansed_host_id.de84c3da05 (execute): 2023-03-07 06:57:10.137607 => 2023-03-07 06:57:10.137615
[0m06:57:10.137869 [debug] [Thread-4  ]: Began compiling node test.dbtlearn.not_null_dim_hosts_cleansed_host_name.42386c5830
[0m06:57:10.138323 [debug] [Thread-3  ]: Acquiring new snowflake connection 'test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad'
[0m06:57:10.138859 [debug] [Thread-1  ]: Finished running node test.dbtlearn.not_null_dim_hosts_cleansed_host_id.de84c3da05
[0m06:57:10.143036 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbtlearn.not_null_dim_hosts_cleansed_host_name.42386c5830"
[0m06:57:10.143285 [debug] [Thread-3  ]: Began compiling node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m06:57:10.143572 [debug] [Thread-1  ]: Began running node test.dbtlearn.unique_dim_hosts_cleansed_host_id.d7e4771347
[0m06:57:10.153508 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m06:57:10.154005 [debug] [Thread-1  ]: Acquiring new snowflake connection 'test.dbtlearn.unique_dim_hosts_cleansed_host_id.d7e4771347'
[0m06:57:10.154351 [debug] [Thread-4  ]: Timing info for test.dbtlearn.not_null_dim_hosts_cleansed_host_name.42386c5830 (compile): 2023-03-07 06:57:10.139014 => 2023-03-07 06:57:10.154303
[0m06:57:10.154557 [debug] [Thread-1  ]: Began compiling node test.dbtlearn.unique_dim_hosts_cleansed_host_id.d7e4771347
[0m06:57:10.154820 [debug] [Thread-4  ]: Began executing node test.dbtlearn.not_null_dim_hosts_cleansed_host_name.42386c5830
[0m06:57:10.155041 [debug] [Thread-3  ]: Timing info for test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad (compile): 2023-03-07 06:57:10.143837 => 2023-03-07 06:57:10.154995
[0m06:57:10.158948 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbtlearn.unique_dim_hosts_cleansed_host_id.d7e4771347"
[0m06:57:10.159200 [debug] [Thread-4  ]: Timing info for test.dbtlearn.not_null_dim_hosts_cleansed_host_name.42386c5830 (execute): 2023-03-07 06:57:10.159150 => 2023-03-07 06:57:10.159160
[0m06:57:10.159434 [debug] [Thread-3  ]: Began executing node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m06:57:10.160085 [debug] [Thread-4  ]: Finished running node test.dbtlearn.not_null_dim_hosts_cleansed_host_name.42386c5830
[0m06:57:10.160334 [debug] [Thread-3  ]: Timing info for test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad (execute): 2023-03-07 06:57:10.160288 => 2023-03-07 06:57:10.160296
[0m06:57:10.160624 [debug] [Thread-4  ]: Began running node model.dbtlearn.mart_fullmoon_reviews
[0m06:57:10.160816 [debug] [Thread-1  ]: Timing info for test.dbtlearn.unique_dim_hosts_cleansed_host_id.d7e4771347 (compile): 2023-03-07 06:57:10.155187 => 2023-03-07 06:57:10.160783
[0m06:57:10.161378 [debug] [Thread-3  ]: Finished running node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m06:57:10.161819 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.dbtlearn.mart_fullmoon_reviews'
[0m06:57:10.162033 [debug] [Thread-1  ]: Began executing node test.dbtlearn.unique_dim_hosts_cleansed_host_id.d7e4771347
[0m06:57:10.162325 [debug] [Thread-3  ]: Began running node test.dbtlearn.consistent_created_at
[0m06:57:10.162587 [debug] [Thread-4  ]: Began compiling node model.dbtlearn.mart_fullmoon_reviews
[0m06:57:10.162790 [debug] [Thread-1  ]: Timing info for test.dbtlearn.unique_dim_hosts_cleansed_host_id.d7e4771347 (execute): 2023-03-07 06:57:10.162745 => 2023-03-07 06:57:10.162752
[0m06:57:10.163220 [debug] [Thread-3  ]: Acquiring new snowflake connection 'test.dbtlearn.consistent_created_at'
[0m06:57:10.166573 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtlearn.mart_fullmoon_reviews"
[0m06:57:10.167160 [debug] [Thread-1  ]: Finished running node test.dbtlearn.unique_dim_hosts_cleansed_host_id.d7e4771347
[0m06:57:10.167391 [debug] [Thread-3  ]: Began compiling node test.dbtlearn.consistent_created_at
[0m06:57:10.170553 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbtlearn.consistent_created_at"
[0m06:57:10.170908 [debug] [Thread-4  ]: Timing info for model.dbtlearn.mart_fullmoon_reviews (compile): 2023-03-07 06:57:10.163376 => 2023-03-07 06:57:10.170863
[0m06:57:10.171158 [debug] [Thread-4  ]: Began executing node model.dbtlearn.mart_fullmoon_reviews
[0m06:57:10.171362 [debug] [Thread-4  ]: Timing info for model.dbtlearn.mart_fullmoon_reviews (execute): 2023-03-07 06:57:10.171319 => 2023-03-07 06:57:10.171327
[0m06:57:10.171560 [debug] [Thread-3  ]: Timing info for test.dbtlearn.consistent_created_at (compile): 2023-03-07 06:57:10.167709 => 2023-03-07 06:57:10.171513
[0m06:57:10.172123 [debug] [Thread-4  ]: Finished running node model.dbtlearn.mart_fullmoon_reviews
[0m06:57:10.172341 [debug] [Thread-3  ]: Began executing node test.dbtlearn.consistent_created_at
[0m06:57:10.172679 [debug] [Thread-3  ]: Timing info for test.dbtlearn.consistent_created_at (execute): 2023-03-07 06:57:10.172633 => 2023-03-07 06:57:10.172640
[0m06:57:10.173294 [debug] [Thread-3  ]: Finished running node test.dbtlearn.consistent_created_at
[0m06:57:10.173609 [debug] [Thread-3  ]: Began running node analysis.dbtlearn.full_moon_no_sleep
[0m06:57:10.174063 [debug] [Thread-3  ]: Acquiring new snowflake connection 'analysis.dbtlearn.full_moon_no_sleep'
[0m06:57:10.174326 [debug] [Thread-3  ]: Began compiling node analysis.dbtlearn.full_moon_no_sleep
[0m06:57:10.177075 [debug] [Thread-3  ]: Writing injected SQL for node "analysis.dbtlearn.full_moon_no_sleep"
[0m06:57:10.177589 [debug] [Thread-3  ]: Timing info for analysis.dbtlearn.full_moon_no_sleep (compile): 2023-03-07 06:57:10.174477 => 2023-03-07 06:57:10.177546
[0m06:57:10.177810 [debug] [Thread-3  ]: Began executing node analysis.dbtlearn.full_moon_no_sleep
[0m06:57:10.178001 [debug] [Thread-3  ]: Timing info for analysis.dbtlearn.full_moon_no_sleep (execute): 2023-03-07 06:57:10.177961 => 2023-03-07 06:57:10.177968
[0m06:57:10.178540 [debug] [Thread-3  ]: Finished running node analysis.dbtlearn.full_moon_no_sleep
[0m06:57:12.246154 [debug] [Thread-2  ]: SQL status: SUCCESS 8 in 2 seconds
[0m06:57:12.252423 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbtlearn.no_nulls_in_dim_listings"
[0m06:57:12.254003 [debug] [Thread-2  ]: Timing info for test.dbtlearn.no_nulls_in_dim_listings (compile): 2023-03-07 06:57:10.065218 => 2023-03-07 06:57:12.253872
[0m06:57:12.254505 [debug] [Thread-2  ]: Began executing node test.dbtlearn.no_nulls_in_dim_listings
[0m06:57:12.254905 [debug] [Thread-2  ]: Timing info for test.dbtlearn.no_nulls_in_dim_listings (execute): 2023-03-07 06:57:12.254812 => 2023-03-07 06:57:12.254834
[0m06:57:12.255287 [debug] [Thread-2  ]: On test.dbtlearn.no_nulls_in_dim_listings: Close
[0m06:57:12.906687 [debug] [Thread-2  ]: Finished running node test.dbtlearn.no_nulls_in_dim_listings
[0m06:57:12.910108 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:57:12.910777 [debug] [MainThread]: Connection 'test.dbtlearn.unique_dim_hosts_cleansed_host_id.d7e4771347' was properly closed.
[0m06:57:12.911096 [debug] [MainThread]: Connection 'test.dbtlearn.no_nulls_in_dim_listings' was properly closed.
[0m06:57:12.911393 [debug] [MainThread]: Connection 'analysis.dbtlearn.full_moon_no_sleep' was properly closed.
[0m06:57:12.911687 [debug] [MainThread]: Connection 'model.dbtlearn.mart_fullmoon_reviews' was properly closed.
[0m06:57:12.913400 [debug] [MainThread]: Command end result
[0m06:57:12.931040 [info ] [MainThread]: Done.
[0m06:57:12.931925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1120ec040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1120dbc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0f8079fa0>]}
[0m06:57:12.932635 [debug] [MainThread]: Flushing usage events


============================== 2023-03-07 07:44:46.298583 | 337bdec6-2934-4fdf-9f2a-d9cd9b15fa3f ==============================
[0m07:44:46.298583 [info ] [MainThread]: Running with dbt=1.4.3
[0m07:44:46.300875 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/katiehuang/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m07:44:46.301231 [debug] [MainThread]: Tracking: tracking
[0m07:44:46.302049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb07907b3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb07907bf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb07907bdf0>]}
[0m07:44:46.321865 [debug] [MainThread]: checksum: c7a5cda64f02d8b9dd20ef412f82fbb79fdce1bb359c3c5dae3d080de7f31bfd, vars: {}, profile: None, target: None, version: 1.4.3
[0m07:44:46.338527 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m07:44:46.338972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '337bdec6-2934-4fdf-9f2a-d9cd9b15fa3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb078d4ac40>]}
[0m07:44:47.425742 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_w_hosts.sql
[0m07:44:47.441625 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_cleansed.sql
[0m07:44:47.447129 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_hosts_cleansed.sql
[0m07:44:47.452395 [debug] [MainThread]: 1603: static parser failed on fct/fct_reviews.sql
[0m07:44:47.476693 [debug] [MainThread]: 1602: parser fallback to jinja rendering on fct/fct_reviews.sql
[0m07:44:47.478406 [debug] [MainThread]: 1699: static parser successfully parsed mart/mart_fullmoon_reviews.sql
[0m07:44:47.483981 [debug] [MainThread]: 1699: static parser successfully parsed src/src_reviews.sql
[0m07:44:47.490090 [debug] [MainThread]: 1699: static parser successfully parsed src/src_listings.sql
[0m07:44:47.495222 [debug] [MainThread]: 1699: static parser successfully parsed src/src_hosts.sql
[0m07:44:47.715228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '337bdec6-2934-4fdf-9f2a-d9cd9b15fa3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb06a8e76a0>]}
[0m07:44:47.727166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '337bdec6-2934-4fdf-9f2a-d9cd9b15fa3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0583f3d30>]}
[0m07:44:47.727513 [info ] [MainThread]: Found 8 models, 13 tests, 1 snapshot, 1 analysis, 418 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
[0m07:44:47.727824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '337bdec6-2934-4fdf-9f2a-d9cd9b15fa3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb058500190>]}
[0m07:44:47.729959 [info ] [MainThread]: 
[0m07:44:47.731517 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m07:44:47.732668 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_airbnb'
[0m07:44:47.748368 [debug] [ThreadPool]: Using snowflake connection "list_airbnb"
[0m07:44:47.748686 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb"} */
show terse schemas in database airbnb
    limit 10000
[0m07:44:47.748909 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:44:50.564665 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 3 seconds
[0m07:44:50.571275 [debug] [ThreadPool]: On list_airbnb: Close
[0m07:44:51.251853 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_airbnb_dev'
[0m07:44:51.263379 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m07:44:51.263785 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m07:44:51.264120 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:44:55.284568 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 4 seconds
[0m07:44:55.289494 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m07:44:55.934256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '337bdec6-2934-4fdf-9f2a-d9cd9b15fa3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb06a8e7280>]}
[0m07:44:55.936382 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:44:55.937641 [info ] [MainThread]: 
[0m07:44:55.945375 [debug] [Thread-1  ]: Began running node model.dbtlearn.src_hosts
[0m07:44:55.945973 [debug] [Thread-2  ]: Began running node model.dbtlearn.src_listings
[0m07:44:55.946938 [debug] [Thread-3  ]: Began running node model.dbtlearn.src_reviews
[0m07:44:55.948640 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtlearn.src_hosts'
[0m07:44:55.950687 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtlearn.src_listings'
[0m07:44:55.953411 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtlearn.src_reviews'
[0m07:44:55.955047 [debug] [Thread-1  ]: Began compiling node model.dbtlearn.src_hosts
[0m07:44:55.955773 [debug] [Thread-2  ]: Began compiling node model.dbtlearn.src_listings
[0m07:44:55.956224 [debug] [Thread-3  ]: Began compiling node model.dbtlearn.src_reviews
[0m07:44:55.965891 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearn.src_hosts"
[0m07:44:56.058215 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtlearn.src_listings"
[0m07:44:56.061584 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtlearn.src_reviews"
[0m07:44:56.063082 [debug] [Thread-1  ]: Timing info for model.dbtlearn.src_hosts (compile): 2023-03-07 07:44:55.956615 => 2023-03-07 07:44:56.062988
[0m07:44:56.063361 [debug] [Thread-2  ]: Timing info for model.dbtlearn.src_listings (compile): 2023-03-07 07:44:55.966228 => 2023-03-07 07:44:56.063309
[0m07:44:56.065119 [debug] [Thread-1  ]: Finished running node model.dbtlearn.src_hosts
[0m07:44:56.065407 [debug] [Thread-3  ]: Timing info for model.dbtlearn.src_reviews (compile): 2023-03-07 07:44:56.058495 => 2023-03-07 07:44:56.065350
[0m07:44:56.066553 [debug] [Thread-2  ]: Finished running node model.dbtlearn.src_listings
[0m07:44:56.067938 [debug] [Thread-3  ]: Finished running node model.dbtlearn.src_reviews
[0m07:44:56.068494 [debug] [Thread-4  ]: Began running node model.dbtlearn.dim_hosts_cleansed
[0m07:44:56.069898 [debug] [Thread-1  ]: Began running node model.dbtlearn.dim_listings_cleansed
[0m07:44:56.069428 [info ] [Thread-4  ]: 1 of 5 START sql view model dev.dim_hosts_cleansed ............................. [RUN]
[0m07:44:56.070363 [debug] [Thread-2  ]: Began running node model.dbtlearn.fct_reviews
[0m07:44:56.070662 [info ] [Thread-1  ]: 2 of 5 START sql view model dev.dim_listings_cleansed .......................... [RUN]
[0m07:44:56.071460 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.dbtlearn.dim_hosts_cleansed'
[0m07:44:56.071794 [info ] [Thread-2  ]: 3 of 5 START sql incremental model dev.fct_reviews ............................. [RUN]
[0m07:44:56.072572 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtlearn.dim_listings_cleansed'
[0m07:44:56.072836 [debug] [Thread-4  ]: Began compiling node model.dbtlearn.dim_hosts_cleansed
[0m07:44:56.074245 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtlearn.fct_reviews'
[0m07:44:56.074558 [debug] [Thread-1  ]: Began compiling node model.dbtlearn.dim_listings_cleansed
[0m07:44:56.082651 [debug] [Thread-2  ]: Began compiling node model.dbtlearn.fct_reviews
[0m07:44:56.090848 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtlearn.dim_hosts_cleansed"
[0m07:44:56.127840 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearn.dim_listings_cleansed"
[0m07:44:56.141972 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtlearn.fct_reviews"
[0m07:44:56.143413 [debug] [Thread-1  ]: Timing info for model.dbtlearn.dim_listings_cleansed (compile): 2023-03-07 07:44:56.091253 => 2023-03-07 07:44:56.143249
[0m07:44:56.143905 [debug] [Thread-1  ]: Began executing node model.dbtlearn.dim_listings_cleansed
[0m07:44:56.149739 [debug] [Thread-4  ]: Timing info for model.dbtlearn.dim_hosts_cleansed (compile): 2023-03-07 07:44:56.074755 => 2023-03-07 07:44:56.149467
[0m07:44:56.150963 [debug] [Thread-2  ]: Timing info for model.dbtlearn.fct_reviews (compile): 2023-03-07 07:44:56.104163 => 2023-03-07 07:44:56.150791
[0m07:44:56.163557 [debug] [Thread-4  ]: Began executing node model.dbtlearn.dim_hosts_cleansed
[0m07:44:56.185923 [debug] [Thread-2  ]: Began executing node model.dbtlearn.fct_reviews
[0m07:44:56.201435 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtlearn.dim_listings_cleansed"
[0m07:44:56.205585 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbtlearn.dim_hosts_cleansed"
[0m07:44:56.255283 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m07:44:56.257086 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.dim_listings_cleansed"
[0m07:44:56.257355 [debug] [Thread-2  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
create or replace  temporary view airbnb.dev.fct_reviews__dbt_tmp
  
   as (
    -- Doc | Config : https://docs.getdbt.com/reference/dbt-jinja-functions/config


-- dbt materializes the model as an incremental table. 
-- Read for difference btw table vs. incremental: https://docs.getdbt.com/docs/build/materializations

WITH  __dbt__cte__src_reviews as (
WITH raw_reviews AS (
	SELECT * FROM airbnb.raw.raw_reviews
)

SELECT
    listing_id,
    date AS review_date,
    reviewer_name,
    comments AS review_text,
    sentiment AS review_sentiment
FROM raw_reviews
),src_reviews AS (
    SELECT * FROM __dbt__cte__src_reviews
)

SELECT 
    -- Create a unique review_id based on the following columns
    
    
md5(cast(coalesce(cast(listing_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(review_date as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(reviewer_name as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(review_text as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as review_id,
    listing_id,
    review_date,
    NVL(reviewer_name, 'Anonymous') AS reviewer_name,
    review_text,
    review_sentiment
FROM src_reviews
WHERE review_text IS NOT NULL


  and review_date > (select max(review_date) from airbnb.dev.fct_reviews)

  );
[0m07:44:56.257615 [debug] [Thread-1  ]: On model.dbtlearn.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_cleansed"} */
create or replace   view airbnb.dev.dim_listings_cleansed
  
   as (
    


WITH  __dbt__cte__src_listings as (
WITH raw_listings AS (
	SELECT * FROM airbnb.raw.raw_listings
)

SELECT 
	id AS listing_id,
    name AS listing_name,
    listing_url,
    room_type,
    minimum_nights,
    host_id,
    price AS price_str,
    created_at,
    updated_at
FROM 
	raw_listings
),src_listings AS (
    SELECT * FROM __dbt__cte__src_listings
)

SELECT
    listing_id,
    listing_name,
    room_type,
    CASE 
        WHEN minimum_nights = 0 THEN 1 -- 0 night = 1 night, so we assign the value of 1 to indicate 1 night
        ELSE minimum_nights
    END AS minimum_nights,
    host_id,
    REPLACE( -- Parse string value into numerical form
        price_str, '$' -- Replace '$' with price_str value. In other words, to remove '$' from string.
        ) :: NUMBER (10, 2 -- Convert string type to numerical with 2 decimal places
    ) AS price,
    created_at,
    updated_at
    
FROM src_listings
  );
[0m07:44:56.258763 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearn.dim_hosts_cleansed"
[0m07:44:56.259029 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m07:44:56.259265 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:44:56.259464 [debug] [Thread-4  ]: On model.dbtlearn.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_hosts_cleansed"} */
create or replace   view airbnb.dev.dim_hosts_cleansed
  
   as (
    

WITH  __dbt__cte__src_hosts as (
WITH raw_hosts AS (
	SELECT * FROM airbnb.raw.raw_hosts
)

SELECT
    id AS host_id,
    name AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM raw_hosts
),src_hosts AS (
    SELECT * FROM __dbt__cte__src_hosts
)

SELECT 
    host_id,
    NVL(host_name, 'Anonymous') AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM src_hosts
  );
[0m07:44:56.261454 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m07:44:58.998599 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 3 seconds
[0m07:44:59.028012 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m07:44:59.028547 [debug] [Thread-2  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
describe table airbnb.dev.fct_reviews__dbt_tmp
[0m07:44:59.097270 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 3 seconds
[0m07:44:59.123556 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 3 seconds
[0m07:44:59.150470 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.dim_listings_cleansed"
[0m07:44:59.150797 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearn.dim_hosts_cleansed"
[0m07:44:59.151046 [debug] [Thread-1  ]: On model.dbtlearn.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_cleansed"} */
GRANT SELECT ON airbnb.dev.dim_listings_cleansed TO ROLE REPORTER
[0m07:44:59.151271 [debug] [Thread-4  ]: On model.dbtlearn.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_hosts_cleansed"} */
GRANT SELECT ON airbnb.dev.dim_hosts_cleansed TO ROLE REPORTER
[0m07:44:59.368748 [debug] [Thread-2  ]: SQL status: SUCCESS 6 in 0 seconds
[0m07:44:59.383907 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m07:44:59.384992 [debug] [Thread-2  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
describe table airbnb.dev.fct_reviews
[0m07:44:59.476400 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0 seconds
[0m07:44:59.501985 [debug] [Thread-4  ]: Timing info for model.dbtlearn.dim_hosts_cleansed (execute): 2023-03-07 07:44:56.201895 => 2023-03-07 07:44:59.501741
[0m07:44:59.502943 [debug] [Thread-4  ]: On model.dbtlearn.dim_hosts_cleansed: Close
[0m07:44:59.509265 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0 seconds
[0m07:44:59.512233 [debug] [Thread-1  ]: Timing info for model.dbtlearn.dim_listings_cleansed (execute): 2023-03-07 07:44:56.144268 => 2023-03-07 07:44:59.512141
[0m07:44:59.513036 [debug] [Thread-1  ]: On model.dbtlearn.dim_listings_cleansed: Close
[0m07:44:59.722851 [debug] [Thread-2  ]: SQL status: SUCCESS 6 in 0 seconds
[0m07:44:59.767335 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m07:44:59.768062 [debug] [Thread-2  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
describe table airbnb.dev.fct_reviews__dbt_tmp
[0m07:45:00.124352 [debug] [Thread-2  ]: SQL status: SUCCESS 6 in 0 seconds
[0m07:45:00.133811 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '337bdec6-2934-4fdf-9f2a-d9cd9b15fa3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb018094220>]}
[0m07:45:00.140161 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m07:45:00.144195 [debug] [Thread-2  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
describe table "AIRBNB"."DEV"."FCT_REVIEWS"
[0m07:45:00.143620 [info ] [Thread-1  ]: 2 of 5 OK created sql view model dev.dim_listings_cleansed ..................... [[32mSUCCESS 1[0m in 4.06s]
[0m07:45:00.146405 [debug] [Thread-1  ]: Finished running node model.dbtlearn.dim_listings_cleansed
[0m07:45:00.149174 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '337bdec6-2934-4fdf-9f2a-d9cd9b15fa3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb05841e4f0>]}
[0m07:45:00.150275 [info ] [Thread-4  ]: 1 of 5 OK created sql view model dev.dim_hosts_cleansed ........................ [[32mSUCCESS 1[0m in 4.08s]
[0m07:45:00.151165 [debug] [Thread-4  ]: Finished running node model.dbtlearn.dim_hosts_cleansed
[0m07:45:00.152410 [debug] [Thread-3  ]: Began running node model.dbtlearn.dim_listings_w_hosts
[0m07:45:00.153019 [info ] [Thread-3  ]: 4 of 5 START sql table model dev.dim_listings_w_hosts .......................... [RUN]
[0m07:45:00.154569 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtlearn.dim_listings_w_hosts'
[0m07:45:00.155293 [debug] [Thread-3  ]: Began compiling node model.dbtlearn.dim_listings_w_hosts
[0m07:45:00.161528 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtlearn.dim_listings_w_hosts"
[0m07:45:00.163753 [debug] [Thread-3  ]: Timing info for model.dbtlearn.dim_listings_w_hosts (compile): 2023-03-07 07:45:00.155670 => 2023-03-07 07:45:00.163664
[0m07:45:00.164135 [debug] [Thread-3  ]: Began executing node model.dbtlearn.dim_listings_w_hosts
[0m07:45:00.193723 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbtlearn.dim_listings_w_hosts"
[0m07:45:00.195848 [debug] [Thread-3  ]: Using snowflake connection "model.dbtlearn.dim_listings_w_hosts"
[0m07:45:00.196055 [debug] [Thread-3  ]: On model.dbtlearn.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_w_hosts"} */
create or replace transient table airbnb.dev.dim_listings_w_hosts  as
        (WITH 
listings AS (
    SELECT * FROM airbnb.dev.dim_listings_cleansed
),
hosts AS (
    SELECT * FROM airbnb.dev.dim_hosts_cleansed
)

SELECT 
    listings.listing_id,
    listings.listing_name,
    listings.room_type,
    listings.minimum_nights,
    listings.price,
    listings.host_id,
    hosts.host_name,
    hosts.is_superhost AS host_is_superhost,
    listings.created_at,
    GREATEST(listings.updated_at, hosts.updated_at) AS updated_at -- Keep most recent updated_at
FROM listings
LEFT JOIN hosts
    ON listings.host_id = hosts.host_id
        );
[0m07:45:00.196238 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m07:45:00.482095 [debug] [Thread-2  ]: SQL status: SUCCESS 6 in 0 seconds
[0m07:45:00.504710 [debug] [Thread-2  ]: 
    In "AIRBNB"."DEV"."FCT_REVIEWS":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m07:45:00.528850 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbtlearn.fct_reviews"
[0m07:45:00.530496 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m07:45:00.530705 [debug] [Thread-2  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
-- back compat for old kwarg name
  
  begin;
[0m07:45:00.879292 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0 seconds
[0m07:45:00.880536 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m07:45:00.881083 [debug] [Thread-2  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
insert into airbnb.dev.fct_reviews ("REVIEW_ID", "LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT")
        (
            select "REVIEW_ID", "LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT"
            from airbnb.dev.fct_reviews__dbt_tmp
        );
[0m07:45:03.346224 [debug] [Thread-2  ]: SQL status: SUCCESS 0 in 2 seconds
[0m07:45:03.348229 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m07:45:03.349323 [debug] [Thread-2  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
COMMIT
[0m07:45:03.777325 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 4 seconds
[0m07:45:03.787047 [debug] [Thread-3  ]: Using snowflake connection "model.dbtlearn.dim_listings_w_hosts"
[0m07:45:03.788130 [debug] [Thread-3  ]: On model.dbtlearn.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_w_hosts"} */
GRANT SELECT ON airbnb.dev.dim_listings_w_hosts TO ROLE REPORTER
[0m07:45:03.806414 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0 seconds
[0m07:45:03.831816 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m07:45:03.832416 [debug] [Thread-2  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
drop view if exists airbnb.dev.fct_reviews__dbt_tmp cascade
[0m07:45:04.169372 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0 seconds
[0m07:45:04.194126 [debug] [Thread-3  ]: Timing info for model.dbtlearn.dim_listings_w_hosts (execute): 2023-03-07 07:45:00.164376 => 2023-03-07 07:45:04.193903
[0m07:45:04.195190 [debug] [Thread-3  ]: On model.dbtlearn.dim_listings_w_hosts: Close
[0m07:45:04.841539 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '337bdec6-2934-4fdf-9f2a-d9cd9b15fa3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb06a87f6a0>]}
[0m07:45:04.843668 [info ] [Thread-3  ]: 4 of 5 OK created sql table model dev.dim_listings_w_hosts ..................... [[32mSUCCESS 1[0m in 4.69s]
[0m07:45:04.845119 [debug] [Thread-3  ]: Finished running node model.dbtlearn.dim_listings_w_hosts
[0m07:45:04.868396 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1 seconds
[0m07:45:04.877573 [debug] [Thread-2  ]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m07:45:04.878304 [debug] [Thread-2  ]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
GRANT SELECT ON airbnb.dev.fct_reviews TO ROLE REPORTER
[0m07:45:05.220507 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0 seconds
[0m07:45:05.229584 [debug] [Thread-2  ]: Timing info for model.dbtlearn.fct_reviews (execute): 2023-03-07 07:44:56.205875 => 2023-03-07 07:45:05.229317
[0m07:45:05.230532 [debug] [Thread-2  ]: On model.dbtlearn.fct_reviews: Close
[0m07:45:05.870395 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '337bdec6-2934-4fdf-9f2a-d9cd9b15fa3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb06a899b80>]}
[0m07:45:05.872062 [info ] [Thread-2  ]: 3 of 5 OK created sql incremental model dev.fct_reviews ........................ [[32mSUCCESS 0[0m in 9.80s]
[0m07:45:05.873175 [debug] [Thread-2  ]: Finished running node model.dbtlearn.fct_reviews
[0m07:45:05.875018 [debug] [Thread-4  ]: Began running node model.dbtlearn.mart_fullmoon_reviews
[0m07:45:05.875730 [info ] [Thread-4  ]: 5 of 5 START sql table model dev.mart_fullmoon_reviews ......................... [RUN]
[0m07:45:05.876974 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.dbtlearn.mart_fullmoon_reviews'
[0m07:45:05.877410 [debug] [Thread-4  ]: Began compiling node model.dbtlearn.mart_fullmoon_reviews
[0m07:45:05.884367 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtlearn.mart_fullmoon_reviews"
[0m07:45:05.885223 [debug] [Thread-4  ]: Timing info for model.dbtlearn.mart_fullmoon_reviews (compile): 2023-03-07 07:45:05.877703 => 2023-03-07 07:45:05.885141
[0m07:45:05.885582 [debug] [Thread-4  ]: Began executing node model.dbtlearn.mart_fullmoon_reviews
[0m07:45:05.889950 [debug] [Thread-4  ]: Writing runtime sql for node "model.dbtlearn.mart_fullmoon_reviews"
[0m07:45:05.892041 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearn.mart_fullmoon_reviews"
[0m07:45:05.892339 [debug] [Thread-4  ]: On model.dbtlearn.mart_fullmoon_reviews: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.mart_fullmoon_reviews"} */
create or replace transient table airbnb.dev.mart_fullmoon_reviews  as
        (

WITH fct_reviews AS (

    SELECT * FROM airbnb.dev.fct_reviews

),
full_moon_dates AS (

    SELECT * FROM airbnb.dev.seed_full_moon_dates
)

SELECT
    reviews.*,
    CASE
        WHEN fullmoon.full_moon_date IS NULL THEN 'not full moon'
        ELSE 'full moon' END AS is_full_moon
FROM fct_reviews AS reviews
LEFT JOIN full_moon_dates AS fullmoon
    ON (TO_DATE(reviews.review_date) = DATEADD(DAY, 1, fullmoon.full_moon_date))
        );
[0m07:45:05.892611 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m07:45:11.853203 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 6 seconds
[0m07:45:11.860545 [debug] [Thread-4  ]: Using snowflake connection "model.dbtlearn.mart_fullmoon_reviews"
[0m07:45:11.861062 [debug] [Thread-4  ]: On model.dbtlearn.mart_fullmoon_reviews: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.mart_fullmoon_reviews"} */
GRANT SELECT ON airbnb.dev.mart_fullmoon_reviews TO ROLE REPORTER
[0m07:45:12.242799 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0 seconds
[0m07:45:12.249830 [debug] [Thread-4  ]: Timing info for model.dbtlearn.mart_fullmoon_reviews (execute): 2023-03-07 07:45:05.885817 => 2023-03-07 07:45:12.249597
[0m07:45:12.250579 [debug] [Thread-4  ]: On model.dbtlearn.mart_fullmoon_reviews: Close
[0m07:45:12.954242 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '337bdec6-2934-4fdf-9f2a-d9cd9b15fa3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb058417190>]}
[0m07:45:12.955320 [info ] [Thread-4  ]: 5 of 5 OK created sql table model dev.mart_fullmoon_reviews .................... [[32mSUCCESS 1[0m in 7.08s]
[0m07:45:12.956349 [debug] [Thread-4  ]: Finished running node model.dbtlearn.mart_fullmoon_reviews
[0m07:45:12.959400 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m07:45:12.960428 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:45:12.960787 [debug] [MainThread]: Connection 'model.dbtlearn.dim_listings_cleansed' was properly closed.
[0m07:45:12.961088 [debug] [MainThread]: Connection 'model.dbtlearn.fct_reviews' was properly closed.
[0m07:45:12.961378 [debug] [MainThread]: Connection 'model.dbtlearn.dim_listings_w_hosts' was properly closed.
[0m07:45:12.961650 [debug] [MainThread]: Connection 'model.dbtlearn.mart_fullmoon_reviews' was properly closed.
[0m07:45:12.962216 [info ] [MainThread]: 
[0m07:45:12.962927 [info ] [MainThread]: Finished running 2 view models, 2 table models, 1 incremental model in 0 hours 0 minutes and 25.23 seconds (25.23s).
[0m07:45:12.964075 [debug] [MainThread]: Command end result
[0m07:45:12.981599 [info ] [MainThread]: 
[0m07:45:12.982239 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:45:12.982672 [info ] [MainThread]: 
[0m07:45:12.983087 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m07:45:12.983613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb058345bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb058345a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb058345be0>]}
[0m07:45:12.983989 [debug] [MainThread]: Flushing usage events


============================== 2023-03-07 08:48:58.011704 | f2eff333-376f-422d-a466-4a383e9fb3f0 ==============================
[0m08:48:58.011704 [info ] [MainThread]: Running with dbt=1.4.3
[0m08:48:58.014322 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/katiehuang/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'compile': True, 'which': 'generate', 'rpc_method': 'docs.generate', 'indirect_selection': 'eager'}
[0m08:48:58.015160 [debug] [MainThread]: Tracking: tracking
[0m08:48:58.015845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae094d33d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae094d3f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae094d3e20>]}
[0m08:48:58.035622 [debug] [MainThread]: checksum: c7a5cda64f02d8b9dd20ef412f82fbb79fdce1bb359c3c5dae3d080de7f31bfd, vars: {}, profile: None, target: None, version: 1.4.3
[0m08:48:58.106480 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m08:48:58.107115 [debug] [MainThread]: Partial parsing: added file: dbtlearn://models/dashboard.yml
[0m08:48:58.118589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae1a4fffd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae1a5f4c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae1a5fda60>]}
[0m08:48:58.118929 [debug] [MainThread]: Flushing usage events
[0m08:48:59.438784 [error] [MainThread]: Encountered an error:
Parsing Error
  Invalid exposures config given in FilePath(searched_path='models', relative_path='dashboard.yml', modification_time=1678178929.8309548, project_root='/Users/katiehuang/Documents/Data Science/Courses/Udemy dbt Airbnb Project/dbtlearn') @ exposures: {'name': 'Executive Dashboard', 'type': 'dashboard', 'maturity': 'low', 'url': 'https://7e942fbd.us2a.app.preset.io:443/r/2', 'description': 'Executive Dashboard about Airbnb listings and hosts', 'depends_on': ["ref('dim_listings_w_hosts')", "ref('mart_fullmoon_reviews')"], 'owner': {'name': 'Katie Huang', 'email': None}} - at path ['owner']['email']: None is not of type 'string'


============================== 2023-03-07 08:55:02.444470 | f154e3a2-cc49-45ce-affe-fa7b412907db ==============================
[0m08:55:02.444470 [info ] [MainThread]: Running with dbt=1.4.3
[0m08:55:02.446919 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/katiehuang/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'compile': True, 'which': 'generate', 'rpc_method': 'docs.generate', 'indirect_selection': 'eager'}
[0m08:55:02.447245 [debug] [MainThread]: Tracking: tracking
[0m08:55:02.447990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe369693310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe369693dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe369693c70>]}
[0m08:55:02.469359 [debug] [MainThread]: checksum: c7a5cda64f02d8b9dd20ef412f82fbb79fdce1bb359c3c5dae3d080de7f31bfd, vars: {}, profile: None, target: None, version: 1.4.3
[0m08:55:02.538899 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m08:55:02.539482 [debug] [MainThread]: Partial parsing: added file: dbtlearn://models/dashboard.yml
[0m08:55:02.551761 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Starting in v1.3, the 'name' of an exposure should contain only letters,
numbers, and underscores. Exposures support a new property, 'label', which may
contain spaces, capital letters, and special characters. Executive Dashboard
does not follow this pattern. Please update the 'name', and use the 'label'
property for a human-friendly title. This will raise an error in a future
version of dbt-core.
[0m08:55:02.552143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'f154e3a2-cc49-45ce-affe-fa7b412907db', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe39a426a30>]}
[0m08:55:02.570735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f154e3a2-cc49-45ce-affe-fa7b412907db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe39a413190>]}
[0m08:55:02.583286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f154e3a2-cc49-45ce-affe-fa7b412907db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe39a3e4df0>]}
[0m08:55:02.583657 [info ] [MainThread]: Found 8 models, 13 tests, 1 snapshot, 1 analysis, 418 macros, 0 operations, 1 seed file, 3 sources, 1 exposure, 0 metrics
[0m08:55:02.583979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f154e3a2-cc49-45ce-affe-fa7b412907db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe39a3e4e80>]}
[0m08:55:02.586321 [info ] [MainThread]: 
[0m08:55:02.588017 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:55:02.589446 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_airbnb_dev'
[0m08:55:02.605223 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m08:55:02.605511 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m08:55:02.605741 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:55:05.381972 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 3 seconds
[0m08:55:05.392157 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m08:55:06.027991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f154e3a2-cc49-45ce-affe-fa7b412907db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe39a3e4580>]}
[0m08:55:06.029256 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:55:06.029845 [info ] [MainThread]: 
[0m08:55:06.036819 [debug] [Thread-1  ]: Began running node model.dbtlearn.src_hosts
[0m08:55:06.037335 [debug] [Thread-2  ]: Began running node model.dbtlearn.src_listings
[0m08:55:06.038147 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbtlearn.src_hosts'
[0m08:55:06.038536 [debug] [Thread-3  ]: Began running node model.dbtlearn.src_reviews
[0m08:55:06.038932 [debug] [Thread-4  ]: Began running node seed.dbtlearn.seed_full_moon_dates
[0m08:55:06.039636 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtlearn.src_listings'
[0m08:55:06.040008 [debug] [Thread-1  ]: Began compiling node model.dbtlearn.src_hosts
[0m08:55:06.040743 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtlearn.src_reviews'
[0m08:55:06.041455 [debug] [Thread-4  ]: Acquiring new snowflake connection 'seed.dbtlearn.seed_full_moon_dates'
[0m08:55:06.041787 [debug] [Thread-2  ]: Began compiling node model.dbtlearn.src_listings
[0m08:55:06.046836 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearn.src_hosts"
[0m08:55:06.047187 [debug] [Thread-3  ]: Began compiling node model.dbtlearn.src_reviews
[0m08:55:06.047462 [debug] [Thread-4  ]: Began compiling node seed.dbtlearn.seed_full_moon_dates
[0m08:55:06.051068 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtlearn.src_listings"
[0m08:55:06.055055 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtlearn.src_reviews"
[0m08:55:06.057517 [debug] [Thread-4  ]: Timing info for seed.dbtlearn.seed_full_moon_dates (compile): 2023-03-07 08:55:06.055492 => 2023-03-07 08:55:06.057422
[0m08:55:06.058021 [debug] [Thread-1  ]: Timing info for model.dbtlearn.src_hosts (compile): 2023-03-07 08:55:06.042060 => 2023-03-07 08:55:06.057958
[0m08:55:06.058311 [debug] [Thread-4  ]: Began executing node seed.dbtlearn.seed_full_moon_dates
[0m08:55:06.060196 [debug] [Thread-1  ]: Finished running node model.dbtlearn.src_hosts
[0m08:55:06.060506 [debug] [Thread-4  ]: Timing info for seed.dbtlearn.seed_full_moon_dates (execute): 2023-03-07 08:55:06.060453 => 2023-03-07 08:55:06.060462
[0m08:55:06.060742 [debug] [Thread-2  ]: Timing info for model.dbtlearn.src_listings (compile): 2023-03-07 08:55:06.047657 => 2023-03-07 08:55:06.060703
[0m08:55:06.060937 [debug] [Thread-3  ]: Timing info for model.dbtlearn.src_reviews (compile): 2023-03-07 08:55:06.051424 => 2023-03-07 08:55:06.060886
[0m08:55:06.061375 [debug] [Thread-1  ]: Began running node snapshot.dbtlearn.scd_raw_listings
[0m08:55:06.062113 [debug] [Thread-4  ]: Finished running node seed.dbtlearn.seed_full_moon_dates
[0m08:55:06.062843 [debug] [Thread-2  ]: Finished running node model.dbtlearn.src_listings
[0m08:55:06.063452 [debug] [Thread-3  ]: Finished running node model.dbtlearn.src_reviews
[0m08:55:06.063975 [debug] [Thread-1  ]: Acquiring new snowflake connection 'snapshot.dbtlearn.scd_raw_listings'
[0m08:55:06.064287 [debug] [Thread-4  ]: Began running node model.dbtlearn.dim_hosts_cleansed
[0m08:55:06.064961 [debug] [Thread-1  ]: Began compiling node snapshot.dbtlearn.scd_raw_listings
[0m08:55:06.065299 [debug] [Thread-2  ]: Began running node model.dbtlearn.dim_listings_cleansed
[0m08:55:06.065602 [debug] [Thread-3  ]: Began running node model.dbtlearn.fct_reviews
[0m08:55:06.066105 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.dbtlearn.dim_hosts_cleansed'
[0m08:55:06.069818 [debug] [Thread-1  ]: Timing info for snapshot.dbtlearn.scd_raw_listings (compile): 2023-03-07 08:55:06.066268 => 2023-03-07 08:55:06.069769
[0m08:55:06.070308 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbtlearn.dim_listings_cleansed'
[0m08:55:06.070753 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtlearn.fct_reviews'
[0m08:55:06.070972 [debug] [Thread-4  ]: Began compiling node model.dbtlearn.dim_hosts_cleansed
[0m08:55:06.071200 [debug] [Thread-1  ]: Began executing node snapshot.dbtlearn.scd_raw_listings
[0m08:55:06.071415 [debug] [Thread-2  ]: Began compiling node model.dbtlearn.dim_listings_cleansed
[0m08:55:06.071613 [debug] [Thread-3  ]: Began compiling node model.dbtlearn.fct_reviews
[0m08:55:06.078126 [debug] [Thread-1  ]: Timing info for snapshot.dbtlearn.scd_raw_listings (execute): 2023-03-07 08:55:06.078075 => 2023-03-07 08:55:06.078084
[0m08:55:06.086547 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtlearn.dim_hosts_cleansed"
[0m08:55:06.096574 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtlearn.dim_listings_cleansed"
[0m08:55:06.109758 [debug] [Thread-1  ]: Finished running node snapshot.dbtlearn.scd_raw_listings
[0m08:55:06.131945 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtlearn.fct_reviews"
[0m08:55:06.133378 [debug] [Thread-4  ]: Timing info for model.dbtlearn.dim_hosts_cleansed (compile): 2023-03-07 08:55:06.071763 => 2023-03-07 08:55:06.133318
[0m08:55:06.133614 [debug] [Thread-2  ]: Timing info for model.dbtlearn.dim_listings_cleansed (compile): 2023-03-07 08:55:06.086769 => 2023-03-07 08:55:06.133565
[0m08:55:06.133853 [debug] [Thread-4  ]: Began executing node model.dbtlearn.dim_hosts_cleansed
[0m08:55:06.134075 [debug] [Thread-3  ]: Timing info for model.dbtlearn.fct_reviews (compile): 2023-03-07 08:55:06.096746 => 2023-03-07 08:55:06.134033
[0m08:55:06.134277 [debug] [Thread-2  ]: Began executing node model.dbtlearn.dim_listings_cleansed
[0m08:55:06.134482 [debug] [Thread-4  ]: Timing info for model.dbtlearn.dim_hosts_cleansed (execute): 2023-03-07 08:55:06.134440 => 2023-03-07 08:55:06.134448
[0m08:55:06.134699 [debug] [Thread-3  ]: Began executing node model.dbtlearn.fct_reviews
[0m08:55:06.134888 [debug] [Thread-2  ]: Timing info for model.dbtlearn.dim_listings_cleansed (execute): 2023-03-07 08:55:06.134851 => 2023-03-07 08:55:06.134856
[0m08:55:06.135452 [debug] [Thread-4  ]: Finished running node model.dbtlearn.dim_hosts_cleansed
[0m08:55:06.135657 [debug] [Thread-3  ]: Timing info for model.dbtlearn.fct_reviews (execute): 2023-03-07 08:55:06.135617 => 2023-03-07 08:55:06.135623
[0m08:55:06.136185 [debug] [Thread-2  ]: Finished running node model.dbtlearn.dim_listings_cleansed
[0m08:55:06.136912 [debug] [Thread-3  ]: Finished running node model.dbtlearn.fct_reviews
[0m08:55:06.137628 [debug] [Thread-3  ]: Began running node test.dbtlearn.accepted_values_dim_hosts_cleansed_is_superhost__t__f.d6051554e4
[0m08:55:06.137936 [debug] [Thread-1  ]: Began running node test.dbtlearn.not_null_dim_hosts_cleansed_host_id.de84c3da05
[0m08:55:06.138373 [debug] [Thread-3  ]: Acquiring new snowflake connection 'test.dbtlearn.accepted_values_dim_hosts_cleansed_is_superhost__t__f.d6051554e4'
[0m08:55:06.138660 [debug] [Thread-4  ]: Began running node test.dbtlearn.not_null_dim_hosts_cleansed_host_name.42386c5830
[0m08:55:06.139094 [debug] [Thread-1  ]: Acquiring new snowflake connection 'test.dbtlearn.not_null_dim_hosts_cleansed_host_id.de84c3da05'
[0m08:55:06.139316 [debug] [Thread-2  ]: Began running node test.dbtlearn.unique_dim_hosts_cleansed_host_id.d7e4771347
[0m08:55:06.139529 [debug] [Thread-3  ]: Began compiling node test.dbtlearn.accepted_values_dim_hosts_cleansed_is_superhost__t__f.d6051554e4
[0m08:55:06.139949 [debug] [Thread-4  ]: Acquiring new snowflake connection 'test.dbtlearn.not_null_dim_hosts_cleansed_host_name.42386c5830'
[0m08:55:06.140154 [debug] [Thread-1  ]: Began compiling node test.dbtlearn.not_null_dim_hosts_cleansed_host_id.de84c3da05
[0m08:55:06.140880 [debug] [Thread-2  ]: Acquiring new snowflake connection 'test.dbtlearn.unique_dim_hosts_cleansed_host_id.d7e4771347'
[0m08:55:06.153853 [debug] [Thread-4  ]: Began compiling node test.dbtlearn.not_null_dim_hosts_cleansed_host_name.42386c5830
[0m08:55:06.154188 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbtlearn.accepted_values_dim_hosts_cleansed_is_superhost__t__f.d6051554e4"
[0m08:55:06.159949 [debug] [Thread-2  ]: Began compiling node test.dbtlearn.unique_dim_hosts_cleansed_host_id.d7e4771347
[0m08:55:06.163359 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbtlearn.not_null_dim_hosts_cleansed_host_id.de84c3da05"
[0m08:55:06.167282 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbtlearn.not_null_dim_hosts_cleansed_host_name.42386c5830"
[0m08:55:06.175510 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbtlearn.unique_dim_hosts_cleansed_host_id.d7e4771347"
[0m08:55:06.175950 [debug] [Thread-3  ]: Timing info for test.dbtlearn.accepted_values_dim_hosts_cleansed_is_superhost__t__f.d6051554e4 (compile): 2023-03-07 08:55:06.141048 => 2023-03-07 08:55:06.175888
[0m08:55:06.176236 [debug] [Thread-3  ]: Began executing node test.dbtlearn.accepted_values_dim_hosts_cleansed_is_superhost__t__f.d6051554e4
[0m08:55:06.176452 [debug] [Thread-3  ]: Timing info for test.dbtlearn.accepted_values_dim_hosts_cleansed_is_superhost__t__f.d6051554e4 (execute): 2023-03-07 08:55:06.176408 => 2023-03-07 08:55:06.176416
[0m08:55:06.177038 [debug] [Thread-3  ]: Finished running node test.dbtlearn.accepted_values_dim_hosts_cleansed_is_superhost__t__f.d6051554e4
[0m08:55:06.177412 [debug] [Thread-3  ]: Began running node model.dbtlearn.dim_listings_w_hosts
[0m08:55:06.177891 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.dbtlearn.dim_listings_w_hosts'
[0m08:55:06.178149 [debug] [Thread-1  ]: Timing info for test.dbtlearn.not_null_dim_hosts_cleansed_host_id.de84c3da05 (compile): 2023-03-07 08:55:06.154372 => 2023-03-07 08:55:06.178109
[0m08:55:06.178392 [debug] [Thread-3  ]: Began compiling node model.dbtlearn.dim_listings_w_hosts
[0m08:55:06.178661 [debug] [Thread-1  ]: Began executing node test.dbtlearn.not_null_dim_hosts_cleansed_host_id.de84c3da05
[0m08:55:06.178842 [debug] [Thread-4  ]: Timing info for test.dbtlearn.not_null_dim_hosts_cleansed_host_name.42386c5830 (compile): 2023-03-07 08:55:06.163553 => 2023-03-07 08:55:06.178801
[0m08:55:06.179048 [debug] [Thread-2  ]: Timing info for test.dbtlearn.unique_dim_hosts_cleansed_host_id.d7e4771347 (compile): 2023-03-07 08:55:06.167557 => 2023-03-07 08:55:06.179016
[0m08:55:06.182025 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtlearn.dim_listings_w_hosts"
[0m08:55:06.182278 [debug] [Thread-1  ]: Timing info for test.dbtlearn.not_null_dim_hosts_cleansed_host_id.de84c3da05 (execute): 2023-03-07 08:55:06.182228 => 2023-03-07 08:55:06.182237
[0m08:55:06.182526 [debug] [Thread-4  ]: Began executing node test.dbtlearn.not_null_dim_hosts_cleansed_host_name.42386c5830
[0m08:55:06.182758 [debug] [Thread-2  ]: Began executing node test.dbtlearn.unique_dim_hosts_cleansed_host_id.d7e4771347
[0m08:55:06.183367 [debug] [Thread-1  ]: Finished running node test.dbtlearn.not_null_dim_hosts_cleansed_host_id.de84c3da05
[0m08:55:06.183591 [debug] [Thread-4  ]: Timing info for test.dbtlearn.not_null_dim_hosts_cleansed_host_name.42386c5830 (execute): 2023-03-07 08:55:06.183552 => 2023-03-07 08:55:06.183558
[0m08:55:06.183807 [debug] [Thread-2  ]: Timing info for test.dbtlearn.unique_dim_hosts_cleansed_host_id.d7e4771347 (execute): 2023-03-07 08:55:06.183769 => 2023-03-07 08:55:06.183774
[0m08:55:06.183999 [debug] [Thread-3  ]: Timing info for model.dbtlearn.dim_listings_w_hosts (compile): 2023-03-07 08:55:06.179178 => 2023-03-07 08:55:06.183960
[0m08:55:06.184257 [debug] [Thread-1  ]: Began running node test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m08:55:06.184840 [debug] [Thread-4  ]: Finished running node test.dbtlearn.not_null_dim_hosts_cleansed_host_name.42386c5830
[0m08:55:06.185365 [debug] [Thread-2  ]: Finished running node test.dbtlearn.unique_dim_hosts_cleansed_host_id.d7e4771347
[0m08:55:06.185580 [debug] [Thread-3  ]: Began executing node model.dbtlearn.dim_listings_w_hosts
[0m08:55:06.186042 [debug] [Thread-1  ]: Acquiring new snowflake connection 'test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af'
[0m08:55:06.186344 [debug] [Thread-4  ]: Began running node test.dbtlearn.dim_listings_minimum_nights
[0m08:55:06.186667 [debug] [Thread-2  ]: Began running node test.dbtlearn.no_nulls_in_dim_listings
[0m08:55:06.186919 [debug] [Thread-3  ]: Timing info for model.dbtlearn.dim_listings_w_hosts (execute): 2023-03-07 08:55:06.186874 => 2023-03-07 08:55:06.186881
[0m08:55:06.187128 [debug] [Thread-1  ]: Began compiling node test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m08:55:06.187569 [debug] [Thread-4  ]: Acquiring new snowflake connection 'test.dbtlearn.dim_listings_minimum_nights'
[0m08:55:06.188000 [debug] [Thread-2  ]: Acquiring new snowflake connection 'test.dbtlearn.no_nulls_in_dim_listings'
[0m08:55:06.188522 [debug] [Thread-3  ]: Finished running node model.dbtlearn.dim_listings_w_hosts
[0m08:55:06.194792 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m08:55:06.195073 [debug] [Thread-4  ]: Began compiling node test.dbtlearn.dim_listings_minimum_nights
[0m08:55:06.195290 [debug] [Thread-2  ]: Began compiling node test.dbtlearn.no_nulls_in_dim_listings
[0m08:55:06.195569 [debug] [Thread-3  ]: Began running node test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m08:55:06.198294 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbtlearn.dim_listings_minimum_nights"
[0m08:55:06.211436 [debug] [Thread-2  ]: Using snowflake connection "test.dbtlearn.no_nulls_in_dim_listings"
[0m08:55:06.211633 [debug] [Thread-1  ]: Timing info for test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af (compile): 2023-03-07 08:55:06.188681 => 2023-03-07 08:55:06.211589
[0m08:55:06.212115 [debug] [Thread-3  ]: Acquiring new snowflake connection 'test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be'
[0m08:55:06.212391 [debug] [Thread-2  ]: On test.dbtlearn.no_nulls_in_dim_listings: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.no_nulls_in_dim_listings"} */
describe table airbnb.dev.dim_listings_cleansed
[0m08:55:06.212623 [debug] [Thread-1  ]: Began executing node test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m08:55:06.212862 [debug] [Thread-3  ]: Began compiling node test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m08:55:06.213061 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m08:55:06.213254 [debug] [Thread-4  ]: Timing info for test.dbtlearn.dim_listings_minimum_nights (compile): 2023-03-07 08:55:06.195837 => 2023-03-07 08:55:06.213218
[0m08:55:06.213430 [debug] [Thread-1  ]: Timing info for test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af (execute): 2023-03-07 08:55:06.213386 => 2023-03-07 08:55:06.213395
[0m08:55:06.217502 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m08:55:06.218037 [debug] [Thread-4  ]: Began executing node test.dbtlearn.dim_listings_minimum_nights
[0m08:55:06.219007 [debug] [Thread-1  ]: Finished running node test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m08:55:06.219809 [debug] [Thread-4  ]: Timing info for test.dbtlearn.dim_listings_minimum_nights (execute): 2023-03-07 08:55:06.219763 => 2023-03-07 08:55:06.219770
[0m08:55:06.220173 [debug] [Thread-1  ]: Began running node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m08:55:06.220824 [debug] [Thread-4  ]: Finished running node test.dbtlearn.dim_listings_minimum_nights
[0m08:55:06.221498 [debug] [Thread-1  ]: Acquiring new snowflake connection 'test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9'
[0m08:55:06.222033 [debug] [Thread-3  ]: Timing info for test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be (compile): 2023-03-07 08:55:06.213584 => 2023-03-07 08:55:06.221991
[0m08:55:06.222304 [debug] [Thread-4  ]: Began running node test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m08:55:06.222918 [debug] [Thread-1  ]: Began compiling node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m08:55:06.223146 [debug] [Thread-3  ]: Began executing node test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m08:55:06.223601 [debug] [Thread-4  ]: Acquiring new snowflake connection 'test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313'
[0m08:55:06.228836 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m08:55:06.229116 [debug] [Thread-3  ]: Timing info for test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be (execute): 2023-03-07 08:55:06.229063 => 2023-03-07 08:55:06.229072
[0m08:55:06.229353 [debug] [Thread-4  ]: Began compiling node test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m08:55:06.229962 [debug] [Thread-3  ]: Finished running node test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m08:55:06.234735 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313"
[0m08:55:06.235088 [debug] [Thread-3  ]: Began running node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m08:55:06.235342 [debug] [Thread-1  ]: Timing info for test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9 (compile): 2023-03-07 08:55:06.223801 => 2023-03-07 08:55:06.235301
[0m08:55:06.235861 [debug] [Thread-3  ]: Acquiring new snowflake connection 'test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad'
[0m08:55:06.236113 [debug] [Thread-1  ]: Began executing node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m08:55:06.236322 [debug] [Thread-3  ]: Began compiling node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m08:55:06.236511 [debug] [Thread-1  ]: Timing info for test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9 (execute): 2023-03-07 08:55:06.236469 => 2023-03-07 08:55:06.236476
[0m08:55:06.245204 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m08:55:06.245865 [debug] [Thread-1  ]: Finished running node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m08:55:06.246076 [debug] [Thread-4  ]: Timing info for test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313 (compile): 2023-03-07 08:55:06.230166 => 2023-03-07 08:55:06.246030
[0m08:55:06.246432 [debug] [Thread-1  ]: Began running node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m08:55:06.246733 [debug] [Thread-4  ]: Began executing node test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m08:55:06.247195 [debug] [Thread-1  ]: Acquiring new snowflake connection 'test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e'
[0m08:55:06.247385 [debug] [Thread-3  ]: Timing info for test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad (compile): 2023-03-07 08:55:06.236655 => 2023-03-07 08:55:06.247343
[0m08:55:06.247585 [debug] [Thread-4  ]: Timing info for test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313 (execute): 2023-03-07 08:55:06.247544 => 2023-03-07 08:55:06.247551
[0m08:55:06.247811 [debug] [Thread-1  ]: Began compiling node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m08:55:06.248024 [debug] [Thread-3  ]: Began executing node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m08:55:06.248574 [debug] [Thread-4  ]: Finished running node test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m08:55:06.252492 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m08:55:06.252743 [debug] [Thread-3  ]: Timing info for test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad (execute): 2023-03-07 08:55:06.252695 => 2023-03-07 08:55:06.252702
[0m08:55:06.253036 [debug] [Thread-4  ]: Began running node model.dbtlearn.mart_fullmoon_reviews
[0m08:55:06.253689 [debug] [Thread-3  ]: Finished running node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m08:55:06.254167 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.dbtlearn.mart_fullmoon_reviews'
[0m08:55:06.254467 [debug] [Thread-3  ]: Began running node test.dbtlearn.consistent_created_at
[0m08:55:06.254678 [debug] [Thread-1  ]: Timing info for test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e (compile): 2023-03-07 08:55:06.248735 => 2023-03-07 08:55:06.254641
[0m08:55:06.254905 [debug] [Thread-4  ]: Began compiling node model.dbtlearn.mart_fullmoon_reviews
[0m08:55:06.255362 [debug] [Thread-3  ]: Acquiring new snowflake connection 'test.dbtlearn.consistent_created_at'
[0m08:55:06.255596 [debug] [Thread-1  ]: Began executing node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m08:55:06.258956 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtlearn.mart_fullmoon_reviews"
[0m08:55:06.259209 [debug] [Thread-3  ]: Began compiling node test.dbtlearn.consistent_created_at
[0m08:55:06.259428 [debug] [Thread-1  ]: Timing info for test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e (execute): 2023-03-07 08:55:06.259378 => 2023-03-07 08:55:06.259385
[0m08:55:06.262317 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbtlearn.consistent_created_at"
[0m08:55:06.262915 [debug] [Thread-1  ]: Finished running node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m08:55:06.263175 [debug] [Thread-4  ]: Timing info for model.dbtlearn.mart_fullmoon_reviews (compile): 2023-03-07 08:55:06.255759 => 2023-03-07 08:55:06.263137
[0m08:55:06.263510 [debug] [Thread-4  ]: Began executing node model.dbtlearn.mart_fullmoon_reviews
[0m08:55:06.263729 [debug] [Thread-4  ]: Timing info for model.dbtlearn.mart_fullmoon_reviews (execute): 2023-03-07 08:55:06.263680 => 2023-03-07 08:55:06.263688
[0m08:55:06.264300 [debug] [Thread-4  ]: Finished running node model.dbtlearn.mart_fullmoon_reviews
[0m08:55:06.264495 [debug] [Thread-3  ]: Timing info for test.dbtlearn.consistent_created_at (compile): 2023-03-07 08:55:06.259646 => 2023-03-07 08:55:06.264459
[0m08:55:06.264808 [debug] [Thread-3  ]: Began executing node test.dbtlearn.consistent_created_at
[0m08:55:06.265066 [debug] [Thread-3  ]: Timing info for test.dbtlearn.consistent_created_at (execute): 2023-03-07 08:55:06.265026 => 2023-03-07 08:55:06.265033
[0m08:55:06.265329 [debug] [Thread-1  ]: Began running node analysis.dbtlearn.full_moon_no_sleep
[0m08:55:06.265859 [debug] [Thread-3  ]: Finished running node test.dbtlearn.consistent_created_at
[0m08:55:06.266309 [debug] [Thread-1  ]: Acquiring new snowflake connection 'analysis.dbtlearn.full_moon_no_sleep'
[0m08:55:06.266637 [debug] [Thread-1  ]: Began compiling node analysis.dbtlearn.full_moon_no_sleep
[0m08:55:06.269540 [debug] [Thread-1  ]: Writing injected SQL for node "analysis.dbtlearn.full_moon_no_sleep"
[0m08:55:06.270008 [debug] [Thread-1  ]: Timing info for analysis.dbtlearn.full_moon_no_sleep (compile): 2023-03-07 08:55:06.266792 => 2023-03-07 08:55:06.269963
[0m08:55:06.270226 [debug] [Thread-1  ]: Began executing node analysis.dbtlearn.full_moon_no_sleep
[0m08:55:06.270410 [debug] [Thread-1  ]: Timing info for analysis.dbtlearn.full_moon_no_sleep (execute): 2023-03-07 08:55:06.270371 => 2023-03-07 08:55:06.270378
[0m08:55:06.270951 [debug] [Thread-1  ]: Finished running node analysis.dbtlearn.full_moon_no_sleep
[0m08:55:08.220293 [debug] [Thread-2  ]: SQL status: SUCCESS 8 in 2 seconds
[0m08:55:08.227408 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbtlearn.no_nulls_in_dim_listings"
[0m08:55:08.229244 [debug] [Thread-2  ]: Timing info for test.dbtlearn.no_nulls_in_dim_listings (compile): 2023-03-07 08:55:06.198512 => 2023-03-07 08:55:08.229132
[0m08:55:08.229703 [debug] [Thread-2  ]: Began executing node test.dbtlearn.no_nulls_in_dim_listings
[0m08:55:08.230079 [debug] [Thread-2  ]: Timing info for test.dbtlearn.no_nulls_in_dim_listings (execute): 2023-03-07 08:55:08.229994 => 2023-03-07 08:55:08.230013
[0m08:55:08.230436 [debug] [Thread-2  ]: On test.dbtlearn.no_nulls_in_dim_listings: Close
[0m08:55:08.907661 [debug] [Thread-2  ]: Finished running node test.dbtlearn.no_nulls_in_dim_listings
[0m08:55:08.911189 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:55:08.911571 [debug] [MainThread]: Connection 'analysis.dbtlearn.full_moon_no_sleep' was properly closed.
[0m08:55:08.911875 [debug] [MainThread]: Connection 'test.dbtlearn.no_nulls_in_dim_listings' was properly closed.
[0m08:55:08.912162 [debug] [MainThread]: Connection 'test.dbtlearn.consistent_created_at' was properly closed.
[0m08:55:08.912443 [debug] [MainThread]: Connection 'model.dbtlearn.mart_fullmoon_reviews' was properly closed.
[0m08:55:08.914428 [debug] [MainThread]: Command end result
[0m08:55:08.931317 [info ] [MainThread]: Done.
[0m08:55:08.940390 [debug] [MainThread]: Acquiring new snowflake connection 'generate_catalog'
[0m08:55:08.940700 [info ] [MainThread]: Building catalog
[0m08:55:08.943301 [debug] [ThreadPool]: Acquiring new snowflake connection 'airbnb.information_schema'
[0m08:55:08.952962 [debug] [ThreadPool]: Using snowflake connection "airbnb.information_schema"
[0m08:55:08.953235 [debug] [ThreadPool]: On airbnb.information_schema: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "airbnb.information_schema"} */
with tables as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",
              table_type as "table_type",
              comment as "table_comment",

              -- note: this is the _role_ that owns the table
              table_owner as "table_owner",

              'Clustering Key' as "stats:clustering_key:label",
              clustering_key as "stats:clustering_key:value",
              'The key used to cluster this table' as "stats:clustering_key:description",
              (clustering_key is not null) as "stats:clustering_key:include",

              'Row Count' as "stats:row_count:label",
              row_count as "stats:row_count:value",
              'An approximate count of rows in this table' as "stats:row_count:description",
              (row_count is not null) as "stats:row_count:include",

              'Approximate Size' as "stats:bytes:label",
              bytes as "stats:bytes:value",
              'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
              (bytes is not null) as "stats:bytes:include",

              'Last Modified' as "stats:last_modified:label",
              to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
              'The timestamp for last update/change' as "stats:last_modified:description",
              (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"

          from airbnb.INFORMATION_SCHEMA.tables

      ),

      columns as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",

              column_name as "column_name",
              ordinal_position as "column_index",
              data_type as "column_type",
              comment as "column_comment"

          from airbnb.INFORMATION_SCHEMA.columns
      )

      select *
      from tables
      join columns using ("table_database", "table_schema", "table_name")
      where (upper("table_schema") = upper('dev') or upper("table_schema") = upper('raw'))
      order by "column_index"
[0m08:55:08.953441 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:55:13.202033 [debug] [ThreadPool]: SQL status: SUCCESS 69 in 4 seconds
[0m08:55:13.242443 [debug] [ThreadPool]: On airbnb.information_schema: Close
[0m08:55:14.004542 [info ] [MainThread]: Catalog written to /Users/katiehuang/Documents/Data Science/Courses/Udemy dbt Airbnb Project/dbtlearn/target/catalog.json
[0m08:55:14.005319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe369693310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe39a78e1f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3697d1d90>]}
[0m08:55:14.005767 [debug] [MainThread]: Flushing usage events
[0m08:55:15.358402 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m08:55:15.360373 [debug] [MainThread]: Connection 'airbnb.information_schema' was properly closed.


============================== 2023-03-07 08:55:30.276606 | 717a7179-13e0-4159-8918-ef11e5e4fc8b ==============================
[0m08:55:30.276606 [info ] [MainThread]: Running with dbt=1.4.3
[0m08:55:30.278999 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/katiehuang/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'port': 8080, 'open_browser': True, 'which': 'serve', 'indirect_selection': 'eager'}
[0m08:55:30.279293 [debug] [MainThread]: Tracking: tracking
[0m08:55:30.280104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcea1704af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcea17048b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcea1704dc0>]}
[0m08:55:30.284648 [info ] [MainThread]: Serving docs at 0.0.0.0:8080
[0m08:55:30.285016 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8080
[0m08:55:30.285294 [info ] [MainThread]: 
[0m08:55:30.285551 [info ] [MainThread]: 
[0m08:55:30.285795 [info ] [MainThread]: Press Ctrl+C to exit.
[0m09:12:48.565569 [debug] [MainThread]: Flushing usage events
[0m09:12:49.886959 [info ] [MainThread]: ctrl-c


============================== 2023-03-07 09:13:00.021338 | c78f12d2-3b4f-4193-aada-e72a3c70cd97 ==============================
[0m09:13:00.021338 [info ] [MainThread]: Running with dbt=1.4.3
[0m09:13:00.022919 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/katiehuang/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'deps', 'rpc_method': 'deps', 'indirect_selection': 'eager'}
[0m09:13:00.023198 [debug] [MainThread]: Tracking: tracking
[0m09:13:00.060692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3e9a92c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3e9af54f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3e9af55e0>]}
[0m09:13:00.063631 [debug] [MainThread]: Set downloads directory='/var/folders/q3/w322smt942d2fh0zxg4b_rfc0000gn/T/dbt-downloads-x0q_uupw'
[0m09:13:00.064508 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m09:13:00.228038 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m09:13:00.228749 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json
[0m09:13:00.325284 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json 200
[0m09:13:00.332307 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json
[0m09:13:00.436388 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json 200
[0m09:13:00.452462 [info ] [MainThread]: Installing calogica/dbt_expectations
[0m09:13:01.146742 [info ] [MainThread]:   Installed from version 0.8.2
[0m09:13:01.147186 [info ] [MainThread]:   Up to date!
[0m09:13:01.147678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'c78f12d2-3b4f-4193-aada-e72a3c70cd97', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3e9a98160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3e9af5610>]}
[0m09:13:01.148013 [info ] [MainThread]: Installing calogica/dbt_date
[0m09:13:01.546880 [info ] [MainThread]:   Installed from version 0.7.2
[0m09:13:01.547413 [info ] [MainThread]:   Up to date!
[0m09:13:01.547842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'c78f12d2-3b4f-4193-aada-e72a3c70cd97', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3e9b25e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3e9b25460>]}
[0m09:13:01.549160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3e9ab1040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3e9a98340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3e9a92c10>]}
[0m09:13:01.549528 [debug] [MainThread]: Flushing usage events


============================== 2023-03-08 02:14:08.092549 | 91430cb1-5ffc-48c2-abd4-4a6f69ec3154 ==============================
[0m02:14:08.092549 [info ] [MainThread]: Running with dbt=1.4.3
[0m02:14:08.094787 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/katiehuang/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'select': ['dim_listings_w_hosts'], 'which': 'test', 'rpc_method': 'test'}
[0m02:14:08.095110 [debug] [MainThread]: Tracking: tracking
[0m02:14:08.095568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ad13569d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ad1356d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ad1356c10>]}
[0m02:14:08.132774 [debug] [MainThread]: checksum: c7a5cda64f02d8b9dd20ef412f82fbb79fdce1bb359c3c5dae3d080de7f31bfd, vars: {}, profile: None, target: None, version: 1.4.3
[0m02:14:08.149292 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m02:14:08.149713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '91430cb1-5ffc-48c2-abd4-4a6f69ec3154', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ad1387430>]}
[0m02:14:09.773709 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_w_hosts.sql
[0m02:14:09.789696 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_cleansed.sql
[0m02:14:09.795580 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_hosts_cleansed.sql
[0m02:14:09.802135 [debug] [MainThread]: 1603: static parser failed on fct/fct_reviews.sql
[0m02:14:09.826282 [debug] [MainThread]: 1602: parser fallback to jinja rendering on fct/fct_reviews.sql
[0m02:14:09.827920 [debug] [MainThread]: 1699: static parser successfully parsed mart/mart_fullmoon_reviews.sql
[0m02:14:09.833825 [debug] [MainThread]: 1699: static parser successfully parsed src/src_reviews.sql
[0m02:14:09.839375 [debug] [MainThread]: 1699: static parser successfully parsed src/src_listings.sql
[0m02:14:09.845771 [debug] [MainThread]: 1699: static parser successfully parsed src/src_hosts.sql
[0m02:14:10.082601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ad1659d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ad1664460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ad1664dc0>]}
[0m02:14:10.082987 [debug] [MainThread]: Flushing usage events
[0m02:14:11.437567 [error] [MainThread]: Encountered an error:
Parsing Error
  Invalid test config given in models/schema.yml:
  	test definition dictionary must have exactly one key, got [('dbt_expectations.expect_table_row_count_to_equal_other_table', None), ('compare_model', "source('airbnb', 'listings')")] instead (2 keys)
  	@: UnparsedNodeUpdate(original_file_path='model...ne)


============================== 2023-03-08 02:15:31.372786 | 1f8e50b3-470c-4f17-bac3-e0927c4d070b ==============================
[0m02:15:31.372786 [info ] [MainThread]: Running with dbt=1.4.3
[0m02:15:31.375001 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/katiehuang/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'select': ['dim_listings_w_hosts'], 'which': 'test', 'rpc_method': 'test'}
[0m02:15:31.375247 [debug] [MainThread]: Tracking: tracking
[0m02:15:31.375847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feee14ac370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feee14acdc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feee14acc10>]}
[0m02:15:31.411733 [debug] [MainThread]: checksum: c7a5cda64f02d8b9dd20ef412f82fbb79fdce1bb359c3c5dae3d080de7f31bfd, vars: {}, profile: None, target: None, version: 1.4.3
[0m02:15:31.428559 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m02:15:31.428957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '1f8e50b3-470c-4f17-bac3-e0927c4d070b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feee14dfee0>]}
[0m02:15:33.042875 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_w_hosts.sql
[0m02:15:33.059164 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_cleansed.sql
[0m02:15:33.064931 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_hosts_cleansed.sql
[0m02:15:33.071699 [debug] [MainThread]: 1603: static parser failed on fct/fct_reviews.sql
[0m02:15:33.096090 [debug] [MainThread]: 1602: parser fallback to jinja rendering on fct/fct_reviews.sql
[0m02:15:33.097729 [debug] [MainThread]: 1699: static parser successfully parsed mart/mart_fullmoon_reviews.sql
[0m02:15:33.103832 [debug] [MainThread]: 1699: static parser successfully parsed src/src_reviews.sql
[0m02:15:33.109509 [debug] [MainThread]: 1699: static parser successfully parsed src/src_listings.sql
[0m02:15:33.116072 [debug] [MainThread]: 1699: static parser successfully parsed src/src_hosts.sql
[0m02:15:33.383798 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Starting in v1.3, the 'name' of an exposure should contain only letters,
numbers, and underscores. Exposures support a new property, 'label', which may
contain spaces, capital letters, and special characters. Executive Dashboard
does not follow this pattern. Please update the 'name', and use the 'label'
property for a human-friendly title. This will raise an error in a future
version of dbt-core.
[0m02:15:33.384238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '1f8e50b3-470c-4f17-bac3-e0927c4d070b', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feec0229220>]}
[0m02:15:33.457568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1f8e50b3-470c-4f17-bac3-e0927c4d070b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feec00bf490>]}
[0m02:15:33.473839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1f8e50b3-470c-4f17-bac3-e0927c4d070b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feec00bf490>]}
[0m02:15:33.474205 [info ] [MainThread]: Found 8 models, 14 tests, 1 snapshot, 1 analysis, 640 macros, 0 operations, 1 seed file, 3 sources, 1 exposure, 0 metrics
[0m02:15:33.474522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1f8e50b3-470c-4f17-bac3-e0927c4d070b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feec01e1550>]}
[0m02:15:33.476112 [info ] [MainThread]: 
[0m02:15:33.477602 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m02:15:33.478965 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_airbnb_dev'
[0m02:15:33.495131 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m02:15:33.495458 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m02:15:33.495683 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:15:39.944271 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 6 seconds
[0m02:15:39.950876 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m02:15:40.597924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1f8e50b3-470c-4f17-bac3-e0927c4d070b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feec00bf880>]}
[0m02:15:40.599440 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m02:15:40.600030 [info ] [MainThread]: 
[0m02:15:40.607166 [debug] [Thread-1  ]: Began running node test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da
[0m02:15:40.607633 [info ] [Thread-1  ]: 1 of 1 START test dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_  [RUN]
[0m02:15:40.608643 [debug] [Thread-1  ]: Acquiring new snowflake connection 'test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da'
[0m02:15:40.608983 [debug] [Thread-1  ]: Began compiling node test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da
[0m02:15:40.618892 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da"
[0m02:15:40.620217 [debug] [Thread-1  ]: Timing info for test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da (compile): 2023-03-08 02:15:40.609227 => 2023-03-08 02:15:40.620125
[0m02:15:40.620537 [debug] [Thread-1  ]: Began executing node test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da
[0m02:15:40.647722 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da"
[0m02:15:40.649874 [debug] [Thread-1  ]: Using snowflake connection "test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da"
[0m02:15:40.650077 [debug] [Thread-1  ]: On test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    with a as (
        
    select
        
        count(*) as expression
    from
        airbnb.dev.dim_listings_w_hosts
    

    ),
    b as (
        
    select
        
        count(*) * 1 as expression
    from
        airbnb.raw.raw_listings
    

    ),
    final as (

        select
            
            a.expression,
            b.expression as compare_expression,
            abs(coalesce(a.expression, 0) - coalesce(b.expression, 0)) as expression_difference,
            abs(coalesce(a.expression, 0) - coalesce(b.expression, 0))/
                nullif(a.expression * 1.0, 0) as expression_difference_percent
        from
        
            a cross join b
        
    )
    -- DEBUG:
    -- select * from final
    select
        *
    from final
    where
        
        expression_difference > 0.0
        

      
    ) dbt_internal_test
[0m02:15:40.650260 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:15:44.581199 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 4 seconds
[0m02:15:44.608130 [debug] [Thread-1  ]: Timing info for test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da (execute): 2023-03-08 02:15:40.620748 => 2023-03-08 02:15:44.608018
[0m02:15:44.608568 [debug] [Thread-1  ]: On test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da: Close
[0m02:15:45.260959 [info ] [Thread-1  ]: 1 of 1 PASS dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_  [[32mPASS[0m in 4.65s]
[0m02:15:45.263780 [debug] [Thread-1  ]: Finished running node test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da
[0m02:15:45.268091 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m02:15:45.268927 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:15:45.269219 [debug] [MainThread]: Connection 'test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da' was properly closed.
[0m02:15:45.269543 [info ] [MainThread]: 
[0m02:15:45.269996 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 11.79 seconds (11.79s).
[0m02:15:45.270555 [debug] [MainThread]: Command end result
[0m02:15:45.290851 [info ] [MainThread]: 
[0m02:15:45.291323 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:15:45.291653 [info ] [MainThread]: 
[0m02:15:45.291959 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m02:15:45.292341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feec00f2070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feee14e8190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feee14ed6d0>]}
[0m02:15:45.292632 [debug] [MainThread]: Flushing usage events


============================== 2023-03-08 02:20:17.379573 | 113c10b6-21b6-4614-989f-71030e0736b5 ==============================
[0m02:20:17.379573 [info ] [MainThread]: Running with dbt=1.4.3
[0m02:20:17.381746 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/katiehuang/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'select': ['dim_listings_w_hosts'], 'which': 'test', 'rpc_method': 'test'}
[0m02:20:17.382040 [debug] [MainThread]: Tracking: tracking
[0m02:20:17.382654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cc0ecc9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cc0eccd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cc0eccc10>]}
[0m02:20:17.418955 [debug] [MainThread]: checksum: c7a5cda64f02d8b9dd20ef412f82fbb79fdce1bb359c3c5dae3d080de7f31bfd, vars: {}, profile: None, target: None, version: 1.4.3
[0m02:20:17.531558 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:20:17.532569 [debug] [MainThread]: Partial parsing: updated file: dbtlearn://models/schema.yml
[0m02:20:17.557054 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_w_hosts.sql
[0m02:20:17.710647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '113c10b6-21b6-4614-989f-71030e0736b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cc115da60>]}
[0m02:20:17.726680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '113c10b6-21b6-4614-989f-71030e0736b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cc0f8af70>]}
[0m02:20:17.727066 [info ] [MainThread]: Found 8 models, 15 tests, 1 snapshot, 1 analysis, 640 macros, 0 operations, 1 seed file, 3 sources, 1 exposure, 0 metrics
[0m02:20:17.727379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '113c10b6-21b6-4614-989f-71030e0736b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cc0f8afa0>]}
[0m02:20:17.729046 [info ] [MainThread]: 
[0m02:20:17.730524 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m02:20:17.731905 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_airbnb_dev'
[0m02:20:17.747363 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m02:20:17.747642 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m02:20:17.747855 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:20:20.690088 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 3 seconds
[0m02:20:20.698141 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m02:20:21.383916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '113c10b6-21b6-4614-989f-71030e0736b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ce2a30430>]}
[0m02:20:21.386961 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m02:20:21.387945 [info ] [MainThread]: 
[0m02:20:21.399781 [debug] [Thread-1  ]: Began running node test.dbtlearn.dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__100__50__0_99.a11eee28e0
[0m02:20:21.400745 [debug] [Thread-2  ]: Began running node test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da
[0m02:20:21.401388 [info ] [Thread-1  ]: 1 of 2 START test dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__100__50__0_99  [RUN]
[0m02:20:21.402340 [info ] [Thread-2  ]: 2 of 2 START test dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_  [RUN]
[0m02:20:21.403757 [debug] [Thread-1  ]: Acquiring new snowflake connection 'test.dbtlearn.dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__100__50__0_99.a11eee28e0'
[0m02:20:21.404694 [debug] [Thread-2  ]: Acquiring new snowflake connection 'test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da'
[0m02:20:21.405141 [debug] [Thread-1  ]: Began compiling node test.dbtlearn.dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__100__50__0_99.a11eee28e0
[0m02:20:21.405588 [debug] [Thread-2  ]: Began compiling node test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da
[0m02:20:21.415335 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbtlearn.dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__100__50__0_99.a11eee28e0"
[0m02:20:21.424767 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da"
[0m02:20:21.425716 [debug] [Thread-2  ]: Timing info for test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da (compile): 2023-03-08 02:20:21.415788 => 2023-03-08 02:20:21.425615
[0m02:20:21.426039 [debug] [Thread-2  ]: Began executing node test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da
[0m02:20:21.438936 [debug] [Thread-1  ]: Timing info for test.dbtlearn.dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__100__50__0_99.a11eee28e0 (compile): 2023-03-08 02:20:21.405893 => 2023-03-08 02:20:21.438878
[0m02:20:21.452657 [debug] [Thread-2  ]: Writing runtime sql for node "test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da"
[0m02:20:21.452904 [debug] [Thread-1  ]: Began executing node test.dbtlearn.dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__100__50__0_99.a11eee28e0
[0m02:20:21.456106 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbtlearn.dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__100__50__0_99.a11eee28e0"
[0m02:20:21.457911 [debug] [Thread-2  ]: Using snowflake connection "test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da"
[0m02:20:21.458120 [debug] [Thread-2  ]: On test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    with a as (
        
    select
        
        count(*) as expression
    from
        airbnb.dev.dim_listings_w_hosts
    

    ),
    b as (
        
    select
        
        count(*) * 1 as expression
    from
        airbnb.raw.raw_listings
    

    ),
    final as (

        select
            
            a.expression,
            b.expression as compare_expression,
            abs(coalesce(a.expression, 0) - coalesce(b.expression, 0)) as expression_difference,
            abs(coalesce(a.expression, 0) - coalesce(b.expression, 0))/
                nullif(a.expression * 1.0, 0) as expression_difference_percent
        from
        
            a cross join b
        
    )
    -- DEBUG:
    -- select * from final
    select
        *
    from final
    where
        
        expression_difference > 0.0
        

      
    ) dbt_internal_test
[0m02:20:21.458330 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m02:20:21.459736 [debug] [Thread-1  ]: Using snowflake connection "test.dbtlearn.dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__100__50__0_99.a11eee28e0"
[0m02:20:21.459937 [debug] [Thread-1  ]: On test.dbtlearn.dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__100__50__0_99.a11eee28e0: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__100__50__0_99.a11eee28e0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      





    with grouped_expression as (
    select
        
        
    
  
( 1=1 and percentile_cont(0.99) within group (order by price) >= 50 and percentile_cont(0.99) within group (order by price) <= 100
)
 as expression


    from airbnb.dev.dim_listings_w_hosts
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors






      
    ) dbt_internal_test
[0m02:20:21.460435 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:20:24.090889 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 3 seconds
[0m02:20:24.120810 [debug] [Thread-1  ]: Timing info for test.dbtlearn.dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__100__50__0_99.a11eee28e0 (execute): 2023-03-08 02:20:21.453189 => 2023-03-08 02:20:24.120653
[0m02:20:24.121410 [debug] [Thread-1  ]: On test.dbtlearn.dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__100__50__0_99.a11eee28e0: Close
[0m02:20:24.143939 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 3 seconds
[0m02:20:24.147619 [debug] [Thread-2  ]: Timing info for test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da (execute): 2023-03-08 02:20:21.426259 => 2023-03-08 02:20:24.147496
[0m02:20:24.148111 [debug] [Thread-2  ]: On test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da: Close
[0m02:20:25.204017 [info ] [Thread-2  ]: 2 of 2 PASS dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_  [[32mPASS[0m in 3.80s]
[0m02:20:25.210294 [debug] [Thread-2  ]: Finished running node test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da
[0m02:20:25.316322 [error] [Thread-1  ]: 1 of 2 FAIL 1 dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__100__50__0_99  [[31mFAIL 1[0m in 3.91s]
[0m02:20:25.318206 [debug] [Thread-1  ]: Finished running node test.dbtlearn.dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__100__50__0_99.a11eee28e0
[0m02:20:25.322360 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m02:20:25.323870 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:20:25.324301 [debug] [MainThread]: Connection 'test.dbtlearn.dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__100__50__0_99.a11eee28e0' was properly closed.
[0m02:20:25.324882 [debug] [MainThread]: Connection 'test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da' was properly closed.
[0m02:20:25.325409 [info ] [MainThread]: 
[0m02:20:25.326128 [info ] [MainThread]: Finished running 2 tests in 0 hours 0 minutes and 7.60 seconds (7.60s).
[0m02:20:25.327152 [debug] [MainThread]: Command end result
[0m02:20:25.354069 [info ] [MainThread]: 
[0m02:20:25.354642 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m02:20:25.355002 [info ] [MainThread]: 
[0m02:20:25.355371 [error] [MainThread]: [31mFailure in test dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__100__50__0_99 (models/schema.yml)[0m
[0m02:20:25.355709 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m02:20:25.356047 [info ] [MainThread]: 
[0m02:20:25.356373 [info ] [MainThread]:   compiled Code at target/compiled/dbtlearn/models/schema.yml/dbt_expectations_expect_column_68f998c0da11ce3e6e806b41ab34f533.sql
[0m02:20:25.356701 [info ] [MainThread]: 
[0m02:20:25.357012 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m02:20:25.357438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ce2ae0c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ce2ae0d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cc0f8ab50>]}
[0m02:20:25.357799 [debug] [MainThread]: Flushing usage events


============================== 2023-03-08 02:21:49.558864 | 1e4531a7-c139-438d-a5c1-40279ef8d132 ==============================
[0m02:21:49.558864 [info ] [MainThread]: Running with dbt=1.4.3
[0m02:21:49.561092 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/katiehuang/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'select': ['dim_listings_w_hosts'], 'which': 'test', 'rpc_method': 'test'}
[0m02:21:49.561369 [debug] [MainThread]: Tracking: tracking
[0m02:21:49.562045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9498ffc460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9498ffceb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9498ffcd00>]}
[0m02:21:49.598187 [debug] [MainThread]: checksum: c7a5cda64f02d8b9dd20ef412f82fbb79fdce1bb359c3c5dae3d080de7f31bfd, vars: {}, profile: None, target: None, version: 1.4.3
[0m02:21:49.708299 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:21:49.709133 [debug] [MainThread]: Partial parsing: updated file: dbtlearn://models/schema.yml
[0m02:21:49.731134 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_w_hosts.sql
[0m02:21:49.884998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1e4531a7-c139-438d-a5c1-40279ef8d132', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94bab4d7c0>]}
[0m02:21:49.901222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1e4531a7-c139-438d-a5c1-40279ef8d132', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94a8276160>]}
[0m02:21:49.901592 [info ] [MainThread]: Found 8 models, 15 tests, 1 snapshot, 1 analysis, 640 macros, 0 operations, 1 seed file, 3 sources, 1 exposure, 0 metrics
[0m02:21:49.901912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1e4531a7-c139-438d-a5c1-40279ef8d132', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94a82762b0>]}
[0m02:21:49.903574 [info ] [MainThread]: 
[0m02:21:49.905044 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m02:21:49.906371 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_airbnb_dev'
[0m02:21:49.921700 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m02:21:49.921971 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m02:21:49.922184 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:21:52.212797 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 2 seconds
[0m02:21:52.218981 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m02:21:52.810581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1e4531a7-c139-438d-a5c1-40279ef8d132', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94a840ad90>]}
[0m02:21:52.811773 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m02:21:52.812343 [info ] [MainThread]: 
[0m02:21:52.819217 [debug] [Thread-1  ]: Began running node test.dbtlearn.dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99.71a0bfb970
[0m02:21:52.819721 [debug] [Thread-2  ]: Began running node test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da
[0m02:21:52.820089 [info ] [Thread-1  ]: 1 of 2 START test dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99  [RUN]
[0m02:21:52.820663 [info ] [Thread-2  ]: 2 of 2 START test dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_  [RUN]
[0m02:21:52.821714 [debug] [Thread-1  ]: Acquiring new snowflake connection 'test.dbtlearn.dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99.71a0bfb970'
[0m02:21:52.822443 [debug] [Thread-2  ]: Acquiring new snowflake connection 'test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da'
[0m02:21:52.822800 [debug] [Thread-1  ]: Began compiling node test.dbtlearn.dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99.71a0bfb970
[0m02:21:52.823156 [debug] [Thread-2  ]: Began compiling node test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da
[0m02:21:52.831284 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbtlearn.dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99.71a0bfb970"
[0m02:21:52.839894 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da"
[0m02:21:52.840935 [debug] [Thread-1  ]: Timing info for test.dbtlearn.dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99.71a0bfb970 (compile): 2023-03-08 02:21:52.823416 => 2023-03-08 02:21:52.840849
[0m02:21:52.841227 [debug] [Thread-1  ]: Began executing node test.dbtlearn.dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99.71a0bfb970
[0m02:21:52.854048 [debug] [Thread-2  ]: Timing info for test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da (compile): 2023-03-08 02:21:52.831551 => 2023-03-08 02:21:52.853987
[0m02:21:52.861820 [debug] [Thread-2  ]: Began executing node test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da
[0m02:21:52.871216 [debug] [Thread-2  ]: Writing runtime sql for node "test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da"
[0m02:21:52.868163 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbtlearn.dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99.71a0bfb970"
[0m02:21:52.873097 [debug] [Thread-1  ]: Using snowflake connection "test.dbtlearn.dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99.71a0bfb970"
[0m02:21:52.873348 [debug] [Thread-1  ]: On test.dbtlearn.dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99.71a0bfb970: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99.71a0bfb970"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      





    with grouped_expression as (
    select
        
        
    
  
( 1=1 and percentile_cont(0.99) within group (order by price) >= 50 and percentile_cont(0.99) within group (order by price) <= 500
)
 as expression


    from airbnb.dev.dim_listings_w_hosts
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors






      
    ) dbt_internal_test
[0m02:21:52.873566 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:21:52.875401 [debug] [Thread-2  ]: Using snowflake connection "test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da"
[0m02:21:52.875920 [debug] [Thread-2  ]: On test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    with a as (
        
    select
        
        count(*) as expression
    from
        airbnb.dev.dim_listings_w_hosts
    

    ),
    b as (
        
    select
        
        count(*) * 1 as expression
    from
        airbnb.raw.raw_listings
    

    ),
    final as (

        select
            
            a.expression,
            b.expression as compare_expression,
            abs(coalesce(a.expression, 0) - coalesce(b.expression, 0)) as expression_difference,
            abs(coalesce(a.expression, 0) - coalesce(b.expression, 0))/
                nullif(a.expression * 1.0, 0) as expression_difference_percent
        from
        
            a cross join b
        
    )
    -- DEBUG:
    -- select * from final
    select
        *
    from final
    where
        
        expression_difference > 0.0
        

      
    ) dbt_internal_test
[0m02:21:52.876194 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m02:21:54.802001 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 2 seconds
[0m02:21:54.824420 [debug] [Thread-2  ]: Timing info for test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da (execute): 2023-03-08 02:21:52.868290 => 2023-03-08 02:21:54.824328
[0m02:21:54.824976 [debug] [Thread-2  ]: On test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da: Close
[0m02:21:55.320871 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2 seconds
[0m02:21:55.325761 [debug] [Thread-1  ]: Timing info for test.dbtlearn.dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99.71a0bfb970 (execute): 2023-03-08 02:21:52.841448 => 2023-03-08 02:21:55.325654
[0m02:21:55.326210 [debug] [Thread-1  ]: On test.dbtlearn.dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99.71a0bfb970: Close
[0m02:21:55.417175 [info ] [Thread-2  ]: 2 of 2 PASS dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_  [[32mPASS[0m in 2.59s]
[0m02:21:55.420502 [debug] [Thread-2  ]: Finished running node test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da
[0m02:21:55.923528 [info ] [Thread-1  ]: 1 of 2 PASS dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99  [[32mPASS[0m in 3.10s]
[0m02:21:55.924700 [debug] [Thread-1  ]: Finished running node test.dbtlearn.dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99.71a0bfb970
[0m02:21:55.927670 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m02:21:55.928707 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:21:55.929067 [debug] [MainThread]: Connection 'test.dbtlearn.dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99.71a0bfb970' was properly closed.
[0m02:21:55.929372 [debug] [MainThread]: Connection 'test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da' was properly closed.
[0m02:21:55.929738 [info ] [MainThread]: 
[0m02:21:55.930253 [info ] [MainThread]: Finished running 2 tests in 0 hours 0 minutes and 6.03 seconds (6.03s).
[0m02:21:55.931006 [debug] [MainThread]: Command end result
[0m02:21:55.953763 [info ] [MainThread]: 
[0m02:21:55.954297 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:21:55.954666 [info ] [MainThread]: 
[0m02:21:55.955006 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m02:21:55.955427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94b88a9580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94bac77c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9498ff9fd0>]}
[0m02:21:55.955776 [debug] [MainThread]: Flushing usage events


============================== 2023-03-08 02:26:15.033076 | d1ed5b83-41b1-47f4-830d-17ff8643d73d ==============================
[0m02:26:15.033076 [info ] [MainThread]: Running with dbt=1.4.3
[0m02:26:15.035417 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/katiehuang/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'select': ['dim_listings_w_hosts'], 'which': 'test', 'rpc_method': 'test'}
[0m02:26:15.035738 [debug] [MainThread]: Tracking: tracking
[0m02:26:15.036429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcad9173a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcad9173e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcad9173cd0>]}
[0m02:26:15.072675 [debug] [MainThread]: checksum: c7a5cda64f02d8b9dd20ef412f82fbb79fdce1bb359c3c5dae3d080de7f31bfd, vars: {}, profile: None, target: None, version: 1.4.3
[0m02:26:15.184861 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:26:15.185732 [debug] [MainThread]: Partial parsing: updated file: dbtlearn://models/schema.yml
[0m02:26:15.207152 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_w_hosts.sql
[0m02:26:15.377930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd1ed5b83-41b1-47f4-830d-17ff8643d73d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcaea96bdf0>]}
[0m02:26:15.394562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd1ed5b83-41b1-47f4-830d-17ff8643d73d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcaea0f2640>]}
[0m02:26:15.394947 [info ] [MainThread]: Found 8 models, 16 tests, 1 snapshot, 1 analysis, 640 macros, 0 operations, 1 seed file, 3 sources, 1 exposure, 0 metrics
[0m02:26:15.395254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd1ed5b83-41b1-47f4-830d-17ff8643d73d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcac834f2e0>]}
[0m02:26:15.396963 [info ] [MainThread]: 
[0m02:26:15.398445 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m02:26:15.399763 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_airbnb_dev'
[0m02:26:15.415408 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m02:26:15.415685 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m02:26:15.415923 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:26:17.833995 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 2 seconds
[0m02:26:17.842325 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m02:26:18.494778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd1ed5b83-41b1-47f4-830d-17ff8643d73d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcaea93bfd0>]}
[0m02:26:18.497140 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m02:26:18.497911 [info ] [MainThread]: 
[0m02:26:18.506429 [debug] [Thread-1  ]: Began running node test.dbtlearn.dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000.5218138b75
[0m02:26:18.507057 [debug] [Thread-2  ]: Began running node test.dbtlearn.dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99.71a0bfb970
[0m02:26:18.507546 [debug] [Thread-3  ]: Began running node test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da
[0m02:26:18.507938 [info ] [Thread-1  ]: 1 of 3 START test dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000  [RUN]
[0m02:26:18.508596 [info ] [Thread-2  ]: 2 of 3 START test dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99  [RUN]
[0m02:26:18.509321 [info ] [Thread-3  ]: 3 of 3 START test dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_  [RUN]
[0m02:26:18.510740 [debug] [Thread-1  ]: Acquiring new snowflake connection 'test.dbtlearn.dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000.5218138b75'
[0m02:26:18.511529 [debug] [Thread-2  ]: Acquiring new snowflake connection 'test.dbtlearn.dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99.71a0bfb970'
[0m02:26:18.512208 [debug] [Thread-3  ]: Acquiring new snowflake connection 'test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da'
[0m02:26:18.512560 [debug] [Thread-1  ]: Began compiling node test.dbtlearn.dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000.5218138b75
[0m02:26:18.512923 [debug] [Thread-2  ]: Began compiling node test.dbtlearn.dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99.71a0bfb970
[0m02:26:18.513261 [debug] [Thread-3  ]: Began compiling node test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da
[0m02:26:18.521898 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbtlearn.dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000.5218138b75"
[0m02:26:18.529687 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbtlearn.dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99.71a0bfb970"
[0m02:26:18.537865 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da"
[0m02:26:18.538743 [debug] [Thread-1  ]: Timing info for test.dbtlearn.dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000.5218138b75 (compile): 2023-03-08 02:26:18.513508 => 2023-03-08 02:26:18.538664
[0m02:26:18.538994 [debug] [Thread-2  ]: Timing info for test.dbtlearn.dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99.71a0bfb970 (compile): 2023-03-08 02:26:18.522333 => 2023-03-08 02:26:18.538945
[0m02:26:18.539241 [debug] [Thread-1  ]: Began executing node test.dbtlearn.dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000.5218138b75
[0m02:26:18.539492 [debug] [Thread-2  ]: Began executing node test.dbtlearn.dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99.71a0bfb970
[0m02:26:18.539692 [debug] [Thread-3  ]: Timing info for test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da (compile): 2023-03-08 02:26:18.529953 => 2023-03-08 02:26:18.539654
[0m02:26:18.570845 [debug] [Thread-3  ]: Began executing node test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da
[0m02:26:18.571292 [debug] [Thread-2  ]: Writing runtime sql for node "test.dbtlearn.dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99.71a0bfb970"
[0m02:26:18.570587 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbtlearn.dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000.5218138b75"
[0m02:26:18.574304 [debug] [Thread-3  ]: Writing runtime sql for node "test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da"
[0m02:26:18.575961 [debug] [Thread-2  ]: Using snowflake connection "test.dbtlearn.dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99.71a0bfb970"
[0m02:26:18.576172 [debug] [Thread-2  ]: On test.dbtlearn.dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99.71a0bfb970: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99.71a0bfb970"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      





    with grouped_expression as (
    select
        
        
    
  
( 1=1 and percentile_cont(0.99) within group (order by price) >= 50 and percentile_cont(0.99) within group (order by price) <= 500
)
 as expression


    from airbnb.dev.dim_listings_w_hosts
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors






      
    ) dbt_internal_test
[0m02:26:18.576387 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m02:26:18.578165 [debug] [Thread-1  ]: Using snowflake connection "test.dbtlearn.dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000.5218138b75"
[0m02:26:18.579748 [debug] [Thread-3  ]: Using snowflake connection "test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da"
[0m02:26:18.580034 [debug] [Thread-1  ]: On test.dbtlearn.dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000.5218138b75: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000.5218138b75"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      




    with grouped_expression as (
    select
        
        
    
  
( 1=1 and max(price) <= 5000
)
 as expression


    from airbnb.dev.dim_listings_w_hosts
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors






      
    ) dbt_internal_test
[0m02:26:18.580780 [debug] [Thread-3  ]: On test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    with a as (
        
    select
        
        count(*) as expression
    from
        airbnb.dev.dim_listings_w_hosts
    

    ),
    b as (
        
    select
        
        count(*) * 1 as expression
    from
        airbnb.raw.raw_listings
    

    ),
    final as (

        select
            
            a.expression,
            b.expression as compare_expression,
            abs(coalesce(a.expression, 0) - coalesce(b.expression, 0)) as expression_difference,
            abs(coalesce(a.expression, 0) - coalesce(b.expression, 0))/
                nullif(a.expression * 1.0, 0) as expression_difference_percent
        from
        
            a cross join b
        
    )
    -- DEBUG:
    -- select * from final
    select
        *
    from final
    where
        
        expression_difference > 0.0
        

      
    ) dbt_internal_test
[0m02:26:18.581015 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:26:18.581211 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m02:26:20.723932 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 2 seconds
[0m02:26:20.748800 [debug] [Thread-2  ]: Timing info for test.dbtlearn.dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99.71a0bfb970 (execute): 2023-03-08 02:26:18.558219 => 2023-03-08 02:26:20.748673
[0m02:26:20.749302 [debug] [Thread-2  ]: On test.dbtlearn.dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99.71a0bfb970: Close
[0m02:26:20.908852 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2 seconds
[0m02:26:20.914274 [debug] [Thread-1  ]: Timing info for test.dbtlearn.dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000.5218138b75 (execute): 2023-03-08 02:26:18.539825 => 2023-03-08 02:26:20.914115
[0m02:26:20.914948 [debug] [Thread-1  ]: On test.dbtlearn.dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000.5218138b75: Close
[0m02:26:20.946337 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 2 seconds
[0m02:26:20.950343 [debug] [Thread-3  ]: Timing info for test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da (execute): 2023-03-08 02:26:18.571496 => 2023-03-08 02:26:20.950220
[0m02:26:20.950867 [debug] [Thread-3  ]: On test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da: Close
[0m02:26:21.367022 [info ] [Thread-2  ]: 2 of 3 PASS dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99  [[32mPASS[0m in 2.86s]
[0m02:26:21.370396 [debug] [Thread-2  ]: Finished running node test.dbtlearn.dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99.71a0bfb970
[0m02:26:21.503322 [error] [Thread-1  ]: 1 of 3 FAIL 1 dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000  [[31mFAIL 1[0m in 2.99s]
[0m02:26:21.504350 [debug] [Thread-1  ]: Finished running node test.dbtlearn.dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000.5218138b75
[0m02:26:21.554106 [info ] [Thread-3  ]: 3 of 3 PASS dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_  [[32mPASS[0m in 3.04s]
[0m02:26:21.554952 [debug] [Thread-3  ]: Finished running node test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da
[0m02:26:21.557641 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m02:26:21.558595 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:26:21.558922 [debug] [MainThread]: Connection 'test.dbtlearn.dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000.5218138b75' was properly closed.
[0m02:26:21.559213 [debug] [MainThread]: Connection 'test.dbtlearn.dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99.71a0bfb970' was properly closed.
[0m02:26:21.559495 [debug] [MainThread]: Connection 'test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da' was properly closed.
[0m02:26:21.559862 [info ] [MainThread]: 
[0m02:26:21.560370 [info ] [MainThread]: Finished running 3 tests in 0 hours 0 minutes and 6.16 seconds (6.16s).
[0m02:26:21.561166 [debug] [MainThread]: Command end result
[0m02:26:21.581415 [info ] [MainThread]: 
[0m02:26:21.581928 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m02:26:21.582278 [info ] [MainThread]: 
[0m02:26:21.582623 [error] [MainThread]: [31mFailure in test dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000 (models/schema.yml)[0m
[0m02:26:21.582960 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m02:26:21.583280 [info ] [MainThread]: 
[0m02:26:21.583605 [info ] [MainThread]:   compiled Code at target/compiled/dbtlearn/models/schema.yml/dbt_expectations_expect_column_c59e300e0dddb335c4211147100ac1c6.sql
[0m02:26:21.583946 [info ] [MainThread]: 
[0m02:26:21.584235 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m02:26:21.584620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcaea876520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcaeab5f850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcaeab5f1c0>]}
[0m02:26:21.584938 [debug] [MainThread]: Flushing usage events


============================== 2023-03-08 02:27:48.544700 | 60ca908b-7800-4008-bc71-75bb320eabe7 ==============================
[0m02:27:48.544700 [info ] [MainThread]: Running with dbt=1.4.3
[0m02:27:48.546915 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/katiehuang/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'select': ['dim_listings_w_hosts'], 'which': 'test', 'rpc_method': 'test'}
[0m02:27:48.547150 [debug] [MainThread]: Tracking: tracking
[0m02:27:48.547891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f2a9e9820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f2a9e9bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f2a9e9a90>]}
[0m02:27:48.583609 [debug] [MainThread]: checksum: c7a5cda64f02d8b9dd20ef412f82fbb79fdce1bb359c3c5dae3d080de7f31bfd, vars: {}, profile: None, target: None, version: 1.4.3
[0m02:27:48.694806 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:27:48.695641 [debug] [MainThread]: Partial parsing: updated file: dbtlearn://models/schema.yml
[0m02:27:48.718129 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_w_hosts.sql
[0m02:27:48.879428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '60ca908b-7800-4008-bc71-75bb320eabe7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f2ac994c0>]}
[0m02:27:48.895394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '60ca908b-7800-4008-bc71-75bb320eabe7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f2ac752b0>]}
[0m02:27:48.895762 [info ] [MainThread]: Found 8 models, 16 tests, 1 snapshot, 1 analysis, 640 macros, 0 operations, 1 seed file, 3 sources, 1 exposure, 0 metrics
[0m02:27:48.896071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '60ca908b-7800-4008-bc71-75bb320eabe7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f2ac75310>]}
[0m02:27:48.897757 [info ] [MainThread]: 
[0m02:27:48.899224 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m02:27:48.900570 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_airbnb_dev'
[0m02:27:48.916130 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m02:27:48.916404 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m02:27:48.916619 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:27:51.169402 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 2 seconds
[0m02:27:51.177544 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m02:27:51.810754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '60ca908b-7800-4008-bc71-75bb320eabe7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f2aa06580>]}
[0m02:27:51.812545 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m02:27:51.813167 [info ] [MainThread]: 
[0m02:27:51.823068 [debug] [Thread-1  ]: Began running node test.dbtlearn.dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000.5218138b75
[0m02:27:51.823775 [debug] [Thread-2  ]: Began running node test.dbtlearn.dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99.71a0bfb970
[0m02:27:51.824273 [debug] [Thread-3  ]: Began running node test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da
[0m02:27:51.824663 [info ] [Thread-1  ]: 1 of 3 START test dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000  [RUN]
[0m02:27:51.825375 [info ] [Thread-2  ]: 2 of 3 START test dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99  [RUN]
[0m02:27:51.826098 [info ] [Thread-3  ]: 3 of 3 START test dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_  [RUN]
[0m02:27:51.827604 [debug] [Thread-1  ]: Acquiring new snowflake connection 'test.dbtlearn.dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000.5218138b75'
[0m02:27:51.828516 [debug] [Thread-2  ]: Acquiring new snowflake connection 'test.dbtlearn.dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99.71a0bfb970'
[0m02:27:51.829346 [debug] [Thread-3  ]: Acquiring new snowflake connection 'test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da'
[0m02:27:51.829766 [debug] [Thread-1  ]: Began compiling node test.dbtlearn.dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000.5218138b75
[0m02:27:51.830182 [debug] [Thread-2  ]: Began compiling node test.dbtlearn.dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99.71a0bfb970
[0m02:27:51.830555 [debug] [Thread-3  ]: Began compiling node test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da
[0m02:27:51.839607 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbtlearn.dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000.5218138b75"
[0m02:27:51.846957 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbtlearn.dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99.71a0bfb970"
[0m02:27:51.854853 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da"
[0m02:27:51.856020 [debug] [Thread-1  ]: Timing info for test.dbtlearn.dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000.5218138b75 (compile): 2023-03-08 02:27:51.830845 => 2023-03-08 02:27:51.855927
[0m02:27:51.856352 [debug] [Thread-3  ]: Timing info for test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da (compile): 2023-03-08 02:27:51.847170 => 2023-03-08 02:27:51.856295
[0m02:27:51.856617 [debug] [Thread-1  ]: Began executing node test.dbtlearn.dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000.5218138b75
[0m02:27:51.856822 [debug] [Thread-2  ]: Timing info for test.dbtlearn.dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99.71a0bfb970 (compile): 2023-03-08 02:27:51.840008 => 2023-03-08 02:27:51.856780
[0m02:27:51.857070 [debug] [Thread-3  ]: Began executing node test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da
[0m02:27:51.876173 [debug] [Thread-2  ]: Began executing node test.dbtlearn.dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99.71a0bfb970
[0m02:27:51.882177 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbtlearn.dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000.5218138b75"
[0m02:27:51.885106 [debug] [Thread-3  ]: Writing runtime sql for node "test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da"
[0m02:27:51.888119 [debug] [Thread-2  ]: Writing runtime sql for node "test.dbtlearn.dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99.71a0bfb970"
[0m02:27:51.890409 [debug] [Thread-3  ]: Using snowflake connection "test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da"
[0m02:27:51.891457 [debug] [Thread-1  ]: Using snowflake connection "test.dbtlearn.dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000.5218138b75"
[0m02:27:51.892593 [debug] [Thread-2  ]: Using snowflake connection "test.dbtlearn.dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99.71a0bfb970"
[0m02:27:51.892763 [debug] [Thread-3  ]: On test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    with a as (
        
    select
        
        count(*) as expression
    from
        airbnb.dev.dim_listings_w_hosts
    

    ),
    b as (
        
    select
        
        count(*) * 1 as expression
    from
        airbnb.raw.raw_listings
    

    ),
    final as (

        select
            
            a.expression,
            b.expression as compare_expression,
            abs(coalesce(a.expression, 0) - coalesce(b.expression, 0)) as expression_difference,
            abs(coalesce(a.expression, 0) - coalesce(b.expression, 0))/
                nullif(a.expression * 1.0, 0) as expression_difference_percent
        from
        
            a cross join b
        
    )
    -- DEBUG:
    -- select * from final
    select
        *
    from final
    where
        
        expression_difference > 0.0
        

      
    ) dbt_internal_test
[0m02:27:51.892959 [debug] [Thread-1  ]: On test.dbtlearn.dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000.5218138b75: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000.5218138b75"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      




    with grouped_expression as (
    select
        
        
    
  
( 1=1 and max(price) <= 5000
)
 as expression


    from airbnb.dev.dim_listings_w_hosts
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors






      
    ) dbt_internal_test
[0m02:27:51.893169 [debug] [Thread-2  ]: On test.dbtlearn.dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99.71a0bfb970: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99.71a0bfb970"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      





    with grouped_expression as (
    select
        
        
    
  
( 1=1 and percentile_cont(0.99) within group (order by price) >= 50 and percentile_cont(0.99) within group (order by price) <= 500
)
 as expression


    from airbnb.dev.dim_listings_w_hosts
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors






      
    ) dbt_internal_test
[0m02:27:51.893360 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m02:27:51.893541 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:27:51.893726 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m02:27:54.023785 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2 seconds
[0m02:27:54.047596 [debug] [Thread-1  ]: Timing info for test.dbtlearn.dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000.5218138b75 (execute): 2023-03-08 02:27:51.857244 => 2023-03-08 02:27:54.047471
[0m02:27:54.048439 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 2 seconds
[0m02:27:54.048855 [debug] [Thread-1  ]: On test.dbtlearn.dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000.5218138b75: Close
[0m02:27:54.051270 [debug] [Thread-2  ]: Timing info for test.dbtlearn.dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99.71a0bfb970 (execute): 2023-03-08 02:27:51.885298 => 2023-03-08 02:27:54.051197
[0m02:27:54.053125 [debug] [Thread-2  ]: On test.dbtlearn.dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99.71a0bfb970: Close
[0m02:27:54.093764 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 2 seconds
[0m02:27:54.096714 [debug] [Thread-3  ]: Timing info for test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da (execute): 2023-03-08 02:27:51.882398 => 2023-03-08 02:27:54.096629
[0m02:27:54.097068 [debug] [Thread-3  ]: On test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da: Close
[0m02:27:54.621543 [info ] [Thread-2  ]: 2 of 3 PASS dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99  [[32mPASS[0m in 2.79s]
[0m02:27:54.623766 [warn ] [Thread-1  ]: 1 of 3 WARN 1 dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000  [[33mWARN 1[0m in 2.80s]
[0m02:27:54.626913 [debug] [Thread-2  ]: Finished running node test.dbtlearn.dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99.71a0bfb970
[0m02:27:54.627481 [debug] [Thread-1  ]: Finished running node test.dbtlearn.dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000.5218138b75
[0m02:27:54.690304 [info ] [Thread-3  ]: 3 of 3 PASS dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_  [[32mPASS[0m in 2.86s]
[0m02:27:54.691186 [debug] [Thread-3  ]: Finished running node test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da
[0m02:27:54.693927 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m02:27:54.694885 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:27:54.695224 [debug] [MainThread]: Connection 'test.dbtlearn.dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000.5218138b75' was properly closed.
[0m02:27:54.695517 [debug] [MainThread]: Connection 'test.dbtlearn.dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99.71a0bfb970' was properly closed.
[0m02:27:54.695792 [debug] [MainThread]: Connection 'test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da' was properly closed.
[0m02:27:54.696149 [info ] [MainThread]: 
[0m02:27:54.696691 [info ] [MainThread]: Finished running 3 tests in 0 hours 0 minutes and 5.80 seconds (5.80s).
[0m02:27:54.697502 [debug] [MainThread]: Command end result
[0m02:27:54.719503 [info ] [MainThread]: 
[0m02:27:54.720021 [info ] [MainThread]: [33mCompleted with 1 warning:[0m
[0m02:27:54.720373 [info ] [MainThread]: 
[0m02:27:54.720715 [warn ] [MainThread]: [33mWarning in test dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000 (models/schema.yml)[0m
[0m02:27:54.721030 [warn ] [MainThread]: Got 1 result, configured to warn if != 0
[0m02:27:54.721314 [info ] [MainThread]: 
[0m02:27:54.721585 [info ] [MainThread]:   compiled Code at target/compiled/dbtlearn/models/schema.yml/dbt_expectations_expect_column_c59e300e0dddb335c4211147100ac1c6.sql
[0m02:27:54.721876 [info ] [MainThread]: 
[0m02:27:54.722152 [info ] [MainThread]: Done. PASS=2 WARN=1 ERROR=0 SKIP=0 TOTAL=3
[0m02:27:54.722546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f2adcf0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f2adcfdf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f080aea60>]}
[0m02:27:54.722880 [debug] [MainThread]: Flushing usage events


============================== 2023-03-08 02:31:11.185792 | f0538e9d-0342-40c9-8da6-4f3757add1bb ==============================
[0m02:31:11.185792 [info ] [MainThread]: Running with dbt=1.4.3
[0m02:31:11.188086 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/katiehuang/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'select': ['dim_listings_w_hosts'], 'which': 'test', 'rpc_method': 'test'}
[0m02:31:11.188431 [debug] [MainThread]: Tracking: tracking
[0m02:31:11.189149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84d951c3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84d951ce20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84d951cc70>]}
[0m02:31:11.227097 [debug] [MainThread]: checksum: c7a5cda64f02d8b9dd20ef412f82fbb79fdce1bb359c3c5dae3d080de7f31bfd, vars: {}, profile: None, target: None, version: 1.4.3
[0m02:31:11.337679 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:31:11.338530 [debug] [MainThread]: Partial parsing: updated file: dbtlearn://models/schema.yml
[0m02:31:11.360060 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_w_hosts.sql
[0m02:31:11.530103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f0538e9d-0342-40c9-8da6-4f3757add1bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84ea8dd0a0>]}
[0m02:31:11.546578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f0538e9d-0342-40c9-8da6-4f3757add1bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84ea80d400>]}
[0m02:31:11.546978 [info ] [MainThread]: Found 8 models, 17 tests, 1 snapshot, 1 analysis, 640 macros, 0 operations, 1 seed file, 3 sources, 1 exposure, 0 metrics
[0m02:31:11.547286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f0538e9d-0342-40c9-8da6-4f3757add1bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84e88294f0>]}
[0m02:31:11.549064 [info ] [MainThread]: 
[0m02:31:11.550533 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m02:31:11.551860 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_airbnb_dev'
[0m02:31:11.567562 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m02:31:11.567830 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m02:31:11.568050 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:31:14.045598 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 2 seconds
[0m02:31:14.053424 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m02:31:14.747298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f0538e9d-0342-40c9-8da6-4f3757add1bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84ea7ff940>]}
[0m02:31:14.749339 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m02:31:14.750067 [info ] [MainThread]: 
[0m02:31:14.758908 [debug] [Thread-1  ]: Began running node test.dbtlearn.dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000.5218138b75
[0m02:31:14.759320 [debug] [Thread-2  ]: Began running node test.dbtlearn.dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99.71a0bfb970
[0m02:31:14.759592 [debug] [Thread-3  ]: Began running node test.dbtlearn.dbt_expectations_expect_column_values_to_be_of_type_dim_listings_w_hosts_price__number_10_2_.55be9dc2db
[0m02:31:14.760236 [debug] [Thread-4  ]: Began running node test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da
[0m02:31:14.759824 [info ] [Thread-1  ]: 1 of 4 START test dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000  [RUN]
[0m02:31:14.760606 [info ] [Thread-2  ]: 2 of 4 START test dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99  [RUN]
[0m02:31:14.760995 [info ] [Thread-3  ]: 3 of 4 START test dbt_expectations_expect_column_values_to_be_of_type_dim_listings_w_hosts_price__number_10_2_  [RUN]
[0m02:31:14.761328 [info ] [Thread-4  ]: 4 of 4 START test dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_  [RUN]
[0m02:31:14.762007 [debug] [Thread-1  ]: Acquiring new snowflake connection 'test.dbtlearn.dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000.5218138b75'
[0m02:31:14.762584 [debug] [Thread-2  ]: Acquiring new snowflake connection 'test.dbtlearn.dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99.71a0bfb970'
[0m02:31:14.763114 [debug] [Thread-3  ]: Acquiring new snowflake connection 'test.dbtlearn.dbt_expectations_expect_column_values_to_be_of_type_dim_listings_w_hosts_price__number_10_2_.55be9dc2db'
[0m02:31:14.763655 [debug] [Thread-4  ]: Acquiring new snowflake connection 'test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da'
[0m02:31:14.763912 [debug] [Thread-1  ]: Began compiling node test.dbtlearn.dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000.5218138b75
[0m02:31:14.764186 [debug] [Thread-2  ]: Began compiling node test.dbtlearn.dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99.71a0bfb970
[0m02:31:14.764580 [debug] [Thread-3  ]: Began compiling node test.dbtlearn.dbt_expectations_expect_column_values_to_be_of_type_dim_listings_w_hosts_price__number_10_2_.55be9dc2db
[0m02:31:14.764811 [debug] [Thread-4  ]: Began compiling node test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da
[0m02:31:14.771902 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbtlearn.dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000.5218138b75"
[0m02:31:14.779550 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbtlearn.dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99.71a0bfb970"
[0m02:31:14.801743 [debug] [Thread-3  ]: Using snowflake connection "test.dbtlearn.dbt_expectations_expect_column_values_to_be_of_type_dim_listings_w_hosts_price__number_10_2_.55be9dc2db"
[0m02:31:14.797830 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da"
[0m02:31:14.802252 [debug] [Thread-3  ]: On test.dbtlearn.dbt_expectations_expect_column_values_to_be_of_type_dim_listings_w_hosts_price__number_10_2_.55be9dc2db: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.dbt_expectations_expect_column_values_to_be_of_type_dim_listings_w_hosts_price__number_10_2_.55be9dc2db"} */
describe table airbnb.dev.dim_listings_w_hosts
[0m02:31:14.802584 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m02:31:14.804259 [debug] [Thread-4  ]: Timing info for test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da (compile): 2023-03-08 02:31:14.791634 => 2023-03-08 02:31:14.804178
[0m02:31:14.804493 [debug] [Thread-1  ]: Timing info for test.dbtlearn.dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000.5218138b75 (compile): 2023-03-08 02:31:14.765019 => 2023-03-08 02:31:14.804440
[0m02:31:14.804695 [debug] [Thread-2  ]: Timing info for test.dbtlearn.dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99.71a0bfb970 (compile): 2023-03-08 02:31:14.772210 => 2023-03-08 02:31:14.804645
[0m02:31:14.805006 [debug] [Thread-4  ]: Began executing node test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da
[0m02:31:14.805251 [debug] [Thread-1  ]: Began executing node test.dbtlearn.dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000.5218138b75
[0m02:31:14.805477 [debug] [Thread-2  ]: Began executing node test.dbtlearn.dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99.71a0bfb970
[0m02:31:14.844115 [debug] [Thread-4  ]: Writing runtime sql for node "test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da"
[0m02:31:14.847305 [debug] [Thread-2  ]: Writing runtime sql for node "test.dbtlearn.dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99.71a0bfb970"
[0m02:31:14.847917 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbtlearn.dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000.5218138b75"
[0m02:31:14.850078 [debug] [Thread-2  ]: Using snowflake connection "test.dbtlearn.dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99.71a0bfb970"
[0m02:31:14.850358 [debug] [Thread-2  ]: On test.dbtlearn.dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99.71a0bfb970: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99.71a0bfb970"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      





    with grouped_expression as (
    select
        
        
    
  
( 1=1 and percentile_cont(0.99) within group (order by price) >= 50 and percentile_cont(0.99) within group (order by price) <= 500
)
 as expression


    from airbnb.dev.dim_listings_w_hosts
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors






      
    ) dbt_internal_test
[0m02:31:14.851386 [debug] [Thread-1  ]: Using snowflake connection "test.dbtlearn.dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000.5218138b75"
[0m02:31:14.853049 [debug] [Thread-4  ]: Using snowflake connection "test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da"
[0m02:31:14.853227 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m02:31:14.853419 [debug] [Thread-1  ]: On test.dbtlearn.dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000.5218138b75: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000.5218138b75"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      




    with grouped_expression as (
    select
        
        
    
  
( 1=1 and max(price) <= 5000
)
 as expression


    from airbnb.dev.dim_listings_w_hosts
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors






      
    ) dbt_internal_test
[0m02:31:14.853631 [debug] [Thread-4  ]: On test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    with a as (
        
    select
        
        count(*) as expression
    from
        airbnb.dev.dim_listings_w_hosts
    

    ),
    b as (
        
    select
        
        count(*) * 1 as expression
    from
        airbnb.raw.raw_listings
    

    ),
    final as (

        select
            
            a.expression,
            b.expression as compare_expression,
            abs(coalesce(a.expression, 0) - coalesce(b.expression, 0)) as expression_difference,
            abs(coalesce(a.expression, 0) - coalesce(b.expression, 0))/
                nullif(a.expression * 1.0, 0) as expression_difference_percent
        from
        
            a cross join b
        
    )
    -- DEBUG:
    -- select * from final
    select
        *
    from final
    where
        
        expression_difference > 0.0
        

      
    ) dbt_internal_test
[0m02:31:14.854500 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:31:14.854709 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m02:31:17.398491 [debug] [Thread-3  ]: SQL status: SUCCESS 10 in 3 seconds
[0m02:31:17.428548 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbtlearn.dbt_expectations_expect_column_values_to_be_of_type_dim_listings_w_hosts_price__number_10_2_.55be9dc2db"
[0m02:31:17.429978 [debug] [Thread-3  ]: Timing info for test.dbtlearn.dbt_expectations_expect_column_values_to_be_of_type_dim_listings_w_hosts_price__number_10_2_.55be9dc2db (compile): 2023-03-08 02:31:14.779847 => 2023-03-08 02:31:17.429790
[0m02:31:17.430522 [debug] [Thread-3  ]: Began executing node test.dbtlearn.dbt_expectations_expect_column_values_to_be_of_type_dim_listings_w_hosts_price__number_10_2_.55be9dc2db
[0m02:31:17.436698 [debug] [Thread-3  ]: Writing runtime sql for node "test.dbtlearn.dbt_expectations_expect_column_values_to_be_of_type_dim_listings_w_hosts_price__number_10_2_.55be9dc2db"
[0m02:31:17.441586 [debug] [Thread-3  ]: Using snowflake connection "test.dbtlearn.dbt_expectations_expect_column_values_to_be_of_type_dim_listings_w_hosts_price__number_10_2_.55be9dc2db"
[0m02:31:17.441892 [debug] [Thread-3  ]: On test.dbtlearn.dbt_expectations_expect_column_values_to_be_of_type_dim_listings_w_hosts_price__number_10_2_.55be9dc2db: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.dbt_expectations_expect_column_values_to_be_of_type_dim_listings_w_hosts_price__number_10_2_.55be9dc2db"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with relation_columns as (

        
        select
            cast('LISTING_ID' as TEXT) as relation_column,
            cast('NUMBER' as TEXT) as relation_column_type
        union all
        
        select
            cast('LISTING_NAME' as TEXT) as relation_column,
            cast('VARCHAR' as TEXT) as relation_column_type
        union all
        
        select
            cast('ROOM_TYPE' as TEXT) as relation_column,
            cast('VARCHAR' as TEXT) as relation_column_type
        union all
        
        select
            cast('MINIMUM_NIGHTS' as TEXT) as relation_column,
            cast('NUMBER' as TEXT) as relation_column_type
        union all
        
        select
            cast('PRICE' as TEXT) as relation_column,
            cast('NUMBER' as TEXT) as relation_column_type
        union all
        
        select
            cast('HOST_ID' as TEXT) as relation_column,
            cast('NUMBER' as TEXT) as relation_column_type
        union all
        
        select
            cast('HOST_NAME' as TEXT) as relation_column,
            cast('VARCHAR' as TEXT) as relation_column_type
        union all
        
        select
            cast('HOST_IS_SUPERHOST' as TEXT) as relation_column,
            cast('VARCHAR' as TEXT) as relation_column_type
        union all
        
        select
            cast('CREATED_AT' as TEXT) as relation_column,
            cast('TIMESTAMP_NTZ' as TEXT) as relation_column_type
        union all
        
        select
            cast('UPDATED_AT' as TEXT) as relation_column,
            cast('TIMESTAMP_NTZ' as TEXT) as relation_column_type
        
        
    ),
    test_data as (

        select
            *
        from
            relation_columns
        where
            relation_column = 'PRICE'
            and
            relation_column_type not in ('NUMBER(10,2)')

    )
    select *
    from test_data
      
    ) dbt_internal_test
[0m02:31:17.663027 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 3 seconds
[0m02:31:17.696453 [debug] [Thread-2  ]: Timing info for test.dbtlearn.dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99.71a0bfb970 (execute): 2023-03-08 02:31:14.844362 => 2023-03-08 02:31:17.696295
[0m02:31:17.697109 [debug] [Thread-2  ]: On test.dbtlearn.dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99.71a0bfb970: Close
[0m02:31:17.722146 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 3 seconds
[0m02:31:17.725315 [debug] [Thread-4  ]: Timing info for test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da (execute): 2023-03-08 02:31:14.805800 => 2023-03-08 02:31:17.725217
[0m02:31:17.725749 [debug] [Thread-4  ]: On test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da: Close
[0m02:31:17.807808 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0 seconds
[0m02:31:17.818554 [debug] [Thread-3  ]: Timing info for test.dbtlearn.dbt_expectations_expect_column_values_to_be_of_type_dim_listings_w_hosts_price__number_10_2_.55be9dc2db (execute): 2023-03-08 02:31:17.430867 => 2023-03-08 02:31:17.818283
[0m02:31:17.819544 [debug] [Thread-3  ]: On test.dbtlearn.dbt_expectations_expect_column_values_to_be_of_type_dim_listings_w_hosts_price__number_10_2_.55be9dc2db: Close
[0m02:31:17.882334 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 3 seconds
[0m02:31:17.886441 [debug] [Thread-1  ]: Timing info for test.dbtlearn.dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000.5218138b75 (execute): 2023-03-08 02:31:14.825087 => 2023-03-08 02:31:17.886277
[0m02:31:17.887115 [debug] [Thread-1  ]: On test.dbtlearn.dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000.5218138b75: Close
[0m02:31:18.307798 [info ] [Thread-2  ]: 2 of 4 PASS dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99  [[32mPASS[0m in 3.54s]
[0m02:31:18.312531 [debug] [Thread-2  ]: Finished running node test.dbtlearn.dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99.71a0bfb970
[0m02:31:18.342513 [info ] [Thread-4  ]: 4 of 4 PASS dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_  [[32mPASS[0m in 3.58s]
[0m02:31:18.344315 [debug] [Thread-4  ]: Finished running node test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da
[0m02:31:18.401682 [error] [Thread-3  ]: 3 of 4 FAIL 1 dbt_expectations_expect_column_values_to_be_of_type_dim_listings_w_hosts_price__number_10_2_  [[31mFAIL 1[0m in 3.64s]
[0m02:31:18.402749 [debug] [Thread-3  ]: Finished running node test.dbtlearn.dbt_expectations_expect_column_values_to_be_of_type_dim_listings_w_hosts_price__number_10_2_.55be9dc2db
[0m02:31:18.488350 [warn ] [Thread-1  ]: 1 of 4 WARN 1 dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000  [[33mWARN 1[0m in 3.73s]
[0m02:31:18.490355 [debug] [Thread-1  ]: Finished running node test.dbtlearn.dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000.5218138b75
[0m02:31:18.494652 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m02:31:18.496449 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:31:18.497258 [debug] [MainThread]: Connection 'test.dbtlearn.dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000.5218138b75' was properly closed.
[0m02:31:18.498056 [debug] [MainThread]: Connection 'test.dbtlearn.dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99.71a0bfb970' was properly closed.
[0m02:31:18.498455 [debug] [MainThread]: Connection 'test.dbtlearn.dbt_expectations_expect_column_values_to_be_of_type_dim_listings_w_hosts_price__number_10_2_.55be9dc2db' was properly closed.
[0m02:31:18.498822 [debug] [MainThread]: Connection 'test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da' was properly closed.
[0m02:31:18.499384 [info ] [MainThread]: 
[0m02:31:18.500154 [info ] [MainThread]: Finished running 4 tests in 0 hours 0 minutes and 6.95 seconds (6.95s).
[0m02:31:18.501719 [debug] [MainThread]: Command end result
[0m02:31:18.529064 [info ] [MainThread]: 
[0m02:31:18.529628 [info ] [MainThread]: [31mCompleted with 1 error and 1 warning:[0m
[0m02:31:18.530002 [info ] [MainThread]: 
[0m02:31:18.530373 [error] [MainThread]: [31mFailure in test dbt_expectations_expect_column_values_to_be_of_type_dim_listings_w_hosts_price__number_10_2_ (models/schema.yml)[0m
[0m02:31:18.530731 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m02:31:18.531060 [info ] [MainThread]: 
[0m02:31:18.531388 [info ] [MainThread]:   compiled Code at target/compiled/dbtlearn/models/schema.yml/dbt_expectations_expect_column_8e138814a11b6202811546795bffca5d.sql
[0m02:31:18.531720 [info ] [MainThread]: 
[0m02:31:18.532061 [warn ] [MainThread]: [33mWarning in test dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000 (models/schema.yml)[0m
[0m02:31:18.532407 [warn ] [MainThread]: Got 1 result, configured to warn if != 0
[0m02:31:18.532734 [info ] [MainThread]: 
[0m02:31:18.533051 [info ] [MainThread]:   compiled Code at target/compiled/dbtlearn/models/schema.yml/dbt_expectations_expect_column_c59e300e0dddb335c4211147100ac1c6.sql
[0m02:31:18.533337 [info ] [MainThread]: 
[0m02:31:18.533627 [info ] [MainThread]: Done. PASS=2 WARN=1 ERROR=1 SKIP=0 TOTAL=4
[0m02:31:18.534059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84d9519400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84d9812e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84d9812df0>]}
[0m02:31:18.534390 [debug] [MainThread]: Flushing usage events


============================== 2023-03-08 02:31:40.776667 | 5a49ffa5-3e83-49c2-b211-0706a30fa557 ==============================
[0m02:31:40.776667 [info ] [MainThread]: Running with dbt=1.4.3
[0m02:31:40.779253 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/katiehuang/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'select': ['dim_listings_w_hosts'], 'which': 'test', 'rpc_method': 'test'}
[0m02:31:40.779516 [debug] [MainThread]: Tracking: tracking
[0m02:31:40.780662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faaf176c4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faaf176cf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faaf176cd60>]}
[0m02:31:40.818592 [debug] [MainThread]: checksum: c7a5cda64f02d8b9dd20ef412f82fbb79fdce1bb359c3c5dae3d080de7f31bfd, vars: {}, profile: None, target: None, version: 1.4.3
[0m02:31:40.925261 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:31:40.926126 [debug] [MainThread]: Partial parsing: updated file: dbtlearn://models/schema.yml
[0m02:31:40.949406 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_w_hosts.sql
[0m02:31:41.124636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5a49ffa5-3e83-49c2-b211-0706a30fa557', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faaf17a7670>]}
[0m02:31:41.140285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5a49ffa5-3e83-49c2-b211-0706a30fa557', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab022a16d0>]}
[0m02:31:41.140651 [info ] [MainThread]: Found 8 models, 17 tests, 1 snapshot, 1 analysis, 640 macros, 0 operations, 1 seed file, 3 sources, 1 exposure, 0 metrics
[0m02:31:41.140978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5a49ffa5-3e83-49c2-b211-0706a30fa557', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab0228ac10>]}
[0m02:31:41.142753 [info ] [MainThread]: 
[0m02:31:41.144241 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m02:31:41.145636 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_airbnb_dev'
[0m02:31:41.161486 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m02:31:41.161766 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m02:31:41.161998 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:31:43.346214 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 2 seconds
[0m02:31:43.351240 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m02:31:44.042924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5a49ffa5-3e83-49c2-b211-0706a30fa557', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab022a16a0>]}
[0m02:31:44.044309 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m02:31:44.044905 [info ] [MainThread]: 
[0m02:31:44.052243 [debug] [Thread-1  ]: Began running node test.dbtlearn.dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000.5218138b75
[0m02:31:44.052753 [debug] [Thread-2  ]: Began running node test.dbtlearn.dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99.71a0bfb970
[0m02:31:44.053164 [debug] [Thread-3  ]: Began running node test.dbtlearn.dbt_expectations_expect_column_values_to_be_of_type_dim_listings_w_hosts_price__number.6e17061c8a
[0m02:31:44.054082 [debug] [Thread-4  ]: Began running node test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da
[0m02:31:44.053523 [info ] [Thread-1  ]: 1 of 4 START test dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000  [RUN]
[0m02:31:44.054619 [info ] [Thread-2  ]: 2 of 4 START test dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99  [RUN]
[0m02:31:44.055187 [info ] [Thread-3  ]: 3 of 4 START test dbt_expectations_expect_column_values_to_be_of_type_dim_listings_w_hosts_price__number  [RUN]
[0m02:31:44.055721 [info ] [Thread-4  ]: 4 of 4 START test dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_  [RUN]
[0m02:31:44.056738 [debug] [Thread-1  ]: Acquiring new snowflake connection 'test.dbtlearn.dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000.5218138b75'
[0m02:31:44.057482 [debug] [Thread-2  ]: Acquiring new snowflake connection 'test.dbtlearn.dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99.71a0bfb970'
[0m02:31:44.058166 [debug] [Thread-3  ]: Acquiring new snowflake connection 'test.dbtlearn.dbt_expectations_expect_column_values_to_be_of_type_dim_listings_w_hosts_price__number.6e17061c8a'
[0m02:31:44.058874 [debug] [Thread-4  ]: Acquiring new snowflake connection 'test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da'
[0m02:31:44.059259 [debug] [Thread-1  ]: Began compiling node test.dbtlearn.dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000.5218138b75
[0m02:31:44.059616 [debug] [Thread-2  ]: Began compiling node test.dbtlearn.dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99.71a0bfb970
[0m02:31:44.059944 [debug] [Thread-3  ]: Began compiling node test.dbtlearn.dbt_expectations_expect_column_values_to_be_of_type_dim_listings_w_hosts_price__number.6e17061c8a
[0m02:31:44.060255 [debug] [Thread-4  ]: Began compiling node test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da
[0m02:31:44.068107 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbtlearn.dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000.5218138b75"
[0m02:31:44.076091 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbtlearn.dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99.71a0bfb970"
[0m02:31:44.094990 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da"
[0m02:31:44.097331 [debug] [Thread-3  ]: Using snowflake connection "test.dbtlearn.dbt_expectations_expect_column_values_to_be_of_type_dim_listings_w_hosts_price__number.6e17061c8a"
[0m02:31:44.097875 [debug] [Thread-3  ]: On test.dbtlearn.dbt_expectations_expect_column_values_to_be_of_type_dim_listings_w_hosts_price__number.6e17061c8a: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.dbt_expectations_expect_column_values_to_be_of_type_dim_listings_w_hosts_price__number.6e17061c8a"} */
describe table airbnb.dev.dim_listings_w_hosts
[0m02:31:44.098123 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m02:31:44.098750 [debug] [Thread-1  ]: Timing info for test.dbtlearn.dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000.5218138b75 (compile): 2023-03-08 02:31:44.060497 => 2023-03-08 02:31:44.098676
[0m02:31:44.099440 [debug] [Thread-1  ]: Began executing node test.dbtlearn.dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000.5218138b75
[0m02:31:44.099670 [debug] [Thread-4  ]: Timing info for test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da (compile): 2023-03-08 02:31:44.088937 => 2023-03-08 02:31:44.099615
[0m02:31:44.112523 [debug] [Thread-2  ]: Timing info for test.dbtlearn.dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99.71a0bfb970 (compile): 2023-03-08 02:31:44.068445 => 2023-03-08 02:31:44.112468
[0m02:31:44.113322 [debug] [Thread-4  ]: Began executing node test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da
[0m02:31:44.125984 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbtlearn.dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000.5218138b75"
[0m02:31:44.126230 [debug] [Thread-2  ]: Began executing node test.dbtlearn.dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99.71a0bfb970
[0m02:31:44.130340 [debug] [Thread-4  ]: Writing runtime sql for node "test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da"
[0m02:31:44.133949 [debug] [Thread-2  ]: Writing runtime sql for node "test.dbtlearn.dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99.71a0bfb970"
[0m02:31:44.135968 [debug] [Thread-1  ]: Using snowflake connection "test.dbtlearn.dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000.5218138b75"
[0m02:31:44.137184 [debug] [Thread-2  ]: Using snowflake connection "test.dbtlearn.dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99.71a0bfb970"
[0m02:31:44.138739 [debug] [Thread-4  ]: Using snowflake connection "test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da"
[0m02:31:44.138909 [debug] [Thread-1  ]: On test.dbtlearn.dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000.5218138b75: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000.5218138b75"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      




    with grouped_expression as (
    select
        
        
    
  
( 1=1 and max(price) <= 5000
)
 as expression


    from airbnb.dev.dim_listings_w_hosts
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors






      
    ) dbt_internal_test
[0m02:31:44.139110 [debug] [Thread-2  ]: On test.dbtlearn.dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99.71a0bfb970: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99.71a0bfb970"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      





    with grouped_expression as (
    select
        
        
    
  
( 1=1 and percentile_cont(0.99) within group (order by price) >= 50 and percentile_cont(0.99) within group (order by price) <= 500
)
 as expression


    from airbnb.dev.dim_listings_w_hosts
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors






      
    ) dbt_internal_test
[0m02:31:44.139310 [debug] [Thread-4  ]: On test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    with a as (
        
    select
        
        count(*) as expression
    from
        airbnb.dev.dim_listings_w_hosts
    

    ),
    b as (
        
    select
        
        count(*) * 1 as expression
    from
        airbnb.raw.raw_listings
    

    ),
    final as (

        select
            
            a.expression,
            b.expression as compare_expression,
            abs(coalesce(a.expression, 0) - coalesce(b.expression, 0)) as expression_difference,
            abs(coalesce(a.expression, 0) - coalesce(b.expression, 0))/
                nullif(a.expression * 1.0, 0) as expression_difference_percent
        from
        
            a cross join b
        
    )
    -- DEBUG:
    -- select * from final
    select
        *
    from final
    where
        
        expression_difference > 0.0
        

      
    ) dbt_internal_test
[0m02:31:44.139507 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:31:44.139685 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m02:31:44.139863 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m02:31:46.517491 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2 seconds
[0m02:31:46.551650 [debug] [Thread-1  ]: Timing info for test.dbtlearn.dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000.5218138b75 (execute): 2023-03-08 02:31:44.099894 => 2023-03-08 02:31:46.551482
[0m02:31:46.552319 [debug] [Thread-1  ]: On test.dbtlearn.dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000.5218138b75: Close
[0m02:31:46.582143 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 2 seconds
[0m02:31:46.585569 [debug] [Thread-2  ]: Timing info for test.dbtlearn.dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99.71a0bfb970 (execute): 2023-03-08 02:31:44.131010 => 2023-03-08 02:31:46.585464
[0m02:31:46.585999 [debug] [Thread-2  ]: On test.dbtlearn.dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99.71a0bfb970: Close
[0m02:31:46.613885 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 2 seconds
[0m02:31:46.617472 [debug] [Thread-4  ]: Timing info for test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da (execute): 2023-03-08 02:31:44.126600 => 2023-03-08 02:31:46.617372
[0m02:31:46.617894 [debug] [Thread-4  ]: On test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da: Close
[0m02:31:46.706580 [debug] [Thread-3  ]: SQL status: SUCCESS 10 in 3 seconds
[0m02:31:46.731216 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbtlearn.dbt_expectations_expect_column_values_to_be_of_type_dim_listings_w_hosts_price__number.6e17061c8a"
[0m02:31:46.733420 [debug] [Thread-3  ]: Timing info for test.dbtlearn.dbt_expectations_expect_column_values_to_be_of_type_dim_listings_w_hosts_price__number.6e17061c8a (compile): 2023-03-08 02:31:44.076334 => 2023-03-08 02:31:46.733184
[0m02:31:46.734135 [debug] [Thread-3  ]: Began executing node test.dbtlearn.dbt_expectations_expect_column_values_to_be_of_type_dim_listings_w_hosts_price__number.6e17061c8a
[0m02:31:46.740883 [debug] [Thread-3  ]: Writing runtime sql for node "test.dbtlearn.dbt_expectations_expect_column_values_to_be_of_type_dim_listings_w_hosts_price__number.6e17061c8a"
[0m02:31:46.746393 [debug] [Thread-3  ]: Using snowflake connection "test.dbtlearn.dbt_expectations_expect_column_values_to_be_of_type_dim_listings_w_hosts_price__number.6e17061c8a"
[0m02:31:46.746701 [debug] [Thread-3  ]: On test.dbtlearn.dbt_expectations_expect_column_values_to_be_of_type_dim_listings_w_hosts_price__number.6e17061c8a: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.dbt_expectations_expect_column_values_to_be_of_type_dim_listings_w_hosts_price__number.6e17061c8a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with relation_columns as (

        
        select
            cast('LISTING_ID' as TEXT) as relation_column,
            cast('NUMBER' as TEXT) as relation_column_type
        union all
        
        select
            cast('LISTING_NAME' as TEXT) as relation_column,
            cast('VARCHAR' as TEXT) as relation_column_type
        union all
        
        select
            cast('ROOM_TYPE' as TEXT) as relation_column,
            cast('VARCHAR' as TEXT) as relation_column_type
        union all
        
        select
            cast('MINIMUM_NIGHTS' as TEXT) as relation_column,
            cast('NUMBER' as TEXT) as relation_column_type
        union all
        
        select
            cast('PRICE' as TEXT) as relation_column,
            cast('NUMBER' as TEXT) as relation_column_type
        union all
        
        select
            cast('HOST_ID' as TEXT) as relation_column,
            cast('NUMBER' as TEXT) as relation_column_type
        union all
        
        select
            cast('HOST_NAME' as TEXT) as relation_column,
            cast('VARCHAR' as TEXT) as relation_column_type
        union all
        
        select
            cast('HOST_IS_SUPERHOST' as TEXT) as relation_column,
            cast('VARCHAR' as TEXT) as relation_column_type
        union all
        
        select
            cast('CREATED_AT' as TEXT) as relation_column,
            cast('TIMESTAMP_NTZ' as TEXT) as relation_column_type
        union all
        
        select
            cast('UPDATED_AT' as TEXT) as relation_column,
            cast('TIMESTAMP_NTZ' as TEXT) as relation_column_type
        
        
    ),
    test_data as (

        select
            *
        from
            relation_columns
        where
            relation_column = 'PRICE'
            and
            relation_column_type not in ('NUMBER')

    )
    select *
    from test_data
      
    ) dbt_internal_test
[0m02:31:47.107158 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0 seconds
[0m02:31:47.113533 [debug] [Thread-3  ]: Timing info for test.dbtlearn.dbt_expectations_expect_column_values_to_be_of_type_dim_listings_w_hosts_price__number.6e17061c8a (execute): 2023-03-08 02:31:46.734530 => 2023-03-08 02:31:47.113233
[0m02:31:47.114498 [debug] [Thread-3  ]: On test.dbtlearn.dbt_expectations_expect_column_values_to_be_of_type_dim_listings_w_hosts_price__number.6e17061c8a: Close
[0m02:31:47.172912 [warn ] [Thread-1  ]: 1 of 4 WARN 1 dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000  [[33mWARN 1[0m in 3.12s]
[0m02:31:47.180922 [debug] [Thread-1  ]: Finished running node test.dbtlearn.dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000.5218138b75
[0m02:31:47.175997 [info ] [Thread-2  ]: 2 of 4 PASS dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99  [[32mPASS[0m in 3.12s]
[0m02:31:47.182233 [debug] [Thread-2  ]: Finished running node test.dbtlearn.dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99.71a0bfb970
[0m02:31:47.242251 [info ] [Thread-4  ]: 4 of 4 PASS dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_  [[32mPASS[0m in 3.18s]
[0m02:31:47.243900 [debug] [Thread-4  ]: Finished running node test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da
[0m02:31:47.742508 [info ] [Thread-3  ]: 3 of 4 PASS dbt_expectations_expect_column_values_to_be_of_type_dim_listings_w_hosts_price__number  [[32mPASS[0m in 3.68s]
[0m02:31:47.743918 [debug] [Thread-3  ]: Finished running node test.dbtlearn.dbt_expectations_expect_column_values_to_be_of_type_dim_listings_w_hosts_price__number.6e17061c8a
[0m02:31:47.747728 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m02:31:47.749723 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:31:47.750249 [debug] [MainThread]: Connection 'test.dbtlearn.dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000.5218138b75' was properly closed.
[0m02:31:47.750723 [debug] [MainThread]: Connection 'test.dbtlearn.dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99.71a0bfb970' was properly closed.
[0m02:31:47.751188 [debug] [MainThread]: Connection 'test.dbtlearn.dbt_expectations_expect_column_values_to_be_of_type_dim_listings_w_hosts_price__number.6e17061c8a' was properly closed.
[0m02:31:47.751653 [debug] [MainThread]: Connection 'test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da' was properly closed.
[0m02:31:47.752274 [info ] [MainThread]: 
[0m02:31:47.753155 [info ] [MainThread]: Finished running 4 tests in 0 hours 0 minutes and 6.61 seconds (6.61s).
[0m02:31:47.754592 [debug] [MainThread]: Command end result
[0m02:31:47.781358 [info ] [MainThread]: 
[0m02:31:47.782013 [info ] [MainThread]: [33mCompleted with 1 warning:[0m
[0m02:31:47.782440 [info ] [MainThread]: 
[0m02:31:47.782851 [warn ] [MainThread]: [33mWarning in test dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000 (models/schema.yml)[0m
[0m02:31:47.783260 [warn ] [MainThread]: Got 1 result, configured to warn if != 0
[0m02:31:47.783664 [info ] [MainThread]: 
[0m02:31:47.784034 [info ] [MainThread]:   compiled Code at target/compiled/dbtlearn/models/schema.yml/dbt_expectations_expect_column_c59e300e0dddb335c4211147100ac1c6.sql
[0m02:31:47.784420 [info ] [MainThread]: 
[0m02:31:47.784798 [info ] [MainThread]: Done. PASS=3 WARN=1 ERROR=0 SKIP=0 TOTAL=4
[0m02:31:47.785284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faaf17694f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faaf1916580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faaf1957730>]}
[0m02:31:47.785700 [debug] [MainThread]: Flushing usage events


============================== 2023-03-08 02:36:09.251709 | 2bda5ba5-a725-4981-a759-95f390e53e95 ==============================
[0m02:36:09.251709 [info ] [MainThread]: Running with dbt=1.4.3
[0m02:36:09.253933 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/katiehuang/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'select': ['listings'], 'which': 'test', 'rpc_method': 'test'}
[0m02:36:09.254266 [debug] [MainThread]: Tracking: tracking
[0m02:36:09.254990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7baa96a430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7baa96aeb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7baa96ad30>]}
[0m02:36:09.292132 [debug] [MainThread]: checksum: c7a5cda64f02d8b9dd20ef412f82fbb79fdce1bb359c3c5dae3d080de7f31bfd, vars: {}, profile: None, target: None, version: 1.4.3
[0m02:36:09.401694 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m02:36:09.403755 [debug] [MainThread]: Partial parsing: updated file: dbtlearn://models/sources.yml
[0m02:36:09.404186 [debug] [MainThread]: Partial parsing: updated file: dbtlearn://models/schema.yml
[0m02:36:09.424517 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_w_hosts.sql
[0m02:36:09.442790 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_cleansed.sql
[0m02:36:09.449539 [debug] [MainThread]: 1699: static parser successfully parsed src/src_listings.sql
[0m02:36:09.455335 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_hosts_cleansed.sql
[0m02:36:09.461150 [debug] [MainThread]: 1699: static parser successfully parsed src/src_hosts.sql
[0m02:36:09.466862 [debug] [MainThread]: 1699: static parser successfully parsed mart/mart_fullmoon_reviews.sql
[0m02:36:09.472672 [debug] [MainThread]: 1603: static parser failed on fct/fct_reviews.sql
[0m02:36:09.551114 [debug] [MainThread]: 1602: parser fallback to jinja rendering on fct/fct_reviews.sql
[0m02:36:09.552945 [debug] [MainThread]: 1699: static parser successfully parsed src/src_reviews.sql
[0m02:36:09.644029 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Starting in v1.3, the 'name' of an exposure should contain only letters,
numbers, and underscores. Exposures support a new property, 'label', which may
contain spaces, capital letters, and special characters. Executive Dashboard
does not follow this pattern. Please update the 'name', and use the 'label'
property for a human-friendly title. This will raise an error in a future
version of dbt-core.
[0m02:36:09.644445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '2bda5ba5-a725-4981-a759-95f390e53e95', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b9912b820>]}
[0m02:36:09.657901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b990c4eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b991202b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b99120ca0>]}
[0m02:36:09.658218 [debug] [MainThread]: Flushing usage events
[0m02:36:10.886662 [error] [MainThread]: Encountered an error:
Parsing Error
  Invalid sources config given in models/sources.yml @ sources: {'name': 'airbnb', 'schema': 'raw', 'tables': [{'name': 'listings', 'identifier': 'raw_listings', 'columns': [{'room_type': None, 'tests': [{'dbt_expectations.expect_column_distinct_count_to_equal': {'value': 4}}]}]}, {'name': 'hosts', 'identifier': 'raw_hosts'}, {'name': 'reviews', 'identifier': 'raw_reviews', 'loaded_at_field': 'date', 'freshness': {'warn_after': {'count': 1, 'period': 'hour'}, 'error_after': {'count': 24, 'period': 'hour'}}}]} - at path ['tables'][0]['columns'][0]: 'name' is a required property


============================== 2023-03-08 02:36:50.325166 | be5feab0-705d-4e0e-be6a-ca45f3dac79e ==============================
[0m02:36:50.325166 [info ] [MainThread]: Running with dbt=1.4.3
[0m02:36:50.327910 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/katiehuang/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'select': ['source:airbnb.listings'], 'which': 'test', 'rpc_method': 'test'}
[0m02:36:50.328255 [debug] [MainThread]: Tracking: tracking
[0m02:36:50.329121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e01c143a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e01c14df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e01c14c40>]}
[0m02:36:50.366550 [debug] [MainThread]: checksum: c7a5cda64f02d8b9dd20ef412f82fbb79fdce1bb359c3c5dae3d080de7f31bfd, vars: {}, profile: None, target: None, version: 1.4.3
[0m02:36:50.473270 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m02:36:50.474210 [debug] [MainThread]: Partial parsing: updated file: dbtlearn://models/schema.yml
[0m02:36:50.475964 [debug] [MainThread]: Partial parsing: updated file: dbtlearn://models/sources.yml
[0m02:36:50.499370 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_w_hosts.sql
[0m02:36:50.517788 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_cleansed.sql
[0m02:36:50.524361 [debug] [MainThread]: 1699: static parser successfully parsed src/src_listings.sql
[0m02:36:50.530096 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_hosts_cleansed.sql
[0m02:36:50.536037 [debug] [MainThread]: 1699: static parser successfully parsed src/src_hosts.sql
[0m02:36:50.541652 [debug] [MainThread]: 1699: static parser successfully parsed mart/mart_fullmoon_reviews.sql
[0m02:36:50.547544 [debug] [MainThread]: 1603: static parser failed on fct/fct_reviews.sql
[0m02:36:50.626949 [debug] [MainThread]: 1602: parser fallback to jinja rendering on fct/fct_reviews.sql
[0m02:36:50.628644 [debug] [MainThread]: 1699: static parser successfully parsed src/src_reviews.sql
[0m02:36:50.843448 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Starting in v1.3, the 'name' of an exposure should contain only letters,
numbers, and underscores. Exposures support a new property, 'label', which may
contain spaces, capital letters, and special characters. Executive Dashboard
does not follow this pattern. Please update the 'name', and use the 'label'
property for a human-friendly title. This will raise an error in a future
version of dbt-core.
[0m02:36:50.844003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'be5feab0-705d-4e0e-be6a-ca45f3dac79e', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e01d3bd30>]}
[0m02:36:50.856930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8dd011c340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e01d07730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e01d070a0>]}
[0m02:36:50.857220 [debug] [MainThread]: Flushing usage events
[0m02:36:52.102936 [error] [MainThread]: Encountered an error:
Parsing Error
  Invalid sources config given in models/sources.yml @ sources: {'name': 'airbnb', 'schema': 'raw', 'tables': [{'name': 'listings', 'identifier': 'raw_listings', 'columns': [{'room_type': None, 'tests': [{'dbt_expectations.expect_column_distinct_count_to_equal': {'value': 4}}]}]}, {'name': 'hosts', 'identifier': 'raw_hosts'}, {'name': 'reviews', 'identifier': 'raw_reviews', 'loaded_at_field': 'date', 'freshness': {'warn_after': {'count': 1, 'period': 'hour'}, 'error_after': {'count': 24, 'period': 'hour'}}}]} - at path ['tables'][0]['columns'][0]: 'name' is a required property


============================== 2023-03-08 02:48:54.959592 | 9a1acf8c-35f1-44a8-9e10-48d908626489 ==============================
[0m02:48:54.959592 [info ] [MainThread]: Running with dbt=1.4.3
[0m02:48:54.961903 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/katiehuang/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'select': ['source:airbnb.listings'], 'which': 'test', 'rpc_method': 'test'}
[0m02:48:54.962217 [debug] [MainThread]: Tracking: tracking
[0m02:48:54.962932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a791e4340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a791e4d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a791e4be0>]}
[0m02:48:54.999111 [debug] [MainThread]: checksum: c7a5cda64f02d8b9dd20ef412f82fbb79fdce1bb359c3c5dae3d080de7f31bfd, vars: {}, profile: None, target: None, version: 1.4.3
[0m02:48:55.109275 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m02:48:55.110008 [debug] [MainThread]: Partial parsing: updated file: dbtlearn://models/schema.yml
[0m02:48:55.111727 [debug] [MainThread]: Partial parsing: updated file: dbtlearn://models/sources.yml
[0m02:48:55.133880 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_w_hosts.sql
[0m02:48:55.151817 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_cleansed.sql
[0m02:48:55.158923 [debug] [MainThread]: 1699: static parser successfully parsed src/src_listings.sql
[0m02:48:55.164615 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_hosts_cleansed.sql
[0m02:48:55.170356 [debug] [MainThread]: 1699: static parser successfully parsed src/src_hosts.sql
[0m02:48:55.175947 [debug] [MainThread]: 1699: static parser successfully parsed mart/mart_fullmoon_reviews.sql
[0m02:48:55.181850 [debug] [MainThread]: 1603: static parser failed on fct/fct_reviews.sql
[0m02:48:55.251665 [debug] [MainThread]: 1602: parser fallback to jinja rendering on fct/fct_reviews.sql
[0m02:48:55.253389 [debug] [MainThread]: 1699: static parser successfully parsed src/src_reviews.sql
[0m02:48:55.468577 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Starting in v1.3, the 'name' of an exposure should contain only letters,
numbers, and underscores. Exposures support a new property, 'label', which may
contain spaces, capital letters, and special characters. Executive Dashboard
does not follow this pattern. Please update the 'name', and use the 'label'
property for a human-friendly title. This will raise an error in a future
version of dbt-core.
[0m02:48:55.469015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '9a1acf8c-35f1-44a8-9e10-48d908626489', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a79246940>]}
[0m02:48:55.530766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9a1acf8c-35f1-44a8-9e10-48d908626489', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a79301e80>]}
[0m02:48:55.547490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9a1acf8c-35f1-44a8-9e10-48d908626489', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a6841bfd0>]}
[0m02:48:55.547863 [info ] [MainThread]: Found 8 models, 19 tests, 1 snapshot, 1 analysis, 640 macros, 0 operations, 1 seed file, 3 sources, 1 exposure, 0 metrics
[0m02:48:55.548168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9a1acf8c-35f1-44a8-9e10-48d908626489', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a68423070>]}
[0m02:48:55.549788 [info ] [MainThread]: 
[0m02:48:55.551242 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m02:48:55.552594 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_airbnb_dev'
[0m02:48:55.568612 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m02:48:55.568938 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m02:48:55.569160 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:48:57.942610 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 2 seconds
[0m02:48:57.949401 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m02:48:58.556882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9a1acf8c-35f1-44a8-9e10-48d908626489', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a6841b7c0>]}
[0m02:48:58.558240 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m02:48:58.558834 [info ] [MainThread]: 
[0m02:48:58.565600 [debug] [Thread-1  ]: Began running node test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da
[0m02:48:58.566101 [debug] [Thread-2  ]: Began running node test.dbtlearn.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65
[0m02:48:58.567031 [debug] [Thread-3  ]: Began running node test.dbtlearn.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.e1269b5d63
[0m02:48:58.566466 [info ] [Thread-1  ]: 1 of 3 START test dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_  [RUN]
[0m02:48:58.567392 [info ] [Thread-2  ]: 2 of 3 START test dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4  [RUN]
[0m02:48:58.568909 [debug] [Thread-1  ]: Acquiring new snowflake connection 'test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da'
[0m02:48:58.567901 [info ] [Thread-3  ]: 3 of 3 START test dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_  [RUN]
[0m02:48:58.569815 [debug] [Thread-2  ]: Acquiring new snowflake connection 'test.dbtlearn.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65'
[0m02:48:58.570191 [debug] [Thread-1  ]: Began compiling node test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da
[0m02:48:58.570944 [debug] [Thread-3  ]: Acquiring new snowflake connection 'test.dbtlearn.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.e1269b5d63'
[0m02:48:58.571303 [debug] [Thread-2  ]: Began compiling node test.dbtlearn.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65
[0m02:48:58.581547 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da"
[0m02:48:58.582044 [debug] [Thread-3  ]: Began compiling node test.dbtlearn.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.e1269b5d63
[0m02:48:58.588326 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbtlearn.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65"
[0m02:48:58.595155 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbtlearn.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.e1269b5d63"
[0m02:48:58.595434 [debug] [Thread-1  ]: Timing info for test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da (compile): 2023-03-08 02:48:58.571571 => 2023-03-08 02:48:58.595359
[0m02:48:58.595761 [debug] [Thread-1  ]: Began executing node test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da
[0m02:48:58.620393 [debug] [Thread-2  ]: Timing info for test.dbtlearn.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65 (compile): 2023-03-08 02:48:58.582383 => 2023-03-08 02:48:58.620328
[0m02:48:58.620960 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da"
[0m02:48:58.621207 [debug] [Thread-2  ]: Began executing node test.dbtlearn.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65
[0m02:48:58.621543 [debug] [Thread-3  ]: Timing info for test.dbtlearn.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.e1269b5d63 (compile): 2023-03-08 02:48:58.588701 => 2023-03-08 02:48:58.621489
[0m02:48:58.624514 [debug] [Thread-2  ]: Writing runtime sql for node "test.dbtlearn.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65"
[0m02:48:58.624799 [debug] [Thread-3  ]: Began executing node test.dbtlearn.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.e1269b5d63
[0m02:48:58.627477 [debug] [Thread-1  ]: Using snowflake connection "test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da"
[0m02:48:58.673579 [debug] [Thread-3  ]: Writing runtime sql for node "test.dbtlearn.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.e1269b5d63"
[0m02:48:58.673829 [debug] [Thread-1  ]: On test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    with a as (
        
    select
        
        count(*) as expression
    from
        airbnb.dev.dim_listings_w_hosts
    

    ),
    b as (
        
    select
        
        count(*) * 1 as expression
    from
        airbnb.raw.raw_listings
    

    ),
    final as (

        select
            
            a.expression,
            b.expression as compare_expression,
            abs(coalesce(a.expression, 0) - coalesce(b.expression, 0)) as expression_difference,
            abs(coalesce(a.expression, 0) - coalesce(b.expression, 0))/
                nullif(a.expression * 1.0, 0) as expression_difference_percent
        from
        
            a cross join b
        
    )
    -- DEBUG:
    -- select * from final
    select
        *
    from final
    where
        
        expression_difference > 0.0
        

      
    ) dbt_internal_test
[0m02:48:58.674165 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:48:58.675497 [debug] [Thread-2  ]: Using snowflake connection "test.dbtlearn.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65"
[0m02:48:58.676244 [debug] [Thread-2  ]: On test.dbtlearn.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      


    with grouped_expression as (
    select
        
        
    
  
count(distinct room_type) = 4
 as expression


    from airbnb.raw.raw_listings
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors



      
    ) dbt_internal_test
[0m02:48:58.676455 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m02:48:58.678603 [debug] [Thread-3  ]: Using snowflake connection "test.dbtlearn.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.e1269b5d63"
[0m02:48:58.679314 [debug] [Thread-3  ]: On test.dbtlearn.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.e1269b5d63: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.e1269b5d63"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      




    with grouped_expression as (
    select
        
        
    
  


    regexp_instr(price, '^\$[0-9][0-9\.]+$', 1, 1)


 > 0
 as expression


    from airbnb.raw.raw_listings
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors





      
    ) dbt_internal_test
[0m02:48:58.679535 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m02:49:00.998927 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2 seconds
[0m02:49:01.023844 [debug] [Thread-1  ]: Timing info for test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da (execute): 2023-03-08 02:48:58.595967 => 2023-03-08 02:49:01.023735
[0m02:49:01.024282 [debug] [Thread-1  ]: On test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da: Close
[0m02:49:01.444392 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 3 seconds
[0m02:49:01.450337 [debug] [Thread-2  ]: Timing info for test.dbtlearn.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65 (execute): 2023-03-08 02:48:58.621711 => 2023-03-08 02:49:01.450160
[0m02:49:01.451004 [debug] [Thread-2  ]: On test.dbtlearn.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65: Close
[0m02:49:01.506684 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 3 seconds
[0m02:49:01.513078 [debug] [Thread-3  ]: Timing info for test.dbtlearn.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.e1269b5d63 (execute): 2023-03-08 02:48:58.627641 => 2023-03-08 02:49:01.512956
[0m02:49:01.513571 [debug] [Thread-3  ]: On test.dbtlearn.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.e1269b5d63: Close
[0m02:49:01.774216 [info ] [Thread-1  ]: 1 of 3 PASS dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_  [[32mPASS[0m in 3.21s]
[0m02:49:01.777513 [debug] [Thread-1  ]: Finished running node test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da
[0m02:49:02.068586 [info ] [Thread-2  ]: 2 of 3 PASS dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4  [[32mPASS[0m in 3.50s]
[0m02:49:02.069723 [debug] [Thread-2  ]: Finished running node test.dbtlearn.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65
[0m02:49:02.095712 [error] [Thread-3  ]: 3 of 3 FAIL 17499 dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_  [[31mFAIL 17499[0m in 3.53s]
[0m02:49:02.096528 [debug] [Thread-3  ]: Finished running node test.dbtlearn.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.e1269b5d63
[0m02:49:02.098894 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m02:49:02.099930 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:49:02.100272 [debug] [MainThread]: Connection 'test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da' was properly closed.
[0m02:49:02.100568 [debug] [MainThread]: Connection 'test.dbtlearn.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65' was properly closed.
[0m02:49:02.100854 [debug] [MainThread]: Connection 'test.dbtlearn.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.e1269b5d63' was properly closed.
[0m02:49:02.101212 [info ] [MainThread]: 
[0m02:49:02.101736 [info ] [MainThread]: Finished running 3 tests in 0 hours 0 minutes and 6.55 seconds (6.55s).
[0m02:49:02.102548 [debug] [MainThread]: Command end result
[0m02:49:02.123082 [info ] [MainThread]: 
[0m02:49:02.123612 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m02:49:02.123963 [info ] [MainThread]: 
[0m02:49:02.124312 [error] [MainThread]: [31mFailure in test dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_ (models/sources.yml)[0m
[0m02:49:02.124654 [error] [MainThread]:   Got 17499 results, configured to fail if != 0
[0m02:49:02.124976 [info ] [MainThread]: 
[0m02:49:02.125299 [info ] [MainThread]:   compiled Code at target/compiled/dbtlearn/models/sources.yml/dbt_expectations_source_expect_a60b59a84fbc4577a11df360c50013bb.sql
[0m02:49:02.125628 [info ] [MainThread]: 
[0m02:49:02.125908 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m02:49:02.126278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a78519460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a8abe3df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a8aa66f40>]}
[0m02:49:02.126586 [debug] [MainThread]: Flushing usage events


============================== 2023-03-08 02:50:05.378699 | 8dd5f3dc-32ed-4244-a985-c906696487c7 ==============================
[0m02:50:05.378699 [info ] [MainThread]: Running with dbt=1.4.3
[0m02:50:05.380999 [debug] [MainThread]: running dbt with arguments {'debug': True, 'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/katiehuang/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'select': ['source:airbnb.listings'], 'which': 'test', 'rpc_method': 'test'}
[0m02:50:05.381436 [debug] [MainThread]: Tracking: tracking
[0m02:50:05.382395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ef1eb44f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ef1eb4f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ef1eb4d90>]}
[0m02:50:05.417537 [debug] [MainThread]: checksum: c7a5cda64f02d8b9dd20ef412f82fbb79fdce1bb359c3c5dae3d080de7f31bfd, vars: {}, profile: None, target: None, version: 1.4.3
[0m02:50:05.523184 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:50:05.523621 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:50:05.533135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8dd5f3dc-32ed-4244-a985-c906696487c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f01da6490>]}
[0m02:50:05.550485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8dd5f3dc-32ed-4244-a985-c906696487c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ee02678e0>]}
[0m02:50:05.551017 [info ] [MainThread]: Found 8 models, 19 tests, 1 snapshot, 1 analysis, 640 macros, 0 operations, 1 seed file, 3 sources, 1 exposure, 0 metrics
[0m02:50:05.551324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8dd5f3dc-32ed-4244-a985-c906696487c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ee0267970>]}
[0m02:50:05.553326 [info ] [MainThread]: 
[0m02:50:05.554860 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m02:50:05.556405 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_airbnb_dev'
[0m02:50:05.573126 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m02:50:05.573586 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m02:50:05.573926 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:50:07.923364 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 2 seconds
[0m02:50:07.928835 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m02:50:08.600745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8dd5f3dc-32ed-4244-a985-c906696487c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ee03e57f0>]}
[0m02:50:08.602388 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m02:50:08.602961 [info ] [MainThread]: 
[0m02:50:08.609922 [debug] [Thread-1  ]: Began running node test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da
[0m02:50:08.610579 [debug] [Thread-2  ]: Began running node test.dbtlearn.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65
[0m02:50:08.611159 [info ] [Thread-1  ]: 1 of 3 START test dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_  [RUN]
[0m02:50:08.611573 [debug] [Thread-3  ]: Began running node test.dbtlearn.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.e1269b5d63
[0m02:50:08.612102 [info ] [Thread-2  ]: 2 of 3 START test dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4  [RUN]
[0m02:50:08.613525 [debug] [Thread-1  ]: Acquiring new snowflake connection 'test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da'
[0m02:50:08.614073 [info ] [Thread-3  ]: 3 of 3 START test dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_  [RUN]
[0m02:50:08.615013 [debug] [Thread-2  ]: Acquiring new snowflake connection 'test.dbtlearn.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65'
[0m02:50:08.615548 [debug] [Thread-1  ]: Began compiling node test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da
[0m02:50:08.616506 [debug] [Thread-3  ]: Acquiring new snowflake connection 'test.dbtlearn.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.e1269b5d63'
[0m02:50:08.617028 [debug] [Thread-2  ]: Began compiling node test.dbtlearn.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65
[0m02:50:08.636619 [debug] [Thread-3  ]: Began compiling node test.dbtlearn.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.e1269b5d63
[0m02:50:08.666735 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da"
[0m02:50:08.669071 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbtlearn.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65"
[0m02:50:08.681109 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbtlearn.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.e1269b5d63"
[0m02:50:08.681827 [debug] [Thread-1  ]: Timing info for test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da (compile): 2023-03-08 02:50:08.617308 => 2023-03-08 02:50:08.681751
[0m02:50:08.682159 [debug] [Thread-2  ]: Timing info for test.dbtlearn.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65 (compile): 2023-03-08 02:50:08.642780 => 2023-03-08 02:50:08.682108
[0m02:50:08.682492 [debug] [Thread-1  ]: Began executing node test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da
[0m02:50:08.682855 [debug] [Thread-2  ]: Began executing node test.dbtlearn.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65
[0m02:50:08.689481 [debug] [Thread-3  ]: Timing info for test.dbtlearn.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.e1269b5d63 (compile): 2023-03-08 02:50:08.669346 => 2023-03-08 02:50:08.689413
[0m02:50:08.714988 [debug] [Thread-3  ]: Began executing node test.dbtlearn.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.e1269b5d63
[0m02:50:08.724108 [debug] [Thread-3  ]: Writing runtime sql for node "test.dbtlearn.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.e1269b5d63"
[0m02:50:08.724877 [debug] [Thread-2  ]: Writing runtime sql for node "test.dbtlearn.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65"
[0m02:50:08.725322 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da"
[0m02:50:08.727099 [debug] [Thread-2  ]: Using snowflake connection "test.dbtlearn.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65"
[0m02:50:08.728226 [debug] [Thread-3  ]: Using snowflake connection "test.dbtlearn.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.e1269b5d63"
[0m02:50:08.728519 [debug] [Thread-2  ]: On test.dbtlearn.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      


    with grouped_expression as (
    select
        
        
    
  
count(distinct room_type) = 4
 as expression


    from airbnb.raw.raw_listings
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors



      
    ) dbt_internal_test
[0m02:50:08.730201 [debug] [Thread-1  ]: Using snowflake connection "test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da"
[0m02:50:08.730508 [debug] [Thread-3  ]: On test.dbtlearn.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.e1269b5d63: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.e1269b5d63"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      




    with grouped_expression as (
    select
        
        
    
  


    regexp_instr(price, '^\$[0-9][0-9\.]+$', 1, 1)


 > 0
 as expression


    from airbnb.raw.raw_listings
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors





      
    ) dbt_internal_test
[0m02:50:08.730873 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m02:50:08.731184 [debug] [Thread-1  ]: On test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    with a as (
        
    select
        
        count(*) as expression
    from
        airbnb.dev.dim_listings_w_hosts
    

    ),
    b as (
        
    select
        
        count(*) * 1 as expression
    from
        airbnb.raw.raw_listings
    

    ),
    final as (

        select
            
            a.expression,
            b.expression as compare_expression,
            abs(coalesce(a.expression, 0) - coalesce(b.expression, 0)) as expression_difference,
            abs(coalesce(a.expression, 0) - coalesce(b.expression, 0))/
                nullif(a.expression * 1.0, 0) as expression_difference_percent
        from
        
            a cross join b
        
    )
    -- DEBUG:
    -- select * from final
    select
        *
    from final
    where
        
        expression_difference > 0.0
        

      
    ) dbt_internal_test
[0m02:50:08.731506 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m02:50:08.732528 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:50:11.079295 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 2 seconds
[0m02:50:11.100005 [debug] [Thread-2  ]: Timing info for test.dbtlearn.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65 (execute): 2023-03-08 02:50:08.696158 => 2023-03-08 02:50:11.099915
[0m02:50:11.100602 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 2 seconds
[0m02:50:11.101209 [debug] [Thread-2  ]: On test.dbtlearn.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65: Close
[0m02:50:11.103908 [debug] [Thread-3  ]: Timing info for test.dbtlearn.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.e1269b5d63 (execute): 2023-03-08 02:50:08.721076 => 2023-03-08 02:50:11.103811
[0m02:50:11.105758 [debug] [Thread-3  ]: On test.dbtlearn.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.e1269b5d63: Close
[0m02:50:11.277152 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 3 seconds
[0m02:50:11.282540 [debug] [Thread-1  ]: Timing info for test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da (execute): 2023-03-08 02:50:08.683124 => 2023-03-08 02:50:11.282400
[0m02:50:11.283640 [debug] [Thread-1  ]: On test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da: Close
[0m02:50:11.733529 [info ] [Thread-2  ]: 2 of 3 PASS dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4  [[32mPASS[0m in 3.12s]
[0m02:50:11.737202 [debug] [Thread-2  ]: Finished running node test.dbtlearn.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65
[0m02:50:11.771289 [error] [Thread-3  ]: 3 of 3 FAIL 17499 dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_  [[31mFAIL 17499[0m in 3.15s]
[0m02:50:11.772166 [debug] [Thread-3  ]: Finished running node test.dbtlearn.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.e1269b5d63
[0m02:50:11.969649 [info ] [Thread-1  ]: 1 of 3 PASS dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_  [[32mPASS[0m in 3.36s]
[0m02:50:11.970723 [debug] [Thread-1  ]: Finished running node test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da
[0m02:50:11.975064 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m02:50:11.976257 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:50:11.976783 [debug] [MainThread]: Connection 'test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da' was properly closed.
[0m02:50:11.977253 [debug] [MainThread]: Connection 'test.dbtlearn.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65' was properly closed.
[0m02:50:11.977707 [debug] [MainThread]: Connection 'test.dbtlearn.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.e1269b5d63' was properly closed.
[0m02:50:11.978242 [info ] [MainThread]: 
[0m02:50:11.978740 [info ] [MainThread]: Finished running 3 tests in 0 hours 0 minutes and 6.42 seconds (6.42s).
[0m02:50:11.979537 [debug] [MainThread]: Command end result
[0m02:50:12.003638 [info ] [MainThread]: 
[0m02:50:12.004105 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m02:50:12.004406 [info ] [MainThread]: 
[0m02:50:12.004710 [error] [MainThread]: [31mFailure in test dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_ (models/sources.yml)[0m
[0m02:50:12.004999 [error] [MainThread]:   Got 17499 results, configured to fail if != 0
[0m02:50:12.005282 [info ] [MainThread]: 
[0m02:50:12.005559 [info ] [MainThread]:   compiled Code at target/compiled/dbtlearn/models/sources.yml/dbt_expectations_source_expect_a60b59a84fbc4577a11df360c50013bb.sql
[0m02:50:12.005849 [info ] [MainThread]: 
[0m02:50:12.006130 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m02:50:12.006507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ef1fbae80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ef1fb7880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ef1fb78b0>]}
[0m02:50:12.006926 [debug] [MainThread]: Flushing usage events


============================== 2023-03-08 02:57:17.709348 | 9d4b08ad-049d-449c-8cab-3957edae46e9 ==============================
[0m02:57:17.709348 [info ] [MainThread]: Running with dbt=1.4.3
[0m02:57:17.711612 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/katiehuang/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'select': ['source:airbnb.listings'], 'which': 'test', 'rpc_method': 'test'}
[0m02:57:17.712000 [debug] [MainThread]: Tracking: tracking
[0m02:57:17.712495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faad14bc3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faad14bce20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faad14bcc70>]}
[0m02:57:17.748555 [debug] [MainThread]: checksum: c7a5cda64f02d8b9dd20ef412f82fbb79fdce1bb359c3c5dae3d080de7f31bfd, vars: {}, profile: None, target: None, version: 1.4.3
[0m02:57:17.859140 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:57:17.860746 [debug] [MainThread]: Partial parsing: updated file: dbtlearn://models/sources.yml
[0m02:57:17.882552 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_w_hosts.sql
[0m02:57:17.899941 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_listings_cleansed.sql
[0m02:57:17.906990 [debug] [MainThread]: 1699: static parser successfully parsed src/src_listings.sql
[0m02:57:17.912698 [debug] [MainThread]: 1699: static parser successfully parsed dim/dim_hosts_cleansed.sql
[0m02:57:17.918382 [debug] [MainThread]: 1699: static parser successfully parsed src/src_hosts.sql
[0m02:57:17.923949 [debug] [MainThread]: 1699: static parser successfully parsed mart/mart_fullmoon_reviews.sql
[0m02:57:17.929438 [debug] [MainThread]: 1603: static parser failed on fct/fct_reviews.sql
[0m02:57:17.998104 [debug] [MainThread]: 1602: parser fallback to jinja rendering on fct/fct_reviews.sql
[0m02:57:17.999796 [debug] [MainThread]: 1699: static parser successfully parsed src/src_reviews.sql
[0m02:57:18.212867 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Starting in v1.3, the 'name' of an exposure should contain only letters,
numbers, and underscores. Exposures support a new property, 'label', which may
contain spaces, capital letters, and special characters. Executive Dashboard
does not follow this pattern. Please update the 'name', and use the 'label'
property for a human-friendly title. This will raise an error in a future
version of dbt-core.
[0m02:57:18.213346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '9d4b08ad-049d-449c-8cab-3957edae46e9', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faad1577fa0>]}
[0m02:57:18.274952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9d4b08ad-049d-449c-8cab-3957edae46e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faad16ab940>]}
[0m02:57:18.291826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9d4b08ad-049d-449c-8cab-3957edae46e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faac035d4c0>]}
[0m02:57:18.292206 [info ] [MainThread]: Found 8 models, 19 tests, 1 snapshot, 1 analysis, 640 macros, 0 operations, 1 seed file, 3 sources, 1 exposure, 0 metrics
[0m02:57:18.292527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9d4b08ad-049d-449c-8cab-3957edae46e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faac041ff40>]}
[0m02:57:18.294168 [info ] [MainThread]: 
[0m02:57:18.295672 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m02:57:18.297052 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_airbnb_dev'
[0m02:57:18.312823 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m02:57:18.313105 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m02:57:18.313329 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:57:21.777032 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 3 seconds
[0m02:57:21.782916 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m02:57:22.573627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9d4b08ad-049d-449c-8cab-3957edae46e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faac03574f0>]}
[0m02:57:22.574924 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m02:57:22.575523 [info ] [MainThread]: 
[0m02:57:22.583384 [debug] [Thread-1  ]: Began running node test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da
[0m02:57:22.583874 [debug] [Thread-2  ]: Began running node test.dbtlearn.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65
[0m02:57:22.584287 [debug] [Thread-3  ]: Began running node test.dbtlearn.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9
[0m02:57:22.584666 [info ] [Thread-1  ]: 1 of 3 START test dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_  [RUN]
[0m02:57:22.585328 [info ] [Thread-2  ]: 2 of 3 START test dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4  [RUN]
[0m02:57:22.585887 [info ] [Thread-3  ]: 3 of 3 START test dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_  [RUN]
[0m02:57:22.586846 [debug] [Thread-1  ]: Acquiring new snowflake connection 'test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da'
[0m02:57:22.588020 [debug] [Thread-2  ]: Acquiring new snowflake connection 'test.dbtlearn.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65'
[0m02:57:22.588726 [debug] [Thread-3  ]: Acquiring new snowflake connection 'test.dbtlearn.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9'
[0m02:57:22.589093 [debug] [Thread-1  ]: Began compiling node test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da
[0m02:57:22.589425 [debug] [Thread-2  ]: Began compiling node test.dbtlearn.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65
[0m02:57:22.589736 [debug] [Thread-3  ]: Began compiling node test.dbtlearn.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9
[0m02:57:22.600153 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da"
[0m02:57:22.606957 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbtlearn.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65"
[0m02:57:22.613283 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbtlearn.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9"
[0m02:57:22.614573 [debug] [Thread-2  ]: Timing info for test.dbtlearn.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65 (compile): 2023-03-08 02:57:22.600469 => 2023-03-08 02:57:22.614499
[0m02:57:22.614817 [debug] [Thread-1  ]: Timing info for test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da (compile): 2023-03-08 02:57:22.589982 => 2023-03-08 02:57:22.614768
[0m02:57:22.615004 [debug] [Thread-3  ]: Timing info for test.dbtlearn.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9 (compile): 2023-03-08 02:57:22.607203 => 2023-03-08 02:57:22.614970
[0m02:57:22.615210 [debug] [Thread-2  ]: Began executing node test.dbtlearn.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65
[0m02:57:22.615437 [debug] [Thread-1  ]: Began executing node test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da
[0m02:57:22.615643 [debug] [Thread-3  ]: Began executing node test.dbtlearn.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9
[0m02:57:22.652234 [debug] [Thread-2  ]: Writing runtime sql for node "test.dbtlearn.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65"
[0m02:57:22.653648 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da"
[0m02:57:22.701920 [debug] [Thread-3  ]: Writing runtime sql for node "test.dbtlearn.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9"
[0m02:57:22.704715 [debug] [Thread-3  ]: Using snowflake connection "test.dbtlearn.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9"
[0m02:57:22.705737 [debug] [Thread-2  ]: Using snowflake connection "test.dbtlearn.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65"
[0m02:57:22.705949 [debug] [Thread-3  ]: On test.dbtlearn.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      




    with grouped_expression as (
    select
        
        
    
  


    regexp_instr(price, '^\\$[0-9][0-9\\.]+$', 1, 1)


 > 0
 as expression


    from airbnb.raw.raw_listings
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors





      
    ) dbt_internal_test
[0m02:57:22.707584 [debug] [Thread-1  ]: Using snowflake connection "test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da"
[0m02:57:22.707776 [debug] [Thread-2  ]: On test.dbtlearn.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      


    with grouped_expression as (
    select
        
        
    
  
count(distinct room_type) = 4
 as expression


    from airbnb.raw.raw_listings
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors



      
    ) dbt_internal_test
[0m02:57:22.707986 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m02:57:22.708190 [debug] [Thread-1  ]: On test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da: /* {"app": "dbt", "dbt_version": "1.4.3", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    with a as (
        
    select
        
        count(*) as expression
    from
        airbnb.dev.dim_listings_w_hosts
    

    ),
    b as (
        
    select
        
        count(*) * 1 as expression
    from
        airbnb.raw.raw_listings
    

    ),
    final as (

        select
            
            a.expression,
            b.expression as compare_expression,
            abs(coalesce(a.expression, 0) - coalesce(b.expression, 0)) as expression_difference,
            abs(coalesce(a.expression, 0) - coalesce(b.expression, 0))/
                nullif(a.expression * 1.0, 0) as expression_difference_percent
        from
        
            a cross join b
        
    )
    -- DEBUG:
    -- select * from final
    select
        *
    from final
    where
        
        expression_difference > 0.0
        

      
    ) dbt_internal_test
[0m02:57:22.708373 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m02:57:22.708835 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:57:24.910357 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 2 seconds
[0m02:57:24.937681 [debug] [Thread-2  ]: Timing info for test.dbtlearn.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65 (execute): 2023-03-08 02:57:22.615806 => 2023-03-08 02:57:24.937562
[0m02:57:24.938129 [debug] [Thread-2  ]: On test.dbtlearn.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65: Close
[0m02:57:24.975745 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2 seconds
[0m02:57:24.980838 [debug] [Thread-1  ]: Timing info for test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da (execute): 2023-03-08 02:57:22.628354 => 2023-03-08 02:57:24.980654
[0m02:57:24.981520 [debug] [Thread-1  ]: On test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da: Close
[0m02:57:25.025560 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 2 seconds
[0m02:57:25.030365 [debug] [Thread-3  ]: Timing info for test.dbtlearn.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9 (execute): 2023-03-08 02:57:22.653828 => 2023-03-08 02:57:25.030154
[0m02:57:25.031091 [debug] [Thread-3  ]: On test.dbtlearn.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9: Close
[0m02:57:25.507467 [info ] [Thread-2  ]: 2 of 3 PASS dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4  [[32mPASS[0m in 2.92s]
[0m02:57:25.512950 [debug] [Thread-2  ]: Finished running node test.dbtlearn.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65
[0m02:57:25.575642 [info ] [Thread-1  ]: 1 of 3 PASS dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_  [[32mPASS[0m in 2.99s]
[0m02:57:25.577458 [debug] [Thread-1  ]: Finished running node test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da
[0m02:57:25.645355 [info ] [Thread-3  ]: 3 of 3 PASS dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_  [[32mPASS[0m in 3.06s]
[0m02:57:25.646986 [debug] [Thread-3  ]: Finished running node test.dbtlearn.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9
[0m02:57:25.650392 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m02:57:25.651586 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:57:25.652052 [debug] [MainThread]: Connection 'test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da' was properly closed.
[0m02:57:25.652369 [debug] [MainThread]: Connection 'test.dbtlearn.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65' was properly closed.
[0m02:57:25.652680 [debug] [MainThread]: Connection 'test.dbtlearn.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_0_9_.09375076a9' was properly closed.
[0m02:57:25.653170 [info ] [MainThread]: 
[0m02:57:25.654221 [info ] [MainThread]: Finished running 3 tests in 0 hours 0 minutes and 7.36 seconds (7.36s).
[0m02:57:25.655423 [debug] [MainThread]: Command end result
[0m02:57:25.680279 [info ] [MainThread]: 
[0m02:57:25.680876 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:57:25.681262 [info ] [MainThread]: 
[0m02:57:25.681646 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m02:57:25.682137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faae2826640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faae2826610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faae2826730>]}
[0m02:57:25.682519 [debug] [MainThread]: Flushing usage events
